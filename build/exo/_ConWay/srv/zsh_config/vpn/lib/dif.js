!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).diffusion=e()}}((function(){var e=function(e){var t;return function(r){return t||e(t={exports:{},parent:r},t.exports),t.exports}},t=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GET_METRICS=t.FETCH_JMX_VALUES=t.LIST_TOPIC_METRIC_COLLECTORS=t.REMOVE_TOPIC_METRIC_COLLECTOR=t.PUT_TOPIC_METRIC_COLLECTOR=t.GET_MEASURED_ENTITY_CLASS_METRICS=t.GET_SERVER_METRICS=t.LIST_SESSION_METRIC_COLLECTORS=t.REMOVE_SESSION_METRIC_COLLECTOR=t.PUT_SESSION_METRIC_COLLECTOR=void 0;var n=r({});t.PUT_SESSION_METRIC_COLLECTOR={id:135,request:gO.SessionMetricCollectorSerialiser,response:yw.ErrorReportListSerialiser},t.REMOVE_SESSION_METRIC_COLLECTOR={id:136,request:q_.StringSerialiser,response:av.NullSerialiser},t.LIST_SESSION_METRIC_COLLECTORS={id:137,request:av.NullSerialiser,response:IO.SessionMetricCollectorListSerialiser},t.GET_SERVER_METRICS={id:142,request:av.NullSerialiser,response:QO.ServerMetricsSerialiser},t.GET_MEASURED_ENTITY_CLASS_METRICS={id:145,request:YO.MeasuredEntityClassRequestSerialiser,response:BO.MeasuredEntityClassMetricsSerialiser},t.PUT_TOPIC_METRIC_COLLECTOR={id:146,request:PO.TopicMetricCollectorSerialiser,response:av.NullSerialiser},t.REMOVE_TOPIC_METRIC_COLLECTOR={id:147,request:q_.StringSerialiser,response:av.NullSerialiser},t.LIST_TOPIC_METRIC_COLLECTORS={id:148,request:av.NullSerialiser,response:DO.TopicMetricCollectorListSerialiser},t.FETCH_JMX_VALUES={id:149,request:tO.JMXFetchRequestSerialiser,response:uO.JMXFetchResponseSerialiser},t.GET_METRICS={id:186,request:n.MetricsRequestSerialiser,response:dO.MetricsResultSerialiser}})),r=e((function(e,t){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsRequestSerialiser=void 0;var a=n({}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.write=function(e,t){Iu.writeCollection(e,s([],i(t.filters.values())),Iu.writeString),Iu.writeString(e,t.pattern),Wh.write(e,t.requestType),t.requestType===a.RequestType.NAMED_SERVER&&Iu.writeString(e,t.server)},t}(Fu.AbstractSerialiser);t.MetricsRequestSerialiser=new u})),n=e((function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MetricsRequestImpl=r.RequestType=void 0;var n,o=t({});!function(e){e[e.CURRENT_SERVER=0]="CURRENT_SERVER",e[e.ALL_SERVERS=1]="ALL_SERVERS",e[e.NAMED_SERVER=2]="NAMED_SERVER"}(n=r.RequestType||(r.RequestType={}));var i=function(){function e(e,t,r,n,o){this.theFilters=e,this.pattern=t,this.theServer=r,this.theRequestType=n,this.internal=o}return e.create=function(t){return new e(new Set,void 0,void 0,n.ALL_SERVERS,t)},e.prototype.filter=function(t){return Zl.requireNonNull(t,"filters"),"string"==typeof t||t instanceof RegExp?new e(new Set,t instanceof RegExp?t.source:t,this.theServer,this.theRequestType,this.internal):new e(new Set(t),void 0,this.theServer,this.theRequestType,this.internal)},e.prototype.server=function(t){if(Zl.requireNonNull(t,"server"),""===t)throw new va.IllegalArgumentError("server must not be empty");return new e(this.theFilters,this.pattern,t,n.NAMED_SERVER,this.internal)},e.prototype.currentServer=function(){return new e(this.theFilters,this.pattern,void 0,n.CURRENT_SERVER,this.internal)},e.prototype.fetch=function(){var e,t=this,r={filters:this.theFilters,pattern:null!==(e=this.pattern)&&void 0!==e?e:"",server:this.theServer,requestType:this.theRequestType};return new Promise((function(e,n){t.internal.checkConnected(n)&&t.internal.getServiceLocator().obtain(o.GET_METRICS).send(r,(function(t,r){t?n(t):e(r)}))}))},e}();r.MetricsRequestImpl=i})),o=e((function(e,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},n=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.GatewayControlImpl=t.ConfigurationMode=t.StatusLevel=void 0;var o=i({});!function(e){e[e.GREEN=0]="GREEN",e[e.AMBER=1]="AMBER",e[e.RED=2]="RED"}(t.StatusLevel||(t.StatusLevel={})),function(e){e[e.STATIC=0]="STATIC",e[e.DYNAMIC=1]="DYNAMIC"}(t.ConfigurationMode||(t.ConfigurationMode={}));var s=function(){function e(e){this.internal=e,this.clientRequestsService=e.getServiceLocator().obtain(o.GATEWAY_CLIENT_REQUEST),this.getClientsService=e.getServiceLocator().obtain(o.GET_GATEWAY_CLIENTS),this.getClientDetailsService=e.getServiceLocator().obtain(o.GET_GATEWAY_CLIENT_DETAILS),this.registerClientService=e.getServiceLocator().obtain(o.REGISTER_GATEWAY_CLIENT),this.removeClientService=e.getServiceLocator().obtain(o.REMOVE_GATEWAY_CLIENT)}return e.prototype.checkSessionId=function(e){if(e instanceof qd.SessionId)return e;if("string"==typeof e)return qd.SessionId.fromString(e);if(null===e)throw new va.IllegalArgumentError("Session ID must be a string or instance of SessionId, but was null");throw new va.IllegalArgumentError("Session ID must be a string or instance of SessionId, but was of type: "+typeof e)},e.prototype.checkClientKey=function(e){if(null==e||"object"!=typeof e)throw new va.IllegalArgumentError("clientKey must be a non-null object");if(null===e.type||void 0===e.type)throw new va.IllegalArgumentError("clientKey type must not be null or undefined");if(null===e.id||void 0===e.id)throw new va.IllegalArgumentError("clientKey id must not be null or undefined");return e},e.prototype.checkOperationName=function(e){return this.checkStringArgument(e,"Operation name")},e.prototype.checkStringArgument=function(e,t){if("string"==typeof e)return e;if(null===e)throw new va.IllegalArgumentError(t+" must be a string, but was null");throw new va.IllegalArgumentError(t+" must be a string, but was of type: "+typeof e)},e.prototype.checkServiceId=function(e){return{name:this.checkStringArgument(e.name,"Service ID name"),type:this.checkStringArgument(e.type,"Service ID type")}},e.prototype.checkServiceHandle=function(e){return r(r({},this.checkServiceId(e)),{sessionId:this.checkSessionId(e.sessionId)})},e.prototype.sessionContextTransformer=function(e){return function(t){return r(r({},t),{id:r(r({},t.id),{sessionId:e})})}},e.prototype.getConfiguration=function(e){var t=this,r=this.checkSessionId(e);return new Promise((function(e,n){t.internal.checkConnected(n)&&t.clientRequestsService.send(new Em.GatewayClientGetConfigurationRequest(r),(function(t,r){t?n(t):e(r)}))}))},e.prototype.getStatus=function(e){var t=this,r=this.checkSessionId(e);return new Promise((function(e,n){t.internal.checkConnected(n)&&t.clientRequestsService.send(new Cm.GatewayClientGetStatusRequest(r),(function(t,r){t?n(t):e(r)}))}))},e.prototype.getClients=function(){var e=this;return new Promise((function(t,r){e.internal.checkConnected(r)&&e.getClientsService.send(null,(function(e,n){e?r(e):t(n)}))}))},e.prototype.getClientDetailList=function(e){var t=this;return new Promise((function(r,n){t.internal.checkConnected(n)&&t.getClientDetailsService.send(e,(function(e,t){e?n(e):r(t)}))}))},e.prototype.registerClient=function(e){var t=this,r=this.checkClientKey(e);return new Promise((function(e,n){t.internal.checkConnected(n)&&t.registerClientService.send(r,(function(t){t?n(t):e()}))}))},e.prototype.removeClient=function(e){var t=this,r=this.checkClientKey(e);return new Promise((function(e,n){t.internal.checkConnected(n)&&t.removeClientService.send(r,(function(t){t?n(t):e()}))}))},e.prototype.getOperations=function(e){var t=this,r=this.checkSessionId(e);return new Promise((function(e,n){t.internal.checkConnected(n)&&t.clientRequestsService.send(new Um.GatewayClientGetOperationsRequest(r),(function(t,r){t?n(t):e(r)}))}))},e.prototype.getOperationDetail=function(e,t){var r=this,n=this.checkSessionId(e),o=this.checkOperationName(t);return new Promise((function(e,t){r.internal.checkConnected(t)&&r.clientRequestsService.send(new jm.GatewayClientGetOperationDetailRequest(n,o),(function(r,n){r?t(r):e(n)}))}))},e.prototype.invokeOperation=function(e,t,r){var n=this,o=this.checkSessionId(e),i=this.checkOperationName(t),s=null===r?void 0:r;return new Promise((function(e,t){n.internal.checkConnected(t)&&n.clientRequestsService.send(new Vm.GatewayClientInvokeOperationRequest(o,i,s),(function(r,n){r?t(r):e(n)}))}))},e.prototype.getServiceTypes=function(e){var t=this,r=this.checkSessionId(e);return new Promise((function(e,n){t.internal.checkConnected(n)&&t.clientRequestsService.send(new gm.GatewayClientGetServiceTypesRequest(r),(function(t,r){t?n(t):e(r.serviceTypes)}))}))},e.prototype.getServices=function(e){var t=this,r=this.checkSessionId(e);return new Promise((function(e,n){t.internal.checkConnected(n)&&t.clientRequestsService.send(new Im.GatewayClientGetServicesRequest(r),(function(o,i){if(o)n(o);else{var s=t.sessionContextTransformer(r);e(i.services.map(s))}}))}))},e.prototype.addService=function(e,t,r,n){var o=this,i=this.checkSessionId(e),s={id:this.checkServiceId(t),description:this.checkStringArgument(r,"Service description"),configuration:this.checkStringArgument(n,"Service configuration")};return new Promise((function(e,t){o.internal.checkConnected(t)&&o.clientRequestsService.send(new vm.GatewayClientAddServiceRequest(i,s),(function(r,n){if(r)t(r);else{var s=o.sessionContextTransformer(i);e(s(n.service))}}))}))},e.prototype.updateService=function(e,t,r){var o=this,i=this.checkServiceHandle(e),s=i.sessionId,a=n(i,["sessionId"]);if(null==t&&null==r)return Promise.reject(new Error("Missing parameter: you must provide configuration or description (or both) when calling updateService"));var u={id:a,description:t,configuration:r};return new Promise((function(e,t){o.internal.checkConnected(t)&&o.clientRequestsService.send(new Nm.GatewayClientUpdateServiceRequest(s,u),(function(r,n){if(r)t(r);else{var i=o.sessionContextTransformer(s);e(i(n.service))}}))}))},e.prototype.removeService=function(e){var t=this,r=this.checkServiceHandle(e),o=r.sessionId,i=n(r,["sessionId"]);return new Promise((function(e,r){t.internal.checkConnected(r)&&t.clientRequestsService.send(new Wm.GatewayClientRemoveServiceRequest(o,i),(function(t,n){t?r(t):e()}))}))},e.prototype.getServiceStatus=function(e){var t=this,r=this.checkServiceHandle(e),o=r.sessionId,i=n(r,["sessionId"]);return new Promise((function(e,r){t.internal.checkConnected(r)&&t.clientRequestsService.send(new og.GatewayServiceGetStatusRequest(o,i),(function(t,n){t?r(t):e(n)}))}))},e.prototype.getServiceConfiguration=function(e){var t=this,r=this.checkServiceHandle(e),o=r.sessionId,i=n(r,["sessionId"]);return new Promise((function(e,r){t.internal.checkConnected(r)&&t.clientRequestsService.send(new Km.GatewayServiceGetConfigurationRequest(o,i),(function(t,n){t?r(t):e(n)}))}))},e.prototype.getServiceOperations=function(e){var t=this,r=this.checkServiceHandle(e),o=r.sessionId,i=n(r,["sessionId"]);return new Promise((function(e,r){t.internal.checkConnected(r)&&t.clientRequestsService.send(new tg.GatewayServiceGetOperationsRequest(o,i),(function(t,n){t?r(t):e(n)}))}))},e.prototype.getServiceOperationDetail=function(e,t){var r=this,o=this.checkServiceHandle(e),i=o.sessionId,s=n(o,["sessionId"]),a=this.checkOperationName(t);return new Promise((function(e,t){r.internal.checkConnected(t)&&r.clientRequestsService.send(new Xm.GatewayServiceGetOperationDetailRequest(i,s,a),(function(r,n){r?t(r):e(n)}))}))},e.prototype.invokeServiceOperation=function(e,t,r){var o=this,i=this.checkServiceHandle(e),s=i.sessionId,a=n(i,["sessionId"]),u=this.checkOperationName(t),c=null===r?void 0:r;return new Promise((function(e,t){o.internal.checkConnected(t)&&o.clientRequestsService.send(new ag.GatewayServiceInvokeOperationRequest(s,a,u,c),(function(r,n){r?t(r):e(n)}))}))},e}();t.GatewayControlImpl=s})),i=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GET_GATEWAY_CLIENT_DETAILS=t.GET_GATEWAY_CLIENTS=t.REMOVE_GATEWAY_CLIENT=t.REGISTER_GATEWAY_CLIENT=t.GATEWAY_CLIENT_REQUEST=void 0;var r=u({}),n=s({});t.GATEWAY_CLIENT_REQUEST={id:170,request:Ig.GatewayClientRequestSerialiser,response:n.GatewayResponseSerialiser},t.REGISTER_GATEWAY_CLIENT={id:173,request:hg.GatewayClientKeySerialiser,response:av.NullSerialiser},t.REMOVE_GATEWAY_CLIENT={id:174,request:hg.GatewayClientKeySerialiser,response:av.NullSerialiser},t.GET_GATEWAY_CLIENTS={id:175,request:av.NullSerialiser,response:vg.GatewayClientListSerialiser},t.GET_GATEWAY_CLIENT_DETAILS={id:185,request:lg.GatewayClientDetailListRequestSerialiser,response:r.GatewayClientDetailListSerialiser}})),s=e((function(e,t){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.GatewayResponseSerialiser=void 0;var o=a({}),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.read=function(e){var t=Wh.read(e,ym.GatewayRequestType);switch(t){case ym.GatewayRequestType.GET_CONFIGURATION:case ym.GatewayRequestType.GET_SERVICE_CONFIGURATION:return new Ag.GetConfigurationResponse(t,Iu.readByte(e),Iu.readString(e),Iu.readString(e));case ym.GatewayRequestType.GET_STATUS:case ym.GatewayRequestType.GET_SERVICE_STATUS:return new Ng.GetStatusResponse(t,Iu.readCollection(e,o.StatusItemSerialiser.read));case ym.GatewayRequestType.GET_OPERATIONS:case ym.GatewayRequestType.GET_SERVICE_OPERATIONS:return new Lg.GetOperationsResponse(t,Iu.readCollection(e,qg.GatewayOperationSerialiser.read));case ym.GatewayRequestType.GET_OPERATION_DETAIL:case ym.GatewayRequestType.GET_SERVICE_OPERATION_DETAIL:return new Dg.GetOperationDetailResponse(t,Iu.readString(e),Iu.readByte(e)?Iu.readString(e):void 0,Iu.readByte(e)?Iu.readString(e):void 0);case ym.GatewayRequestType.INVOKE_OPERATION:case ym.GatewayRequestType.INVOKE_SERVICE_OPERATION:return new Ug.InvokeOperationResponse(t,Iu.readByte(e)?Iu.readString(e):void 0);case ym.GatewayRequestType.ADD_SERVICE:case ym.GatewayRequestType.UPDATE_SERVICE:return new Fg.AddUpdateServiceResponse(t,gg.GatewayServiceSerialiser.read(e));case ym.GatewayRequestType.GET_SERVICES:return new Wg.GetServicesResponse(Iu.readCollection(e,gg.GatewayServiceSerialiser.read));case ym.GatewayRequestType.GET_SERVICE_TYPES:return new Hg.GetServiceTypesResponse(Iu.readCollection(e,Qg.GatewayServiceTypeSerialiser.read));case ym.GatewayRequestType.REMOVE_SERVICE:return{type:t};default:throw new Ig.UnknownGatewayRequestTypeError(t)}},t}(Fu.AbstractSerialiser);t.GatewayResponseSerialiser=new i})),a=e((function(e,t){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.StatusItemSerialiser=void 0;var i=o({}),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.read=function(e){return{level:Wh.read(e,i.StatusLevel),timestamp:Iu.readInt64(e),title:Iu.readString(e),description:Iu.readString(e)}},t}(Fu.AbstractSerialiser);t.StatusItemSerialiser=new s})),u=e((function(e,t){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.GatewayClientDetailListSerialiser=void 0;var o=c({}),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.read=function(e){return{gatewayClientDetails:Iu.readCollection(e,o.GatewayClientDetailSerialiser.read)}},t}(Fu.AbstractSerialiser);t.GatewayClientDetailListSerialiser=new i})),c=e((function(e,t){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.GatewayClientDetailSerialiser=void 0;var o=l({}),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.read=function(e){return{key:hg.GatewayClientKeySerialiser.read(e),connectedClientDetails:Iu.readByte(e)?o.GatewayClientConnectedClientDetailsSerialiser.read(e):void 0}},t}(Fu.AbstractSerialiser);t.GatewayClientDetailSerialiser=new i})),l=e((function(e,t){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.GatewayClientConnectedClientDetailsSerialiser=void 0;var i=o({}),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.read=function(e){return{activeSessionId:Iu.readByte(e)?Iu.readString(e):void 0,passiveSessionIds:Iu.readCollection(e,Iu.readString),configurationMode:Iu.readByte(e)?Wh.read(e,i.ConfigurationMode):void 0}},t}(Fu.AbstractSerialiser);t.GatewayClientConnectedClientDetailsSerialiser=new s})),p=e((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataTypes=void 0;var r=f({}),n=function(){function e(){this.recordv2Impl=new Vf.RecordV2DataTypeImpl,this.binaryImpl=new Gl.BinaryDataTypeImpl,this.stringImpl=new Vp.StringDataTypeImpl,this.doubleImpl=new Mp.DoubleDataTypeImpl,this.int64Impl=new xp.Int64DataTypeImpl,this.jsonImpl=new Cp.JSONDataTypeImpl,this.anyImpl=new Gc.AnyDataTypeImpl}return e.prototype.binary=function(){return this.binaryImpl},e.prototype.string=function(){return this.stringImpl},e.prototype.double=function(){return this.doubleImpl},e.prototype.int64=function(){return this.int64Impl},e.prototype.json=function(){return this.jsonImpl},e.prototype.recordv2=function(){return this.recordv2Impl},e.prototype.any=function(){return this.anyImpl},e.prototype.timeseries=function(e){return r.TimeSeriesEventDataType.create(e)},e.prototype.getByName=function(e){switch(e.toLowerCase()){case"json":return this.json();case"int64":return this.int64();case"binary":return this.binary();case"string":return this.string();case"double":return this.double();case"record_v2":return this.recordv2();default:return}},e.prototype.getByValue=function(e){return e===Dc.TopicTypeEnum.BINARY||e instanceof Fl.BinaryImpl||Ou.isUint8Array(e)?this.binary():e===Dc.TopicTypeEnum.JSON||e instanceof mp.JSONImpl||e.constructor===Object||"boolean"==typeof e?this.json():e===Dc.TopicTypeEnum.STRING||"string"==typeof e?this.string():e===Dc.TopicTypeEnum.DOUBLE||"number"==typeof e?this.double():e===Dc.TopicTypeEnum.INT64||e instanceof Yc.Int64Impl?this.int64():e===Dc.TopicTypeEnum.RECORD_V2||e instanceof Sf.RecordV2Impl?this.recordv2():void 0},e.prototype.get=function(e){var t;return"string"==typeof e&&(t=this.getByName(e)),t||(t=this.getByValue(e)),t||(t=this.getByClassSafely(e)),t||null},e.prototype.getChecked=function(e){if(null==e)throw new va.IllegalArgumentError("No data type for "+e);if(e instanceof Vf.RecordV2DataTypeImpl||e instanceof Gl.BinaryDataTypeImpl||e instanceof Vp.StringDataTypeImpl||e instanceof Mp.DoubleDataTypeImpl||e instanceof xp.Int64DataTypeImpl||e instanceof Cp.JSONDataTypeImpl)return e;var t=this.get(e);if(null===t)throw new va.IllegalArgumentError("No data type for "+e);return t},e.prototype.getValueClassChecked=function(e){switch(this.getChecked(e)){case this.jsonImpl:return mp.JSONImpl;case this.binaryImpl:return Fl.BinaryImpl;case this.stringImpl:return String;case this.doubleImpl:return Number;case this.int64Impl:return Yc.Int64Impl;case this.recordv2Impl:return Sf.RecordV2Impl;default:return}},e.prototype.getByClassSafely=function(e){switch(e){case mp.JSONImpl:return this.jsonImpl;case Fl.BinaryImpl:return this.binaryImpl;case String:return this.stringImpl;case Number:return this.doubleImpl;case Yc.Int64Impl:return this.int64Impl;case Sf.RecordV2Impl:return this.recordv2Impl;default:return}},e.prototype.getByClass=function(e){var t=this.getByClassSafely(e);if(t)return t;throw new va.IllegalArgumentError("No data type for "+e)},e}(),o=new n;t.DataTypes=o})),f=e((function(e,t){(function(e){(function(){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.TimeSeriesEventDataType=void 0;var o,i=p({});function s(e,t){var r=new nc.BufferOutputStream;t.isEditEvent?(Iu.writeByte(r,o.EDIT_EVENT),Qf.EventMetadataImplSerialiser.write(r,t.originalEvent)):Iu.writeByte(r,o.ORIGINAL_EVENT),Qf.EventMetadataImplSerialiser.write(r,t);var n=e(t.value);return Iu.writeBytes(r,n.$buffer),r.getBuffer()}function a(e,t){var r=new tc.BufferInputStream(t.$buffer),n=Iu.readByte(r);switch(n){case o.ORIGINAL_EVENT:return function(e,t){var r=Qf.EventMetadataImplSerialiser.read(t),n=e(Iu.readBytes(t));return Hf.EventImpl.create(r,r,n)}(e,r);case o.EDIT_EVENT:return function(e,t){var r=Qf.EventMetadataImplSerialiser.read(t),n=Qf.EventMetadataImplSerialiser.read(t),o=e(Iu.readBytes(t));return Hf.EventImpl.create(n,r,o)}(e,r);default:throw new va.InvalidDataError("Unrecognised event type: "+n)}}!function(e){e[e.ORIGINAL_EVENT=0]="ORIGINAL_EVENT",e[e.EDIT_EVENT=1]="EDIT_EVENT"}(o||(o={}));var u=function(t){function r(e,r,n,o){var u=this,c=i.DataTypes.getByName(r),l=void 0!==c?[{name:c.valueClass.toString(),convert:function(e,t,r){var o=new Bl.BytesImpl(e,t,r);return a(n,o).value}}]:[];return(u=t.call(this,e,Hf.EventImpl,Bl.BytesImpl,(function(e){return function(e,t){if(!t)throw new va.IllegalArgumentError("Cannot convert null event to Bytes");return new Bl.BytesImpl(s(e,t))}(o,e)}),(function(e){return a(n,e)}),l,!0)||this).valueToBytes=o,u.valueTypeName=r,u}return n(r,t),r.create=function(e){return new r("timeseriesevent-"+e.name(),e.name(),e.readValue.bind(e),e.toBytes.bind(e))},r.prototype.writeValue=function(t){return e.from(s(this.valueToBytes,t))},r.prototype.writeValueToArray=function(e){return s(this.valueToBytes,e)},r.prototype.validate=function(){},r.prototype.from=function(e){return e instanceof sl.BufferSlice?e:this.valueToBytes(e.value)},r}(ql.AbstractDataType);t.TimeSeriesEventDataType=u}).call(this)}).call(this,d({}).Buffer)})),h=e((function(e,t){(function(e){(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decompressSync=void 0;var r=require("zlib");t.decompressSync=function(t){var n=t instanceof Uint8Array?void 0===e?t:e.from(t):t;return r.inflateSync(n)}}).call(this)}).call(this,d({}).Buffer)})),d=e((function(e,t){(function(e){(function(){"use strict";t.Buffer=r,t.INSPECT_MAX_BYTES=50;function e(e){if(e>2147483647)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=r.prototype,t}function r(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return i(e)}return n(e,t,r)}function n(t,n,o){if("string"==typeof t)return function(t,n){"string"==typeof n&&""!==n||(n="utf8");if(!r.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var o=0|u(t,n),i=e(o),s=i.write(t,n);s!==o&&(i=i.slice(0,s));return i}(t,n);if(ArrayBuffer.isView(t))return s(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(L(t,ArrayBuffer)||t&&L(t.buffer,ArrayBuffer))return function(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var o;o=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n);return o.__proto__=r.prototype,o}(t,n,o);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return r.from(i,n,o);var c=function(t){if(r.isBuffer(t)){var n=0|a(t.length),o=e(n);return 0===o.length||t.copy(o,0,0,n),o}if(void 0!==t.length)return"number"!=typeof t.length||x(t.length)?e(0):s(t);if("Buffer"===t.type&&Array.isArray(t.data))return s(t.data)}(t);if(c)return c;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return r.from(t[Symbol.toPrimitive]("string"),n,o);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function o(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function i(t){return o(t),e(t<0?0:0|a(t))}function s(t){for(var r=t.length<0?0:0|a(t.length),n=e(r),o=0;o<r;o+=1)n[o]=255&t[o];return n}function a(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function u(e,t){if(r.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||L(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,o=arguments.length>2&&!0===arguments[2];if(!o&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return M(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return D(e).length;default:if(i)return o?-1:M(e).length;t=(""+t).toLowerCase(),i=!0}}function c(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,r);case"utf8":case"utf-8":return w(this,t,r);case"ascii":return m(this,t,r);case"latin1":case"binary":return g(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function l(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function p(e,t,n,o,i){if(0===e.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),x(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=r.from(t,o)),r.isBuffer(t))return 0===t.length?-1:f(e,t,n,o,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):f(e,[t],n,o,i);throw new TypeError("val must be string, number or Buffer")}function f(e,t,r,n,o){var i,s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var l=-1;for(i=r;i<a;i++)if(c(e,i)===c(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(r+u>a&&(r=a-u),i=r;i>=0;i--){for(var p=!0,f=0;f<u;f++)if(c(e,i+f)!==c(t,f)){p=!1;break}if(p)return i}return-1}function h(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;n>i/2&&(n=i/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(x(a))return s;e[r+s]=a}return s}function d(e,t,r,n){return j(M(t,e.length-r),e,r,n)}function y(e,t,r,n){return j(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function v(e,t,r,n){return y(e,t,r,n)}function S(e,t,r,n){return j(D(t),e,r,n)}function _(e,t,r,n){return j(function(e,t){for(var r,n,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function E(e,t,r){return 0===t&&r===e.length?du.fromByteArray(e):du.fromByteArray(e.slice(t,r))}function w(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,s,a,u,c=e[o],l=null,p=c>239?4:c>223?3:c>191?2:1;if(o+p<=r)switch(p){case 1:c<128&&(l=c);break;case 2:128==(192&(i=e[o+1]))&&(u=(31&c)<<6|63&i)>127&&(l=u);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(u=(15&c)<<12|(63&i)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,p=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),o+=p}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}r.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),r.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192,r.from=function(e,t,r){return n(e,t,r)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,r.alloc=function(t,r,n){return function(t,r,n){return o(t),t<=0?e(t):void 0!==r?"string"==typeof n?e(t).fill(r,n):e(t).fill(r):e(t)}(t,r,n)},r.allocUnsafe=function(e){return i(e)},r.allocUnsafeSlow=function(e){return i(e)},r.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==r.prototype},r.compare=function(e,t){if(L(e,Uint8Array)&&(e=r.from(e,e.offset,e.byteLength)),L(t,Uint8Array)&&(t=r.from(t,t.offset,t.byteLength)),!r.isBuffer(e)||!r.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,o=t.length,i=0,s=Math.min(n,o);i<s;++i)if(e[i]!==t[i]){n=e[i],o=t[i];break}return n<o?-1:o<n?1:0},r.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return r.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var o=r.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(L(s,Uint8Array)&&(s=r.from(s)),!r.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(o,i),i+=s.length}return o},r.byteLength=u,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)l(this,t,t+1);return this},r.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)l(this,t,t+3),l(this,t+1,t+2);return this},r.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)l(this,t,t+7),l(this,t+1,t+6),l(this,t+2,t+5),l(this,t+3,t+4);return this},r.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?w(this,0,e):c.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(e){if(!r.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===r.compare(this,e)},r.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},r.prototype.compare=function(e,t,n,o,i){if(L(e,Uint8Array)&&(e=r.from(e,e.offset,e.byteLength)),!r.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===o&&(o=0),void 0===i&&(i=this.length),t<0||n>e.length||o<0||i>this.length)throw new RangeError("out of range index");if(o>=i&&t>=n)return 0;if(o>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(o>>>=0),a=(n>>>=0)-(t>>>=0),u=Math.min(s,a),c=this.slice(o,i),l=e.slice(t,n),p=0;p<u;++p)if(c[p]!==l[p]){s=c[p],a=l[p];break}return s<a?-1:a<s?1:0},r.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},r.prototype.indexOf=function(e,t,r){return p(this,e,t,r,!0)},r.prototype.lastIndexOf=function(e,t,r){return p(this,e,t,r,!1)},r.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return h(this,e,t,r);case"utf8":case"utf-8":return d(this,e,t,r);case"ascii":return y(this,e,t,r);case"latin1":case"binary":return v(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function m(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function g(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function T(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=N(e[i]);return o}function O(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function I(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function b(e,t,n,o,i,s){if(!r.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(n+o>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function C(e,t,r,n,o){return t=+t,r>>>=0,o||R(e,0,r,4),Tu.write(e,t,r,n,23,4),r+4}function A(e,t,r,n,o){return t=+t,r>>>=0,o||R(e,0,r,8),Tu.write(e,t,r,n,52,8),r+8}r.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var o=this.subarray(e,t);return o.__proto__=r.prototype,o},r.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},r.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},r.prototype.readUInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),this[e]},r.prototype.readUInt16LE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]|this[e+1]<<8},r.prototype.readUInt16BE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]<<8|this[e+1]},r.prototype.readUInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},r.prototype.readUInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},r.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},r.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},r.prototype.readInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},r.prototype.readInt16LE=function(e,t){e>>>=0,t||I(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},r.prototype.readInt16BE=function(e,t){e>>>=0,t||I(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},r.prototype.readInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},r.prototype.readInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},r.prototype.readFloatLE=function(e,t){return e>>>=0,t||I(e,4,this.length),Tu.read(this,e,!0,23,4)},r.prototype.readFloatBE=function(e,t){return e>>>=0,t||I(e,4,this.length),Tu.read(this,e,!1,23,4)},r.prototype.readDoubleLE=function(e,t){return e>>>=0,t||I(e,8,this.length),Tu.read(this,e,!0,52,8)},r.prototype.readDoubleBE=function(e,t){return e>>>=0,t||I(e,8,this.length),Tu.read(this,e,!1,52,8)},r.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||b(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},r.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||b(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},r.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,1,255,0),this[t]=255&e,t+1},r.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},r.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},r.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},r.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},r.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var o=Math.pow(2,8*r-1);b(this,e,t,r,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},r.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var o=Math.pow(2,8*r-1);b(this,e,t,r,o-1,-o)}var i=r-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},r.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},r.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},r.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},r.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},r.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},r.prototype.writeFloatLE=function(e,t,r){return C(this,e,t,!0,r)},r.prototype.writeFloatBE=function(e,t,r){return C(this,e,t,!1,r)},r.prototype.writeDoubleLE=function(e,t,r){return A(this,e,t,!0,r)},r.prototype.writeDoubleBE=function(e,t,r){return A(this,e,t,!1,r)},r.prototype.copy=function(e,t,n,o){if(!r.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),o||0===o||(o=this.length),t>=e.length&&(t=e.length),t||(t=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-t<o-n&&(o=e.length-t+n);var i=o-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,o);else if(this===e&&n<t&&t<o)for(var s=i-1;s>=0;--s)e[s+t]=this[s+n];else Uint8Array.prototype.set.call(e,this.subarray(n,o),t);return i},r.prototype.fill=function(e,t,n,o){if("string"==typeof e){if("string"==typeof t?(o=t,t=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!r.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(1===e.length){var i=e.charCodeAt(0);("utf8"===o&&i<128||"latin1"===o)&&(e=i)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var a=r.isBuffer(e)?e:r.from(e,o),u=a.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=a[s%u]}return this};var P=/[^+/0-9A-Za-z-_]/g;function N(e){return e<16?"0"+e.toString(16):e.toString(16)}function M(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function D(e){return du.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function j(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function L(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function x(e){return e!=e}}).call(this)}).call(this,d({}).Buffer)})),y={};(function(e){(function(){var t=function(e){return e&&e.Math==Math&&e};y=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var v=function(e){try{return!!e()}catch(e){return!0}},S=!v((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),_={},E={}.propertyIsEnumerable,w=Object.getOwnPropertyDescriptor,m=w&&!E.call({1:2},1);_.f=m?function(e){var t=w(this,e);return!!t&&t.enumerable}:E;var g,T,O=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},I={}.toString,b=function(e){return I.call(e).slice(8,-1)},R="".split,C=v((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==b(e)?R.call(e,""):Object(e)}:Object,A=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},P=function(e){return C(A(e))},N=function(e){return"object"==typeof e?null!==e:"function"==typeof e},M=function(e){return"function"==typeof e?e:void 0},D=function(e,t){return arguments.length<2?M(y[e]):y[e]&&y[e][t]},j=D("navigator","userAgent")||"",L=y.process,x=y.Deno,U=L&&L.versions||x&&x.version,B=U&&U.v8;B?T=(g=B.split("."))[0]<4?1:g[0]+g[1]:j&&(!(g=j.match(/Edge\/(\d+)/))||g[1]>=74)&&(g=j.match(/Chrome\/(\d+)/))&&(T=g[1]);var q,V=T&&+T,k=!!Object.getOwnPropertySymbols&&!v((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&V&&V<41})),F=k&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,G=F?function(e){return"symbol"==typeof e}:function(e){var t=D("Symbol");return"function"==typeof t&&Object(e)instanceof t},H=function(e,t){try{Object.defineProperty(y,e,{value:t,configurable:!0,writable:!0})}catch(r){y[e]=t}return t},Y=y["__core-js_shared__"]||H("__core-js_shared__",{});(q=function(e,t){return Y[e]||(Y[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.16.2",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var W=function(e){return Object(A(e))},z={}.hasOwnProperty,Q=Object.hasOwn||function(e,t){return z.call(W(e),t)},K=0,J=Math.random(),$=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++K+J).toString(36)},X=q("wks"),Z=y.Symbol,ee=F?Z:Z&&Z.withoutSetter||$,te=function(e){return Q(X,e)&&(k||"string"==typeof X[e])||(k&&Q(Z,e)?X[e]=Z[e]:X[e]=ee("Symbol."+e)),X[e]},re=te("toPrimitive"),ne=function(e,t){if(!N(e)||G(e))return e;var r,n=e[re];if(void 0!==n){if(void 0===t&&(t="default"),r=n.call(e,t),!N(r)||G(r))return r;throw TypeError("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var r,n;if("string"===t&&"function"==typeof(r=e.toString)&&!N(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!N(n=r.call(e)))return n;if("string"!==t&&"function"==typeof(r=e.toString)&&!N(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")}(e,t)},oe=function(e){var t=ne(e,"string");return G(t)?t:String(t)},ie=y.document,se=N(ie)&&N(ie.createElement),ae=function(e){return se?ie.createElement(e):{}},ue=!S&&!v((function(){return 7!=Object.defineProperty(ae("div"),"a",{get:function(){return 7}}).a})),ce={},le=Object.getOwnPropertyDescriptor;ce.f=S?le:function(e,t){if(e=P(e),t=oe(t),ue)try{return le(e,t)}catch(e){}if(Q(e,t))return O(!_.f.call(e,t),e[t])};var pe=function(e){if(!N(e))throw TypeError(String(e)+" is not an object");return e},fe={},he=Object.defineProperty;fe.f=S?he:function(e,t,r){if(pe(e),t=oe(t),pe(r),ue)try{return he(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var de=S?function(e,t,r){return fe.f(e,t,O(1,r))}:function(e,t,r){return e[t]=r,e},ye=Function.toString;"function"!=typeof Y.inspectSource&&(Y.inspectSource=function(e){return ye.call(e)});var ve,Se,_e,Ee=Y.inspectSource,we=y.WeakMap,me="function"==typeof we&&/native code/.test(Ee(we)),ge=q("keys"),Te=function(e){return ge[e]||(ge[e]=$(e))},Oe={},Ie=y.WeakMap;if(me||Y.state){var be=Y.state||(Y.state=new Ie),Re=be.get,Ce=be.has,Ae=be.set;ve=function(e,t){if(Ce.call(be,e))throw new TypeError("Object already initialized");return t.facade=e,Ae.call(be,e,t),t},Se=function(e){return Re.call(be,e)||{}},_e=function(e){return Ce.call(be,e)}}else{var Pe=Te("state");Oe[Pe]=!0,ve=function(e,t){if(Q(e,Pe))throw new TypeError("Object already initialized");return t.facade=e,de(e,Pe,t),t},Se=function(e){return Q(e,Pe)?e[Pe]:{}},_e=function(e){return Q(e,Pe)}}var Ne,Me={set:ve,get:Se,enforce:function(e){return _e(e)?Se(e):ve(e,{})},getterFor:function(e){return function(t){var r;if(!N(t)||(r=Se(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}},De=Me.get,je=Me.enforce,Le=String(String).split("String");(Ne=function(e,t,r,n){var o,i=!!n&&!!n.unsafe,s=!!n&&!!n.enumerable,a=!!n&&!!n.noTargetGet;"function"==typeof r&&("string"!=typeof t||Q(r,"name")||de(r,"name",t),(o=je(r)).source||(o.source=Le.join("string"==typeof t?t:""))),e!==y?(i?!a&&e[t]&&(s=!0):delete e[t],s?e[t]=r:de(e,t,r)):s?e[t]=r:H(t,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&De(this).source||Ee(this)}));var xe=Math.ceil,Ue=Math.floor,Be=function(e){return isNaN(e=+e)?0:(e>0?Ue:xe)(e)},qe=Math.min,Ve=function(e){return e>0?qe(Be(e),9007199254740991):0},ke=Math.max,Fe=Math.min,Ge=function(e,t){var r=Be(e);return r<0?ke(r+t,0):Fe(r,t)},He=function(e){return function(t,r,n){var o,i=P(t),s=Ve(i.length),a=Ge(n,s);if(e&&r!=r){for(;s>a;)if((o=i[a++])!=o)return!0}else for(;s>a;a++)if((e||a in i)&&i[a]===r)return e||a||0;return!e&&-1}},Ye={includes:He(!0),indexOf:He(!1)},We=Ye.indexOf,ze=function(e,t){var r,n=P(e),o=0,i=[];for(r in n)!Q(Oe,r)&&Q(n,r)&&i.push(r);for(;t.length>o;)Q(n,r=t[o++])&&(~We(i,r)||i.push(r));return i},Qe=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ke={},Je=Qe.concat("length","prototype");Ke.f=Object.getOwnPropertyNames||function(e){return ze(e,Je)};var $e={};$e.f=Object.getOwnPropertySymbols;var Xe=D("Reflect","ownKeys")||function(e){var t=Ke.f(pe(e)),r=$e.f;return r?t.concat(r(e)):t},Ze=function(e,t){for(var r=Xe(t),n=fe.f,o=ce.f,i=0;i<r.length;i++){var s=r[i];Q(e,s)||n(e,s,o(t,s))}},et=/#|\.prototype\./,tt=function(e,t){var r=nt[rt(e)];return r==it||r!=ot&&("function"==typeof t?v(t):!!t)},rt=tt.normalize=function(e){return String(e).replace(et,".").toLowerCase()},nt=tt.data={},ot=tt.NATIVE="N",it=tt.POLYFILL="P",st=tt,at=ce.f,ut=function(e,t){var r,n,o,i,s,a=e.target,u=e.global,c=e.stat;if(r=u?y:c?y[a]||H(a,{}):(y[a]||{}).prototype)for(n in t){if(i=t[n],o=e.noTargetGet?(s=at(r,n))&&s.value:r[n],!st(u?n:a+(c?".":"#")+n,e.forced)&&void 0!==o){if(typeof i==typeof o)continue;Ze(i,o)}(e.sham||o&&o.sham)&&de(i,"sham",!0),Ne(r,n,i,e)}},ct=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},lt=function(e,t,r){if(ct(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}},pt=function(e){var t=e.return;if(void 0!==t)return pe(t.call(e)).value},ft=function(e,t,r,n){try{return n?t(pe(r)[0],r[1]):t(r)}catch(t){throw pt(e),t}},ht={},dt=te("iterator"),yt=Array.prototype,vt=function(e){return void 0!==e&&(ht.Array===e||yt[dt]===e)},St=function(e,t,r){var n=oe(t);n in e?fe.f(e,n,O(0,r)):e[n]=r},_t={};_t[te("toStringTag")]="z";var Et="[object z]"===String(_t),wt=te("toStringTag"),mt="Arguments"==b(function(){return arguments}()),gt=Et?b:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),wt))?r:mt?b(t):"Object"==(n=b(t))&&"function"==typeof t.callee?"Arguments":n},Tt=te("iterator"),Ot=function(e){if(null!=e)return e[Tt]||e["@@iterator"]||ht[gt(e)]},It=te("iterator"),bt=!1;try{var Rt=0,Ct={next:function(){return{done:!!Rt++}},return:function(){bt=!0}};Ct[It]=function(){return this},Array.from(Ct,(function(){throw 2}))}catch(e){}var At=function(e,t){if(!t&&!bt)return!1;var r=!1;try{var n={};n[It]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(e){}return r},Pt=!At((function(e){Array.from(e)}));ut({target:"Array",stat:!0,forced:Pt},{from:function(e){var t,r,n,o,i,s,a=W(e),u="function"==typeof this?this:Array,c=arguments.length,l=c>1?arguments[1]:void 0,p=void 0!==l,f=Ot(a),h=0;if(p&&(l=lt(l,c>2?arguments[2]:void 0,2)),null==f||u==Array&&vt(f))for(r=new u(t=Ve(a.length));t>h;h++)s=p?l(a[h],h):a[h],St(r,h,s);else for(i=(o=f.call(a)).next,r=new u;!(n=i.call(o)).done;h++)s=p?ft(o,l,[n.value,h],!0):n.value,St(r,h,s);return r.length=h,r}});var Nt=Array.isArray||function(e){return"Array"==b(e)};ut({target:"Array",stat:!0},{isArray:Nt});var Mt=v((function(){function e(){}return!(Array.of.call(e)instanceof e)}));ut({target:"Array",stat:!0,forced:Mt},{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)St(r,e,arguments[e++]);return r.length=t,r}});var Dt=te("species"),jt=function(e){var t;return Nt(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!Nt(t.prototype)?N(t)&&null===(t=t[Dt])&&(t=void 0):t=void 0),void 0===t?Array:t},Lt=function(e,t){return new(jt(e))(0===t?0:t)},xt=te("species"),Ut=function(e){return V>=51||!v((function(){var t=[];return(t.constructor={})[xt]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Bt=te("isConcatSpreadable"),qt=V>=51||!v((function(){var e=[];return e[Bt]=!1,e.concat()[0]!==e})),Vt=Ut("concat"),kt=function(e){if(!N(e))return!1;var t=e[Bt];return void 0!==t?!!t:Nt(e)};ut({target:"Array",proto:!0,forced:!qt||!Vt},{concat:function(e){var t,r,n,o,i,s=W(this),a=Lt(s,0),u=0;for(t=-1,n=arguments.length;t<n;t++)if(kt(i=-1===t?s:arguments[t])){if(u+(o=Ve(i.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(r=0;r<o;r++,u++)r in i&&St(a,u,i[r])}else{if(u>=9007199254740991)throw TypeError("Maximum allowed index exceeded");St(a,u++,i)}return a.length=u,a}});var Ft,Gt=Math.min,Ht=[].copyWithin||function(e,t){var r=W(this),n=Ve(r.length),o=Ge(e,n),i=Ge(t,n),s=arguments.length>2?arguments[2]:void 0,a=Gt((void 0===s?n:Ge(s,n))-i,n-o),u=1;for(i<o&&o<i+a&&(u=-1,i+=a-1,o+=a-1);a-- >0;)i in r?r[o]=r[i]:delete r[o],o+=u,i+=u;return r},Yt=Object.keys||function(e){return ze(e,Qe)},Wt=S?Object.defineProperties:function(e,t){pe(e);for(var r,n=Yt(t),o=n.length,i=0;o>i;)fe.f(e,r=n[i++],t[r]);return e},zt=D("document","documentElement"),Qt=Te("IE_PROTO"),Kt=function(){},Jt=function(e){return"<script>"+e+"<\/script>"},$t=function(e){e.write(Jt("")),e.close();var t=e.parentWindow.Object;return e=null,t},Xt=function(){try{Ft=new ActiveXObject("htmlfile")}catch(e){}var e,t;Xt="undefined"!=typeof document?document.domain&&Ft?$t(Ft):((t=ae("iframe")).style.display="none",zt.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Jt("document.F=Object")),e.close(),e.F):$t(Ft);for(var r=Qe.length;r--;)delete Xt.prototype[Qe[r]];return Xt()};Oe[Qt]=!0;var Zt=Object.create||function(e,t){var r;return null!==e?(Kt.prototype=pe(e),r=new Kt,Kt.prototype=null,r[Qt]=e):r=Xt(),void 0===t?r:Wt(r,t)},er=te("unscopables"),tr=Array.prototype;null==tr[er]&&fe.f(tr,er,{configurable:!0,value:Zt(null)});var rr=function(e){tr[er][e]=!0};ut({target:"Array",proto:!0},{copyWithin:Ht}),rr("copyWithin");var nr=[].push,or=function(e){var t=1==e,r=2==e,n=3==e,o=4==e,i=6==e,s=7==e,a=5==e||i;return function(u,c,l,p){for(var f,h,d=W(u),y=C(d),v=lt(c,l,3),S=Ve(y.length),_=0,E=p||Lt,w=t?E(u,S):r||s?E(u,0):void 0;S>_;_++)if((a||_ in y)&&(h=v(f=y[_],_,d),e))if(t)w[_]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return _;case 2:nr.call(w,f)}else switch(e){case 4:return!1;case 7:nr.call(w,f)}return i?-1:n||o?o:w}},ir={forEach:or(0),map:or(1),filter:or(2),some:or(3),every:or(4),find:or(5),findIndex:or(6),filterReject:or(7)},sr=function(e,t){var r=[][e];return!!r&&v((function(){r.call(null,t||function(){throw 1},1)}))},ar=ir.every,ur=sr("every");ut({target:"Array",proto:!0,forced:!ur},{every:function(e){return ar(this,e,arguments.length>1?arguments[1]:void 0)}});ut({target:"Array",proto:!0},{fill:function(e){for(var t=W(this),r=Ve(t.length),n=arguments.length,o=Ge(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,s=void 0===i?r:Ge(i,r);s>o;)t[o++]=e;return t}}),rr("fill");var cr=ir.filter,lr=Ut("filter");ut({target:"Array",proto:!0,forced:!lr},{filter:function(e){return cr(this,e,arguments.length>1?arguments[1]:void 0)}});var pr=ir.find,fr=!0;"find"in[]&&Array(1).find((function(){fr=!1})),ut({target:"Array",proto:!0,forced:fr},{find:function(e){return pr(this,e,arguments.length>1?arguments[1]:void 0)}}),rr("find");var hr=ir.findIndex,dr=!0;"findIndex"in[]&&Array(1).findIndex((function(){dr=!1})),ut({target:"Array",proto:!0,forced:dr},{findIndex:function(e){return hr(this,e,arguments.length>1?arguments[1]:void 0)}}),rr("findIndex");var yr=function(e,t,r,n,o,i,s,a){for(var u,c=o,l=0,p=!!s&&lt(s,a,3);l<n;){if(l in r){if(u=p?p(r[l],l,t):r[l],i>0&&Nt(u))c=yr(e,t,u,Ve(u.length),c,i-1)-1;else{if(c>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[c]=u}c++}l++}return c},vr=yr;ut({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=W(this),r=Ve(t.length),n=Lt(t,0);return n.length=vr(n,t,t,r,0,void 0===e?1:Be(e)),n}});ut({target:"Array",proto:!0},{flatMap:function(e){var t,r=W(this),n=Ve(r.length);return ct(e),(t=Lt(r,0)).length=vr(t,r,r,n,0,1,e,arguments.length>1?arguments[1]:void 0),t}});var Sr=ir.forEach,_r=sr("forEach")?[].forEach:function(e){return Sr(this,e,arguments.length>1?arguments[1]:void 0)};ut({target:"Array",proto:!0,forced:[].forEach!=_r},{forEach:_r});var Er=Ye.includes;ut({target:"Array",proto:!0},{includes:function(e){return Er(this,e,arguments.length>1?arguments[1]:void 0)}}),rr("includes");var wr=Ye.indexOf,mr=[].indexOf,gr=!!mr&&1/[1].indexOf(1,-0)<0,Tr=sr("indexOf");ut({target:"Array",proto:!0,forced:gr||!Tr},{indexOf:function(e){return gr?mr.apply(this,arguments)||0:wr(this,e,arguments.length>1?arguments[1]:void 0)}});var Or,Ir,br,Rr=!v((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Cr=Te("IE_PROTO"),Ar=Object.prototype,Pr=Rr?Object.getPrototypeOf:function(e){return e=W(e),Q(e,Cr)?e[Cr]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Ar:null},Nr=te("iterator"),Mr=!1;[].keys&&("next"in(br=[].keys())?(Ir=Pr(Pr(br)))!==Object.prototype&&(Or=Ir):Mr=!0);var Dr=null==Or||v((function(){var e={};return Or[Nr].call(e)!==e}));Dr&&(Or={}),Q(Or,Nr)||de(Or,Nr,(function(){return this}));var jr={IteratorPrototype:Or,BUGGY_SAFARI_ITERATORS:Mr},Lr=fe.f,xr=te("toStringTag"),Ur=function(e,t,r){e&&!Q(e=r?e:e.prototype,xr)&&Lr(e,xr,{configurable:!0,value:t})},Br=jr.IteratorPrototype,qr=function(){return this},Vr=function(e,t,r){var n=t+" Iterator";return e.prototype=Zt(Br,{next:O(1,r)}),Ur(e,n,!1),ht[n]=qr,e},kr=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return pe(r),function(e){if(!N(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(n),t?e.call(r,n):r.__proto__=n,r}}():void 0),Fr=jr.IteratorPrototype,Gr=jr.BUGGY_SAFARI_ITERATORS,Hr=te("iterator"),Yr=function(){return this},Wr=function(e,t,r,n,o,i,s){Vr(r,t,n);var a,u,c,l=function(e){if(e===o&&y)return y;if(!Gr&&e in h)return h[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},p=t+" Iterator",f=!1,h=e.prototype,d=h[Hr]||h["@@iterator"]||o&&h[o],y=!Gr&&d||l(o),v="Array"==t&&h.entries||d;if(v&&(a=Pr(v.call(new e)),Fr!==Object.prototype&&a.next&&(Pr(a)!==Fr&&(kr?kr(a,Fr):"function"!=typeof a[Hr]&&de(a,Hr,Yr)),Ur(a,p,!0))),"values"==o&&d&&"values"!==d.name&&(f=!0,y=function(){return d.call(this)}),h[Hr]!==y&&de(h,Hr,y),ht[t]=y,o)if(u={values:l("values"),keys:i?y:l("keys"),entries:l("entries")},s)for(c in u)(Gr||f||!(c in h))&&Ne(h,c,u[c]);else ut({target:t,proto:!0,forced:Gr||f},u);return u},zr=Me.set,Qr=Me.getterFor("Array Iterator"),Kr=Wr(Array,"Array",(function(e,t){zr(this,{type:"Array Iterator",target:P(e),index:0,kind:t})}),(function(){var e=Qr(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values");ht.Arguments=ht.Array,rr("keys"),rr("values"),rr("entries");var Jr=[].join,$r=C!=Object,Xr=sr("join",",");ut({target:"Array",proto:!0,forced:$r||!Xr},{join:function(e){return Jr.call(P(this),void 0===e?",":e)}});var Zr=Math.min,en=[].lastIndexOf,tn=!!en&&1/[1].lastIndexOf(1,-0)<0,rn=sr("lastIndexOf"),nn=tn||!rn?function(e){if(tn)return en.apply(this,arguments)||0;var t=P(this),r=Ve(t.length),n=r-1;for(arguments.length>1&&(n=Zr(n,Be(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}:en;ut({target:"Array",proto:!0,forced:nn!==[].lastIndexOf},{lastIndexOf:nn});var on=ir.map,sn=Ut("map");ut({target:"Array",proto:!0,forced:!sn},{map:function(e){return on(this,e,arguments.length>1?arguments[1]:void 0)}});var an=function(e){return function(t,r,n,o){ct(r);var i=W(t),s=C(i),a=Ve(i.length),u=e?a-1:0,c=e?-1:1;if(n<2)for(;;){if(u in s){o=s[u],u+=c;break}if(u+=c,e?u<0:a<=u)throw TypeError("Reduce of empty array with no initial value")}for(;e?u>=0:a>u;u+=c)u in s&&(o=r(o,s[u],u,i));return o}},un={left:an(!1),right:an(!0)},cn="process"==b(y.process),ln=un.left,pn=sr("reduce");ut({target:"Array",proto:!0,forced:!pn||!cn&&V>79&&V<83},{reduce:function(e){return ln(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var fn=un.right,hn=sr("reduceRight");ut({target:"Array",proto:!0,forced:!hn||!cn&&V>79&&V<83},{reduceRight:function(e){return fn(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var dn=[].reverse,yn=[1,2];ut({target:"Array",proto:!0,forced:String(yn)===String(yn.reverse())},{reverse:function(){return Nt(this)&&(this.length=this.length),dn.call(this)}});var vn=Ut("slice"),Sn=te("species"),_n=[].slice,En=Math.max;ut({target:"Array",proto:!0,forced:!vn},{slice:function(e,t){var r,n,o,i=P(this),s=Ve(i.length),a=Ge(e,s),u=Ge(void 0===t?s:t,s);if(Nt(i)&&("function"!=typeof(r=i.constructor)||r!==Array&&!Nt(r.prototype)?N(r)&&null===(r=r[Sn])&&(r=void 0):r=void 0,r===Array||void 0===r))return _n.call(i,a,u);for(n=new(void 0===r?Array:r)(En(u-a,0)),o=0;a<u;a++,o++)a in i&&St(n,o,i[a]);return n.length=o,n}});var wn=ir.some,mn=sr("some");ut({target:"Array",proto:!0,forced:!mn},{some:function(e){return wn(this,e,arguments.length>1?arguments[1]:void 0)}});var gn=function(e){if(G(e))throw TypeError("Cannot convert a Symbol value to a string");return String(e)},Tn=Math.floor,On=function(e,t){var r=e.length,n=Tn(r/2);return r<8?In(e,t):bn(On(e.slice(0,n),t),On(e.slice(n),t),t)},In=function(e,t){for(var r,n,o=e.length,i=1;i<o;){for(n=i,r=e[i];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==i++&&(e[n]=r)}return e},bn=function(e,t,r){for(var n=e.length,o=t.length,i=0,s=0,a=[];i<n||s<o;)i<n&&s<o?a.push(r(e[i],t[s])<=0?e[i++]:t[s++]):a.push(i<n?e[i++]:t[s++]);return a},Rn=On,Cn=j.match(/firefox\/(\d+)/i),An=!!Cn&&+Cn[1],Pn=/MSIE|Trident/.test(j),Nn=j.match(/AppleWebKit\/(\d+)\./),Mn=!!Nn&&+Nn[1],Dn=[],jn=Dn.sort,Ln=v((function(){Dn.sort(void 0)})),xn=v((function(){Dn.sort(null)})),Un=sr("sort"),Bn=!v((function(){if(V)return V<70;if(!(An&&An>3)){if(Pn)return!0;if(Mn)return Mn<603;var e,t,r,n,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)Dn.push({k:t+n,v:r})}for(Dn.sort((function(e,t){return t.v-e.v})),n=0;n<Dn.length;n++)t=Dn[n].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));ut({target:"Array",proto:!0,forced:Ln||!xn||!Un||!Bn},{sort:function(e){void 0!==e&&ct(e);var t=W(this);if(Bn)return void 0===e?jn.call(t):jn.call(t,e);var r,n,o=[],i=Ve(t.length);for(n=0;n<i;n++)n in t&&o.push(t[n]);for(r=(o=Rn(o,function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:gn(t)>gn(r)?1:-1}}(e))).length,n=0;n<r;)t[n]=o[n++];for(;n<i;)delete t[n++];return t}});var qn=te("species"),Vn=function(e){var t=D(e),r=fe.f;S&&t&&!t[qn]&&r(t,qn,{configurable:!0,get:function(){return this}})};Vn("Array");var kn=Ut("splice"),Fn=Math.max,Gn=Math.min;ut({target:"Array",proto:!0,forced:!kn},{splice:function(e,t){var r,n,o,i,s,a,u=W(this),c=Ve(u.length),l=Ge(e,c),p=arguments.length;if(0===p?r=n=0:1===p?(r=0,n=c-l):(r=p-2,n=Gn(Fn(Be(t),0),c-l)),c+r-n>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(o=Lt(u,n),i=0;i<n;i++)(s=l+i)in u&&St(o,i,u[s]);if(o.length=n,r<n){for(i=l;i<c-n;i++)a=i+r,(s=i+n)in u?u[a]=u[s]:delete u[a];for(i=c;i>c-n+r;i--)delete u[i-1]}else if(r>n)for(i=c-n;i>l;i--)a=i+r-1,(s=i+n-1)in u?u[a]=u[s]:delete u[a];for(i=0;i<r;i++)u[i+l]=arguments[i+2];return u.length=c-n+r,o}});rr("flat");rr("flatMap");var Hn=Et?{}.toString:function(){return"[object "+gt(this)+"]"};Et||Ne(Object.prototype,"toString",Hn,{unsafe:!0});var Yn,Wn={charAt:(Yn=!0,function(e,t){var r,n,o=gn(A(e)),i=Be(t),s=o.length;return i<0||i>=s?Yn?"":void 0:(r=o.charCodeAt(i))<55296||r>56319||i+1===s||(n=o.charCodeAt(i+1))<56320||n>57343?Yn?o.charAt(i):r:Yn?o.slice(i,i+2):n-56320+(r-55296<<10)+65536})}.charAt,zn=Me.set,Qn=Me.getterFor("String Iterator");Wr(String,"String",(function(e){zn(this,{type:"String Iterator",string:gn(e),index:0})}),(function(){var e,t=Qn(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=Wn(r,n),t.index+=e.length,{value:e,done:!1})}));var Kn=y,Jn=(Kn.Array,{}),$n=Ke.f,Xn={}.toString,Zn="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Jn.f=function(e){return Zn&&"[object Window]"==Xn.call(e)?function(e){try{return $n(e)}catch(e){return Zn.slice()}}(e):$n(P(e))};v((function(){return Object.isExtensible(Object.preventExtensions({}))}));var eo,to=fe.f,ro=$("meta"),no=0,oo=Object.isExtensible||function(){return!0},io=function(e){to(e,ro,{value:{objectID:"O"+no++,weakData:{}}})},so=eo={enable:function(){so.enable=function(){},!0;var e=Ke.f,t=[].splice,r={};r[ro]=1,e(r).length&&(Ke.f=function(r){for(var n=e(r),o=0,i=n.length;o<i;o++)if(n[o]===ro){t.call(n,o,1);break}return n},ut({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Jn.f}))},fastKey:function(e,t){if(!N(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!Q(e,ro)){if(!oo(e))return"F";if(!t)return"E";io(e)}return e[ro].objectID}};Oe[ro]=!0;var ao=function(e,t){this.stopped=e,this.result=t},uo=function(e,t,r){var n,o,i,s,a,u,c,l=r&&r.that,p=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_ITERATOR),h=!(!r||!r.INTERRUPTED),d=lt(t,l,1+p+h),y=function(e){return n&&pt(n),new ao(!0,e)},v=function(e){return p?(pe(e),h?d(e[0],e[1],y):d(e[0],e[1])):h?d(e,y):d(e)};if(f)n=e;else{if("function"!=typeof(o=Ot(e)))throw TypeError("Target is not iterable");if(vt(o)){for(i=0,s=Ve(e.length);s>i;i++)if((a=v(e[i]))&&a instanceof ao)return a;return new ao(!1)}n=o.call(e)}for(u=n.next;!(c=u.call(n)).done;){try{a=v(c.value)}catch(e){throw pt(n),e}if("object"==typeof a&&a&&a instanceof ao)return a}return new ao(!1)},co=function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return e},lo=function(e,t,r){var n,o;return kr&&"function"==typeof(n=t.constructor)&&n!==r&&N(o=n.prototype)&&o!==r.prototype&&kr(e,o),e},po=function(e,t,r){var n=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),i=n?"set":"add",s=y[e],a=s&&s.prototype,u=s,c={},l=function(e){var t=a[e];Ne(a,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!N(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!N(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!N(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})};if(st(e,"function"!=typeof s||!(o||a.forEach&&!v((function(){(new s).entries().next()})))))u=r.getConstructor(t,e,n,i),eo.enable();else if(st(e,!0)){var p=new u,f=p[i](o?{}:-0,1)!=p,h=v((function(){p.has(1)})),d=At((function(e){new s(e)})),S=!o&&v((function(){for(var e=new s,t=5;t--;)e[i](t,t);return!e.has(-0)}));d||((u=t((function(t,r){co(t,u,e);var o=lo(new s,t,u);return null!=r&&uo(r,o[i],{that:o,AS_ENTRIES:n}),o}))).prototype=a,a.constructor=u),(h||S)&&(l("delete"),l("has"),n&&l("get")),(S||f)&&l(i),o&&a.clear&&delete a.clear}return c[e]=u,ut({global:!0,forced:u!=s},c),Ur(u,e),o||r.setStrong(u,e,n),u},fo=function(e,t,r){for(var n in t)Ne(e,n,t[n],r);return e},ho=fe.f,yo=eo.fastKey,vo=Me.set,So=Me.getterFor,_o={getConstructor:function(e,t,r,n){var o=e((function(e,i){co(e,o,t),vo(e,{type:t,index:Zt(null),first:void 0,last:void 0,size:0}),S||(e.size=0),null!=i&&uo(i,e[n],{that:e,AS_ENTRIES:r})})),i=So(t),s=function(e,t,r){var n,o,s=i(e),u=a(e,t);return u?u.value=r:(s.last=u={index:o=yo(t,!0),key:t,value:r,previous:n=s.last,next:void 0,removed:!1},s.first||(s.first=u),n&&(n.next=u),S?s.size++:e.size++,"F"!==o&&(s.index[o]=u)),e},a=function(e,t){var r,n=i(e),o=yo(t);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==t)return r};return fo(o.prototype,{clear:function(){for(var e=i(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,S?e.size=0:this.size=0},delete:function(e){var t=i(this),r=a(this,e);if(r){var n=r.next,o=r.previous;delete t.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),t.first==r&&(t.first=n),t.last==r&&(t.last=o),S?t.size--:this.size--}return!!r},forEach:function(e){for(var t,r=i(this),n=lt(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!a(this,e)}}),fo(o.prototype,r?{get:function(e){var t=a(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),S&&ho(o.prototype,"size",{get:function(){return i(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=So(t),i=So(n);Wr(e,t,(function(e,t){vo(this,{type:n,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),Vn(t)}};po("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),_o);ut({target:"Array",proto:!0},{at:function(e){var t=W(this),r=Ve(t.length),n=Be(e),o=n>=0?n:r+n;return o<0||o>=r?void 0:t[o]}}),rr("at");var Eo=ir.filterReject;ut({target:"Array",proto:!0},{filterOut:function(e){return Eo(this,e,arguments.length>1?arguments[1]:void 0)}}),rr("filterOut");var wo=ir.filterReject;ut({target:"Array",proto:!0},{filterReject:function(e){return wo(this,e,arguments.length>1?arguments[1]:void 0)}}),rr("filterReject");var mo=function(e){var t=1==e;return function(r,n,o){for(var i,s=W(r),a=C(s),u=lt(n,o,3),c=Ve(a.length);c-- >0;)if(u(i=a[c],c,s))switch(e){case 0:return i;case 1:return c}return t?-1:void 0}},go={findLast:mo(0),findLastIndex:mo(1)},To=go.findLast;ut({target:"Array",proto:!0},{findLast:function(e){return To(this,e,arguments.length>1?arguments[1]:void 0)}}),rr("findLast");var Oo=go.findLastIndex;ut({target:"Array",proto:!0},{findLastIndex:function(e){return Oo(this,e,arguments.length>1?arguments[1]:void 0)}}),rr("findLastIndex");var Io=function(e,t){for(var r=0,n=t.length,o=new e(n);n>r;)o[r]=t[r++];return o},bo=[].push,Ro=function(e,t,r,n){for(var o,i,s,a=W(e),u=C(a),c=lt(t,r,3),l=Zt(null),p=Ve(u.length),f=0;p>f;f++)s=u[f],(i=oe(c(s,f,a)))in l?bo.call(l[i],s):l[i]=[s];if(n&&(o=n(a))!==Array)for(i in l)l[i]=Io(o,l[i]);return l};ut({target:"Array",proto:!0},{groupBy:function(e){var t=arguments.length>1?arguments[1]:void 0;return Ro(this,e,t,jt)}}),rr("groupBy");var Co=Object.isFrozen,Ao=function(e,t){if(!Co||!Nt(e)||!Co(e))return!1;for(var r,n=0,o=e.length;n<o;)if(!("string"==typeof(r=e[n++])||t&&void 0===r))return!1;return 0!==o};ut({target:"Array",stat:!0},{isTemplateObject:function(e){if(!Ao(e,!0))return!1;var t=e.raw;return!(t.length!==e.length||!Ao(t,!1))}});var Po=fe.f;S&&!("lastItem"in[])&&(Po(Array.prototype,"lastItem",{configurable:!0,get:function(){var e=W(this),t=Ve(e.length);return 0==t?void 0:e[t-1]},set:function(e){var t=W(this),r=Ve(t.length);return t[0==r?0:r-1]=e}}),rr("lastItem"));var No=fe.f;S&&!("lastIndex"in[])&&(No(Array.prototype,"lastIndex",{configurable:!0,get:function(){var e=W(this),t=Ve(e.length);return 0==t?0:t-1}}),rr("lastIndex"));var Mo=[].push;ut({target:"Array",proto:!0},{uniqueBy:function(e){var t,r,n,o,i=W(this),s=Ve(i.length),a=Lt(i,0),u=new(D("Map"));if("function"==typeof e)t=e;else{if(null!=e)throw new TypeError("Incorrect resolver!");t=function(e){return e}}for(r=0;r<s;r++)o=t(n=i[r]),u.has(o)||u.set(o,n);return u.forEach((function(e){Mo.call(a,e)})),a}}),rr("uniqueBy");Kn.Map;var Do={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},jo=te("iterator"),Lo=te("toStringTag"),xo=Kr.values;for(var Uo in Do){var Bo=y[Uo],qo=Bo&&Bo.prototype;if(qo){if(qo[jo]!==xo)try{de(qo,jo,xo)}catch(e){qo[jo]=xo}if(qo[Lo]||de(qo,Lo,Uo),Do[Uo])for(var Vo in Kr)if(qo[Vo]!==Kr[Vo])try{de(qo,Vo,Kr[Vo])}catch(e){qo[Vo]=Kr[Vo]}}}var ko=function(e){var t,r,n,o,i=arguments.length,s=i>1?arguments[1]:void 0;return ct(this),(t=void 0!==s)&&ct(s),null==e?new this:(r=[],t?(n=0,o=lt(s,i>2?arguments[2]:void 0,2),uo(e,(function(e){r.push(o(e,n++))}))):uo(e,r.push,{that:r}),new this(r))};ut({target:"Map",stat:!0},{from:ko});var Fo=function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)};ut({target:"Map",stat:!0},{of:Fo});var Go=function(){for(var e,t=pe(this),r=ct(t.delete),n=!0,o=0,i=arguments.length;o<i;o++)e=r.call(t,arguments[o]),n=n&&e;return!!n};ut({target:"Map",proto:!0,real:!0,forced:!1},{deleteAll:function(){return Go.apply(this,arguments)}});ut({target:"Map",proto:!0,real:!0,forced:!1},{emplace:function(e,t){var r=pe(this),n=r.has(e)&&"update"in t?t.update(r.get(e),e,r):t.insert(e,r);return r.set(e,n),n}});var Ho=function(e){return Map.prototype.entries.call(e)};ut({target:"Map",proto:!0,real:!0,forced:!1},{every:function(e){var t=pe(this),r=Ho(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3);return!uo(r,(function(e,r,o){if(!n(r,e,t))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var Yo=te("species"),Wo=function(e,t){var r,n=pe(e).constructor;return void 0===n||null==(r=pe(n)[Yo])?t:ct(r)};ut({target:"Map",proto:!0,real:!0,forced:!1},{filter:function(e){var t=pe(this),r=Ho(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3),o=new(Wo(t,D("Map"))),i=ct(o.set);return uo(r,(function(e,r){n(r,e,t)&&i.call(o,e,r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});ut({target:"Map",proto:!0,real:!0,forced:!1},{find:function(e){var t=pe(this),r=Ho(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3);return uo(r,(function(e,r,o){if(n(r,e,t))return o(r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});ut({target:"Map",proto:!0,real:!0,forced:!1},{findKey:function(e){var t=pe(this),r=Ho(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3);return uo(r,(function(e,r,o){if(n(r,e,t))return o(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});ut({target:"Map",stat:!0},{groupBy:function(e,t){var r=new this;ct(t);var n=ct(r.has),o=ct(r.get),i=ct(r.set);return uo(e,(function(e){var s=t(e);n.call(r,s)?o.call(r,s).push(e):i.call(r,s,[e])})),r}});ut({target:"Map",proto:!0,real:!0,forced:!1},{includes:function(e){return uo(Ho(pe(this)),(function(t,r,n){if((o=r)===(i=e)||o!=o&&i!=i)return n();var o,i}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});ut({target:"Map",stat:!0},{keyBy:function(e,t){var r=new this;ct(t);var n=ct(r.set);return uo(e,(function(e){n.call(r,t(e),e)})),r}});ut({target:"Map",proto:!0,real:!0,forced:!1},{keyOf:function(e){return uo(Ho(pe(this)),(function(t,r,n){if(r===e)return n(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});ut({target:"Map",proto:!0,real:!0,forced:!1},{mapKeys:function(e){var t=pe(this),r=Ho(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3),o=new(Wo(t,D("Map"))),i=ct(o.set);return uo(r,(function(e,r){i.call(o,n(r,e,t),r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});ut({target:"Map",proto:!0,real:!0,forced:!1},{mapValues:function(e){var t=pe(this),r=Ho(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3),o=new(Wo(t,D("Map"))),i=ct(o.set);return uo(r,(function(e,r){i.call(o,e,n(r,e,t))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o}});ut({target:"Map",proto:!0,real:!0,forced:!1},{merge:function(e){for(var t=pe(this),r=ct(t.set),n=arguments.length,o=0;o<n;)uo(arguments[o++],r,{that:t,AS_ENTRIES:!0});return t}});ut({target:"Map",proto:!0,real:!0,forced:!1},{reduce:function(e){var t=pe(this),r=Ho(t),n=arguments.length<2,o=n?void 0:arguments[1];if(ct(e),uo(r,(function(r,i){n?(n=!1,o=i):o=e(o,i,r,t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),n)throw TypeError("Reduce of empty map with no initial value");return o}});ut({target:"Map",proto:!0,real:!0,forced:!1},{some:function(e){var t=pe(this),r=Ho(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3);return uo(r,(function(e,r,o){if(n(r,e,t))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});ut({target:"Map",proto:!0,real:!0,forced:!1},{update:function(e,t){var r=pe(this),n=arguments.length;ct(t);var o=r.has(e);if(!o&&n<3)throw TypeError("Updating absent value");var i=o?r.get(e):ct(n>2?arguments[2]:void 0)(e,r);return r.set(e,t(i,e,r)),r}});var zo=function(e,t){var r,n=pe(this),o=arguments.length>2?arguments[2]:void 0;if("function"!=typeof t&&"function"!=typeof o)throw TypeError("At least one callback required");return n.has(e)?(r=n.get(e),"function"==typeof t&&(r=t(r),n.set(e,r))):"function"==typeof o&&(r=o(),n.set(e,r)),r};ut({target:"Map",proto:!0,real:!0,forced:!1},{upsert:zo});ut({target:"Map",proto:!0,real:!0,forced:!1},{updateOrInsert:zo});var Qo,Ko="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",Jo=RegExp("^"+Ko+Ko+"*"),$o=RegExp(Ko+Ko+"*$"),Xo={trim:(Qo=3,function(e){var t=gn(A(e));return 1&Qo&&(t=t.replace(Jo,"")),2&Qo&&(t=t.replace($o,"")),t})},Zo=Ke.f,ei=ce.f,ti=fe.f,ri=Xo.trim,ni=y.Number,oi=ni.prototype,ii="Number"==b(Zt(oi)),si=function(e){if(G(e))throw TypeError("Cannot convert a Symbol value to a number");var t,r,n,o,i,s,a,u,c=ne(e,"number");if("string"==typeof c&&c.length>2)if(43===(t=(c=ri(c)).charCodeAt(0))||45===t){if(88===(r=c.charCodeAt(2))||120===r)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(s=(i=c.slice(2)).length,a=0;a<s;a++)if((u=i.charCodeAt(a))<48||u>o)return NaN;return parseInt(i,n)}return+c};if(st("Number",!ni(" 0o1")||!ni("0b1")||ni("+0x1"))){for(var ai,ui=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof ui&&(ii?v((function(){oi.valueOf.call(r)})):"Number"!=b(r))?lo(new ni(si(t)),r,ui):si(t)},ci=S?Zo(ni):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),li=0;ci.length>li;li++)Q(ni,ai=ci[li])&&!Q(ui,ai)&&ti(ui,ai,ei(ni,ai));ui.prototype=oi,oi.constructor=ui,Ne(y,"Number",ui)}ut({target:"Number",stat:!0},{EPSILON:Math.pow(2,-52)});var pi=y.isFinite,fi=Number.isFinite||function(e){return"number"==typeof e&&pi(e)};ut({target:"Number",stat:!0},{isFinite:fi});var hi=Math.floor,di=function(e){return!N(e)&&isFinite(e)&&hi(e)===e};ut({target:"Number",stat:!0},{isInteger:di});ut({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var yi=Math.abs;ut({target:"Number",stat:!0},{isSafeInteger:function(e){return di(e)&&yi(e)<=9007199254740991}});ut({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991});ut({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991});var vi=Xo.trim,Si=y.parseFloat,_i=1/Si("\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff-0")!=-1/0?function(e){var t=vi(gn(e)),r=Si(t);return 0===r&&"-"==t.charAt(0)?-0:r}:Si;ut({target:"Number",stat:!0,forced:Number.parseFloat!=_i},{parseFloat:_i});var Ei=Xo.trim,wi=y.parseInt,mi=/^[+-]?0[Xx]/,gi=8!==wi("\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff08")||22!==wi("\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff0x16")?function(e,t){var r=Ei(gn(e));return wi(r,t>>>0||(mi.test(r)?16:10))}:wi;ut({target:"Number",stat:!0,forced:Number.parseInt!=gi},{parseInt:gi});var Ti=function(e){if("number"!=typeof e&&"Number"!=b(e))throw TypeError("Incorrect invocation");return+e},Oi=function(e){var t=gn(A(this)),r="",n=Be(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},Ii=1..toFixed,bi=Math.floor,Ri=function(e,t,r){return 0===t?r:t%2==1?Ri(e,t-1,r*e):Ri(e*e,t/2,r)},Ci=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=bi(o/1e7)},Ai=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=bi(n/t),n=n%t*1e7},Pi=function(e){for(var t=6,r="";--t>=0;)if(""!==r||0===t||0!==e[t]){var n=String(e[t]);r=""===r?n:r+Oi.call("0",7-n.length)+n}return r},Ni=Ii&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!v((function(){Ii.call({})}));ut({target:"Number",proto:!0,forced:Ni},{toFixed:function(e){var t,r,n,o,i=Ti(this),s=Be(e),a=[0,0,0,0,0,0],u="",c="0";if(s<0||s>20)throw RangeError("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return String(i);if(i<0&&(u="-",i=-i),i>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(i*Ri(2,69,1))-69)<0?i*Ri(2,-t,1):i/Ri(2,t,1),r*=4503599627370496,(t=52-t)>0){for(Ci(a,0,r),n=s;n>=7;)Ci(a,1e7,0),n-=7;for(Ci(a,Ri(10,n,1),0),n=t-1;n>=23;)Ai(a,1<<23),n-=23;Ai(a,1<<n),Ci(a,1,1),Ai(a,2),c=Pi(a)}else Ci(a,0,r),Ci(a,1<<-t,0),c=Pi(a)+Oi.call("0",s);return c=s>0?u+((o=c.length)<=s?"0."+Oi.call("0",s-o)+c:c.slice(0,o-s)+"."+c.slice(o-s)):u+c}});var Mi=1..toPrecision,Di=v((function(){return"1"!==Mi.call(1,void 0)}))||!v((function(){Mi.call({})}));ut({target:"Number",proto:!0,forced:Di},{toPrecision:function(e){return void 0===e?Mi.call(Ti(this)):Mi.call(Ti(this),e)}});Kn.Number;var ji=/^[\da-z]+$/;ut({target:"Number",stat:!0},{fromString:function(e,t){var r,n,o=1;if("string"!=typeof e)throw TypeError("Invalid number representation");if(!e.length)throw SyntaxError("Invalid number representation");if("-"==e.charAt(0)&&(o=-1,!(e=e.slice(1)).length))throw SyntaxError("Invalid number representation");if((r=void 0===t?10:Be(t))<2||r>36)throw RangeError("Invalid radix");if(!ji.test(e)||(n=gi(e,r)).toString(r)!==e)throw SyntaxError("Invalid number representation");return o*n}});var Li="Incorrect Number.range arguments",xi=Me.set,Ui=Me.getterFor("NumericRangeIterator"),Bi=Vr((function(e,t,r,n,o,i){if(typeof e!=n||t!==1/0&&t!==-1/0&&typeof t!=n)throw new TypeError(Li);if(e===1/0||e===-1/0)throw new RangeError(Li);var s,a=t>e,u=!1;if(void 0===r)s=void 0;else if(N(r))s=r.step,u=!!r.inclusive;else{if(typeof r!=n)throw new TypeError(Li);s=r}if(null==s&&(s=a?i:-i),typeof s!=n)throw new TypeError(Li);if(s===1/0||s===-1/0||s===o&&e!==t)throw new RangeError(Li);xi(this,{type:"NumericRangeIterator",start:e,end:t,step:s,inclusiveEnd:u,hitsEnd:e!=e||t!=t||s!=s||t>e!=s>o,currentCount:o,zero:o}),S||(this.start=e,this.end=t,this.step=s,this.inclusive=u)}),"NumericRangeIterator",(function(){var e=Ui(this);if(e.hitsEnd)return{value:void 0,done:!0};var t=e.start,r=e.end,n=t+e.step*e.currentCount++;n===r&&(e.hitsEnd=!0);var o=e.inclusiveEnd;return(r>t?o?n>r:n>=r:o?r>n:r>=n)?{value:void 0,done:e.hitsEnd=!0}:{value:n,done:!1}})),qi=function(e){return{get:e,set:function(){},configurable:!0,enumerable:!1}};S&&Wt(Bi.prototype,{start:qi((function(){return Ui(this).start})),end:qi((function(){return Ui(this).end})),inclusive:qi((function(){return Ui(this).inclusiveEnd})),step:qi((function(){return Ui(this).step}))});var Vi=Bi;ut({target:"Number",stat:!0},{range:function(e,t,r){return new Vi(e,t,r,"number",0,1)}});var ki,Fi=_.f,Gi={values:(ki=!1,function(e){for(var t,r=P(e),n=Yt(r),o=n.length,i=0,s=[];o>i;)t=n[i++],S&&!Fi.call(r,t)||s.push(ki?[t,r[t]]:r[t]);return s})}.values;ut({target:"Object",stat:!0},{values:function(e){return Gi(e)}});Kn.Object.values;var Hi=function(e,t){var r=this;if(!(r instanceof Hi))return new Hi(e,t);kr&&(r=kr(new Error(void 0),Pr(r))),void 0!==t&&de(r,"message",gn(t));var n=[];return uo(e,n.push,{that:n}),de(r,"errors",n),r};Hi.prototype=Zt(Error.prototype,{constructor:O(5,Hi),message:O(5,""),name:O(5,"AggregateError")}),ut({global:!0},{AggregateError:Hi});var Yi,Wi,zi,Qi,Ki=y.Promise,Ji=/(?:ipad|iphone|ipod).*applewebkit/i.test(j),$i=y.setImmediate,Xi=y.clearImmediate,Zi=y.process,es=y.MessageChannel,ts=y.Dispatch,rs=0,ns={};try{Yi=y.location}catch(e){}var os=function(e){if(ns.hasOwnProperty(e)){var t=ns[e];delete ns[e],t()}},is=function(e){return function(){os(e)}},ss=function(e){os(e.data)},as=function(e){y.postMessage(String(e),Yi.protocol+"//"+Yi.host)};$i&&Xi||($i=function(e){for(var t=[],r=arguments.length,n=1;r>n;)t.push(arguments[n++]);return ns[++rs]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Wi(rs),rs},Xi=function(e){delete ns[e]},cn?Wi=function(e){Zi.nextTick(is(e))}:ts&&ts.now?Wi=function(e){ts.now(is(e))}:es&&!Ji?(Qi=(zi=new es).port2,zi.port1.onmessage=ss,Wi=lt(Qi.postMessage,Qi,1)):y.addEventListener&&"function"==typeof postMessage&&!y.importScripts&&Yi&&"file:"!==Yi.protocol&&!v(as)?(Wi=as,y.addEventListener("message",ss,!1)):Wi="onreadystatechange"in ae("script")?function(e){zt.appendChild(ae("script")).onreadystatechange=function(){zt.removeChild(this),os(e)}}:function(e){setTimeout(is(e),0)});var us,cs,ls,ps,fs,hs,ds,ys,vs={set:$i},Ss=/ipad|iphone|ipod/i.test(j)&&void 0!==y.Pebble,_s=/web0s(?!.*chrome)/i.test(j),Es=ce.f,ws=vs.set,ms=y.MutationObserver||y.WebKitMutationObserver,gs=y.document,Ts=y.process,Os=y.Promise,Is=Es(y,"queueMicrotask"),bs=Is&&Is.value;bs||(us=function(){var e,t;for(cn&&(e=Ts.domain)&&e.exit();cs;){t=cs.fn,cs=cs.next;try{t()}catch(e){throw cs?ps():ls=void 0,e}}ls=void 0,e&&e.enter()},Ji||cn||_s||!ms||!gs?!Ss&&Os&&Os.resolve?((ds=Os.resolve(void 0)).constructor=Os,ys=ds.then,ps=function(){ys.call(ds,us)}):ps=cn?function(){Ts.nextTick(us)}:function(){ws.call(y,us)}:(fs=!0,hs=gs.createTextNode(""),new ms(us).observe(hs,{characterData:!0}),ps=function(){hs.data=fs=!fs}));var Rs=bs||function(e){var t={fn:e,next:void 0};ls&&(ls.next=t),cs||(cs=t,ps()),ls=t},Cs={},As=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=ct(t),this.reject=ct(r)};Cs.f=function(e){return new As(e)};var Ps,Ns,Ms,Ds,js=function(e,t){if(pe(e),N(t)&&t.constructor===e)return t;var r=Cs.f(e);return(0,r.resolve)(t),r.promise},Ls=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},xs="object"==typeof window,Us=vs.set,Bs=te("species"),qs="Promise",Vs=Me.get,ks=Me.set,Fs=Me.getterFor(qs),Gs=Ki&&Ki.prototype,Hs=Ki,Ys=Gs,Ws=y.TypeError,zs=y.document,Qs=y.process,Ks=Cs.f,Js=Ks,$s=!!(zs&&zs.createEvent&&y.dispatchEvent),Xs="function"==typeof PromiseRejectionEvent,Zs=!1,ea=st(qs,(function(){var e=Ee(Hs),t=e!==String(Hs);if(!t&&66===V)return!0;if(V>=51&&/native code/.test(e))return!1;var r=new Hs((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};return(r.constructor={})[Bs]=n,!(Zs=r.then((function(){}))instanceof n)||!t&&xs&&!Xs})),ta=ea||!At((function(e){Hs.all(e).catch((function(){}))})),ra=function(e){var t;return!(!N(e)||"function"!=typeof(t=e.then))&&t},na=function(e,t){if(!e.notified){e.notified=!0;var r=e.reactions;Rs((function(){for(var n=e.value,o=1==e.state,i=0;r.length>i;){var s,a,u,c=r[i++],l=o?c.ok:c.fail,p=c.resolve,f=c.reject,h=c.domain;try{l?(o||(2===e.rejection&&aa(e),e.rejection=1),!0===l?s=n:(h&&h.enter(),s=l(n),h&&(h.exit(),u=!0)),s===c.promise?f(Ws("Promise-chain cycle")):(a=ra(s))?a.call(s,p,f):p(s)):f(n)}catch(e){h&&!u&&h.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&ia(e)}))}},oa=function(e,t,r){var n,o;$s?((n=zs.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),y.dispatchEvent(n)):n={promise:t,reason:r},!Xs&&(o=y["on"+e])?o(n):"unhandledrejection"===e&&function(e,t){var r=y.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}("Unhandled promise rejection",r)},ia=function(e){Us.call(y,(function(){var t,r=e.facade,n=e.value;if(sa(e)&&(t=Ls((function(){cn?Qs.emit("unhandledRejection",n,r):oa("unhandledrejection",r,n)})),e.rejection=cn||sa(e)?2:1,t.error))throw t.value}))},sa=function(e){return 1!==e.rejection&&!e.parent},aa=function(e){Us.call(y,(function(){var t=e.facade;cn?Qs.emit("rejectionHandled",t):oa("rejectionhandled",t,e.value)}))},ua=function(e,t,r){return function(n){e(t,n,r)}},ca=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,na(e,!0))},la=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw Ws("Promise can't be resolved itself");var n=ra(t);n?Rs((function(){var r={done:!1};try{n.call(t,ua(la,r,e),ua(ca,r,e))}catch(t){ca(r,t,e)}})):(e.value=t,e.state=1,na(e,!1))}catch(t){ca({done:!1},t,e)}}};if(ea&&(Ys=(Hs=function(e){co(this,Hs,qs),ct(e),Ps.call(this);var t=Vs(this);try{e(ua(la,t),ua(ca,t))}catch(e){ca(t,e)}}).prototype,(Ps=function(e){ks(this,{type:qs,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=fo(Ys,{then:function(e,t){var r=Fs(this),n=Ks(Wo(this,Hs));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=cn?Qs.domain:void 0,r.parent=!0,r.reactions.push(n),0!=r.state&&na(r,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),Ns=function(){var e=new Ps,t=Vs(e);this.promise=e,this.resolve=ua(la,t),this.reject=ua(ca,t)},Cs.f=Ks=function(e){return e===Hs||e===Ms?new Ns(e):Js(e)},"function"==typeof Ki&&Gs!==Object.prototype)){Ds=Gs.then,Zs||(Ne(Gs,"then",(function(e,t){var r=this;return new Hs((function(e,t){Ds.call(r,e,t)})).then(e,t)}),{unsafe:!0}),Ne(Gs,"catch",Ys.catch,{unsafe:!0}));try{delete Gs.constructor}catch(e){}kr&&kr(Gs,Ys)}ut({global:!0,wrap:!0,forced:ea},{Promise:Hs}),Ur(Hs,qs,!1),Vn(qs),Ms=D(qs),ut({target:qs,stat:!0,forced:ea},{reject:function(e){var t=Ks(this);return t.reject.call(void 0,e),t.promise}}),ut({target:qs,stat:!0,forced:ea},{resolve:function(e){return js(this,e)}}),ut({target:qs,stat:!0,forced:ta},{all:function(e){var t=this,r=Ks(t),n=r.resolve,o=r.reject,i=Ls((function(){var r=ct(t.resolve),i=[],s=0,a=1;uo(e,(function(e){var u=s++,c=!1;i.push(void 0),a++,r.call(t,e).then((function(e){c||(c=!0,i[u]=e,--a||n(i))}),o)})),--a||n(i)}));return i.error&&o(i.value),r.promise},race:function(e){var t=this,r=Ks(t),n=r.reject,o=Ls((function(){var o=ct(t.resolve);uo(e,(function(e){o.call(t,e).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}}),ut({target:"Promise",stat:!0},{allSettled:function(e){var t=this,r=Cs.f(t),n=r.resolve,o=r.reject,i=Ls((function(){var r=ct(t.resolve),o=[],i=0,s=1;uo(e,(function(e){var a=i++,u=!1;o.push(void 0),s++,r.call(t,e).then((function(e){u||(u=!0,o[a]={status:"fulfilled",value:e},--s||n(o))}),(function(e){u||(u=!0,o[a]={status:"rejected",reason:e},--s||n(o))}))})),--s||n(o)}));return i.error&&o(i.value),r.promise}});ut({target:"Promise",stat:!0},{any:function(e){var t=this,r=Cs.f(t),n=r.resolve,o=r.reject,i=Ls((function(){var r=ct(t.resolve),i=[],s=0,a=1,u=!1;uo(e,(function(e){var c=s++,l=!1;i.push(void 0),a++,r.call(t,e).then((function(e){l||u||(u=!0,n(e))}),(function(e){l||u||(l=!0,i[c]=e,--a||o(new(D("AggregateError"))(i,"No one promise resolved")))}))})),--a||o(new(D("AggregateError"))(i,"No one promise resolved"))}));return i.error&&o(i.value),r.promise}});var pa=!!Ki&&v((function(){Ki.prototype.finally.call({then:function(){}},(function(){}))}));if(ut({target:"Promise",proto:!0,real:!0,forced:pa},{finally:function(e){var t=Wo(this,D("Promise")),r="function"==typeof e;return this.then(r?function(r){return js(t,e()).then((function(){return r}))}:e,r?function(r){return js(t,e()).then((function(){throw r}))}:e)}}),"function"==typeof Ki){var fa=D("Promise").prototype.finally;Ki.prototype.finally!==fa&&Ne(Ki.prototype,"finally",fa,{unsafe:!0})}Kn.Promise;ut({target:"Promise",stat:!0},{try:function(e){var t=Cs.f(this),r=Ls(e);return(r.error?t.reject:t.resolve)(r.value),t.promise}});po("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),_o),Kn.Set;ut({target:"Set",stat:!0},{from:ko});ut({target:"Set",stat:!0},{of:Fo});var ha=function(){for(var e=pe(this),t=ct(e.add),r=0,n=arguments.length;r<n;r++)t.call(e,arguments[r]);return e};ut({target:"Set",proto:!0,real:!0,forced:!1},{addAll:function(){return ha.apply(this,arguments)}});ut({target:"Set",proto:!0,real:!0,forced:!1},{deleteAll:function(){return Go.apply(this,arguments)}});var da=function(e){return Set.prototype.values.call(e)};ut({target:"Set",proto:!0,real:!0,forced:!1},{every:function(e){var t=pe(this),r=da(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3);return!uo(r,(function(e,r){if(!n(e,e,t))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});ut({target:"Set",proto:!0,real:!0,forced:!1},{difference:function(e){var t=pe(this),r=new(Wo(t,D("Set")))(t),n=ct(r.delete);return uo(e,(function(e){n.call(r,e)})),r}});ut({target:"Set",proto:!0,real:!0,forced:!1},{filter:function(e){var t=pe(this),r=da(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3),o=new(Wo(t,D("Set"))),i=ct(o.add);return uo(r,(function(e){n(e,e,t)&&i.call(o,e)}),{IS_ITERATOR:!0}),o}});ut({target:"Set",proto:!0,real:!0,forced:!1},{find:function(e){var t=pe(this),r=da(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3);return uo(r,(function(e,r){if(n(e,e,t))return r(e)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}});ut({target:"Set",proto:!0,real:!0,forced:!1},{intersection:function(e){var t=pe(this),r=new(Wo(t,D("Set"))),n=ct(t.has),o=ct(r.add);return uo(e,(function(e){n.call(t,e)&&o.call(r,e)})),r}});ut({target:"Set",proto:!0,real:!0,forced:!1},{isDisjointFrom:function(e){var t=pe(this),r=ct(t.has);return!uo(e,(function(e,n){if(!0===r.call(t,e))return n()}),{INTERRUPTED:!0}).stopped}});ut({target:"Set",proto:!0,real:!0,forced:!1},{isSubsetOf:function(e){var t=function(e){var t=Ot(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return pe(t.call(e))}(this),r=pe(e),n=r.has;return"function"!=typeof n&&(r=new(D("Set"))(e),n=ct(r.has)),!uo(t,(function(e,t){if(!1===n.call(r,e))return t()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});ut({target:"Set",proto:!0,real:!0,forced:!1},{isSupersetOf:function(e){var t=pe(this),r=ct(t.has);return!uo(e,(function(e,n){if(!1===r.call(t,e))return n()}),{INTERRUPTED:!0}).stopped}});ut({target:"Set",proto:!0,real:!0,forced:!1},{join:function(e){var t=pe(this),r=da(t),n=void 0===e?",":String(e),o=[];return uo(r,o.push,{that:o,IS_ITERATOR:!0}),o.join(n)}});ut({target:"Set",proto:!0,real:!0,forced:!1},{map:function(e){var t=pe(this),r=da(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3),o=new(Wo(t,D("Set"))),i=ct(o.add);return uo(r,(function(e){i.call(o,n(e,e,t))}),{IS_ITERATOR:!0}),o}});ut({target:"Set",proto:!0,real:!0,forced:!1},{reduce:function(e){var t=pe(this),r=da(t),n=arguments.length<2,o=n?void 0:arguments[1];if(ct(e),uo(r,(function(r){n?(n=!1,o=r):o=e(o,r,r,t)}),{IS_ITERATOR:!0}),n)throw TypeError("Reduce of empty set with no initial value");return o}});ut({target:"Set",proto:!0,real:!0,forced:!1},{some:function(e){var t=pe(this),r=da(t),n=lt(e,arguments.length>1?arguments[1]:void 0,3);return uo(r,(function(e,r){if(n(e,e,t))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});ut({target:"Set",proto:!0,real:!0,forced:!1},{symmetricDifference:function(e){var t=pe(this),r=new(Wo(t,D("Set")))(t),n=ct(r.delete),o=ct(r.add);return uo(e,(function(e){n.call(r,e)||o.call(r,e)})),r}});ut({target:"Set",proto:!0,real:!0,forced:!1},{union:function(e){var t=pe(this),r=new(Wo(t,D("Set")))(t);return uo(e,ct(r.add),{that:r}),r}});var ya,va={},Sa=this&&this.__extends||(ya=function(e,t){return(ya=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ya(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(va,"__esModule",{value:!0}),va.InternalError=va.IllegalStateError=va.RetryLimitError=va.SchemaParseError=va.SchemaViolationError=va.InvalidFilterError=va.OutOfBoundsError=va.IllegalArgumentError=va.SessionError=va.IOError=va.InvalidDataError=va.AssertionError=va.RuntimeError=va.NullValueError=void 0;var _a=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="null_value_error",t}(Error);va.NullValueError=_a;var Ea=function(e){function t(t,r){var n=e.call(this,t)||this;return n.cause=r,n}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="runtime_error",t}(Error);va.RuntimeError=Ea;var wa=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="assertion_error",t}(Error);va.AssertionError=wa;var ma=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="invalid_data_error",t}(Error);va.InvalidDataError=ma;var ga=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="io_error",t}(Error);va.IOError=ga;var Ta=function(e){function t(t,r){var n=e.call(this,t)||this;return n.cause=r,n}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="session_error",t}(Error);va.SessionError=Ta;var Oa=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="illegal_argument_error",t}(Error);va.IllegalArgumentError=Oa;var Ia=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="out_of_bounds_error",t}(Error);va.OutOfBoundsError=Ia;var ba=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="invalid_filter_error",t}(Error);va.InvalidFilterError=ba;var Ra=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="schema_violation_error",t}(Error);va.SchemaViolationError=Ra;var Ca=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="schema_parse_error",t}(Error);va.SchemaParseError=Ca;var Aa=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="retry_limit_error",t}(Error);va.RetryLimitError=Aa;var Pa=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="illegal_state_error",t}(Error);va.IllegalStateError=Pa;var Na=function(e){function t(t){return e.call(this,t)||this}return Sa(t,e),t.prototype.getType=function(){return t.type},t.type="internal_error",t}(Error);va.InternalError=Na;var Ma={};Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.ConnectionActivityMonitorImpl=void 0;var Da=function(){function e(e,t){this.currentTimeout=null,this.pingTimeout=e,this.connection=t,this.currentTimeout=setTimeout(t.closeIdleConnection.bind(t),e)}return e.prototype.onSystemPing=function(){var e=this;null!==this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=setTimeout((function(){e.connection.closeIdleConnection()}),this.pingTimeout))},e.prototype.shutdown=function(){null!==this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null)},e}();Ma.ConnectionActivityMonitorImpl=Da;var ja={};Object.defineProperty(ja,"__esModule",{value:!0}),ja.connectionActivityMonitorFactory=void 0;var La={onSystemPing:function(){},shutdown:function(){}};ja.connectionActivityMonitorFactory=function(e,t){if(!t.systemPingPeriod)return La;var r=t.systemPingPeriod.toNumber();if(r>0){var n=2*r;return new Ma.ConnectionActivityMonitorImpl(n,e)}return La};var xa={};Object.defineProperty(xa,"__esModule",{value:!0}),xa.sessionActivityMonitorFactory=void 0;var Ua=function(){function e(e){this.factory=e}return e.prototype.onNewConnection=function(e,t){this.currentConnectionMonitor=this.factory(e,t)},e.prototype.onConnectionClosed=function(){void 0!==this.currentConnectionMonitor&&(this.currentConnectionMonitor.shutdown(),this.currentConnectionMonitor=void 0)},e.prototype.onSystemPing=function(){void 0!==this.currentConnectionMonitor&&this.currentConnectionMonitor.onSystemPing()},e}();xa.sessionActivityMonitorFactory={NOOP:{onNewConnection:function(){},onConnectionClosed:function(){},onSystemPing:function(){}},create:function(e){return new Ua(e)}};var Ba={};Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.InternalSessionState=void 0,function(e){e.INITIALISING="initialising",e.CONNECTING="connecting",e.CONNECTED="connected",e.DISCONNECTED="disconnected",e.RECONNECTING="reconnecting",e.CLOSING="closing",e.CLOSED="closed"}(Ba.InternalSessionState||(Ba.InternalSessionState={}));var qa={};Object.defineProperty(qa,"__esModule",{value:!0}),qa.ErrorReason=void 0;var Va=function(){function e(e,t){this.id=e,this.reason=t}return e.prototype.toString=function(){return this.id+": "+this.reason},e}();qa.ErrorReason=Va;var ka=Ga,Fa=null;try{Fa=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Ga(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function Ha(e){return!0===(e&&e.__isLong__)}Ga.prototype.__isLong__,Object.defineProperty(Ga.prototype,"__isLong__",{value:!0}),Ga.isLong=Ha;var Ya={},Wa={};function za(e,t){var r,n,o;return t?(o=0<=(e>>>=0)&&e<256)&&(n=Wa[e])?n:(r=Ka(e,(0|e)<0?-1:0,!0),o&&(Wa[e]=r),r):(o=-128<=(e|=0)&&e<128)&&(n=Ya[e])?n:(r=Ka(e,e<0?-1:0,!1),o&&(Ya[e]=r),r)}function Qa(e,t){if(isNaN(e))return t?ou:nu;if(t){if(e<0)return ou;if(e>=eu)return cu}else{if(e<=-tu)return lu;if(e+1>=tu)return uu}return e<0?Qa(-e,t).neg():Ka(e%Za|0,e/Za|0,t)}function Ka(e,t,r){return new Ga(e,t,r)}Ga.fromInt=za,Ga.fromNumber=Qa,Ga.fromBits=Ka;var Ja=Math.pow;function $a(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return nu;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return $a(e.substring(1),t,r).neg();for(var o=Qa(Ja(r,8)),i=nu,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+a),r);if(a<8){var c=Qa(Ja(r,a));i=i.mul(c).add(Qa(u))}else i=(i=i.mul(o)).add(Qa(u))}return i.unsigned=t,i}function Xa(e,t){return"number"==typeof e?Qa(e,t):"string"==typeof e?$a(e,t):Ka(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Ga.fromString=$a,Ga.fromValue=Xa;var Za=4294967296,eu=Za*Za,tu=eu/2,ru=za(1<<24),nu=za(0);Ga.ZERO=nu;var ou=za(0,!0);Ga.UZERO=ou;var iu=za(1);Ga.ONE=iu;var su=za(1,!0);Ga.UONE=su;var au=za(-1);Ga.NEG_ONE=au;var uu=Ka(-1,2147483647,!1);Ga.MAX_VALUE=uu;var cu=Ka(-1,-1,!0);Ga.MAX_UNSIGNED_VALUE=cu;var lu=Ka(0,-2147483648,!1);Ga.MIN_VALUE=lu;var pu=Ga.prototype;pu.toInt=function(){return this.unsigned?this.low>>>0:this.low},pu.toNumber=function(){return this.unsigned?(this.high>>>0)*Za+(this.low>>>0):this.high*Za+(this.low>>>0)},pu.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(lu)){var t=Qa(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=Qa(Ja(e,6),this.unsigned),i=this,s="";;){var a=i.div(o),u=(i.sub(a.mul(o)).toInt()>>>0).toString(e);if((i=a).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},pu.getHighBits=function(){return this.high},pu.getHighBitsUnsigned=function(){return this.high>>>0},pu.getLowBits=function(){return this.low},pu.getLowBitsUnsigned=function(){return this.low>>>0},pu.getNumBitsAbs=function(){if(this.isNegative())return this.eq(lu)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},pu.isZero=function(){return 0===this.high&&0===this.low},pu.eqz=pu.isZero,pu.isNegative=function(){return!this.unsigned&&this.high<0},pu.isPositive=function(){return this.unsigned||this.high>=0},pu.isOdd=function(){return 1==(1&this.low)},pu.isEven=function(){return 0==(1&this.low)},pu.equals=function(e){return Ha(e)||(e=Xa(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},pu.eq=pu.equals,pu.notEquals=function(e){return!this.eq(e)},pu.neq=pu.notEquals,pu.ne=pu.notEquals,pu.lessThan=function(e){return this.comp(e)<0},pu.lt=pu.lessThan,pu.lessThanOrEqual=function(e){return this.comp(e)<=0},pu.lte=pu.lessThanOrEqual,pu.le=pu.lessThanOrEqual,pu.greaterThan=function(e){return this.comp(e)>0},pu.gt=pu.greaterThan,pu.greaterThanOrEqual=function(e){return this.comp(e)>=0},pu.gte=pu.greaterThanOrEqual,pu.ge=pu.greaterThanOrEqual,pu.compare=function(e){if(Ha(e)||(e=Xa(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},pu.comp=pu.compare,pu.negate=function(){return!this.unsigned&&this.eq(lu)?lu:this.not().add(iu)},pu.neg=pu.negate,pu.add=function(e){Ha(e)||(e=Xa(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,a=e.low>>>16,u=0,c=0,l=0,p=0;return l+=(p+=o+(65535&e.low))>>>16,c+=(l+=n+a)>>>16,u+=(c+=r+s)>>>16,u+=t+i,Ka((l&=65535)<<16|(p&=65535),(u&=65535)<<16|(c&=65535),this.unsigned)},pu.subtract=function(e){return Ha(e)||(e=Xa(e)),this.add(e.neg())},pu.sub=pu.subtract,pu.multiply=function(e){if(this.isZero())return nu;if(Ha(e)||(e=Xa(e)),Fa)return Ka(Fa.mul(this.low,this.high,e.low,e.high),Fa.get_high(),this.unsigned);if(e.isZero())return nu;if(this.eq(lu))return e.isOdd()?lu:nu;if(e.eq(lu))return this.isOdd()?lu:nu;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(ru)&&e.lt(ru))return Qa(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,a=e.low>>>16,u=65535&e.low,c=0,l=0,p=0,f=0;return p+=(f+=o*u)>>>16,l+=(p+=n*u)>>>16,p&=65535,l+=(p+=o*a)>>>16,c+=(l+=r*u)>>>16,l&=65535,c+=(l+=n*a)>>>16,l&=65535,c+=(l+=o*s)>>>16,c+=t*u+r*a+n*s+o*i,Ka((p&=65535)<<16|(f&=65535),(c&=65535)<<16|(l&=65535),this.unsigned)},pu.mul=pu.multiply,pu.divide=function(e){if(Ha(e)||(e=Xa(e)),e.isZero())throw Error("division by zero");var t,r,n;if(Fa)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?Ka((this.unsigned?Fa.div_u:Fa.div_s)(this.low,this.high,e.low,e.high),Fa.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?ou:nu;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return ou;if(e.gt(this.shru(1)))return su;n=ou}else{if(this.eq(lu))return e.eq(iu)||e.eq(au)?lu:e.eq(lu)?iu:(t=this.shr(1).div(e).shl(1)).eq(nu)?e.isNegative()?iu:au:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(lu))return this.unsigned?ou:nu;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=nu}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(t)/Math.LN2),i=o<=48?1:Ja(2,o-48),s=Qa(t),a=s.mul(e);a.isNegative()||a.gt(r);)a=(s=Qa(t-=i,this.unsigned)).mul(e);s.isZero()&&(s=iu),n=n.add(s),r=r.sub(a)}return n},pu.div=pu.divide,pu.modulo=function(e){return Ha(e)||(e=Xa(e)),Fa?Ka((this.unsigned?Fa.rem_u:Fa.rem_s)(this.low,this.high,e.low,e.high),Fa.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},pu.mod=pu.modulo,pu.rem=pu.modulo,pu.not=function(){return Ka(~this.low,~this.high,this.unsigned)},pu.and=function(e){return Ha(e)||(e=Xa(e)),Ka(this.low&e.low,this.high&e.high,this.unsigned)},pu.or=function(e){return Ha(e)||(e=Xa(e)),Ka(this.low|e.low,this.high|e.high,this.unsigned)},pu.xor=function(e){return Ha(e)||(e=Xa(e)),Ka(this.low^e.low,this.high^e.high,this.unsigned)},pu.shiftLeft=function(e){return Ha(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?Ka(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Ka(0,this.low<<e-32,this.unsigned)},pu.shl=pu.shiftLeft,pu.shiftRight=function(e){return Ha(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?Ka(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Ka(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},pu.shr=pu.shiftRight,pu.shiftRightUnsigned=function(e){if(Ha(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?Ka(this.low>>>e|t<<32-e,t>>>e,this.unsigned):Ka(32===e?t:t>>>e-32,0,this.unsigned)},pu.shru=pu.shiftRightUnsigned,pu.shr_u=pu.shiftRightUnsigned,pu.toSigned=function(){return this.unsigned?Ka(this.low,this.high,!1):this},pu.toUnsigned=function(){return this.unsigned?this:Ka(this.low,this.high,!0)},pu.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},pu.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},pu.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Ga.fromBytes=function(e,t,r){return r?Ga.fromBytesLE(e,t):Ga.fromBytesBE(e,t)},Ga.fromBytesLE=function(e,t){return new Ga(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Ga.fromBytesBE=function(e,t){return new Ga(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var fu={};Object.defineProperty(fu,"__esModule",{value:!0}),fu.ONEWAY_CID=fu.ConversationId=void 0;var hu=function(){function e(e){this.val=e}return e.fromString=function(t){return new e(ka.fromString(t,!1))},e.prototype.toString=function(){return this.val.toString(10)},e.prototype.equals=function(e){return e.val&&this.val.equals(e.val)},e}();fu.ConversationId=hu,fu.ONEWAY_CID=new hu(ka.fromNumber(0));for(var du={toByteArray:function(e){var t,r,n=mu(e),o=n[0],i=n[1],s=new Su(function(e,t,r){return 3*(t+r)/4-r}(0,o,i)),a=0,u=i>0?o-4:o;for(r=0;r<u;r+=4)t=vu[e.charCodeAt(r)]<<18|vu[e.charCodeAt(r+1)]<<12|vu[e.charCodeAt(r+2)]<<6|vu[e.charCodeAt(r+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;2===i&&(t=vu[e.charCodeAt(r)]<<2|vu[e.charCodeAt(r+1)]>>4,s[a++]=255&t);1===i&&(t=vu[e.charCodeAt(r)]<<10|vu[e.charCodeAt(r+1)]<<4|vu[e.charCodeAt(r+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t);return s},fromByteArray:function(e){for(var t,r=e.length,n=r%3,o=[],i=0,s=r-n;i<s;i+=16383)o.push(gu(e,i,i+16383>s?s:i+16383));1===n?(t=e[r-1],o.push(yu[t>>2]+yu[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],o.push(yu[t>>10]+yu[t>>4&63]+yu[t<<2&63]+"="));return o.join("")}},yu=[],vu=[],Su="undefined"!=typeof Uint8Array?Uint8Array:Array,_u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Eu=0,wu=_u.length;Eu<wu;++Eu)yu[Eu]=_u[Eu],vu[_u.charCodeAt(Eu)]=Eu;function mu(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function gu(e,t,r){for(var n,o,i=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(yu[(o=n)>>18&63]+yu[o>>12&63]+yu[o>>6&63]+yu[63&o]);return i.join("")}vu["-".charCodeAt(0)]=62,vu["_".charCodeAt(0)]=63;var Tu={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(e,t,r,n,o){var i,s,a=8*o-n-1,u=(1<<a)-1,c=u>>1,l=-7,p=r?o-1:0,f=r?-1:1,h=e[t+p];for(p+=f,i=h&(1<<-l)-1,h>>=-l,l+=a;l>0;i=256*i+e[t+p],p+=f,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=n;l>0;s=256*s+e[t+p],p+=f,l-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,n),i-=c}return(h?-1:1)*s*Math.pow(2,i-n)},write:function(e,t,r,n,o,i){var s,a,u,c=8*i-o-1,l=(1<<c)-1,p=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,d=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+p>=1?f/u:f*Math.pow(2,1-p))*u>=2&&(s++,u/=2),s+p>=l?(a=0,s=l):s+p>=1?(a=(t*u-1)*Math.pow(2,o),s+=p):(a=t*Math.pow(2,p-1)*Math.pow(2,o),s=0));o>=8;e[r+h]=255&a,h+=d,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;e[r+h]=255&s,h+=d,s/=256,c-=8);e[r+h-d]|=128*y}},Ou={};(function(e){(function(){"use strict";var t=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},n=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};function o(e){for(var t=[],o=0;o<e.length;o+=128)t.push(e.subarray(o,Math.min(o+128,e.length)));return t.map((function(e){return String.fromCharCode.apply(String,n([],r(e)))})).join("")}Object.defineProperty(Ou,"__esModule",{value:!0}),Ou.isUint8Array=Ou.isEqualUint8Arrays=Ou.uint8toUtf8=Ou.uint8ToBase64=Ou.uint8ToAscii=Ou.uint8FromDoubleBE=Ou.uint8FromBase64=Ou.uint8FromUtf8=Ou.uint8FromBinary=Ou.writeInt32BE=Ou.writeInt8=Ou.readDoubleBE=Ou.readFloatBE=Ou.readInt32BE=Ou.readUInt32BE=Ou.readUInt16BE=Ou.readInt8=Ou.concatUint8Arrays=void 0,Ou.concatUint8Arrays=function(e){var r,n,o=e.reduce((function(e,t){return e+t.length}),0),i=new Uint8Array(o),s=0;try{for(var a=t(e),u=a.next();!u.done;u=a.next()){var c=u.value;i.set(c,s),s+=c.length}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i},Ou.readInt8=function(e,t){return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt8(t)},Ou.readUInt16BE=function(e,t){return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(t,!1)},Ou.readUInt32BE=function(e,t){return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(t,!1)},Ou.readInt32BE=function(e,t){return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t,!1)},Ou.readFloatBE=function(e,t){return new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!1)},Ou.readDoubleBE=function(e,t){return new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!1)},Ou.writeInt8=function(e,t,r){e[t]=r},Ou.writeInt32BE=function(e,t,r){new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(t,r,!1)},Ou.uint8FromBinary=function(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t},Ou.uint8FromUtf8=function(e){return(new TextEncoder).encode(e)},Ou.uint8FromBase64="undefined"==typeof window||void 0===window.atob?function(t){return new Uint8Array(e.from(t,"base64"))}:function(e){return new Uint8Array(window.atob(e).split("").map((function(e){return e.charCodeAt(0)})))},Ou.uint8FromDoubleBE=function(e){var t=new ArrayBuffer(8);return new DataView(t).setFloat64(0,e,!1),new Uint8Array(t)},Ou.uint8ToAscii=o,Ou.uint8ToBase64="undefined"==typeof window||void 0===window.btoa?function(t){return e.from(t).toString("base64")}:function(e){return window.btoa(o(e))},Ou.uint8toUtf8=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.length),(new TextDecoder).decode(e.subarray(t,r))},Ou.isEqualUint8Arrays=function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0},Ou.isUint8Array=function(e){return"function"==typeof Uint8Array&&e instanceof Uint8Array||"[object Uint8Array]"===Object.prototype.toString.call(e)}}).call(this)}).call(this,d({}).Buffer);var Iu={},bu=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Iu,"__esModule",{value:!0}),Iu.writeOptional=Iu.writeBoolean=Iu.readBoolean=Iu.writeMap=Iu.readMap=Iu.readObject=Iu.writeObject=Iu.writeDictionary=Iu.readDictionary=Iu.readCollection=Iu.writeCollection=Iu.writeString=Iu.readString=Iu.writeBytes=Iu.readBytes=Iu.writeByte=Iu.writeInt32=Iu.readInt32=Iu.writeInt64=Iu.readInt64=Iu.readByte=void 0;var Ru=ka.fromNumber(128),Cu=ka.fromNumber(127),Au=Cu.not();function Pu(e){var t=e.read();if(-1===t)throw new va.IOError("End of stream");return t}function Nu(e){for(var t=0,r=0;t<32;){var n=Pu(e);if(r|=(127&n)<<t,0==(128&n))return r;t+=7}throw new va.IOError("Malformed int32")}function Mu(e,t){for(;0!=(-128&t);)e.write(127&t|128),t>>>=7;e.write(t)}function Du(e,t){e.write(t)}function ju(e){var t=Nu(e);return e.readMany(t)}function Lu(e,t){Mu(e,t.length),e.writeMany(t)}function xu(e){var t=ju(e);return t?Ou.uint8toUtf8(t):""}function Uu(e,t){Lu(e,Ou.uint8FromUtf8(t))}function Bu(e,t,r,n){var o,i;Mu(e,Object.keys(t).length);try{for(var s=bu(Object.getOwnPropertyNames(t)),a=s.next();!a.done;a=s.next()){var u=a.value;r(e,u),n(e,t[u])}}catch(e){o={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}function qu(e,t,r){for(var n=Nu(e),o={},i=0;i<n;++i){o[t(e)]=r(e)}return o}Iu.readByte=Pu,Iu.readInt64=function(e){for(var t=ka.fromNumber(0),r=0;r<64;){var n=Pu(e),o=ka.fromNumber(n);if(t=t.or(o.and(Cu).shiftLeft(r)),o.and(Ru).equals(0))return t;r+=7}throw new va.IOError("Malformed int64")},Iu.writeInt64=function(e,t){for(var r=t instanceof ka?t:ka.fromNumber(t,!1);!r.and(Au).equals(0);)e.write(r.and(Cu).or(Ru).toInt()),r=r.shiftRightUnsigned(7);e.write(r.toInt())},Iu.readInt32=Nu,Iu.writeInt32=Mu,Iu.writeByte=Du,Iu.readBytes=ju,Iu.writeBytes=Lu,Iu.readString=xu,Iu.writeString=Uu,Iu.writeCollection=function(e,t,r){var n,o;Mu(e,t.length);try{for(var i=bu(t),s=i.next();!s.done;s=i.next()){r(e,s.value)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},Iu.readCollection=function(e,t){for(var r=Nu(e),n=[],o=0;o<r;++o)n.push(t(e));return n},Iu.readDictionary=function(e,t){return qu(e,xu,t)},Iu.writeDictionary=function(e,t,r){Bu(e,t,Uu,r)},Iu.writeObject=Bu,Iu.readObject=qu,Iu.readMap=function(e,t,r){for(var n=Nu(e),o=new Map,i=0;i<n;++i){var s=t(e);o.set(s,r(e))}return o},Iu.writeMap=function(e,t,r,n){Mu(e,t.size),t.forEach((function(t,o){r(e,o),n(e,t)}))},Iu.readBoolean=function(e){return 0!==e.readInt8()},Iu.writeBoolean=function(e,t){e.writeInt8(t?1:0)},Iu.writeOptional=function(e,t,r,n){void 0===n&&(n=function(e){return null!=e}),n(t)?(Du(e,1),r(e,t)):Du(e,0)};var Vu={};Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.CIDSerialiser=void 0;var ku=function(){function e(){}return e.prototype.read=function(e){return new fu.ConversationId(Iu.readInt64(e))},e.prototype.write=function(e,t){Iu.writeInt64(e,t.val)},e}();Vu.CIDSerialiser=new ku;var Fu={};Object.defineProperty(Fu,"__esModule",{value:!0}),Fu.AbstractSerialiser=void 0;var Gu=function(){function e(){}return e.prototype.read=function(e){throw new va.InternalError("AbstractSerialiser#read is not implemented")},e.prototype.write=function(e,t){throw new va.InternalError("AbstractSerialiser#write is not implemented")},e}();Fu.AbstractSerialiser=Gu;var Hu={};Object.defineProperty(Hu,"__esModule",{value:!0}),Hu.CommandHeader=void 0;var Yu=function(){function e(e,t){this.service=e,this.cid=t}return e.createRequestHeader=function(t,r){return new e(t,r)},e.prototype.createResponseHeader=function(){return new e(this.service,this.cid)},e.prototype.createErrorHeader=function(){return new e(this.service,this.cid)},e.prototype.toString=function(){return"<"+this.service+", "+this.cid.toString()+">"},e}();Hu.CommandHeader=Yu;var Wu={},zu=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Wu,"__esModule",{value:!0}),Wu.ResponseCommandHeaderSerialiser=Wu.CommandHeaderSerialiser=void 0;var Qu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zu(t,e),t.prototype.read=function(e){var t=Iu.readInt32(e),r=Vu.CIDSerialiser.read(e);return new Hu.CommandHeader(t,r)},t.prototype.write=function(e,t){Iu.writeInt32(e,t.service),Vu.CIDSerialiser.write(e,t.cid)},t}(Fu.AbstractSerialiser),Ku=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zu(t,e),t.prototype.write=function(e,t){Vu.CIDSerialiser.write(e,t.cid)},t.prototype.read=function(e){var t=Vu.CIDSerialiser.read(e);return new Hu.CommandHeader(0,t)},t}(Fu.AbstractSerialiser);Wu.CommandHeaderSerialiser=new Qu,Wu.ResponseCommandHeaderSerialiser=new Ku;var Ju={exports:{}};!function(e,t){"use strict";Ju.exports?Ju.exports=t():e.log=t()}(this,(function(){"use strict";var e=function(){},t="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function n(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function i(r){return"debug"===r&&(r="log"),"undefined"!=typeof console&&("trace"===r&&t?o:void 0!==console[r]?n(console,r):void 0!==console.log?n(console,"log"):e)}function s(t,n){for(var o=0;o<r.length;o++){var i=r[o];this[i]=o<t?e:this.methodFactory(i,t,n)}this.log=this.debug}function a(e,t,r){return function(){"undefined"!=typeof console&&(s.call(this,t,r),this[e].apply(this,arguments))}}function u(e,t,r){return i(e)||a.apply(this,arguments)}function c(e,t,n){var o,i=this,a="loglevel";function c(){var e;if("undefined"!=typeof window&&a){try{e=window.localStorage[a]}catch(e){}if(void 0===e)try{var t=window.document.cookie,r=t.indexOf(encodeURIComponent(a)+"=");-1!==r&&(e=/^([^;]+)/.exec(t.slice(r))[1])}catch(e){}return void 0===i.levels[e]&&(e=void 0),e}}"string"==typeof e?a+=":"+e:"symbol"==typeof e&&(a=void 0),i.name=e,i.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},i.methodFactory=n||u,i.getLevel=function(){return o},i.setLevel=function(t,n){if("string"==typeof t&&void 0!==i.levels[t.toUpperCase()]&&(t=i.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=i.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(o=t,!1!==n&&function(e){var t=(r[e]||"silent").toUpperCase();if("undefined"!=typeof window&&a){try{return void(window.localStorage[a]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(a)+"="+t+";"}catch(e){}}}(t),s.call(i,t,e),"undefined"==typeof console&&t<i.levels.SILENT)return"No console available for logging"},i.setDefaultLevel=function(e){c()||i.setLevel(e,!1)},i.enableAll=function(e){i.setLevel(i.levels.TRACE,e)},i.disableAll=function(e){i.setLevel(i.levels.SILENT,e)};var l=c();null==l&&(l=null==t?"WARN":t),i.setLevel(l,!1)}var l=new c,p={};l.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=p[e];return t||(t=p[e]=new c(e,l.getLevel(),l.methodFactory)),t};var f="undefined"!=typeof window?window.log:void 0;return l.noConflict=function(){return"undefined"!=typeof window&&window.log===l&&(window.log=f),l},l.getLoggers=function(){return p},l.default=l,l})),Ju=Ju.exports;var $u,Xu={},Zu=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function ec(e,t){var r="|"+e.toUpperCase()+"|"+t+"|",n=function(){return new Date};return function(t,o){o?Ju[e](n()+r+t,o):Ju[e](n()+r+t)}}Object.defineProperty(Xu,"__esModule",{value:!0}),Xu.setLevel=Xu.create=Xu.LoggingLevel=void 0,function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error"}($u=Xu.LoggingLevel||(Xu.LoggingLevel={})),Xu.create=function(e){var t,r,n={};try{for(var o=Zu(Object.keys($u)),i=o.next();!i.done;i=o.next()){var s=i.value;n[s]=ec(s,e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},Xu.setLevel=Ju.setLevel;var tc={};Object.defineProperty(tc,"__esModule",{value:!0}),tc.BufferInputStream=void 0;var rc=function(){function e(e){this.buffer=e,this.count=e.length,this.pos=0}return e.prototype.read=function(){return this.pos<this.count?255&this.buffer[this.pos++]:-1},e.prototype.peek=function(){return this.pos<this.count?255&this.buffer[this.pos]:-1},e.prototype.readMany=function(e){var t=Math.min(e,this.count-this.pos);if(t<0)throw new va.IOError("Length out of bounds");var r=this.buffer.subarray(this.pos,this.pos+t);return this.pos+=t,r},e.prototype.readUntil=function(e){for(var t=this.count,r=this.pos;r<this.count;r++)if(this.buffer[r]===e){t=r;break}var n=this.buffer.subarray(this.pos,t);return this.pos=t===this.count?t:t+1,n},e.prototype.readInt8=function(){return Ou.readInt8(this.buffer,this.pos++)},e.prototype.readInt32=function(){var e=Ou.readInt32BE(this.buffer,this.pos);return this.pos+=4,e},e.prototype.readInt64=function(){var e=Ou.readInt32BE(this.buffer,this.pos);this.pos+=4;var t=Ou.readInt32BE(this.buffer,this.pos);return this.pos+=4,ka.fromBits(t,e,!1)},e.prototype.readUInt64=function(){var e=Ou.readInt32BE(this.buffer,this.pos);this.pos+=4;var t=Ou.readInt32BE(this.buffer,this.pos);return this.pos+=4,ka.fromBits(t,e,!0)},e.prototype.hasRemaining=function(){return this.pos<this.buffer.length},e}();tc.BufferInputStream=rc;var nc={};Object.defineProperty(nc,"__esModule",{value:!0}),nc.BufferOutputStream=void 0;var oc=function(){function e(e){void 0===e&&(e=32),"number"==typeof e?(this.buffer=new Uint8Array(e),this.count=0):(this.buffer=e,this.count=e.length)}return e.prototype.write=function(e){this.ensureCapacity(this.count+1),this.buffer[this.count++]=e},e.prototype.writeMany=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length),0!==r&&(this.ensureCapacity(this.count+r),this.buffer.set(e.subarray(t,t+r),this.count),this.count+=r)},e.prototype.writeString=function(e){var t=Ou.uint8FromUtf8(e),r=t.length;this.ensureCapacity(this.count+r),this.buffer.set(t,this.count),this.count+=r},e.prototype.writeInt8=function(e){this.ensureCapacity(this.count+1),Ou.writeInt8(this.buffer,this.count++,e)},e.prototype.writeInt32=function(e){this.ensureCapacity(this.count+4),Ou.writeInt32BE(this.buffer,this.count,e),this.count+=4},e.prototype.writeInt64=function(e){this.ensureCapacity(this.count+8),Ou.writeInt32BE(this.buffer,this.count,e.getHighBits()),Ou.writeInt32BE(this.buffer,this.count+4,e.getLowBits()),this.count+=8},e.prototype.getBuffer=function(){return this.buffer.subarray(0,this.count)},e.prototype.getBase64=function(){return Ou.uint8ToBase64(this.getBuffer())},e.prototype.ensureCapacity=function(e){e-this.buffer.length>0&&this.grow(e)},e.prototype.grow=function(e){var t=this.buffer.length<<1;t-e<0&&(t=e);try{var r=new Uint8Array(t);r.set(this.buffer),this.buffer=r}catch(e){throw new va.IOError("Unable to resize BufferOutputStream to "+t)}},e}();nc.BufferOutputStream=oc;var ic={};Object.defineProperty(ic,"__esModule",{value:!0}),ic.PROTOCOL=void 0,ic.PROTOCOL={TYPE:"WB",CAPABILITIES:function(){try{if(require("zlib"))return!0}catch(e){return!1}return!1}()?10:8,PROTOCOL_BYTE:35,CURRENT_VERSION:28};var sc={};Object.defineProperty(sc,"__esModule",{value:!0}),sc.EncodingType=sc.MessageEncoding=void 0;var ac=function(){function e(e,t){this.encodingByte=e,this.messageTypeFlags=t}return e.extractMessageType=function(e){return-11000001&e},e.extractMessageEncoding=function(e){return 128===(11e6&e)?sc.EncodingType.ZLIB:sc.EncodingType.NO_ENCODING},e}();sc.MessageEncoding=ac,sc.EncodingType={NO_ENCODING:new ac(0,0),ZLIB:new ac(18,1)};var uc={};Object.defineProperty(uc,"__esModule",{value:!0}),uc.isObjectAs=void 0,uc.isObjectAs=function(e){return e instanceof Object};var cc={},lc=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(cc,"__esModule",{value:!0}),cc.writeToBuffer=cc.create=cc.parse=cc.encoding=cc.types=void 0;var pc,fc,hc,dc=Xu.create("Message");10===ic.PROTOCOL.CAPABILITIES?pc=h({}):(dc.warn("Per message compression is disabled because 'zlib' bundle is not included"),pc=null),function(e){e[e.SERVICE_REQUEST=0]="SERVICE_REQUEST",e[e.SERVICE_RESPONSE=6]="SERVICE_RESPONSE",e[e.SERVICE_ERROR=7]="SERVICE_ERROR",e[e.TOPIC_VALUE=4]="TOPIC_VALUE",e[e.TOPIC_DELTA=5]="TOPIC_DELTA",e[e.ABORT_NOTIFICATION=28]="ABORT_NOTIFICATION",e[e.CLOSE_REQUEST=29]="CLOSE_REQUEST",e[e.FETCH_REPLY=34]="FETCH_REPLY"}(fc=cc.types||(cc.types={})),function(e){e[e.NONE=0]="NONE",e[e.ENCRYPTION_REQUESTED=1]="ENCRYPTION_REQUESTED",e[e.COMPRESSION_REQUESTED=2]="COMPRESSION_REQUESTED",e[e.BASE64_REQUESTED=3]="BASE64_REQUESTED",e[e.ENCRYPTED=17]="ENCRYPTED",e[e.COMPRESSED=18]="COMPRESSED",e[e.BASE64=19]="BASE64"}(hc=cc.encoding||(cc.encoding={}));var yc=function(){function e(e,t,r,n,o){this.type=e,this.encoding=t,this.id=r.id,this.topic=r.topic,this.data=n,this.headers=o}return e.prototype.getInputStream=function(){return new tc.BufferInputStream(this.data)},e}(),vc=function(e){function t(t){var r=e.call(this,t.type,t.encoding,t,t.buffer,t.headers)||this;return r.stream=new nc.BufferOutputStream(t.buffer),r}return lc(t,e),t.prototype.getStream=function(){return this.stream},t.prototype.getBuffer=function(){return this.stream.getBuffer()},t}(yc);cc.parse=function(e,t){var r=new tc.BufferInputStream(e),n=r.read(),o=sc.MessageEncoding.extractMessageType(n),i=sc.MessageEncoding.extractMessageEncoding(n);if(void 0===fc[o]&&t(new Error("Invalid message type: "+o),null),o===fc.SERVICE_REQUEST||o===fc.SERVICE_RESPONSE||o===fc.SERVICE_ERROR)t(null,function(e,t){var r=t.readMany(t.count);return new yc(e,hc.NONE,{},r,[])}(o,r));else if(o===fc.TOPIC_VALUE||o===fc.TOPIC_DELTA)!function(e,t,r,n){var o=[],i={id:r.readInt32()};if(t===sc.EncodingType.ZLIB&&null!==pc)try{var s=pc.decompressSync(r.readMany(r.count));n(null,new yc(e,hc.COMPRESSED,i,s,o))}catch(e){n(e,null)}else n(null,new yc(e,hc.NONE,i,r.readMany(r.count),o))}(o,i,r,t);else{var s=r.readUntil(1).toString().split(""),a=r.readMany(r.count),u=o===fc.FETCH_REPLY?s.shift():void 0;t(null,new yc(o,hc.NONE,{topic:u},a,s))}},cc.create=function(e){var t;if(void 0===e||"number"==typeof e&&void 0===fc[e])throw new va.InternalError("Invalid message type: "+e);return(t=uc.isObjectAs(e)?e:{type:e}).encoding=t.encoding||0,t.headers=t.headers||[],t.buffer=t.buffer||new Uint8Array(0),new vc(t)},cc.writeToBuffer=function(e,t){t.write(e.type),t.writeString(function(e){return e.type!==fc.FETCH_REPLY?"":[e.topic].concat(e.headers).join("")+""}(e)),t.writeMany(e.getBuffer())};var Sc={};Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.enumerize=void 0,Sc.enumerize=function(e){Object.keys(e).forEach((function(t){var r=e[t].id;void 0!==r&&(e[r]=t)}))};var _c={};Object.defineProperty(_c,"__esModule",{value:!0}),_c.ErrorReason=void 0,_c.ErrorReason={COMMUNICATION_FAILURE:new qa.ErrorReason(100,"Communication with server failed"),SESSION_CLOSED:new qa.ErrorReason(101,"Session is closed"),REQUEST_TIME_OUT:new qa.ErrorReason(102,"Request time out"),ACCESS_DENIED:new qa.ErrorReason(103,"Access denied"),UNSUPPORTED:new qa.ErrorReason(104,"Unsupported service"),CALLBACK_EXCEPTION:new qa.ErrorReason(105,"An application callback threw an exception. Check logs for more information"),INVALID_DATA:new qa.ErrorReason(106,"Invalid data"),NO_SUCH_SESSION:new qa.ErrorReason(107,"A requested session could not be found"),INCOMPATIBLE_DATATYPE:new qa.ErrorReason(108,"Data type is incompatible"),UNHANDLED_MESSAGE:new qa.ErrorReason(109,"A message was not handled"),CLUSTER_REPARTITION:new qa.ErrorReason(110,"The cluster was repartitioning and the request could not be routed."),INCOMPATIBLE_STATE:new qa.ErrorReason(111,"Topic operation not performed because it is managed by a component that prohibits external updates"),CLUSTER_ROUTING:new qa.ErrorReason(112,"The cluster operation could not be routed."),TOPIC_TREE_REGISTRATION_CONFLICT:new qa.ErrorReason(200,"A conflicting registration exists on the same branch of the topic tree"),HANDLER_CONFLICT:new qa.ErrorReason(201,"Conflict with an existing handler"),INVALID_PATH:new qa.ErrorReason(202,"Invalid path"),REJECTED_REQUEST:new qa.ErrorReason(9003,"A request has been rejected by the recipient session")},Sc.enumerize(_c.ErrorReason);var Ec={};Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.ServiceAdapter=void 0;var wc=Xu.create("ServiceAdapter"),mc={respond:function(){},fail:function(){}},gc=function(){function e(e,t){this.listeners={},this.internalSession=e,this.sender=t}return e.prototype.sendRequest=function(e,t,r){var n=cc.create({type:cc.types.SERVICE_REQUEST}),o=n.getStream();Wu.CommandHeaderSerialiser.write(o,e),r.write(o,t),wc.debug("Sending command request: "+e,t),this.sender(n)},e.prototype.sendResponse=function(e,t,r){var n=cc.create({type:cc.types.SERVICE_RESPONSE}),o=n.getStream();Wu.ResponseCommandHeaderSerialiser.write(o,e),r.write(o,t),wc.debug("Sending command response: "+e,t),this.sender(n)},e.prototype.sendError=function(e,t,r){var n=cc.create({type:cc.types.SERVICE_ERROR}),o=n.getStream();Wu.ResponseCommandHeaderSerialiser.write(o,e),Iu.writeString(o,r),Iu.writeInt32(o,t.id),wc.debug("Sending command error: "+t.id,r),this.sender(n)},e.prototype.addService=function(e,t){var r=this;if(void 0!==this.listeners[e.id])throw new va.RuntimeError("Service already exists for service "+e.id);var n=e.request,o=e.response;this.listeners[e.id]=function(i,s){var a=n.read(s),u=i.cid.equals(fu.ONEWAY_CID)?mc:{respond:function(e){var t=i.createResponseHeader();r.sendResponse(t,e,o)},fail:function(e,t,n){void 0===n&&(n=!0);var o=i.createErrorHeader();if(r.sendError(o,e,t),n)throw new va.RuntimeError("Callback received an error",e)}};try{t.onRequest(r.internalSession,a,u)}catch(t){throw wc.error(t),new va.RuntimeError("Unable to handle request for service "+e.id)}}},e.prototype.isServiceRegistered=function(e){return void 0!==this.listeners[e]},e.prototype.onMessage=function(e,t){switch(e){case cc.types.SERVICE_REQUEST:this.handleRequest(Wu.CommandHeaderSerialiser.read(t),t);break;case cc.types.SERVICE_RESPONSE:this.handleResponse(Vu.CIDSerialiser.read(t),t);break;case cc.types.SERVICE_ERROR:this.handleError(Vu.CIDSerialiser.read(t),t);break;default:throw new va.AssertionError("Unknown Command Service message "+e)}},e.prototype.handleRequest=function(e,t){var r=this.listeners[e.service];r?(wc.debug("Received command request for service: "+e),r(e,t)):(wc.error("Received command request for unknown service: "+e),this.sendError(e.createErrorHeader(),_c.ErrorReason.COMMUNICATION_FAILURE,"Unknown client service: "+e.service))},e.prototype.handleResponse=function(e,t){wc.debug("Received command response: "+e),this.internalSession.getConversationSet().respondIfPresent(e,t)},e.prototype.handleError=function(e,t){var r=Iu.readString(t),n=Iu.readInt32(t),o=new qa.ErrorReason(n,r);wc.warn("Received command error",o),this.internalSession.getConversationSet().discard(e,o)},e}();Ec.ServiceAdapter=gc;var Tc={},Oc=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},Ic=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(Tc,"__esModule",{value:!0}),Tc.ServiceLocatorImpl=void 0;var bc=Xu.create("ServiceLocator"),Rc=function(){function e(e,t){this.context=e,this.serviceAdapter=t}return e.prototype.obtain=function(e){var t=this,r=e.request,n=e.response;return{send:function(o,i){return void 0===i&&(i=function(){}),Oc(t,void 0,void 0,(function(){var t,s,a,u=this;return Ic(this,(function(c){switch(c.label){case 0:return t={onOpen:function(t){var n=new Hu.CommandHeader(e.id,t);try{u.serviceAdapter.sendRequest(n,o,r)}catch(e){throw i(e),e}},onResponse:function(t,r){var o;try{o=n.read(r)}catch(t){return bc.debug("Failed to deserialise response from service "+e.id,t.stack),i(t),!0}try{i(null,o)}catch(t){bc.debug("Request callback for service '"+e.id+"' threw an error",t.stack);try{i(t)}catch(t){bc.debug("Failed to notify callback error for service '"+e.id+"'",t)}}return!0},onDiscard:function(e,t){i(t)}},[4,(s=this.context.getConversationSet()).newConversation(t)];case 1:return a=c.sent(),[2,function(){s.discard(a,new Error("Cancelled"))}]}}))}))}}},e}();Tc.ServiceLocatorImpl=Rc;var Cc={},Ac=this&&this.__assign||function(){return(Ac=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Pc=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.TopicSpecification=void 0;var Nc=["PUBLISH_VALUES_ONLY","SCHEMA","VALIDATE_VALUES","TIDY_ON_UNSUBSCRIBE","TIME_SERIES_EVENT_VALUE_TYPE","TIME_SERIES_RETAINED_RANGE","TIME_SERIES_SUBSCRIPTION_RANGE","DONT_RETAIN_VALUE","PERSISTENT","REMOVAL","OWNER","COMPRESSION","CONFLATION","PRIORITY"],Mc=function(){function e(e,t){void 0===t&&(t={}),this.type=e,this.properties=t}return e.prototype.withProperty=function(t,r){var n;if("string"!=typeof t||Nc.indexOf(t.toUpperCase())<0)throw new va.IllegalArgumentError("Invalid key: "+t);if("string"!=typeof r)throw new va.IllegalArgumentError("Invalid value, must be string: "+r);var o=Ac(Ac({},this.properties),((n={})[t]=r,n));return new e(this.type,o)},e.prototype.withProperties=function(t){var r,n;try{for(var o=Pc(Object.getOwnPropertyNames(t)),i=o.next();!i.done;i=o.next()){var s=i.value;if("string"!=typeof s||Nc.indexOf(s.toUpperCase())<0)throw new va.IllegalArgumentError("Invalid key: "+s);var a=t[s];if("string"!=typeof a)throw new va.IllegalArgumentError("Invalid value, must be string: "+a)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}var u=Ac(Ac({},this.properties),t);return new e(this.type,u)},e.PUBLISH_VALUES_ONLY="PUBLISH_VALUES_ONLY",e.VALIDATE_VALUES="VALIDATE_VALUES",e.TIDY_ON_UNSUBSCRIBE="TIDY_ON_UNSUBSCRIBE",e.TIME_SERIES_EVENT_VALUE_TYPE="TIME_SERIES_EVENT_VALUE_TYPE",e.TIME_SERIES_RETAINED_RANGE="TIME_SERIES_RETAINED_RANGE",e.TIME_SERIES_SUBSCRIPTION_RANGE="TIME_SERIES_SUBSCRIPTION_RANGE",e.SCHEMA="SCHEMA",e.DONT_RETAIN_VALUE="DONT_RETAIN_VALUE",e.PERSISTENT="PERSISTENT",e.REMOVAL="REMOVAL",e.CONFLATION="CONFLATION",e.OWNER="OWNER",e.COMPRESSION="COMPRESSION",e.PRIORITY="PRIORITY",e}();Cc.TopicSpecification=Mc;var Dc={};Object.defineProperty(Dc,"__esModule",{value:!0}),Dc.TopicTypeEnum=void 0;var jc=function(e,t,r){this.id=e,this.stateful=t,this.functional=r};Dc.TopicTypeEnum={BINARY:new jc(14,!0,!1),JSON:new jc(15,!0,!1),STRING:new jc(17,!0,!1),INT64:new jc(18,!0,!1),DOUBLE:new jc(19,!0,!1),TIME_SERIES:new jc(16,!0,!1),RECORD_V2:new jc(20,!0,!1),UNKNOWN_TOPIC_TYPE:new jc(21,!1,!1)},Sc.enumerize(Dc.TopicTypeEnum);var Lc={};Object.defineProperty(Lc,"__esModule",{value:!0}),Lc.FetchRequest=void 0;var xc=function(){function e(){}return e.getAllTypes=function(){return new Set([Dc.TopicTypeEnum.JSON,Dc.TopicTypeEnum.BINARY,Dc.TopicTypeEnum.RECORD_V2,Dc.TopicTypeEnum.DOUBLE,Dc.TopicTypeEnum.INT64,Dc.TopicTypeEnum.STRING,Dc.TopicTypeEnum.TIME_SERIES])},e}();Lc.FetchRequest=xc;var Uc={};Object.defineProperty(Uc,"__esModule",{value:!0}),Uc.topicsNamespace=Uc.TopicAddFailReasonEnum=Uc.UpdateFailReasonEnum=Uc.UnsubscribeReasonEnum=void 0;var Bc=function(e,t){this.id=e,this.reason=t};Uc.UnsubscribeReasonEnum={SUBSCRIPTION_REFRESH:new Bc(void 0,"The server has re-subscribed this session"),STREAM_CHANGE:new Bc(void 0,"A more specific stream has been registered to the same path"),REQUESTED:new Bc(0,"The unsubscription was requested by this client"),CONTROL:new Bc(1,"The server or another client unsubscribed this client"),REMOVED:new Bc(2,"The topic was removed"),AUTHORIZATION:new Bc(3,"Not authorized to subscribe to this topic"),UNKNOWN_UNSUBSCRIBE_REASON:new Bc(4,"Unknown unsubscribe reason"),BACK_PRESSURE:new Bc(5,"The server has unsubscribed due to a backlog of messages"),BRANCH_MAPPINGS:new Bc(6,"Branch mapping rules have changed")},Sc.enumerize(Uc.UnsubscribeReasonEnum),Object.freeze(Uc.UnsubscribeReasonEnum);var qc=function(e,t){this.id=e,this.reason=t};Uc.UpdateFailReasonEnum={INCOMPATIBLE_UPDATE:new qc(1,"Update type is incompatible with topic type"),UPDATE_FAILED:new qc(2,"Update failed - possible content incompatibility"),INVALID_UPDATER:new qc(3,"Updater is invalid for updating"),MISSING_TOPIC:new qc(4,"Topic does not exist"),EXCLUSIVE_UPDATER_CONFLICT:new qc(7,"An exclusive update source is already registered for the topic branch"),DELTA_WITHOUT_VALUE:new qc(8,"An attempt has been made to apply a delta to a topic that does not yet have a value"),CLUSTER_REPARTITION:new qc(9,"When trying to update the topic the cluster was migrating the partition that owns the topic"),INCOMPATIBLE_STATE:new qc(10,"An update could not be performed because the topic is managed bya component (e.g fan-out) that prohibits updates from the caller"),UNSATISFIED_CONSTRAINT:new qc(-1,"The topic update failed because the constraint was not satisfied"),INVALID_UPDATE_STREAM:new qc(-2,"The topic update failed because the update stream is no longer valid")},Sc.enumerize(Uc.UpdateFailReasonEnum),Object.freeze(Uc.UpdateFailReasonEnum);var Vc=function(e,t){this.id=e,this.reason=t};Uc.TopicAddFailReasonEnum={EXISTS:new Vc(1,"The topic already exists with the same details"),EXISTS_MISMATCH:new Vc(2,"The topic already exists, with different details"),INVALID_NAME:new Vc(15,"The supplied topic path is invalid."),INVALID_DETAILS:new Vc(4,"The topic details are invalid"),PERMISSIONS_FAILURE:new Vc(7,"Invalid permissions to add a topic at the specified path"),UNEXPECTED_ERROR:new Vc(9,"An unexpected error occured while creating the topic"),CLUSTER_REPARTITION:new Vc(10,"When trying to create the topic the cluster was migrating the partition that owns the topic"),EXCEEDED_LICENSE_LIMIT:new Vc(11,"Adding the topic failed because of a license limit"),EXISTS_INCOMPATIBLE:new Vc(14,"Adding the topic failed because a topic is already bound to the specifiedpath but the caller does not have the rights to manage it")},Sc.enumerize(Uc.TopicAddFailReasonEnum),Object.freeze(Uc.TopicAddFailReasonEnum),Uc.topicsNamespace={FetchRequest:Lc.FetchRequest,TopicType:Dc.TopicTypeEnum,TopicSpecification:Cc.TopicSpecification,UnsubscribeReason:Uc.UnsubscribeReasonEnum,UpdateFailReason:Uc.UpdateFailReasonEnum,TopicAddFailReason:Uc.TopicAddFailReasonEnum};var kc={};Object.defineProperty(kc,"__esModule",{value:!0}),kc.CloseReasonImpl=void 0;var Fc=function(){function e(e,t,r){this.id=e,this.message=t,this.canReconnect=r}return e.prototype.toString=function(){return"id: "+this.message},e}();kc.CloseReasonImpl=Fc;var Gc={};Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.AnyDataTypeImpl=void 0;var Hc=function(){function e(){this.valueClass=e}return e.prototype.name=function(){return"any"},e}();Gc.AnyDataTypeImpl=Hc;var Yc={},Wc=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Yc,"__esModule",{value:!0}),Yc.Int64Impl=void 0;var zc=4294967296;function Qc(e,t,r){for(var n=r?0:4,o=3;o>=0;--o)t[n+o]=255&e,e>>=8}function Kc(e,t){var r=t?0:4;return e[r]*(1<<24)+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3]}var Jc=function(){function e(t,r){this.buffer=Uint8Array.from([0,0,0,0,0,0,0,0]),Ou.isUint8Array(t)&&(this.buffer=t),"string"==typeof t&&function(e,t,r){var n,o,i="-"===e[0];i?e=e.substring(1):"0x"===e.substring(0,2)&&(e=e.substring(2),t=16);var s=0,a=0;try{for(var u=Wc(e),c=u.next();!c.done;c=u.next()){var l=c.value;a=a*t+parseInt(l,t),s=s*t+Math.floor(a/zc),a%=zc}}catch(e){n={error:e}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}i&&(s=~s,a?a=zc-a:s++),Qc(s,r,!0),Qc(a,r,!1)}(t,r=r||10,this.buffer),"number"==typeof t&&("number"==typeof r?(Qc(t,this.buffer,!0),Qc(r,this.buffer,!1)):t>=0?function(e,t){for(var r=7;r>=0;--r)t[r]=255&e,e/=256}(t,this.buffer):function(e,t){e++;for(var r=7;r>=0;--r)t[r]=255&-e^255,e/=256}(t,this.buffer)),t instanceof e&&(Qc(t.getHighBits(),this.buffer,!0),Qc(t.getLowBits(),this.buffer,!1))}return e.toString=function(){return"Int64Impl"},e.prototype.getHighBits=function(){return Kc(this.buffer,!0)},e.prototype.getLowBits=function(){return Kc(this.buffer,!1)},e.prototype.toBuffer=function(){return this.buffer},e.prototype.toNumber=function(){var e=0|this.getHighBits(),t=this.getLowBits();return e?e*zc+t:t},e.prototype.isNegative=function(){return!!(2147483648&this.getHighBits())},e.prototype.toString=function(e){void 0===e&&(e=10);var t=this.getHighBits(),r=this.getLowBits(),n=this.isNegative();if(n&&(t=~t,r=zc-r),0===t&&0===r)return"0";for(var o="";t||r;){var i=t%e*zc+r;t=Math.floor(t/e),r=Math.floor(i/e),o=(i%e).toString(e)+o}return n&&(o="-"+o),o},e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.getHighBits()===t.getHighBits()&&this.getLowBits()===t.getLowBits())},e}();Yc.Int64Impl=Jc;var $c,Xc={};Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.isStructEnd=Xc.isStructStart=Xc.tokens=Xc.BYTE_BREAK=Xc.additional=Xc.types=void 0,function(e){e[e.UINT=0]="UINT",e[e.INT=1]="INT",e[e.BYTES=2]="BYTES",e[e.STRING=3]="STRING",e[e.ARRAY=4]="ARRAY",e[e.MAP=5]="MAP",e[e.SEMANTIC=6]="SEMANTIC",e[e.SIMPLE=7]="SIMPLE",e[e.FLOAT=7]="FLOAT"}(Xc.types||(Xc.types={})),function(e){e[e.FALSE=20]="FALSE",e[e.TRUE=21]="TRUE",e[e.NULL=22]="NULL",e[e.UNDEFINED=23]="UNDEFINED",e[e.SIMPLE=24]="SIMPLE",e[e.HALF_PRECISION=25]="HALF_PRECISION",e[e.SINGLE_PRECISION=26]="SINGLE_PRECISION",e[e.DOUBLE_PRECISION=27]="DOUBLE_PRECISION",e[e.BREAK=31]="BREAK"}(Xc.additional||(Xc.additional={})),Xc.BYTE_BREAK=255,function(e){e[e.ARRAY_START=0]="ARRAY_START",e[e.ARRAY_END=1]="ARRAY_END",e[e.MAP_START=2]="MAP_START",e[e.MAP_END=3]="MAP_END",e[e.STRING_START=4]="STRING_START",e[e.STRING_END=5]="STRING_END",e[e.VALUE=6]="VALUE"}($c=Xc.tokens||(Xc.tokens={})),Xc.isStructStart=function(e){switch(e){case $c.ARRAY_START:case $c.MAP_START:case $c.STRING_START:return!0;default:return!1}},Xc.isStructEnd=function(e){switch(e){case $c.ARRAY_END:case $c.MAP_END:case $c.STRING_END:return!0;default:return!1}};var Zc,el={};Object.defineProperty(el,"__esModule",{value:!0}),el.Context=el.TokenContextType=void 0,function(e){e[e.root=0]="root",e[e.string=1]="string",e[e.array=2]="array",e[e.object=3]="object"}(Zc=el.TokenContextType||(el.TokenContextType={}));var tl=function(){function e(){this.ROOT={length:-1,type:Zc.root,read:0},this.stack=[],this.tail=this.ROOT}return e.prototype.type=function(){return this.tail.type},e.prototype.read=function(){return this.tail.read},e.prototype.expected=function(){return this.tail.length},e.prototype.push=function(e,t){void 0===t&&(t=-1),this.tail={length:t,type:e,read:0},this.stack.push(this.tail)},e.prototype.pop=function(){var e=this.stack.pop();return this.stack.length?this.tail=this.stack[this.stack.length-1]:this.tail=this.ROOT,e},e.prototype.next=function(){if(!this.hasRemaining())throw new va.InvalidDataError("Exceeded expected collection limit");this.tail.read++},e.prototype.break=function(){this.acceptsBreakMarker()&&(this.tail.length=0,this.tail.read=0)},e.prototype.hasRemaining=function(){return-1===this.tail.length||this.tail.length>this.tail.read},e.prototype.acceptsBreakMarker=function(){return this.tail!==this.ROOT&&-1===this.tail.length},e}();el.Context=tl;var rl={};Object.defineProperty(rl,"__esModule",{value:!0}),rl.Tokeniser=void 0;var nl=new Error,ol=new Uint8Array(0),il=function(){function e(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length),this.bufferOffset=t,this.length=r,this.data=e,this.context=new el.Context,this.pos=this.bufferOffset}return e.prototype.reset=function(){this.context=new el.Context,this.token=void 0,this.type=void 0,this.pos=this.bufferOffset},e.prototype.hasRemaining=function(){var e=this.context.type()===el.TokenContextType.root?this.length:this.length+1;return this.pos<this.bufferOffset+e},e.prototype.offset=function(){return this.pos},e.prototype.getContext=function(){return this.context},e.prototype.getToken=function(){return this.token},e.prototype.nextToken=function(){if(!this.hasRemaining())return null;var e=this.context.type(),t=this.pos;if(e!==el.TokenContextType.root&&!this.context.hasRemaining()){switch(e){case el.TokenContextType.object:this.type=Xc.tokens.MAP_END;break;case el.TokenContextType.array:this.type=Xc.tokens.ARRAY_END;break;case el.TokenContextType.string:this.type=Xc.tokens.STRING_END}return this.context.pop(),{pos:this.pos,type:this.type,getBuffer:function(){return ol}}}this.context.next();var r,n=this.readHeader();switch(n.type){case Xc.types.INT:case Xc.types.UINT:case Xc.types.FLOAT:case Xc.types.SIMPLE:this.type=Xc.tokens.VALUE,r=this.readValue(n);break;case Xc.types.BYTES:case Xc.types.STRING:n.raw===Xc.additional.BREAK?(this.context.push(el.TokenContextType.string,-1),this.type=Xc.tokens.STRING_START):(this.type=Xc.tokens.VALUE,r=this.readValue(n));break;case Xc.types.ARRAY:this.context.push(el.TokenContextType.array,this.readCollectionLength(n)),this.type=Xc.tokens.ARRAY_START;break;case Xc.types.MAP:var o=this.readCollectionLength(n);o>=0&&(o*=2),this.context.push(el.TokenContextType.object,o),this.type=Xc.tokens.MAP_START;break;case Xc.types.SEMANTIC:return this.nextToken();default:throw new va.InvalidDataError("Unknown CBOR header type: "+n.type)}if(r instanceof Error){if(this.context.acceptsBreakMarker())return this.context.break(),this.nextToken();throw new va.InvalidDataError("Unexpected break flag outside of indefinite-length context")}var i=this.data;return this.token={pos:t,type:this.type,value:r,header:n,length:this.pos,getBuffer:function(){return i.subarray(this.pos,this.length)}},this.token},e.prototype.readValue=function(e){switch(e.type){case Xc.types.UINT:return this.readHeaderValue(e);case Xc.types.INT:return this.readHeaderValue(e,!0);case Xc.types.BYTES:return this.readBuffer(this.readHeaderValue(e));case Xc.types.STRING:return Ou.uint8toUtf8(this.readBuffer(this.readHeaderValue(e)));case Xc.types.SIMPLE:return this.readSimpleValue(e.raw)}throw new va.InvalidDataError("Unrecognised value type ("+e.type+")")},e.prototype.readSimpleValue=function(e){switch(e){case Xc.additional.TRUE:return!0;case Xc.additional.FALSE:return!1;case Xc.additional.NULL:return null;case Xc.additional.BREAK:return nl;case Xc.additional.HALF_PRECISION:return this.readFloat16();case Xc.additional.SINGLE_PRECISION:return this.readFloat32();case Xc.additional.DOUBLE_PRECISION:return this.readFloat64();default:return}},e.prototype.readByte=function(){if(this.pos<this.data.length)return this.data[this.pos++];throw new va.InvalidDataError("Exhausted token stream")},e.prototype.readBuffer=function(e){return this.data.subarray(this.pos,this.pos+=e)},e.prototype.readUint16=function(){var e=Ou.readUInt16BE(this.data,this.pos);return this.pos+=2,e},e.prototype.readUint32=function(){var e=Ou.readUInt32BE(this.data,this.pos);return this.pos+=4,e},e.prototype.readUint64=function(e){var t=Uint8Array.from(this.readBuffer(8));if(e)for(var r=0;r<8;++r)t[r]=~t[r];var n=new Yc.Int64Impl(t),o=n.toNumber();return o<=9007199254740991&&o>=-9007199254740991?o:n},e.prototype.readFloat16=function(){var e=this.readUint16(),t=1023&e,r=(31744&e)>>10,n=(32768&e)>>15?-1:1;return 0===r?n*Math.pow(2,-14)*(t/Math.pow(2,10)):31===r?t?NaN:n*(1/0):n*Math.pow(2,r-15)*(1+t/Math.pow(2,10))},e.prototype.readFloat32=function(){var e=Ou.readFloatBE(this.data,this.pos);return this.pos+=4,e},e.prototype.readFloat64=function(){var e=Ou.readDoubleBE(this.data,this.pos);return this.pos+=8,e},e.prototype.readHeader=function(){var e=this.readByte();return{type:e>>5,raw:31&e}},e.prototype.readHeaderValue=function(e,t){void 0===t&&(t=!1);var r=e.raw,n=function(e){return t?-1-e:e};if(r<24)return n(r);switch(r){case Xc.additional.SIMPLE:return n(this.readByte());case Xc.additional.HALF_PRECISION:return n(this.readUint16());case Xc.additional.SINGLE_PRECISION:return n(this.readUint32());case Xc.additional.DOUBLE_PRECISION:return this.readUint64(t);case Xc.additional.BREAK:return nl;default:throw new va.InvalidDataError("Unexpected value "+r)}},e.prototype.readCollectionLength=function(e){var t=this.readHeaderValue(e);return t===nl?-1:t},e}();rl.Tokeniser=il;var sl={};Object.defineProperty(sl,"__esModule",{value:!0}),sl.BufferSlice=void 0;var al=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length),this.$buffer=e,this.$offset=t,this.$length=r};sl.BufferSlice=al;var ul={},cl=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ul,"__esModule",{value:!0}),ul.BinaryDeltaImpl=void 0;var ll=function(e){function t(t,r,n){return void 0===r&&(r=0),void 0===n&&(n=t.length),e.call(this,t,r,n)||this}return cl(t,e),t.prototype.visit=function(e){if(this.hasChanges()){for(var t=new rl.Tokeniser(this.$buffer,this.$offset,this.$length);t.hasRemaining();){var r=t.nextToken(),n=!1;if(Ou.isUint8Array(r.value))n=!e.insert(r.value);else{var o=r.value,i=t.nextToken().value;n=!e.match(o,i)}if(n)return void e.end()}e.end()}else e.noChange()},t.prototype.hasChanges=function(){return 1!==this.$length},t}(sl.BufferSlice);ul.BinaryDeltaImpl=ll;var pl={};Object.defineProperty(pl,"__esModule",{value:!0}),pl.isString=pl.isInt64=pl.isDouble=pl.Decoder=void 0;var fl=function(){function e(e,t,r){this.tokeniser=Ou.isUint8Array(e)?new rl.Tokeniser(e,t,r):e}return e.prototype.hasRemaining=function(){return this.tokeniser.hasRemaining()},e.prototype.nextValue=function(){return this.nextValueExpecting(hl)},e.prototype.nextValueExpecting=function(e){if(!this.tokeniser.hasRemaining())throw new va.InvalidDataError("Token stream exhausted");var t=this.tokeniser.nextToken();if(e(t.header.type))return function e(t,r){switch(t.type){case Xc.tokens.VALUE:return t.value;case Xc.tokens.MAP_START:for(var n={};;){var o=r.nextToken();if(null===o)throw new va.InvalidDataError("Unexpected EOF (reading: map key)");if(o.type===Xc.tokens.MAP_END)break;var i=r.nextToken();if(null===i||i.type===Xc.tokens.MAP_END)throw new va.InvalidDataError("Unexpected EOF (reading: map value)");var s=e(o,r);if(null==s)throw new va.InvalidDataError("Cannot have undefined key (reading: map key)");n[s.toString()]=e(i,r)}return n;case Xc.tokens.ARRAY_START:for(var a=[];;){var u=r.nextToken();if(null===u)throw new va.InvalidDataError("Unexpected EOF (reading: array value)");if(u.type===Xc.tokens.ARRAY_END)break;a.push(e(u,r))}return a;case Xc.tokens.STRING_START:for(var c=[];;){var l=r.nextToken();if(null===l)throw new va.InvalidDataError("Unexpected EOF (reading: indefinite-length string");if(l.type===Xc.tokens.STRING_END)break;if(l.header.type!==t.header.type)throw new va.InvalidDataError("Unexpected chunk type ("+l.header.type+") within string");c.push(l.value)}switch(t.header.type){case Xc.types.BYTES:return Ou.concatUint8Arrays(c);case Xc.types.STRING:return c.join("");default:throw new va.InvalidDataError("Unexpected chunk type ("+t.header.type+") (reading: string)")}default:throw new va.InvalidDataError("Unexpected token: "+JSON.stringify(t))}}(t,this.tokeniser);throw new va.InvalidDataError("Unexpected CBOR type")},e}();function hl(){return!0}pl.Decoder=fl,pl.isDouble=function(e){return e===Xc.types.FLOAT},pl.isInt64=function(e){return e===Xc.types.UINT||e===Xc.types.INT},pl.isString=function(e){return e===Xc.types.STRING};var dl={},yl=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(dl,"__esModule",{value:!0}),dl.Encoder=void 0;var vl=function(){function e(){this.bos=new nc.BufferOutputStream}return e.prototype.writeByte=function(e){this.bos.write(e)},e.prototype.writeBuffer=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length),this.bos.writeMany(e,t,r)},e.prototype.writeUint16=function(e){this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.writeUint32=function(e){this.writeUint16(e>>16&65535),this.writeUint16(65535&e)},e.prototype.writeUint64=function(e){this.writeUint32(Math.floor(e/4294967296)),this.writeUint32(e%4294967296)},e.prototype.writeBreakHeader=function(e){this.writeByte(e<<5|Xc.additional.BREAK)},e.prototype.writeToken=function(e,t){var r=e<<5;t<24?this.writeByte(r|t):t<256?(this.writeByte(24|r),this.writeByte(t)):t<65536?(this.writeByte(25|r),this.writeUint16(t)):t<4294967296?(this.writeByte(26|r),this.writeUint32(t)):(this.writeByte(27|r),this.writeUint64(t))},e.prototype.writeNumber=function(e){if(e.toString().indexOf(".")>-1){var t=Ou.uint8FromDoubleBE(e);this.writeByte(Xc.types.SIMPLE<<5|Xc.additional.DOUBLE_PRECISION),this.writeBuffer(t)}else e<0?this.writeToken(Xc.types.INT,-1-e):this.writeToken(Xc.types.UINT,e)},e.prototype.writeString=function(e){var t=Ou.uint8FromUtf8(e);this.writeToken(Xc.types.STRING,t.length),this.writeBuffer(t)},e.prototype.writeBinary=function(e,t,r){void 0===r&&(r=e.length),this.writeToken(Xc.types.BYTES,r),this.writeBuffer(e,t,r)},e.prototype.writeBoolean=function(e){this.writeToken(Xc.types.SIMPLE,e?Xc.additional.TRUE:Xc.additional.FALSE)},e.prototype.writeUndefined=function(){this.writeToken(Xc.types.SIMPLE,Xc.additional.UNDEFINED)},e.prototype.writeNull=function(){this.writeToken(Xc.types.SIMPLE,Xc.additional.NULL)},e.prototype.writeObject=function(e){var t,r,n=Object.getOwnPropertyNames(e);this.startObject();try{for(var o=yl(n),i=o.next();!i.done;i=o.next()){var s=i.value;this.encode(s),this.encode(e[s])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}this.break()},e.prototype.writeArray=function(e){var t,r;this.startArray();try{for(var n=yl(e),o=n.next();!o.done;o=n.next()){var i=o.value;this.encode(i)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}this.break()},e.prototype.break=function(){return this.writeBreakHeader(Xc.types.SIMPLE),this},e.prototype.startArray=function(e){return void 0===e?this.writeBreakHeader(Xc.types.ARRAY):this.writeToken(Xc.types.ARRAY,e),this},e.prototype.startObject=function(e){return void 0===e?this.writeBreakHeader(Xc.types.MAP):this.writeToken(Xc.types.MAP,e),this},e.prototype.writeInt64=function(e){var t=0|e.getHighBits();if(0===t||-1===t)this.writeNumber(e.toNumber());else if(e.isNegative()){this.writeByte(Xc.types.INT<<5|27);for(var r=Uint8Array.from(e.toBuffer()),n=0;n<8;++n)r[n]=~r[n];this.writeBuffer(r)}else this.writeByte(Xc.types.UINT<<5|27),this.writeBuffer(e.toBuffer());return this},e.prototype.writeDouble=function(e){var t=Ou.uint8FromDoubleBE(e);return this.writeByte(Xc.types.SIMPLE<<5|Xc.additional.DOUBLE_PRECISION),this.writeBuffer(t),this},e.prototype.encode=function(e,t,r){if(e instanceof Date)this.writeString(e.toJSON());else if(null===e)this.writeNull();else if(void 0===e)this.writeUndefined();else if(e instanceof Yc.Int64Impl)this.writeInt64(e);else switch(typeof e){case"boolean":this.writeBoolean(e);break;case"string":this.writeString(e);break;case"number":this.writeNumber(e);break;case"object":Ou.isUint8Array(e)?this.writeBinary(e,t,r):Array.isArray(e)?this.writeArray(e):this.writeObject(e)}return this},e.prototype.flush=function(){var e=this.bos.getBuffer();return this.bos=new nc.BufferOutputStream,e},e}();dl.Encoder=vl;var Sl={};Object.defineProperty(Sl,"__esModule",{value:!0}),Sl.MIN_SAFE_INTEGER=Sl.MAX_SAFE_INTEGER=Sl.MAX_INT32=Sl.findNextPowerOfTwo=Sl.approximateSquareRoot=void 0,Sl.approximateSquareRoot=function(e){if(e<0)throw new va.IllegalArgumentError("Value must be great or equal to 0");if(0===e)return 0;var t=32-function(e){if(0===e)return 32;var t=1;return e>>>16==0&&(t+=16,e<<=16),e>>>24==0&&(t+=8,e<<=8),e>>>28==0&&(t+=4,e<<=4),e>>>30==0&&(t+=2,e<<=2),t-=e>>>31}(e);return 1<<Math.round(t/2)},Sl.findNextPowerOfTwo=function(e){if(e<0||e>1<<30)throw new va.IllegalArgumentError("Illegal argument: "+e);return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},Sl.MAX_INT32=2147483647,Sl.MAX_SAFE_INTEGER=9007199254740991,Sl.MIN_SAFE_INTEGER=-9007199254740991;var _l={},El=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(_l,"__esModule",{value:!0}),_l.MyersBinaryDiff=_l.NO_CHANGE=_l.REPLACE=_l.SUCCESS=void 0;_l.SUCCESS=0,_l.REPLACE=1,_l.NO_CHANGE=2;var wl=function(){function e(e){this.maximumD=(e-3)/4,this.vectorLength=0,this.vector=[]}return e.prototype.fill=function(e){for(var t=e;t<this.vectorLength+4;t+=4)this.vector[t+0]=-1,this.vector[t+1]=-1,this.vector[t+2]=2147483647,this.vector[t+3]=2147483647},e.prototype.ensure=function(e){this.vectorLength=4*(e+1)+3},e.prototype.initialise=function(e){return this.ensure(e),this.fill(3),this.vector},e.prototype.extend=function(e){if(e>this.maximumD)return null;var t=this.vectorLength;return this.ensure(e),this.fill(t),this.vector},e}();function ml(e){return e<0?-4*e-1:4*e}function gl(e){return ml(e)+2}function Tl(e,t){var r=e[ml(t)];return void 0===r?0:r}function Ol(e,t){var r=e[gl(t)];return void 0===r?0:r}function Il(e,t,r){e[ml(t)]=r}function bl(e,t,r){e[gl(t)]=r}function Rl(e,t){var r=Tl(e,t+1),n=Tl(e,t-1);return r<n?n:r+1}function Cl(e,t){var r=Ol(e,t+1),n=Ol(e,t-1);return r<n?r:n-1}function Al(e,t){return e<=t?e:2*t-e}function Pl(e,t,r){if(t<0)throw new va.InternalError("offset "+t+" < 0");if(r<0)throw new va.InternalError("length "+r+" < 0");if(t+r>e.length||t+r<0)throw new va.InternalError("offset "+t+" + "+r+" > "+e.length)}var Nl=function(){function e(e,t,r,n,o){this.storage=e,this.a=t,this.b=r,this.script=n,this.bailOutFactor=o}return e.prototype.diff=function(e,t,r,n,o){void 0===o&&(o=this.bailOutFactor),Pl(this.a,e,t),Pl(this.b,r,n);var i=this.afterCommonPrefix(e,t,r,n),s=this.beforeCommonSuffix(e,t,r,n,i),a=s+n-t;return!!this.script.match(e,i)&&((i===s?this.script.insert(r+i,a-i):i===a?this.script.delete():this.middleSnake(e+i,s-i,r+i,a-i,o))&&this.script.match(e+s,t-s))},e.prototype.afterCommonPrefix=function(e,t,r,n){for(var o=Math.min(t,n),i=0;i<o;++i)if(this.a[e+i]!==this.b[r+i])return i;return Math.max(0,o)},e.prototype.beforeCommonSuffix=function(e,t,r,n,o){for(var i=Math.max(0,t-n)+o,s=t;s>i;--s)if(this.a[e+s-1]!==this.b[r+s+n-t-1])return s;return Math.min(t,i)},e.prototype.diffNoPrefix=function(e,t,r,n,o){void 0===o&&(o=this.bailOutFactor);var i=this.beforeCommonSuffix(e,t,r,n,0),s=i+n-t;return(0===i?this.script.insert(r,s):0===s?this.script.delete():this.middleSnake(e,i,r,s,o))&&this.script.match(e+i,t-i)},e.prototype.diffNoSuffix=function(e,t,r,n,o){void 0===o&&(o=this.bailOutFactor);var i=this.afterCommonPrefix(e,t,r,n);return!!this.script.match(e,i)&&(i===t?this.script.insert(r+i,n-i):i===n?this.script.delete():this.middleSnake(e+i,t-i,r+i,n-i,o))},e.prototype.middleSnake=function(e,t,r,n,o){var i=t-n,s=1&i,a=this.storage.initialise(1);Il(a,0,0),bl(a,0,t);var u=1,c=o;do{for(var l=Al(u,t),p=Al(u,n),f=-l;f<=p;f+=2){var h=Rl(a,f),d=h+this.afterCommonPrefix(e+h,t-h,r+h+f,n-f-h);if(s&&Math.abs(f+i)<=u-1&&d>=Ol(a,f+i))return this.recurse(e,t,r,n,h,d,f);Il(a,f,d)}for(var y=-p;y<=l;y+=2){var v=Cl(a,y),S=y-i,_=this.beforeCommonSuffix(e,v,r,S+v,0);if(!s&&Math.abs(S)<=u&&_<=Tl(a,S))return this.recurse(e,t,r,n,_,v,S);bl(a,y,_)}if(0==(63&u)&&this.slowProgress(a,t,n,l,p,u))c-=48;else if(u>Math.max(4,c))return this.bail(a,e,t,r,n,l,p,Math.trunc(c/2));++u,a=this.storage.extend(u)}while(null!==a);return!1},e.prototype.slowProgress=function(e,t,r,n,o,i){var s=El(this.bestForward(e,t,r,n,o),2),a=s[0],u=s[1],c=El(this.bestReverse(e,t,r,n,o),2);return a+u+(t+r-c[0]-c[1])<Sl.approximateSquareRoot(i)*i},e.prototype.bestForward=function(e,t,r,n,o){for(var i=0,s=0,a=-n;a<=o;a+=2){var u=Math.min(Tl(e,a),t,r-a),c=u+a;u+c>i+s&&(i=u,s=c)}return[i,s]},e.prototype.bestReverse=function(e,t,r,n,o){for(var i=t,s=r,a=-o;a<=n;a+=2){var u=a-(t-r),c=Math.max(Ol(e,a),0,-u),l=c+u;c+l<i+s&&(i=c,s=l)}return[i,s]},e.prototype.recurse=function(e,t,r,n,o,i,s){return this.diffNoPrefix(e,o,r,o+s)&&this.script.match(e+o,i-o)&&this.diffNoSuffix(e+i,t-i,r+i+s,n-i-s)},e.prototype.bail=function(e,t,r,n,o,i,s,a){var u=El(this.bestForward(e,r,o,i,s),2),c=u[0],l=u[1],p=El(this.bestReverse(e,r,o,i,s),2),f=p[0],h=p[1];return c>=f||l>=h?r+o-f-h>c+l?this.splitDiff(t,f,r,n,h,o):this.splitDiff(t,c,r,n,l,o):this.diffNoPrefix(t,c,n,l)&&this.boundedDiff(t+c,f-c,n+l,h-l,r,o,a)&&this.diffNoSuffix(t+f,r-f,n+h,o-h)},e.prototype.boundedDiff=function(e,t,r,n,o,i,s){var a=o*i;if(t*n>=Math.floor((1<<24)+a/2)){if(s<=0){var u=Math.trunc(t/4),c=u+Math.trunc(t/2),l=Math.trunc(n/4),p=l+Math.trunc(n/2);return this.noDiff(r,l)&&this.diff(e+u,c-u,r+l,p-l,s)&&this.noDiff(r+p,n-p)}var f=Math.trunc(t/2),h=Math.trunc(n/2);return this.splitDiff(e,f,t,r,h,n,s)}return this.middleSnake(e,t,r,n,s)},e.prototype.splitDiff=function(e,t,r,n,o,i,s){return this.diffNoPrefix(e,t,n,o,s)&&this.diffNoSuffix(e+t,r-t,n+o,i-o,s)},e.prototype.noDiff=function(e,t){return this.script.insert(e,t)&&this.script.delete()},e}();function Ml(e,t,r){return e.insert(t,r)}function Dl(e,t,r){return e.match(t,r)}function jl(){return!0}function Ll(e,t,r){var n=!0,o=0,i=0,s=jl;function a(){return n=n&&s===jl,s(e,i,o)}function u(e,t,r){if(r>0)if(s!==e){if(!a())return!1;s=e,i=t,o=r}else o+=r;return!0}return{insert:function(e,t){return u(Ml,e-r,t)},match:function(e,r){return u(Dl,e-t,r)},delete:function(e,t){if(s===Ml)return!0;var r=a();return s=jl,r},close:function(t,r){if(n){if(s===Ml)return _l.REPLACE;if(0===i&&o===t)return _l.NO_CHANGE}return a()&&e.close()?_l.SUCCESS:_l.REPLACE}}}var xl=function(){function e(e,t){void 0===e&&(e=2147483647),void 0===t&&(t=1e4),this.bailOutFactor=t,this.storage=new wl(e)}return e.prototype.diff=function(e,t,r,n,o,i,s){var a=Ll(s,t,o);return new Nl(this.storage,e,n,a,this.bailOutFactor).diff(t,r,o,i)?a.close(r,i):_l.REPLACE},e}();_l.MyersBinaryDiff=xl;var Ul={};(function(e){(function(){"use strict";Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.BinaryDeltaTypeImpl=Ul.NO_CHANGE=void 0;var t=new dl.Encoder;function r(e){return e<24?1:e<255?2:e<=65535?3:5}function n(e,t,n){var o=r(e)+1;return r(t+n)-r(n)+t<=o}Ul.NO_CHANGE=new ul.BinaryDeltaImpl(Uint8Array.from([-10]),0,1);var o=function(){function e(e,t,r,n){this.insertStart=-1,this.matchStart=-1,this.cborEncoder=e,this.buffer=t,this.offset=r,this.blowsBudget=n}return e.prototype.insert=function(e,t){if(-1!==this.matchStart){if(n(this.matchStart,this.matchLength,t))return this.matchStart=-1,-1===this.insertStart?(this.insertStart=e-this.matchLength,this.insertLength=this.matchLength+t):this.insertLength+=this.matchLength+t,!0;if(!this.flush())return!1}return-1===this.insertStart?(this.insertStart=e,this.insertLength=t):this.insertLength+=t,!0},e.prototype.match=function(e,t){if(-1!==this.matchStart){if(!this.flush())return!1}else if(-1!==this.insertStart&&n(e,t,this.insertLength))return this.insertLength+=t,!0;return this.matchStart=e,this.matchLength=t,!0},e.prototype.delete=function(e,t){return!0},e.prototype.close=function(){return this.flush()},e.prototype.flush=function(){return(-1===this.insertStart||this.writeInsert())&&(-1===this.matchStart||this.writeMatch())},e.prototype.writeInsert=function(){return!this.blowsBudget(this.insertLength+r(this.insertLength))&&(t.encode(this.buffer,this.offset+this.insertStart,this.insertLength),this.insertStart=-1,!0)},e.prototype.writeMatch=function(){return!this.blowsBudget(r(this.matchStart)+r(this.matchLength))&&(this.cborEncoder.encode(this.matchStart),this.cborEncoder.encode(this.matchLength),this.matchStart=-1,!0)},e}(),i=function(){function r(e,t,r){this.binaryDiff=new _l.MyersBinaryDiff,this.implementation=e,this.cToV=r,this.vToC=t}return r.prototype.name=function(){return"binary"},r.prototype.diff=function(e,r){var n,i=this.vToC(e),s=this.vToC(r),a=s.$buffer,u=s.$offset,c=s.$length,l=c,p=new o(t,a,u,(function(e){return(l-=e)<=0})),f=this.binaryDiff.diff(i.$buffer,i.$offset,i.$length,a,u,c,p),h=t.flush();switch(f){case _l.REPLACE:return n=s,t.encode(n.$buffer,n.$offset,n.$length),new ul.BinaryDeltaImpl(t.flush());case _l.NO_CHANGE:return Ul.NO_CHANGE;default:return this.readDelta(h)}},r.prototype.apply=function(e,t){return this.applyImpl(e,t).value},r.prototype.applyImpl=function(e,t,r){var n=t,o=r||this.vToC(e);if(!t||!t.hasChanges())return{value:this.cToV(o),cbor:o};for(var i=new pl.Decoder(n.$buffer),s=new nc.BufferOutputStream;i.hasRemaining();){var a=i.nextValue();Ou.isUint8Array(a)?s.writeMany(a):"number"==typeof a&&s.writeMany(o.$buffer,o.$offset+a,i.nextValue())}var u=new this.implementation(s.getBuffer());return{value:this.cToV(u),cbor:u}},r.prototype.readDelta=function(e,t,r){var n=new ul.BinaryDeltaImpl(e,t,r);return 1===n.$length&&e[n.$offset]===Ul.NO_CHANGE.$buffer[0]?Ul.NO_CHANGE:n},r.prototype.writeDelta=function(t){return e.from(this.writeDeltaToArray(t).buffer)},r.prototype.writeDeltaToArray=function(e){var t=e;return t.$buffer.subarray(t.$offset,t.$offset+t.$length)},r.prototype.noChange=function(){return Ul.NO_CHANGE},r.prototype.isValueCheaper=function(e,t){return e.$length<=t.$length},r}();Ul.BinaryDeltaTypeImpl=i}).call(this)}).call(this,d({}).Buffer);var Bl={};(function(e){(function(){"use strict";var t=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.BytesImpl=void 0;var r=function(r){function n(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=e.length),r.call(this,e,t,n)||this}return t(n,r),n.toString=function(){return"BytesImpl"},n.prototype.length=function(){return this.$length},n.prototype.asBuffer=function(){return e.from(this.asArray())},n.prototype.asArray=function(){return this.$buffer.subarray(this.$offset,this.$offset+this.$length)},n.prototype.copyTo=function(e,t){void 0===t&&(t=0),e.set(this.$buffer.subarray(this.$offset,this.$offset+this.$length),t)},n.prototype.equals=function(e){return this.equalBytes(e.$buffer,e.$offset,e.$length)},n.prototype.equalBytes=function(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=e.length),this.$length!==r)return!1;if(this.$buffer===e&&this.$offset===t)return!0;for(var n=0;n<r;++n)if(this.$buffer[this.$offset+n]!==e[t+n])return!1;return!0},n}(sl.BufferSlice);Bl.BytesImpl=r}).call(this)}).call(this,d({}).Buffer);var ql={};(function(e){(function(){"use strict";Object.defineProperty(ql,"__esModule",{value:!0}),ql.AbstractDataType=void 0;var t=function(){function t(e,t,r,n,o,i,s){var a=this;this.valueConverters={},this.typeName=e,this.cToV=o,this.vToC=n,this.implementation=r,i.forEach((function(e){a.valueConverters[e.name]=e.convert})),this.valueConverters[Bl.BytesImpl.toString()]=function(e,t,r){return new Bl.BytesImpl(e,t,r)},this.valueConverters[t.toString()]=this.readValue.bind(this),this.valueConverters[Gc.AnyDataTypeImpl.toString()]=this.readValue.bind(this),this.valueClass=t,s&&(this.binaryDeltaTypeImpl=new Ul.BinaryDeltaTypeImpl(r,n,o))}return t.prototype.name=function(){return this.typeName},t.prototype.toString=function(){return this.typeName+" data type"},t.prototype.writeValue=function(t){return e.from(this.writeValueToArray(t))},t.prototype.writeValueToArray=function(e){var t=this.vToC(e);if(null===t)throw new va.IllegalArgumentError(this+" cannot write "+e);return t.asArray()},t.prototype.toBytes=function(e){var t=this.vToC(e);if(t)return t;throw new va.IllegalArgumentError(this+" cannot convert value to Bytes: "+e)},t.prototype.readValue=function(e,t,r){return e instanceof Bl.BytesImpl?e instanceof this.implementation?this.cToV(e):this.readValue(e.$buffer,e.$offset,e.$length):this.cToV(new this.implementation(e,t,r))},t.prototype.canReadAs=function(e){return void 0!==this.valueConverters[e.toString()]},t.prototype.readAs=function(e,t,r,n){if(t instanceof Bl.BytesImpl)return this.readAs(e,t.$buffer,t.$offset,t.$length);if(this.valueConverters[e.toString()])return this.valueConverters[e.toString()](t,r,n);throw new va.IllegalArgumentError(this+" is incompatible with values of "+e)},t.prototype.deltaType=function(e){if(!e||"binary"===e||e instanceof ul.BinaryDeltaImpl)return this.binaryDeltaType();throw new va.IllegalArgumentError(this+" has no '"+e+"' delta type")},t.prototype.binaryDeltaType=function(){if(void 0===this.binaryDeltaTypeImpl)throw new va.IllegalArgumentError(this+" has no binary delta type");return this.binaryDeltaTypeImpl},t}();ql.AbstractDataType=t}).call(this)}).call(this,d({}).Buffer);var Vl={};function kl(e,t){switch(t.length){case 0:return e();case 1:return e(t[0]);case 2:return e(t[0],t[1]);case 3:return e(t[0],t[1],t[2]);case 4:return e(t[0],t[1],t[2],t[3]);case 5:return e(t[0],t[1],t[2],t[3],t[4]);case 6:return e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7])}return e.apply(e,t)}Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.identity=Vl.callWithArguments=Vl.curryR=void 0,Vl.curryR=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return kl(e,r.concat(t))}},Vl.callWithArguments=kl,Vl.identity=function(e){return e};var Fl={};(function(e){(function(){"use strict";var t=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function r(e){if(e instanceof n)return e;if(Ou.isUint8Array(e))return new n(e);throw new va.IllegalArgumentError("Unable to read Binary value from: "+e)}Object.defineProperty(Fl,"__esModule",{value:!0}),Fl.BinaryImpl=void 0;var n=function(n){function i(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.length),n.call(this,e,t,r)||this}return t(i,n),i.toString=function(){return"BinaryImpl"},i.from=function(e){return r(e)},i.prototype.get=function(){return e.from(this.getArray())},i.prototype.getArray=function(){return this.asArray()},i.prototype.diff=function(e,t){return o.diff(e,this)},i.prototype.apply=function(e){return o.apply(this,e)},i.prototype.toString=function(){return"Binary <"+this.$length+" bytes> "+Ou.uint8toUtf8(this.getArray())},i}(Bl.BytesImpl);Fl.BinaryImpl=n;var o=new Ul.BinaryDeltaTypeImpl(n,r,Vl.identity)}).call(this)}).call(this,d({}).Buffer);var Gl={},Hl=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Gl,"__esModule",{value:!0}),Gl.BinaryDataTypeImpl=void 0;var Yl=function(e){function t(){var t=e.call(this,"binary",Fl.BinaryImpl,Fl.BinaryImpl,Fl.BinaryImpl.from,Vl.identity,[],!0)||this;return t.Binary=Fl.BinaryImpl,t}return Hl(t,e),t.prototype.from=function(e){return Fl.BinaryImpl.from(e)},t.prototype.validate=function(){},t}(ql.AbstractDataType);Gl.BinaryDataTypeImpl=Yl;var Wl={},zl=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.ROOT=Wl.JSONPointer=void 0;var Ql=function(){function e(e){this.index=e}return e.prototype.equals=function(t){return t===this||!!(t&&t instanceof e)&&t.index===this.index},e.prototype.toString=function(){return"/"+this.index},e}(),Kl=new Ql(0),Jl=function(){function e(e){this.expression="/"+function(e){for(var t=0;t<e.length;++t){var r=e.charAt(t);if("/"===r||"~"===r){var n=e.length,o=[];o.push(e.substring(0,t));for(var i=t;i<n;++i){var s=e.charAt(i);"/"===s?o.push("~1"):"~"===s?o.push("~0"):o.push(s)}return o.join("")}}return e}(e)}return e.prototype.equals=function(t){return t===this||!!(t&&t instanceof e)&&t.expression===this.expression},e.prototype.toString=function(){return this.expression},e}(),$l=function(){function e(e){if(this.pos=0,""!==e&&"/"!==e.charAt(0))throw new va.IllegalArgumentError("JSON Pointer expression must be empty or start with '/' : "+e);this.expression=e}return e.prototype.nextSegmentString=function(){for(var e=this.pos;this.pos<this.expression.length;++this.pos){var t=this.expression[this.pos];if("/"===t)break;if("~"===t){for(var r=[this.expression.substring(e,this.pos)],n=this.expression.length;this.pos<n;++this.pos){var o=this.expression.charAt(this.pos);if("/"===o)break;if("~"===o&&this.pos!==n-1){++this.pos;var i=this.expression.charAt(this.pos);"0"===i?r.push("~"):"1"===i?r.push("/"):(r.push("~"),r.push(i))}else r.push(o)}return r.join("")}}return this.expression.substring(e,this.pos)},e.prototype.maybeIndex=function(e){var t=e.length;if(0===t||t>10)return null;for(var r=0;r<t;++r){var n=e.charAt(r);if(n<"0"||n>"9")return null;if("0"===n&&0===r)return 1===t?Kl:null}var o=parseInt(e,10);return o>Sl.MAX_INT32?null:new Ql(o)},e.prototype.next=function(){if(this.pos===this.expression.length)return null;++this.pos;var e=this.nextSegmentString(),t=this.maybeIndex(e);return null!==t?t:new Jl(e)},e}(),Xl=function(){function e(e){this.segments=e}return e.parse=function(t){if(t instanceof e)return t;for(var r=Wl.ROOT,n=new $l(t);;){var o=n.next();if(null===o)return r;r=r.withSegment(o)}},e.prototype.withKey=function(e){return this.withSegment(new Jl(e))},e.prototype.withIndex=function(e){return this.withSegment(new Ql(e))},e.prototype.withSegment=function(t){return new e(this.segments.concat(t))},e.prototype.equalIgnoringIndexes=function(e){if(e===this)return!0;var t=this.segments.length;if(t!==e.segments.length)return!1;for(var r=0;r<t;++r){var n=this.segments[r],o=e.segments[r];if(n instanceof Ql){if(o instanceof Jl)return!1}else if(!n.equals(o))return!1}return!0},e.prototype.toString=function(){var e,t,r=[];try{for(var n=zl(this.segments),o=n.next();!o.done;o=n.next()){var i=o.value;r.push(i.toString())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r.join("")},e.prototype.equals=function(t){if(t===this)return!0;if(!(t&&t instanceof e))return!1;if(this.segments.length!==t.segments.length)return!1;for(var r=this.segments.length,n=0;n<r;++n){var o=this.segments[n],i=t.segments[n];if(!o.equals(i))return!1}return!0},e}();Wl.JSONPointer=Xl,Wl.ROOT=new Xl([]);var Zl={};Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.requireNonNull=void 0,Zl.requireNonNull=function(e,t){if(null==e)throw new va.NullValueError(t+" is null");return e};var ep={},tp=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ep,"__esModule",{value:!0}),ep.JSONPointerMap=void 0;var rp=function(){function e(e,t,r){this.segment=e,this.pointer=t,this.children=[],this.value=null,this.context=r}return e.prototype.count=function(){var e,t,r=this.value?1:0;try{for(var n=tp(this.children),o=n.next();!o.done;o=n.next()){r+=o.value.count()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},e.prototype.addChild=function(t){var r=new e(t,this.pointer.withSegment(t),this.context);return this.children.push(r),r},e.prototype.findChild=function(e){var t,r;try{for(var n=tp(this.children),o=n.next();!o.done;o=n.next()){var i=o.value;if(e.equals(i.segment))return i}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return null},e.prototype.setValue=function(e){var t=this.value;return null===t&&this.context.size++,this.value=e,t},e.prototype.removeDescendants=function(){var e,t,r=0;try{for(var n=tp(this.children),o=n.next();!o.done;o=n.next()){r+=o.value.count()}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return this.children=[],this.context.size-=r,r},e.prototype.numberOfChildren=function(){var e,t,r=0;try{for(var n=tp(this.children),o=n.next();!o.done;o=n.next()){r+=o.value.value?1:0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},e.prototype.toString=function(){return this.pointer+"="+this.value},e}(),np=function(){function e(e){this.nextChildIndex=0,this.node=e}return e.prototype.nextChild=function(){var e=this.node.children;return this.nextChildIndex>=e.length?null:e[this.nextChildIndex++]},e}(),op=function(){function e(e){this.nextEntry=e(),this.nextWithValue=e}return e.prototype.hasNext=function(){return null!==this.nextEntry},e.prototype.next=function(){if(null===this.nextEntry)throw new va.InternalError("No such element");var e=this.nextEntry;return this.nextEntry=this.nextWithValue(),e},e}(),ip=function(){function e(){this.root=new rp(null,Wl.ROOT,this),this.size=0}return e.prototype.put=function(e,t){Zl.requireNonNull(t,"value");for(var r=this.root,n=0;n<e.segments.length;){var o=e.segments[n++],i=r.findChild(o);if(null===i){r=r.addChild(o);break}r=i}for(;n<e.segments.length;n++)r=r.addChild(e.segments[n]);return r.setValue(t)},e.prototype.contains=function(e){return null!==this.get(e)},e.prototype.get=function(e){var t=this.getEntry(e);return t?t.value:null},e.prototype.getEntry=function(e){var t,r,n=this.root;try{for(var o=tp(e.segments),i=o.next();!i.done;i=o.next()){var s=i.value;if(null===(n=n.findChild(s)))return null}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e.prototype.descendants=function(t){var r=new e,n=this.root,o=r.root,i=t.segments,s=i.length;if(0===s)return this;for(var a=0;a<s-1;++a){var u=i[a];if(null===(n=n.findChild(u)))return sp;o=o.addChild(u)}var c=n.findChild(i[s-1]);return null===c?sp:(o.children.push(c),r.size=c.count(),r)},e.prototype.intersection=function(t){var r=new e,n=this.root,o=r.root,i=t.segments,s=i.length;if(0===s)return this;null!==n.value&&o.setValue(n.value);for(var a=0;a<s-1;++a){var u=i[a];if(null===(n=n.findChild(u)))return r;o=o.addChild(u),null!==n.value&&o.setValue(n.value)}var c=n.findChild(i[s-1]);return null===c||(o.children.push(c),r.size+=c.count()),r},e.prototype.iterator=function(){var e=[this.root];return new op((function(){for(;;){var t=e.shift();if(void 0===t)return null;for(var r=t.children.length;r>0;--r)e.unshift(t.children[r-1]);if(null!==t.value)return t}}))},e.prototype.postOrder=function(){var e=[new np(this.root)];return new op((function(){for(;;){var t=e[0];if(void 0===t)return null;var r=t.nextChild();if(null===r){if(e.shift(),null!==t.node.value)return t.node}else{if(0===r.children.length)return r;e.unshift(new np(r))}}}))},e.prototype.toString=function(){for(var e=["{"],t=this.iterator();t.hasNext();)e.length>1&&e.push(", "),e.push(t.next());return e.push("}"),e.join("")},e}();ep.JSONPointerMap=ip;var sp=new ip,ap={},up=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),cp=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ap,"__esModule",{value:!0}),ap.SpanParser=void 0;var lp=function(){function e(e,t,r,n){this.tokenRange=[],this.accumulatedTokens=0,this.totalTokens=0,this.tokeniser=e,this.base=t,this.startOffset=r,this.nextOffset=n}return e.prototype.total=function(){return this.totalTokens},e.prototype.accumulated=function(){return this.accumulatedTokens},e.prototype.newArray=function(e,t){return new pp(this.tokeniser,this.currentPointer(this.base,this.totalTokens),e,t)},e.prototype.newObject=function(e,t){return new fp(this.tokeniser,this.currentPointer(this.base,this.totalTokens),e,t)},e.prototype.notEmptyAndSplitBy=function(e){return this.startOffset<e&&0!==this.totalTokens},e.prototype.add=function(e){return this.tokenRange[this.accumulatedTokens]=[this.nextOffset,e],this.nextOffset=e,++this.accumulatedTokens,++this.totalTokens,!1},e.prototype.setNextStart=function(e){this.nextOffset=e},e.prototype.skip=function(){++this.totalTokens,this.accumulatedTokens=0},e.prototype.takeAll=function(e){for(var t=this.totalTokens-this.accumulatedTokens,r=0;r<this.accumulatedTokens;++r){var n=this.tokenRange[r],o=n[0],i=n[1];this.take(e,this.base,t,t+r,o,i-o)}this.accumulatedTokens=0},e.prototype.splitStructureEnd=function(e){e.splitStructureEnd(this.base,this.totalTokens,this.startOffset,this.nextOffset+1-this.startOffset)},e.prototype.toString=function(){return this.base.toString()},e}(),pp=function(e){function t(t,r,n,o){return e.call(this,t,r,n,o)||this}return up(t,e),t.prototype.take=function(e,t,r,n,o,i){e.accept(t.withIndex(n),o,i)},t.prototype.currentPointer=function(e,t){return e.withIndex(t)},t}(lp),fp=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n,o)||this;return i.pendingKeyName="",i.pendingKey=!0,i.keys=[],i}return up(t,e),t.prototype.add=function(t){return this.pendingKey?(this.setNextStart(t),this.pendingKeyName=this.tokeniser.getToken().value,this.pendingKey=!1):(this.keys[this.accumulated()]=this.pendingKeyName,this.pendingKey=!0,e.prototype.add.call(this,t)),!this.pendingKey},t.prototype.take=function(e,t,r,n,o,i){e.accept(t.withKey(this.keys[n-r]),o,i)},t.prototype.currentPointer=function(e){return e.withKey(this.pendingKeyName)},t}(lp),hp=function(e){function t(t){return e.call(this,t,Wl.ROOT,-1,0)||this}return up(t,e),t.prototype.take=function(e,t,r,n,o,i){if(this.total()>1)throw new va.InvalidDataError("Invalid JSON: multiple values found");e.accept(t,o,i)},t.prototype.currentPointer=function(e){return e},t}(lp),dp=function(){function e(e){this.parentStack=[],this.tokeniser=new rl.Tokeniser(e.$buffer,e.$offset,e.$length),this.structure=new hp(this.tokeniser),this.startOffset=this.tokeniser.offset(),this.json=e}return e.prototype.spanToNext=function(e,t){return this.spanTo(e,t,!0)},e.prototype.spanTo=function(e,t,r){var n,o;void 0===r&&(r=!1);var i=this.nextByte();if(i>=e)return 0;var s,a=this.parentStack.length,u=r,c=i;do{s=this.tokeniser.nextToken();var l=c;if(c=this.nextByte(),null===s){if(0!==this.parentStack.length)throw new va.InvalidDataError("Invalid structure");break}if(s.type===Xc.tokens.VALUE)u=this.structure.add(c);else if(s.type===Xc.tokens.ARRAY_START)this.parentStack.push(this.structure),this.structure=this.structure.newArray(l,c);else if(s.type===Xc.tokens.MAP_START)this.parentStack.push(this.structure),this.structure=this.structure.newObject(l,c);else if(Xc.isStructEnd(s.type)){var p=this.parentStack.pop();this.structure.notEmptyAndSplitBy(i)?(this.structure.takeAll(t),this.structure.splitStructureEnd(t),p.skip(),p.setNextStart(c)):p.add(c),this.structure=p,u=!1}}while(u||c<e||this.nextTokenIsStructEnd(s,c));try{for(var f=cp(this.parentStack),h=f.next();!h.done;h=f.next()){h.value.takeAll(t)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}return this.structure.takeAll(t),this.parentStack.length-a},e.prototype.nextTokenIsStructEnd=function(e,t){var r=this.tokeniser.getContext();return Xc.isStructStart(e.type)?0===r.expected():r.acceptsBreakMarker()&&t<this.json.$length&&this.json.$buffer[this.json.$offset+t]===Xc.BYTE_BREAK||!r.hasRemaining()},e.prototype.nextByte=function(){return this.tokeniser.offset()-this.startOffset},e.prototype.toString=function(){var e=["SpanParser"," next=",this.nextByte().toString()," ["];return this.parentStack.forEach((function(t){e.push(t.toString()),e.push(", ")})),e.push(this.structure.toString()),e.push("]"),e.join("")},e}();ap.SpanParser=dp;var yp={};Object.defineProperty(yp,"__esModule",{value:!0}),yp.JSONDeltaImpl=void 0;var vp=function(){function e(e){this.splitStructures=e}return e.prototype.accept=function(e,t,r){this.last=e,this.lastStart=t,this.lastLength=r},e.prototype.foundLast=function(){return void 0!==this.last},e.prototype.consumeLast=function(e){e.accept(this.last,this.lastStart,this.lastLength)},e.prototype.splitStructureEnd=function(e,t,r,n){this.splitStructures.put(e,{start:r,length:n,elements:t})},e}();function Sp(e,t,r,n){return e.equalBytes(t.$buffer,t.$offset+r,n)}var _p=function(){function e(e,t,r,n,o,i){var s=this;this.removedSplitStructures=new ep.JSONPointerMap,this.insertedSplitStructures=new ep.JSONPointerMap,this.oldOffset=0,this.newOffset=0,this.pendingRemove=null,this.pendingInsert=null,this.inserter={accept:function(e,t,r){null!==s.pendingRemove&&s.pendingRemove.equalIgnoringIndexes(e)&&Sp(s.pendingRemoveValue,s.newValue,t,r)?(s.pendingRemove=null,s.pendingRemoveValue=null):(s.addInsert(e,s.partOf(s.newValue,t,r)),s.addRemove(null,null))},splitStructureEnd:function(e,t,r,n){s.insertedSplitStructures.put(e,{start:r,length:n,elements:t})}},this.remover={accept:function(e,t,r){null!==s.pendingInsert&&s.pendingInsert.equalIgnoringIndexes(e)&&Sp(s.pendingInsertValue,s.oldValue,t,r)?(s.pendingInsert=null,s.pendingInsertValue=null):(s.addRemove(e,s.copyPartOf(s.oldValue,t,r)),s.addInsert(null,null))},splitStructureEnd:function(e,t,r,n){s.removedSplitStructures.put(e,{start:r,length:n,elements:t})}},this.oldParser=new ap.SpanParser(e),this.newParser=new ap.SpanParser(t),this.oldValue=e,this.newValue=t,this.inserted=r,this.removed=n,this.partOf=o,this.copyPartOf=i}return e.prototype.match=function(e,t){return this.handleDelete(this.oldOffset,e-this.oldOffset),this.handleMatch(e,t),!0},e.prototype.handleDelete=function(e,t){this.checkInvariants();var r=e+t;this.oldParser.nextByte()<r&&(0!==this.oldParser.spanTo(r,this.remover)||this.oldParser.nextByte()>r)&&this.newParser.spanToNext(this.newOffset+1,this.inserter)},e.prototype.handleMatch=function(e,t){this.checkInvariants();var r=this.newOffset,n=e+t;this.newOffset+=t,this.oldOffset=n;var o=this.oldParser.nextByte(),i=this.newParser.nextByte();i>r&&o===e?this.oldParser.spanToNext(e+1,this.remover):o>e&&i===r&&this.newParser.spanToNext(r+1,this.inserter);var s=new vp(this.removedSplitStructures),a=new vp(this.insertedSplitStructures);this.oldParser.spanTo(n,s),this.newParser.spanTo(this.newOffset,a);var u=s.foundLast()&&this.oldParser.nextByte()>n,c=a.foundLast()&&this.newParser.nextByte()>this.newOffset;u&&c&&(s.consumeLast(this.remover),a.consumeLast(this.inserter))},e.prototype.insert=function(e){return this.checkInvariants(),this.newOffset+=e.length,this.newParser.nextByte()<this.newOffset&&(0!==this.newParser.spanTo(this.newOffset,this.inserter)||this.newParser.nextByte()>this.newOffset)&&this.oldParser.spanToNext(this.oldOffset+1,this.remover),!0},e.prototype.end=function(){this.handleDelete(this.oldOffset,this.oldValue.$length-this.oldOffset),this.addInsert(null,null),this.addRemove(null,null),this.replaceFullRemovedStructures(),this.replaceFullInsertedStructures()},e.prototype.addInsert=function(e,t){null!==this.pendingInsert&&this.inserted.put(this.pendingInsert,this.pendingInsertValue),this.pendingInsert=e,this.pendingInsertValue=t},e.prototype.addRemove=function(e,t){null!==this.pendingRemove&&this.removed.put(this.pendingRemove,this.pendingRemoveValue),this.pendingRemove=e,this.pendingRemoveValue=t},e.prototype.noChange=function(){},e.prototype.checkInvariants=function(){if(this.oldParser.nextByte()<this.oldOffset||this.newParser.nextByte()<this.newOffset)throw new va.InvalidDataError("Invalid binary delta")},e.prototype.replaceFullRemovedStructures=function(){for(var e=this.removedSplitStructures.postOrder();e.hasNext();){var t=e.next(),r=t.value,n=this.removed.getEntry(t.pointer);null!==n&&n.numberOfChildren()===r.elements&&(n.setValue(this.copyPartOf(this.oldValue,r.start,r.length)),n.removeDescendants())}},e.prototype.replaceFullInsertedStructures=function(){for(var e=this.insertedSplitStructures.postOrder();e.hasNext();){var t=e.next(),r=t.value,n=this.inserted.getEntry(t.pointer);null!==n&&n.numberOfChildren()===r.elements&&(n.setValue(this.partOf(this.newValue,r.start,r.length)),n.removeDescendants())}},e}(),Ep=function(){function e(e){this.entries=[],this.parts=e;for(var t=e.iterator();t.hasNext();){var r=t.next();this.entries.push({key:r.pointer.toString(),value:r.value.get()})}this.length=this.entries.length}return e.prototype.get=function(e){return this.parts.get(Wl.JSONPointer.parse(e)).get()},e.prototype.entrySet=function(){return this.entries},e.prototype.containsKey=function(e){return this.parts.contains(Wl.JSONPointer.parse(e))},e.prototype.descendants=function(t){return new e(this.parts.descendants(Wl.JSONPointer.parse(t)))},e.prototype.intersection=function(t){return new e(this.parts.intersection(Wl.JSONPointer.parse(t)))},e}(),wp=function(){function e(e,t,r,n){this.insertedMap=new ep.JSONPointerMap,this.removedMap=new ep.JSONPointerMap,this.factory=e,void 0!==n?n.visit(new _p(t,r,this.insertedMap,this.removedMap,this.partOf.bind(this),this.copyPartOf.bind(this))):(this.insertedMap.put(Wl.ROOT,t),this.removedMap.put(Wl.ROOT,r))}return e.prototype.partOf=function(e,t,r){return new this.factory(e.$buffer,e.$offset+t,r)},e.prototype.copyPartOf=function(e,t,r){var n=e.$offset+t,o=new Uint8Array(r);return o.set(e.$buffer.subarray(n,n+r)),new this.factory(o,0,r)},e.prototype.removed=function(){return new Ep(this.removedMap)},e.prototype.inserted=function(){return new Ep(this.insertedMap)},e.prototype.hasChanges=function(){return 0!==this.removedMap.size||0!==this.insertedMap.size},e.prototype.toString=function(){return["REMOVE ",this.removedMap," INSERT ",this.insertedMap].join("")},e}();yp.JSONDeltaImpl=wp;var mp={},gp=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(mp,"__esModule",{value:!0}),mp.JSONImpl=void 0;var Tp=new dl.Encoder;function Op(e){return e instanceof bp?e:new bp(Tp.encode(e).flush())}function Ip(e,t){return t instanceof Yc.Int64Impl?t.toString():t}var bp=function(e){function t(t,r,n){return void 0===r&&(r=0),void 0===n&&(n=t.length),e.call(this,t,r,n)||this}return gp(t,e),t.toString=function(){return"JSONImpl"},t.from=function(e){return Op(e)},t.prototype.get=function(){return new pl.Decoder(this.$buffer,this.$offset,this.$length).nextValue()},t.prototype.diff=function(e,r){var n=Op(e),o=this.binaryDiff(n);return"json"===r?new yp.JSONDeltaImpl(t,n,this,o):o},t.prototype.binaryDiff=function(e){return Rp.diff(e,this)},t.prototype.jsonDiff=function(e){return this.diff(e,"json")},t.prototype.apply=function(e){return Rp.apply(this,e)},t.prototype.toString=function(){return JSON.stringify(this.get())},t.prototype.toJsonString=function(){return JSON.stringify(this.get(),Ip)},t}(Bl.BytesImpl);mp.JSONImpl=bp;var Rp=new Ul.BinaryDeltaTypeImpl(bp,Op,Vl.identity),Cp={},Ap=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Cp,"__esModule",{value:!0}),Cp.JSONDataTypeImpl=void 0;var Pp=function(e){function t(){var t=e.call(this,"json",mp.JSONImpl,mp.JSONImpl,mp.JSONImpl.from,Vl.identity,[],!0)||this;return t.JSON=mp.JSONImpl,t}return Ap(t,e),t.prototype.fromJsonString=function(e){return mp.JSONImpl.from(JSON.parse(e))},t.prototype.from=function(e){return mp.JSONImpl.from(e)},t.prototype.validate=function(){},t}(ql.AbstractDataType);Cp.JSONDataTypeImpl=Pp;var Np={};(function(e){(function(){"use strict";var t=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Np,"__esModule",{value:!0}),Np.PrimitiveDataType=void 0;var r=new dl.Encoder,n=new Bl.BytesImpl(Uint8Array.from([246])),o=function(o){function i(e,t,i,s,a){var u=this,c=function(e){return i(e,r),new Bl.BytesImpl(r.flush())},l={name:mp.JSONImpl.toString(),convert:function(e,t,r){return new mp.JSONImpl(e,t,r)}};return(u=o.call(this,e,t,Bl.BytesImpl,c,(function(e){return n.equals(e)?null:new pl.Decoder(e.$buffer,e.$offset,e.$length).nextValueExpecting(s)}),[l],a)||this).serialise=i,u.fromValue=c,u}return t(i,o),i.prototype.writeValue=function(t){return e.from(this.writeValueToArray(t))},i.prototype.writeValueToArray=function(e){return null==e?n.asArray():(this.serialise(e,r),r.flush())},i.prototype.validate=function(){},i.prototype.from=function(e){return e.$buffer?e:this.fromValue(e)},i}(ql.AbstractDataType);Np.PrimitiveDataType=o}).call(this)}).call(this,d({}).Buffer);var Mp={},Dp=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function jp(e,t){null==e?t.encode(null):t.writeDouble(e)}Object.defineProperty(Mp,"__esModule",{value:!0}),Mp.DoubleDataTypeImpl=void 0;var Lp=function(e){function t(){return e.call(this,"double",Number,jp,pl.isDouble,!1)||this}return Dp(t,e),t}(Np.PrimitiveDataType);Mp.DoubleDataTypeImpl=Lp;var xp={},Up=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Bp(e,t){null==e?t.encode(null):t.writeInt64(new Yc.Int64Impl(e))}Object.defineProperty(xp,"__esModule",{value:!0}),xp.Int64DataTypeImpl=void 0;var qp=function(e){function t(){var t=e.call(this,"int64",Yc.Int64Impl,Bp,pl.isInt64,!1)||this;return t.Int64=Yc.Int64Impl,t}return Up(t,e),t}(Np.PrimitiveDataType);xp.Int64DataTypeImpl=qp;var Vp={},kp=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Fp(e,t){null==e?t.encode(null):t.encode(e.toString())}Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.StringDataTypeImpl=void 0;var Gp=function(e){function t(){return e.call(this,"string",String,Fp,pl.isString,!0)||this}return kp(t,e),t}(Np.PrimitiveDataType);Vp.StringDataTypeImpl=Gp;var Hp={};function Yp(e,t,r,n,o){if(0===r)return 0;if(e[0]===n)return 1;for(var i=1,s=t;s<t+r;s++)e[s]===o&&i++;return i}Object.defineProperty(Hp,"__esModule",{value:!0}),Hp.recordIsSingleEmptyField=Hp.isSingleEmptyRecord=Hp.findDelimiter=Hp.fieldCount=Hp.recordCount=Hp.bytesToString=Hp.FIELD_MU=Hp.RECORD_MU=Hp.EMPTY_FIELD=Hp.FIELD_DELIMITER=Hp.RECORD_DELIMITER=void 0,Hp.RECORD_DELIMITER=1,Hp.FIELD_DELIMITER=2,Hp.EMPTY_FIELD=3,Hp.RECORD_MU=4,Hp.FIELD_MU=5,String.fromCharCode(Hp.RECORD_DELIMITER),String.fromCharCode(Hp.FIELD_DELIMITER),String.fromCharCode(Hp.EMPTY_FIELD),String.fromCharCode(Hp.RECORD_MU),String.fromCharCode(Hp.FIELD_MU),Hp.bytesToString=function(e,t,r){for(var n="",o=t;o<t+r;++o)switch(e[o]){case Hp.FIELD_DELIMITER:n+="<FD>";break;case Hp.RECORD_DELIMITER:n+="<RD>";break;case Hp.EMPTY_FIELD:n+="<EF>";break;case Hp.FIELD_MU:n+="<FM>";break;case Hp.RECORD_MU:n+="<RM>";break;default:n+=String.fromCharCode(e[o])}return n},Hp.recordCount=function(e,t,r){return Yp(e,t,r,Hp.RECORD_MU,Hp.RECORD_DELIMITER)},Hp.fieldCount=function(e,t,r){return Yp(e,t,r,Hp.FIELD_MU,Hp.FIELD_DELIMITER)},Hp.findDelimiter=function(e,t,r,n){for(var o=t;o<r;o++)if(e[o]===n)return o;return r},Hp.isSingleEmptyRecord=function(e,t,r){return 1===r&&e[t]===Hp.RECORD_MU},Hp.recordIsSingleEmptyField=function(e,t,r){return 1===r&&(e[t]===Hp.FIELD_MU||e[t]===Hp.EMPTY_FIELD)};var Wp={};function zp(e,t){if(0!==e.length)if(1!==e.length||0!==e[0].length){var r=!1;e.forEach((function(e){if(r?t.write(Hp.RECORD_DELIMITER):r=!0,1===e.length&&""===e[0])t.write(Hp.FIELD_MU);else{var n=!1;e.forEach((function(e){n?t.write(Hp.FIELD_DELIMITER):n=!0,null!=e&&t.writeMany(Ou.uint8FromUtf8(e))}))}}))}else t.write(Hp.RECORD_MU)}Object.defineProperty(Wp,"__esModule",{value:!0}),Wp.toBuffer=void 0,Wp.toBuffer=function(e){var t=new nc.BufferOutputStream;return zp(e,t),t.getBuffer()};var Qp={};function Kp(e,t,r){var n=e.getAbsoluteIndex(r);if(n>t.length-1)throw new va.OutOfBoundsError("Index '"+r+"' does not have a matching entry for variable occurrence record: '"+e.name+"'");return n}function Jp(e,t,r){var n=e.getAbsoluteIndex(r);if(n>t.length-1)throw new va.OutOfBoundsError("Index '"+r+"' does not have a matching entry for variable occurrence field: '"+e.name+"'");return n}Object.defineProperty(Qp,"__esModule",{value:!0}),Qp.AbstractRecordModel=Qp.resolveFieldIndex=Qp.resolveRecordIndex=void 0,Qp.resolveRecordIndex=Kp,Qp.resolveFieldIndex=Jp;var $p=function(){function e(e,t){this.recordV2Constructor=e,this.modelSchema=t}return e.prototype.schema=function(){return this.modelSchema},e.prototype.asValue=function(){return new this.recordV2Constructor(Wp.toBuffer(this.model()))},e.prototype.get=function(e,t,r,n){var o,i;switch(void 0===t&&(t=0),void 0===n&&(n=0),arguments.length){case 1:var s=this.parseKey(e);e=s.recordName,i=s.recordIndex,o=s.fieldName,n=s.fieldIndex;break;case 2:o=t,i=0;break;default:o=r,i=t}var a=this.modelSchema.getRecord(e),u=a.getField(o),c=this.getRecord(a,i);return c[Jp(u,c,n)]},e.prototype.recordCount=function(e){var t=this.modelSchema.getRecord(e);return t.isVariable?this.model().length-t.index:t.min},e.prototype.fieldCount=function(e,t,r){var n=this.modelSchema.getRecord(e),o=n.getField(r);return o.isVariable?this.getRecord(n,t).length-o.index:o.min},e.prototype.getRecord=function(e,t){var r=this.model();return r[Kp(e,r,t)]},e.prototype.parseKey=function(e){var t,r,n,o=e.split(".",2);if(1===o.length)t=this.modelSchema.firstRecord().name,r=0,n=o[0];else{var i=this.parseKeyPart(o[0].trim());t=i[0],r=i[1],n=o[1]}var s=this.parseKeyPart(n);return{recordName:t,recordIndex:r,fieldName:s[0],fieldIndex:s[1]}},e.prototype.parseKeyPart=function(e){if(0===e.length)throw new va.IllegalArgumentError("No name specified");var t=e.indexOf("(");if(-1===t)return[e,0];if(0===t)throw new va.IllegalArgumentError("No name specified");var r=e.indexOf(")");if(-1===r||r<t)throw new va.IllegalArgumentError("'(' found without closing ')'");if(r<e.length-1)throw new va.IllegalArgumentError("Characters found after closing ')'");return[e.substring(0,t),parseInt(e.substring(t+1,r),10)]},e}();Qp.AbstractRecordModel=$p;var Xp,Zp={};Object.defineProperty(Zp,"__esModule",{value:!0}),Zp.normalise=Zp.FieldImpl=Zp.Type=void 0,function(e){e.DECIMAL="DECIMAL",e.INTEGER="INTEGER",e.STRING="STRING"}(Xp=Zp.Type||(Zp.Type={}));var ef=function(){function e(e,t,r,n,o,i){this.name=e,this.type=t,this.min=r,this.max=n,this.scale=i,this.index=o,this.isVariable=r!==n}return e.prototype.getAbsoluteIndex=function(e){if(e<0||-1!==this.max&&e>this.max-1)throw new va.OutOfBoundsError("Invalid index '"+e+"' for field '"+this.name+"'");return this.index+e},e.prototype.toString=function(){var e="Name="+this.name+", Type="+this.type;return this.min===this.max?e+=", Occurs="+this.min:(e+=", Min="+this.min+", Max=",-1===this.max?e+="Unlimited":e+=this.max),this.type===Xp.DECIMAL&&(e+=", Scale="+this.scale),"Field ["+e+"]"},e.prototype.modelValue=function(){switch(this.type){case Xp.DECIMAL:return function(e){switch(e.scale){case void 0:case 1:return"0.0";case 2:return"0.00";case 3:return"0.000";default:for(var t="0.",r=0;r<e.scale;++r)t+="0";return t}}(this);case Xp.INTEGER:return"0";case Xp.STRING:default:return""}},e.prototype.toJSON=function(){var e={name:this.name,type:this.type,min:this.min,max:this.max};return this.type===Xp.DECIMAL&&(e.scale=this.scale),e},e}();Zp.FieldImpl=ef,Zp.normalise=function(e,t){switch(e.type){case Xp.DECIMAL:var r=parseFloat(t);if(Number.isNaN(r))throw new va.SchemaViolationError("Invalid decimal value: '"+t+"'");return r.toFixed(e.scale);case Xp.INTEGER:var n=parseInt(t,10),o=n.toString();if(Number.isNaN(n)||t.indexOf(".")>-1)throw new va.SchemaViolationError("Invalid integer value: '"+t+"'");return o;case Xp.STRING:return t;default:return""}};var tf={},rf=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),nf=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function of(e,t,r){var n,o,i=r.length,s=e.lastField(),a=s.max,u=s.index;if(-1!==a&&i>u+a)throw new va.InvalidDataError("Too many occurrences of field '"+e.name+"("+t+")."+s.name+"'");if(i<u+s.min)throw new va.InvalidDataError("Too few field occurrences in record '"+e.name+"("+t+")'");try{for(var c=nf(e.fields),l=c.next();!l.done;l=c.next()){for(var p=l.value,f=p.index,h=p.min,d=f;d<f+h;++d)sf(e,t,p,d-f,r[d]);if(p.isVariable)for(d=f+h;d<i;d++){sf(e,t,p,d-f,r[d])}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}}function sf(e,t,r,n,o){try{Zp.normalise(r,Zl.requireNonNull(o,"FieldData"))}catch(o){throw new va.InvalidDataError("Invalid value for field '"+e.name+"("+t+")."+r.name+"("+n+")")}}Object.defineProperty(tf,"__esModule",{value:!0}),tf.RecordModelImpl=void 0;var af=function(e){function t(t,r,n,o){var i=e.call(this,t,r)||this;return o&&function(e,t){var r,n,o=t.length,i=e.lastRecord(),s=i.index,a=i.max;if(-1!==a&&o>s+a)throw new va.InvalidDataError("Too many occurrences of record '"+i.name+"'");if(o<s+i.min)throw new va.InvalidDataError("Too few record occurrences");var u=e.records();try{for(var c=nf(u),l=c.next();!l.done;l=c.next()){for(var p=l.value,f=p.index,h=p.min,d=f;d<f+h;++d)of(p,d-f,t[d]);if(p.isVariable)for(d=f+h;d<o;++d){of(p,d-f,t[d])}}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}(r,n),i.recordData=n,i}return rf(t,e),t.prototype.model=function(){return Array.from(this.recordData)},t}(Qp.AbstractRecordModel);tf.RecordModelImpl=af;var uf={};function cf(e,t,r,n,o){var i=!1;r<n?i=lf(e,t,r,n,o):r>0&&e[r-1]===Hp.FIELD_DELIMITER&&o.push(""),i||t.push(Array.from(o)),o.length=0}function lf(e,t,r,n,o){var i=n-r;return 0===o.length&&1===i&&e[r]===Hp.FIELD_MU?(t.push([""]),!0):(o.push(Ou.uint8toUtf8(e,r,n)),!1)}Object.defineProperty(uf,"__esModule",{value:!0}),uf.parse=void 0,uf.parse=function(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=e.length),0===r)return[];if(1===r&&e[t]===Hp.RECORD_MU)return[[]];for(var n=[],o=[],i=t,s=t;s<r;++s)e[s]===Hp.RECORD_DELIMITER?(cf(e,n,i,s,o),i=s+1):e[s]===Hp.FIELD_DELIMITER&&(lf(e,n,i,s,o),i=s+1);return function(e,t,r,n,o){if(n>r)lf(e,t,r,n,o);else{var i=e[n-1];i===Hp.RECORD_DELIMITER?t.push([]):i===Hp.FIELD_DELIMITER&&o.push("")}o.length&&t.push(Array.from(o))}(e,n,i,r,o),n};var pf={},ff=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(pf,"__esModule",{value:!0}),pf.RecordV2DeltaImpl=pf.Type=pf.NO_CHANGE=void 0;var hf,df=function(e){function t(){return e.call(this,Uint8Array.from([]))||this}return ff(t,e),t.prototype.changes=function(){return[]},t}(Bl.BytesImpl);pf.NO_CHANGE=new df,function(e){e.FIELD_CHANGED="FIELD_CHANGED",e.FIELDS_ADDED="FIELDS_ADDED",e.FIELDS_REMOVED="FIELDS_REMOVED",e.RECORDS_ADDED="RECORDS_ADDED",e.RECORDS_REMOVED="RECORDS_REMOVED"}(hf=pf.Type||(pf.Type={}));var yf=function(){function e(e,t,r,n,o){this.type=e,this.recordName=t,this.recordIndex=r,this.fieldName=n,this.fieldIndex=o;var i=t+"("+r+")";e!==hf.RECORDS_REMOVED&&e!==hf.RECORDS_ADDED&&(i+="."+n+"("+o+")"),this.key=i}return e.prototype.toString=function(){return this.type+" "+this.key},e}(),vf=function(e){function t(t,r,n,o,i){void 0===r&&(r=0),void 0===n&&(n=t.length);var s=e.call(this,t,r,n)||this;return s.recordChanges=o,s.fieldChanges=i,s}return ff(t,e),t.prototype.changes=function(e){var t=this,r=uf.parse(this.$buffer,this.$offset,this.$length),n=0,o=[];return e.records().forEach((function(e){if(r.length<n+e.min)throw new va.SchemaViolationError("Insufficient records of type "+e.name+" in delta for schema");n=e.isVariable?t.processVariableRecordChanges(e,n,r,o):t.processFixedRecordChanges(e,n,r,o)})),o},t.prototype.processFixedRecordChanges=function(e,t,r,n){for(var o=t,i=0;i<e.min;++i)this.processRecordChanges(o,e,i,r[o],n),o++;return o},t.prototype.processVariableRecordChanges=function(e,t,r,n){var o=r.length,i=e.max;if(-1!==i&&o>t+i)throw new va.SchemaViolationError("Too many records of type "+e.name+" in delta for schema");for(var s=t,a=this.recordChanges&&this.recordChanges[0]?this.recordChanges[1]:o,u=0;s<a;s++,u++)this.processRecordChanges(s,e,u,r[s],n);return this.recordChanges&&n.push(new yf(this.recordChanges[0]?hf.RECORDS_ADDED:hf.RECORDS_REMOVED,e.name,this.recordChanges[1]-t,"",0)),s},t.prototype.processRecordChanges=function(e,t,r,n,o){var i=this,s=0;t.fields.forEach((function(a){s=a.isVariable?i.processVariableFieldChanges(t,r,e,a,s,n,o):i.processFixedFieldChanges(t,r,a,s,n,o)}))},t.prototype.processFixedFieldChanges=function(e,t,r,n,o,i){for(var s=o.length,a=n,u=0;u<r.min;++u){if(a>=s)throw new va.SchemaViolationError("Insufficient fields of type "+r.name+" in delta for schema record "+e.name);""!==o[a]&&i.push(new yf(hf.FIELD_CHANGED,e.name,t,r.name,u)),a++}return a},t.prototype.processVariableFieldChanges=function(e,t,r,n,o,i,s){var a=i.length,u=o;if(a<u+n.min)throw new va.SchemaViolationError("Insufficient fields of type "+n.name+" in delta for schema record "+e.name);for(var c=this.fieldChanges[r],l=c?c[1]:a,p=0;u<l;u++,p++)""!==i[u]&&s.push(new yf(hf.FIELD_CHANGED,e.name,t,n.name,p));return c&&s.push(new yf(c[0]?hf.FIELDS_ADDED:hf.FIELDS_REMOVED,e.name,t,n.name,c[1])),u},t.prototype.toString=function(){return Hp.bytesToString(this.$buffer,this.$offset,this.$length)},t}(Bl.BytesImpl);pf.RecordV2DeltaImpl=vf;var Sf={},_f=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Sf,"__esModule",{value:!0}),Sf.RecordV2Impl=void 0;var Ef=function(){function e(){this.delta=new nc.BufferOutputStream,this.changed=!1,this.recordChanges=null,this.fieldChanges={}}return e.prototype.write=function(e,t,r){void 0!==t&&void 0!==r?this.delta.writeMany(e,t,r):this.delta.write(e)},e.prototype.getDelta=function(){return this.delta.getBuffer()},e.prototype.size=function(){return this.delta.count},e.prototype.hasChanges=function(){return this.changed},e.prototype.setChanged=function(){this.changed=!0},e.prototype.setRecordsChanged=function(e,t){this.recordChanges=[e,t],this.changed=!0},e.prototype.getRecordChanges=function(){return this.recordChanges},e.prototype.setFieldsAdded=function(e,t){this.fieldChanges[e]=[!0,t],this.changed=!0},e.prototype.setFieldsRemoved=function(e,t){this.fieldChanges[e]=[!1,t],this.changed=!0},e.prototype.getFieldChanges=function(){return this.fieldChanges},e}();function wf(e,t,r,n,o,i,s,a){if(0!==s){if(!Hp.recordIsSingleEmptyField(o,i,s))return 0===n?(a.write(o,i,s),void a.setFieldsAdded(e,0)):void(Hp.recordIsSingleEmptyField(t,r,n)?function(e,t,r,n,o){var i=t[r];i===Hp.EMPTY_FIELD?o.write(t,r+1,n-1):(o.write(t,r,n),i!==Hp.FIELD_DELIMITER&&o.setChanged());Hp.fieldCount(t,r,n)>1&&o.setFieldsAdded(e,1)}(e,o,i,s,a):function(e,t,r,n,o,i,s,a){for(var u=Hp.fieldCount(t,r,n),c=Hp.fieldCount(o,i,s),l=Math.min(u,c),p=r,f=r,h=i,d=i,y=a.size(),v=0;v<l;++v)f=Hp.findDelimiter(t,f,r+n,Hp.FIELD_DELIMITER),d=Hp.findDelimiter(o,d,i+s,Hp.FIELD_DELIMITER),v>0&&a.write(Hp.FIELD_DELIMITER),mf(t,p,f-p,o,h,d-h,a),p=++f,h=++d;c!==u&&(c>u?(a.write(o,h-1,i+s-h+1),a.setFieldsAdded(e,l)):a.setFieldsRemoved(e,l));1===c&&y===a.size()&&a.write(Hp.FIELD_MU)}(e,t,r,n,o,i,s,a));!function(e,t,r,n,o){if(Hp.recordIsSingleEmptyField(t,r,n))o.write(Hp.FIELD_MU);else{Hp.fieldCount(t,r,n)>1&&o.setFieldsRemoved(e,1),o.write(Hp.EMPTY_FIELD),o.setChanged()}}(e,t,r,n,a)}else 0!==n&&a.setFieldsRemoved(e,0)}function mf(e,t,r,n,o,i,s){(function(e,t,r,n,o,i){if(r===i){if(0===r||function(e,t,r,n,o){for(var i=0;i<o;++i)if(e[t+i]!==r[n+i])return!1;return!0}(e,t,n,o,r))return!0}else{if(1===r&&e[t]===Hp.EMPTY_FIELD&&0===i)return!0;if(1===i&&n[o]===Hp.EMPTY_FIELD&&0===r)return!0}return!1})(e,t,r,n,o,i)||(0===i?s.write(Hp.EMPTY_FIELD):s.write(n,o,i),s.setChanged())}function gf(e){if(e instanceof Tf)return e;if(Ou.isUint8Array(e))return new Tf(e);throw new va.SchemaViolationError("Unable to read RecordV2 value from: "+e)}var Tf=function(e){function t(t,r,n){return void 0===r&&(r=0),void 0===n&&(n=t.length),e.call(this,t,r,n)||this}return _f(t,e),t.toString=function(){return"RecordV2Impl"},t.from=function(e){return gf(e)},t.prototype.apply=function(e){return Of.apply(this,e)},t.prototype.toString=function(){return JSON.stringify(this.asRecords())},t.prototype.asRecords=function(){return uf.parse(this.$buffer,this.$offset,this.$length)},t.prototype.asFields=function(){return this.asRecords().reduce((function(e,t){return e.concat(t)}),[])},t.prototype.asModel=function(e){return new tf.RecordModelImpl(t,e,this.asRecords(),!1)},t.prototype.asValidatedModel=function(e){return new tf.RecordModelImpl(t,e,this.asRecords(),!0)},t.prototype.binaryDiff=function(e){return Of.diff(e,this)},t.prototype.diff=function(e){var t=e.$buffer,r=e.$offset,n=e.$length,o=this.$buffer,i=this.$offset,s=this.$length;if(0===s)return 0===n?pf.NO_CHANGE:new pf.RecordV2DeltaImpl(Uint8Array.from([]),0,0,[!1,0],{});if(Hp.isSingleEmptyRecord(o,i,s))return Hp.isSingleEmptyRecord(t,r,n)?pf.NO_CHANGE:function(e){switch(e){case 0:return new pf.RecordV2DeltaImpl(Uint8Array.from([Hp.RECORD_MU]),0,1,[!0,0],{});case 1:return new pf.RecordV2DeltaImpl(Uint8Array.from([Hp.RECORD_MU]),0,1,null,{0:[!1,0]});default:return new pf.RecordV2DeltaImpl(Uint8Array.from([Hp.RECORD_MU]),0,1,[!1,1],{0:[!1,0]})}}(Hp.recordCount(t,r,n));if(0===n)return function(e,t,r){return new pf.RecordV2DeltaImpl(e,t,r,[!0,0],{})}(o,i,s);if(Hp.isSingleEmptyRecord(t,r,n))return function(e,t,r){return 1===Hp.recordCount(e,t,r)?new pf.RecordV2DeltaImpl(e,t,r,null,{0:[!0,0]}):new pf.RecordV2DeltaImpl(e,t,r,[!0,1],e[0]===Hp.RECORD_DELIMITER?{}:{0:[!0,0]})}(o,i,s);var a=function(e,t,r,n,o,i){for(var s=new Ef,a=Hp.recordCount(e,t,r),u=Hp.recordCount(n,o,i),c=Math.min(a,u),l=t,p=t,f=o,h=o,d=0;d<c;++d)p=Hp.findDelimiter(e,p,t+r,Hp.RECORD_DELIMITER),h=Hp.findDelimiter(n,h,o+i,Hp.RECORD_DELIMITER),d>0&&s.write(Hp.RECORD_DELIMITER),wf(d,e,l,p-l,n,f,h-f,s),l=++p,f=++h;return u!==a&&(u>a&&s.write(n,f-1,o+i-f+1),s.setRecordsChanged(u>a,c)),s}(t,r,n,o,i,s);if(a.hasChanges()){var u=a.getDelta();return new pf.RecordV2DeltaImpl(u,0,u.length,a.getRecordChanges(),a.getFieldChanges())}return pf.NO_CHANGE},t}(Bl.BytesImpl);Sf.RecordV2Impl=Tf;var Of=new Ul.BinaryDeltaTypeImpl(Tf,gf,Vl.identity),If={};Object.defineProperty(If,"__esModule",{value:!0}),If.RecordV2BuilderImpl=void 0;var bf=function(){function e(){this.records=[]}return e.prototype.addFields=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(arguments.length>1?t.unshift(e):t=e,t){var n=this.records.length?this.records[this.records.length-1]:[];this.records[Math.max(this.records.length-1,0)]=n.concat(t)}return this},e.prototype.addRecord=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return arguments.length>1?t.unshift(e):t=e,t?this.records.push([].concat(t)):this.records.push([]),this},e.prototype.clear=function(){return this.records=[],this},e.prototype.build=function(){return new Sf.RecordV2Impl(Wp.toBuffer(this.records))},e}();If.RecordV2BuilderImpl=bf;var Rf={};Object.defineProperty(Rf,"__esModule",{value:!0}),Rf.toJSON=Rf.RecordImpl=void 0;var Cf=function(){function e(e,t,r,n,o){var i=this;this.name=e,this.min=t,this.max=r,this.index=n,this.isVariable=t!==r,this.fields=o,this.fieldsMap={},o.forEach((function(e){i.fieldsMap[e.name]=e}))}return e.prototype.getFields=function(){return[].concat(this.fields)},e.prototype.getField=function(e){var t=this.fieldsMap[e];if(t)return t;throw new va.SchemaViolationError("Record '"+this.name+"' has no field named '"+e+"'")},e.prototype.lastField=function(){return this.fields[this.fields.length-1]},e.prototype.createModel=function(){var e=[];return this.fields.forEach((function(t){for(var r=0;r<t.min;++r)e.push(t.modelValue())})),e},e.prototype.getAbsoluteIndex=function(e){if(e<0||-1!==this.max&&e>this.max-1)throw new va.IllegalArgumentError("Invalid index '"+e+"' for record '"+this.name+"'");return this.index+e},e.prototype.toString=function(){var e="Name="+this.name;return this.min===this.max?e+=", Occurs="+this.min:(e+=", Min="+this.min+", Max=",-1===this.max?e+="Unlimited":e+=this.max),"Record ["+(e+=", Fields="+this.fields)+"]"},e}();Rf.RecordImpl=Cf,Rf.toJSON=function(e){return{fields:e.fields.map((function(e){return e.toJSON()})),name:e.name,min:e.min,max:e.max}};var Af={},Pf=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Af,"__esModule",{value:!0}),Af.MutableRecordModelImpl=void 0;var Nf=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.recordData=r.createModel(),n}return Pf(t,e),t.prototype.model=function(){return this.recordData},t.prototype.set=function(e,t,r,n,o){var i,s;switch(void 0===n&&(n=0),arguments.length){case 2:o=t;var a=this.parseKey(e);e=a.recordName,i=a.recordIndex,s=a.fieldName,n=a.fieldIndex;break;case 3:o=r,s=t,i=0;break;case 5:i=t,s=r;break;default:i=0,s=""}var u=this.schema().getRecord(e),c=this.getRecord(u,i),l=u.getField(s);return c[Qp.resolveFieldIndex(l,c,n)]=Zp.normalise(l,o),this},t.prototype.add=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o,i=this.schema().getRecord(e);if("number"==typeof t)o=this.getRecord(i,t);else if(r.unshift(t),i.isVariable){if(!(this.recordData.length>i.index))throw new va.SchemaViolationError("Variable record '"+i.name+"' has no occurrences to add a field to");o=this.recordData[this.recordData.length-1]}else o=this.getRecord(i,Math.max(i.max-1,0));return this.addValuesToRecord(i,o,r),this},t.prototype.addRecord=function(){var e=this.schema().lastRecord();if(!e.isVariable)throw new va.SchemaViolationError("Record '"+e.name+"' is not variable");var t=e.max;if(-1!==t&&this.recordData.length-e.index>=t)throw new va.SchemaViolationError("Record '"+e.name+"' already has maximum number of occurrences");return this.recordData.push(e.createModel()),this},t.prototype.removeRecord=function(e){var t=this.schema().lastRecord();if(!t.isVariable)throw new va.SchemaViolationError("Record '"+t.name+"' is not variable");var r=Qp.resolveRecordIndex(t,this.recordData,e);if(this.recordData.length-t.index-1<t.min)throw new va.SchemaViolationError("Removing an occurrence of record '"+t.name+"' would violate the minimum number of occurrences");return this.recordData.splice(r,1),this},t.prototype.removeField=function(e,t,r){var n=this.schema().getRecord(e),o=this.getRecord(n,t),i=n.lastField();if(!i.isVariable)throw new va.SchemaViolationError("Field '"+i.name+"' is not a variable field");var s=Qp.resolveFieldIndex(i,o,r);if(o.length-i.index-1<i.min)throw new va.SchemaViolationError("Removing an occurrence of field '"+i.name+"' would violate the minimum number of occurrences");return o.splice(s,1),this},t.prototype.addValuesToRecord=function(e,t,r){var n=e.lastField();if(!n.isVariable)throw new va.SchemaViolationError("Final field of record '"+e.name+"' is not variable");var o=n.max;if(-1!==o&&t.length-n.index+r.length>o)throw new va.SchemaViolationError("Adding values would exceed maximum number of field occurrences");r.forEach((function(e){t.push(Zp.normalise(n,e))}))},t}(Qp.AbstractRecordModel);Af.MutableRecordModelImpl=Nf;var Mf={};Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.SchemaImpl=void 0;var Df=function(){function e(e,t){var r=this;this.recordsMap={},this.recordV2Constructor=e,this.recordsArray=t,t.forEach((function(e){r.recordsMap[e.name]=e}))}return e.prototype.getRecord=function(e){var t=this.recordsMap[e];if(t)return t;throw new va.SchemaViolationError("Record '"+e+"' is not known")},e.prototype.getRecords=function(){return[].concat(this.recordsArray)},e.prototype.records=function(){return this.recordsArray},e.prototype.firstRecord=function(){return this.recordsArray[0]},e.prototype.lastRecord=function(){return this.recordsArray[this.recordsArray.length-1]},e.prototype.createMutableModel=function(){return new Af.MutableRecordModelImpl(this.recordV2Constructor,this)},e.prototype.createModel=function(){var e=[];return this.recordsArray.forEach((function(t){var r=t.createModel();if(t.min>0)for(var n=0;n<t.min;++n)e.push([].concat(r))})),e},e.prototype.asJSON=function(){return JSON.stringify({records:this.recordsArray.map(Rf.toJSON)})},e.prototype.toString=function(){return"Schema [Records="+this.recordsArray+"]"},e}();Mf.SchemaImpl=Df;var jf={},Lf=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function xf(e,t,r){if(t<0)throw new va.SchemaViolationError("'"+e+"' has invalid 'min' value '"+t+"'");if(-1!==r&&(r<1||r<t))throw new va.SchemaViolationError("'"+e+"' has invalid 'max' value '"+r+"'")}Object.defineProperty(jf,"__esModule",{value:!0}),jf.SchemaBuilderImpl=void 0;var Uf=function(){function e(e){this.records=[],this.recordV2Constructor=e}return e.prototype.record=function(e,t,r){return void 0===t&&(t=1),void 0===r&&(r=t),xf(e,t,r),this.checkRecord(e),void 0!==this.currentFields&&this.addRecord(),this.currentName=e,this.currentMin=t,this.currentMax=r,this.currentFields=[],this},e.prototype.string=function(e,t,r){return void 0===t&&(t=1),void 0===r&&(r=t),xf(e,t,r),this.checkField(e),this.currentFields.push(new Zp.FieldImpl(e,Zp.Type.STRING,t,r,this.fieldIndex())),this},e.prototype.integer=function(e,t,r){return void 0===t&&(t=1),void 0===r&&(r=t),xf(e,t,r),this.checkField(e),this.currentFields.push(new Zp.FieldImpl(e,Zp.Type.INTEGER,t,r,this.fieldIndex())),this},e.prototype.decimal=function(e,t,r,n){return void 0===r&&(r=1),void 0===n&&(n=r),xf(e,r,n),function(e,t){if(t<1)throw new va.SchemaViolationError("'"+e+"' has invalid 'scale' value '"+t+"'")}(e,t),this.checkField(e),this.currentFields.push(new Zp.FieldImpl(e,Zp.Type.DECIMAL,r,n,this.fieldIndex(),t)),this},e.prototype.build=function(){if(void 0!==this.currentFields&&this.addRecord(),0===this.records.length)throw new va.SchemaViolationError("Schema has no records");return new Mf.SchemaImpl(this.recordV2Constructor,this.records)},e.prototype.fieldIndex=function(){var e=this.currentFields;if(0===e.length)return 0;var t=e[e.length-1];return t.index+t.max},e.prototype.addRecord=function(){var e,t=this.currentFields;if(0===t.length)throw new va.SchemaViolationError("No fields specified for record: '"+this.currentName+"'");if(0===this.records.length)e=0;else{var r=this.records[this.records.length-1];e=r.index+r.max}this.records.push(new Rf.RecordImpl(this.currentName,this.currentMin,this.currentMax,e,t))},e.prototype.checkRecord=function(e){var t,r;if(Zl.requireNonNull(e,"name"),e===this.currentName)throw new va.SchemaViolationError("Duplicate record name: '"+e+"'");if(this.records.length)try{for(var n=Lf(this.records),o=n.next();!o.done;o=n.next()){if(e===o.value.name)throw new va.SchemaViolationError("Duplicate record name: '"+e+"'")}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}if(void 0!==this.currentFields&&this.currentMin!==this.currentMax)throw new va.SchemaViolationError("Record '"+e+"' not allowed after variable multiplicity record: '"+this.currentName+"'")},e.prototype.checkField=function(e){var t,r;if(Zl.requireNonNull(e,"name"),void 0===this.currentFields)throw new va.SchemaViolationError("Cannot add field '"+e+"' as there is no current record");if(this.currentFields.length){try{for(var n=Lf(this.currentFields),o=n.next();!o.done;o=n.next()){if(e===o.value.name)throw new va.SchemaViolationError("Duplicate field name: '"+e+"'")}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}var i=this.currentFields[this.currentFields.length-1];if(i.isVariable)throw new va.SchemaViolationError("Field '"+e+"' is not allowed after variable multiplicity field '"+i.name+"'")}},e}();jf.SchemaBuilderImpl=Uf;var Bf={};Object.defineProperty(Bf,"__esModule",{value:!0}),Bf.SchemaParser=void 0;var qf=function(){function e(e){this.recordV2Constructor=e}return e.prototype.parse=function(e){var t,r=new jf.SchemaBuilderImpl(this.recordV2Constructor);try{t=JSON.parse(e)}catch(e){throw new va.SchemaParseError("Invalid Schema JSON string")}if(void 0===t.records)throw new va.SchemaParseError("Schema has no records");try{return t.records.forEach((function(e){void 0!==e.occurs?r.record(e.name,e.occurs):r.record(e.name,e.min,e.max),e.fields&&e.fields.forEach((function(e){var t,n;void 0!==e.occurs?(t=e.occurs,n=e.occurs):(t=e.min,n=e.max);var o=e.type||"STRING";switch(o.toUpperCase()){case"STRING":r.string(e.name,t,n);break;case"INTEGER":r.integer(e.name,t,n);break;case"DECIMAL":var i=e.scale||2;r.decimal(e.name,i,t,n);break;default:throw new va.SchemaParseError("Invalid field type value '"+o+"'")}}))})),r.build()}catch(e){throw e instanceof va.SchemaParseError?e:e instanceof Error?new va.SchemaParseError(e.message):new va.SchemaParseError("Could not parse schema JSON string")}},e}();Bf.SchemaParser=qf;var Vf={},kf=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Ff(){}Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.RecordV2DataTypeImpl=void 0;var Gf=function(e){function t(t){void 0===t&&(t=Ff);var r=e.call(this,"record_v2",Sf.RecordV2Impl,Sf.RecordV2Impl,Sf.RecordV2Impl.from,Vl.identity,[],!0)||this;return r.RecordV2=Sf.RecordV2Impl,r.validator=t,r}return kf(t,e),t.prototype.from=function(e){return Sf.RecordV2Impl.from(e)},t.prototype.validate=function(e){this.validator(Zl.requireNonNull(e,"RecordV2 instance"))},t.prototype.parseSchema=function(e){return new Bf.SchemaParser(Sf.RecordV2Impl).parse(e)},t.prototype.schemaBuilder=function(){return new jf.SchemaBuilderImpl(Sf.RecordV2Impl)},t.prototype.valueBuilder=function(){return new If.RecordV2BuilderImpl},t.prototype.withSchema=function(e){return new t((function(t){return t.asValidatedModel(e)}))},t}(ql.AbstractDataType);Vf.RecordV2DataTypeImpl=Gf;var Hf={};Object.defineProperty(Hf,"__esModule",{value:!0}),Hf.EventImpl=void 0;var Yf=function(){function e(e,t,r){this.metadata=e,this.originalEvent=t,this.value=r,this.sequence=e.sequence,this.timestamp=e.timestamp,this.author=e.author,this.isEditEvent=!e.equals(t),this.isOriginalEvent=!this.isEditEvent}return e.create=function(t,r,n){return new e(t,r,n)},e.prototype.withValue=function(t){return new e(this.metadata,this.originalEvent,t)},e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.metadata.equals(t.metadata)&&this.originalEvent.equals(t.originalEvent)&&this.value===t.value)},e.prototype.toString=function(){return(this.isEditEvent?"Edit of ["+this.originalEvent+"]":"")+"["+this.metadata+"] "+this.value},e}();Hf.EventImpl=Yf;var Wf={};Object.defineProperty(Wf,"__esModule",{value:!0}),Wf.EventMetadataImpl=void 0;var zf=function(){function e(e,t,r){this.sequence=e,this.timestamp=t,this.author=r}return e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.sequence===t.sequence&&this.timestamp===t.timestamp&&this.author===t.author)},e}();Wf.EventMetadataImpl=zf;var Qf={},Kf=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Qf,"__esModule",{value:!0}),Qf.EventMetadataImplSerialiser=void 0;var Jf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Kf(t,e),t.prototype.read=function(e){var t=Iu.readInt64(e),r=Iu.readInt64(e),n=Iu.readString(e);return new Wf.EventMetadataImpl(t.toNumber(),r.toNumber(),n)},t.prototype.write=function(e,t){Iu.writeInt64(e,t.sequence),Iu.writeInt64(e,t.timestamp),Iu.writeString(e,t.author)},t}(Fu.AbstractSerialiser);Qf.EventMetadataImplSerialiser=new Jf;var $f={};Object.defineProperty($f,"__esModule",{value:!0}),$f.DescendantQualifier=$f.canonicalise=$f.split=$f.PATH_SEPARATOR=void 0,$f.PATH_SEPARATOR="/",$f.split=function(e){return e.split($f.PATH_SEPARATOR)},$f.canonicalise=function(e){if(!e)return"";var t=e.length,r=t>0&&e.charAt(0)===$f.PATH_SEPARATOR?1:0,n=t>1&&e.charAt(t-1)===$f.PATH_SEPARATOR?1:0;return e.substring(r,t-n)};var Xf=function(e){this.includesDescendants=e};$f.DescendantQualifier=Object.freeze({MATCH:new Xf(!1),DESCENDANTS_OF_MATCH:new Xf(!0),MATCH_AND_DESCENDANTS:new Xf(!0)});var Zf={};Object.defineProperty(Zf,"__esModule",{value:!0}),Zf.AbstractTopicSelector=void 0;var eh=function(){function e(e,t,r){this.type=e,this.prefix=t,this.expression=r}return e.prototype.selects=function(e){var t=$f.canonicalise(e);return 0===t.indexOf(this.prefix)&&this.doSelects(t)},e.prototype.toString=function(){return this.expression},e}();Zf.AbstractTopicSelector=eh;var th={};Object.defineProperty(th,"__esModule",{value:!0}),th.regex=void 0,th.regex=function(e,t){if(void 0===t&&(t=""),""===e)throw new va.IllegalArgumentError("Empty regular expression ["+t+"]");try{var r=new RegExp(e);return function(e){var t=r.exec(e);return t&&t[0]===e}}catch(e){throw new va.IllegalArgumentError("Bad regular expression ["+e.message+", "+t+"]")}};var rh={},nh=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(rh,"__esModule",{value:!0}),rh.FullPathSelector=void 0;var oh=function(e){function t(t){var r=e.call(this,t.type,t.prefix,t.expression)||this;if(r.pattern=void 0,r.qualifier=t.qualifier,!t.base)throw new va.IllegalArgumentError("Invalid full-path selector");return r.base=t.base,r}return nh(t,e),t.prototype.doSelects=function(e){if(!this.pattern)switch(this.qualifier){case $f.DescendantQualifier.DESCENDANTS_OF_MATCH:this.pattern=th.regex(this.base+"/.+");break;case $f.DescendantQualifier.MATCH_AND_DESCENDANTS:this.pattern=th.regex(this.base+"(?:$|/.+)");break;default:case $f.DescendantQualifier.MATCH:this.pattern=th.regex(this.base)}return!0===this.pattern(e)},t}(Zf.AbstractTopicSelector);rh.FullPathSelector=oh;var ih={};Object.defineProperty(ih,"__esModule",{value:!0}),ih.Type=ih.Prefix=void 0,function(e){e.PATH=">",e.SPLIT_PATH_PATTERN="?",e.FULL_PATH_PATTERN="*",e.SELECTOR_SET="#"}(ih.Prefix||(ih.Prefix={})),function(e){e.PATH=">",e.SPLIT_PATH_PATTERN="?",e.FULL_PATH_PATTERN="*",e.SELECTOR_SET="#"}(ih.Type||(ih.Type={}));var sh={},ah=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(sh,"__esModule",{value:!0}),sh.PathSelector=void 0;var uh=function(e){function t(t){var r=this,n=t.remainder;if(t.type===ih.Type.PATH){if(""===t.prefix)throw new va.IllegalArgumentError("Topic path must have at least one part: "+n);if(t.prefix.indexOf("//")>-1)throw new va.IllegalArgumentError("Topic path contains empty part: "+n)}return(r=e.call(this,t.type,t.prefix,t.expression)||this).qualifier=t.qualifier,r.path=t.prefix,r}return ah(t,e),t.prototype.doSelects=function(e){var t=this.path===e,r=0===e.indexOf(this.path+"/");switch(this.qualifier){case $f.DescendantQualifier.MATCH:return t;case $f.DescendantQualifier.DESCENDANTS_OF_MATCH:return r;case $f.DescendantQualifier.MATCH_AND_DESCENDANTS:return t||r;default:return!1}},t}(Zf.AbstractTopicSelector);sh.PathSelector=uh;var ch={},lh=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ph=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(ch,"__esModule",{value:!0}),ch.SelectorSet=ch.DELIMITER=void 0,ch.DELIMITER="////";var fh=function(e){function t(r){var n=this,o=[];r.forEach((function(e){e instanceof t?e.selectors.forEach((function(e){o.push(e)})):o.push(e)}));var i=o.join(ch.DELIMITER),s=function(e){var t,r;if(0===e.length)return"";var n=Sl.MAX_INT32,o=[];e.forEach((function(e,t){var r=$f.split(e.prefix);n=Math.min(n,r.length),o[t]=r}));var i=[];e:for(var s=0;s<n;++s){var a=o[0][s];try{for(var u=(t=void 0,ph(o)),c=u.next();!c.done;c=u.next()){if(a!==c.value[s])break e}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}i.push(a),i.push($f.PATH_SEPARATOR)}return $f.canonicalise(i.join(""))}(o);return(n=e.call(this,ih.Type.SELECTOR_SET,s,ih.Prefix.SELECTOR_SET+i)||this).selectors=o,n}return lh(t,e),t.prototype.selects=function(e){var t,r;try{for(var n=ph(this.selectors),o=n.next();!o.done;o=n.next()){if(o.value.selects(e))return!0}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1},t.prototype.doSelects=function(e){return this.selects(e)},t}(Zf.AbstractTopicSelector);ch.SelectorSet=fh;var hh={},dh=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(hh,"__esModule",{value:!0}),hh.SplitPathSelector=void 0;var yh=function(e){function t(t){var r=e.call(this,t.type,t.prefix,t.expression)||this;return r.patterns=void 0,r.qualifier=t.qualifier,r.parts=$f.split(t.base),r.parts.forEach((function(e){if(!e)throw new va.IllegalArgumentError("Invalid split-path selector")})),r}return dh(t,e),t.prototype.doSelects=function(e){this.patterns||(this.patterns=this.parts.map((function(e){return th.regex(e)})));var t=this.patterns.length,r=e.split($f.PATH_SEPARATOR);switch(this.qualifier){case $f.DescendantQualifier.MATCH:if(r.length!==t)return!1;break;case $f.DescendantQualifier.DESCENDANTS_OF_MATCH:if(r.length<=t)return!1;break;case $f.DescendantQualifier.MATCH_AND_DESCENDANTS:if(r.length<t)return!1}for(var n=0;n<t;++n)if(!this.patterns[n](r[n]))return!1;return!0},t}(Zf.AbstractTopicSelector);hh.SplitPathSelector=yh;var vh={};Object.defineProperty(vh,"__esModule",{value:!0}),vh.memoize=void 0,vh.memoize=function(e,t,r){void 0===t&&(t={}),void 0===r&&(r=Vl.identity);var n=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=r(n),s=t[i];return s||(s=e.apply(e,n),t[i]=s,s)};return n._uncached=e,n};var Sh={};function _h(e){return"'"===e||'"'===e}function Eh(e){var t=[],r="",n=0,o=!1;e:for(;n<e.length;n++){var i=e[n];if(_h(i)){for(n++,r="",o=!1;n<e.length;n++){var s=e[n];if(o)r+=s,o=!1;else if("\\"===s)o=!0;else{if(s===i){t.push(r);continue e}r+=s}}throw new va.IllegalArgumentError("Mis-quoted input")}}return t}function wh(e){for(var t=0;t<e.length;t++){var r=e.charAt(t);if('"'===r||"\\"===r||"'"===r){for(var n="",o=0;o<e.length;o++){var i=e.charAt(o);switch(i){case"\\":n+="\\\\";break;case'"':n+='\\"';break;case"'":n+="\\'";break;default:n+=i}}return n}}return e}Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.collectionToString=Sh.stringToSet=Sh.escape=Sh.split=void 0,Sh.split=function(e,t){if(""===e)return[];for(var r=[],n=t.length,o=e.lastIndexOf(t);o>-1;)r.push(e.substring(o+n,e.length)),o=(e=e.substring(0,o)).lastIndexOf(t);return r.push(e),r.reverse()},Sh.escape=wh,Sh.stringToSet=function(e){return new Set(Eh(e))},Sh.collectionToString=function(e){var t=[];return e.forEach((function(e){t.push('"'+wh(e)+'"')})),t.join(",")};var mh,gh,Th,Oh=mh={};function Ih(){throw new Error("setTimeout has not been defined")}function bh(){throw new Error("clearTimeout has not been defined")}function Rh(e){if(gh===setTimeout)return setTimeout(e,0);if((gh===Ih||!gh)&&setTimeout)return gh=setTimeout,setTimeout(e,0);try{return gh(e,0)}catch(t){try{return gh.call(null,e,0)}catch(t){return gh.call(this,e,0)}}}!function(){try{gh="function"==typeof setTimeout?setTimeout:Ih}catch(e){gh=Ih}try{Th="function"==typeof clearTimeout?clearTimeout:bh}catch(e){Th=bh}}();var Ch,Ah=[],Ph=!1,Nh=-1;function Mh(){Ph&&Ch&&(Ph=!1,Ch.length?Ah=Ch.concat(Ah):Nh=-1,Ah.length&&Dh())}function Dh(){if(!Ph){var e=Rh(Mh);Ph=!0;for(var t=Ah.length;t;){for(Ch=Ah,Ah=[];++Nh<t;)Ch&&Ch[Nh].run();Nh=-1,t=Ah.length}Ch=null,Ph=!1,function(e){if(Th===clearTimeout)return clearTimeout(e);if((Th===bh||!Th)&&clearTimeout)return Th=clearTimeout,clearTimeout(e);try{Th(e)}catch(t){try{return Th.call(null,e)}catch(t){return Th.call(this,e)}}}(e)}}function jh(e,t){this.fun=e,this.array=t}function Lh(){}Oh.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];Ah.push(new jh(e,t)),1!==Ah.length||Ph||Rh(Dh)},jh.prototype.run=function(){this.fun.apply(null,this.array)},Oh.title="browser",Oh.browser=!0,Oh.env={},Oh.argv=[],Oh.version="",Oh.versions={},Oh.on=Lh,Oh.addListener=Lh,Oh.once=Lh,Oh.off=Lh,Oh.removeListener=Lh,Oh.removeAllListeners=Lh,Oh.emit=Lh,Oh.prependListener=Lh,Oh.prependOnceListener=Lh,Oh.listeners=function(e){return[]},Oh.binding=function(e){throw new Error("process.binding is not supported")},Oh.cwd=function(){return"/"},Oh.chdir=function(e){throw new Error("process.chdir is not supported")},Oh.umask=function(){return 0};var xh={};(function(e){(function(){"use strict";Object.defineProperty(xh,"__esModule",{value:!0}),xh.parseSelector=void 0;var t=$f.DescendantQualifier;function r(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(!e)throw new va.IllegalArgumentError("Empty topic selector expression");if(t.length>0&&(e=[e].concat(t)),e instanceof Array){var s=e.map((function(e){return e instanceof Zf.AbstractTopicSelector?e:r(e)}));return new ch.SelectorSet(s)}if("string"==typeof e){var a=n(e);if(o(a))return new sh.PathSelector(a);switch(a.type){case ih.Type.SPLIT_PATH_PATTERN:return new hh.SplitPathSelector(a);case ih.Type.FULL_PATH_PATTERN:return new rh.FullPathSelector(a);case ih.Type.SELECTOR_SET:var u=Sh.split(a.remainder,ch.DELIMITER),c=u.map((function(e){return r(e)}));return new ch.SelectorSet(c)}}if(e instanceof Zf.AbstractTopicSelector)return e;throw new va.IllegalArgumentError("Topic selector expression must be a string or array")}function n(e){var r=function(e){switch(e[0]){case ih.Prefix.PATH:return ih.Type.PATH;case ih.Prefix.SPLIT_PATH_PATTERN:return ih.Type.SPLIT_PATH_PATTERN;case ih.Prefix.FULL_PATH_PATTERN:return ih.Type.FULL_PATH_PATTERN;case ih.Prefix.SELECTOR_SET:return ih.Type.SELECTOR_SET;case"$":case"%":case"&":case"<":throw new va.IllegalArgumentError("Invalid expression type: "+e);default:return null}}(e);null===r&&(e=ih.Prefix.PATH+e,r=ih.Type.PATH);var n,o,i=e.substring(1);return r===ih.Type.PATH?(o=i,n=t.MATCH):"/"===i[i.length-1]?"/"===i[i.length-2]?(n=t.MATCH_AND_DESCENDANTS,o=$f.canonicalise(i.substring(0,i.length-2))):(n=t.DESCENDANTS_OF_MATCH,o=$f.canonicalise(i.substring(0,i.length-1))):(o=$f.canonicalise(i),n=t.MATCH),{type:r,base:o,prefix:r===ih.Type.PATH?$f.canonicalise(i):function(e){for(var t=[],r=[],n=s,o=0,i=e.length;o<i;++o){var u=e[o];if("\\"===u&&o<i-1){var c=e[o+1];if(n===s)if(o++,"Q"===c)n=a;else{if(!(c<"a"||c>"z")||!(c<"A"||c>"Z")){t.length=0;break}t.push(c)}else"E"===c?(o++,n=s):t.push(u)}else if(u===$f.PATH_SEPARATOR)r.push(t.join("")),t.length=0,t.push(u);else{if(!n(u)){t.length=0;break}t.push(u)}}return r.push(t.join("")),$f.canonicalise(r.join(""))}(o),remainder:i,qualifier:n,expression:r+i}}function o(e){return e.type===ih.Type.PATH||e.type!==ih.Type.SELECTOR_SET&&""!==e.prefix&&e.prefix===e.base}var i=["*",".","+","?","^","$","{","}","(",")","[","]","\\","|"];function s(e){return-1===i.indexOf(e)}function a(){return!0}var u=e&&e.env&&"true"===e.env.DISABLE_TOPIC_CACHE?r:vh.memoize(r,{},(function(e){return JSON.stringify(e)}));xh.parseSelector=u}).call(this)}).call(this,mh);var Uh={};Object.defineProperty(Uh,"__esModule",{value:!0}),Uh.sessionContext=void 0;var Bh=p({}),qh=f({});Uh.sessionContext={ErrorReason:_c.ErrorReason,TopicTypeEnum:Dc.TopicTypeEnum,TopicAddFailReasonEnum:Uc.TopicAddFailReasonEnum,TopicSpecification:Cc.TopicSpecification,TimeSeriesEventDataType:qh.TimeSeriesEventDataType,DataTypes:Bh.DataTypes,AbstractDataType:ql.AbstractDataType,parseSelector:xh.parseSelector,CloseReason:kc.CloseReasonImpl};var Vh={},kh=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Vh,"__esModule",{value:!0}),Vh.StreamImpl=void 0;var Fh=function(){function e(e){this.listeners=e.getListeners(),this.errorCallback=e.getErrorCallback(),this.closeCallback=e.getCloseCallback()}return e.prototype.on=function(e,t){return this.attach(e,t),this},e.prototype.off=function(e,t){return this.remove(e,t),this},e.prototype.close=function(e){return this.closeCallback(e),this},e.prototype.error=function(e){return this.errorCallback(e),this},e.prototype.attach=function(e,t){var r,n;if("object"==typeof e)try{for(var o=kh(Object.keys(e)),i=o.next();!i.done;i=o.next()){var s=i.value;this.attach(s,e[s])}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}else t&&(this.listeners.hasOwnProperty(e)||(this.listeners[e]=[]),this.listeners[e].push(t))},e.prototype.remove=function(e,t){var r,n;if("object"==typeof e)try{for(var o=kh(Object.keys(e)),i=o.next();!i.done;i=o.next()){var s=i.value;this.remove(s,e[s])}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}else this.listeners.hasOwnProperty(e)&&(this.listeners[e]=t?this.listeners[e].filter((function(e){return e!==t})):[])},e}();Vh.StreamImpl=Fh;var Gh={};(function(e){(function(){"use strict";var t=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Gh,"__esModule",{value:!0}),Gh.Emitter=void 0;var r=new(function(){function r(){this.pendingEvents=[],this.events=[],this.busy=!1}return r.prototype.addEmitterEvent=function(t){var r=this;this.pendingEvents.push(t),this.busy||(this.busy=!0,e.nextTick((function(){r.drainEmitterQueue()})))},r.prototype.drainEmitterQueue=function(){var r,n,o=this;this.events=this.pendingEvents,this.pendingEvents=[];try{for(var i=t(this.events),s=i.next();!s.done;s=i.next()){var a=s.value;try{a()}catch(e){}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}this.pendingEvents.length>0?e.nextTick((function(){o.drainEmitterQueue()})):this.busy=!1},r}()),n=function(){function e(e){var t=this;if(this.listeners={},this.closed=!1,this.listener=function(){},void 0===e||void 0===e.stream){var r={getListeners:function(){return t.listeners},getErrorCallback:function(){return t.error.bind(t)},getCloseCallback:function(){return t.close.bind(t)}};this.stream=new Vh.StreamImpl(r)}else{if(this.stream=e.stream,void 0===e.listeners)throw new va.InternalError("Listeners must be defined when supplying a stream");this.listeners=e.listeners}void 0!==e&&void 0!==e.event&&this.stream.on(e.event,e.callback)}return e.create=function(){var t={},r=function(){},n=function(){};return{getListeners:function(){return t},getErrorCallback:function(){return function(e){r(e)}},getCloseCallback:function(){return function(e){n(e)}},emitter:function(o){var i=new e({stream:o,listeners:t});return r=i.error.bind(i),n=i.close.bind(i),i}}},e.prototype.emitUnsafe=function(e,t){var n=this,o=function(e){Vl.callWithArguments(e,t||[])};r.addEmitterEvent((function(){n.listeners.hasOwnProperty(e)&&n.listeners[e].forEach(o)})),this.listener(e,t)},e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];!this.closed&&e&&this.emitUnsafe(e,t)},e.prototype.immediate=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this.closed&&e){var n=function(e){try{Vl.callWithArguments(e,t||[])}catch(e){}};this.listeners.hasOwnProperty(e)&&this.listeners[e].forEach(n)}},e.prototype.error=function(e){this.closed||(this.emitUnsafe("error",[e]),this.close(e?e.message:void 0))},e.prototype.close=function(e){this.closed||(this.closed=!0,this.emitUnsafe("close",[e]))},e.prototype.listen=function(e){this.listener=e},e.prototype.get=function(){return this.stream},e}();Gh.Emitter=n}).call(this)}).call(this,mh);var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0}),Hh.BooleanSerialiser=void 0;var Yh=function(){function e(){}return e.prototype.read=function(e){return Iu.readBoolean(e)},e.prototype.write=function(e,t){Iu.writeBoolean(e,t)},e}();Hh.BooleanSerialiser=new Yh;var Wh={};Object.defineProperty(Wh,"__esModule",{value:!0}),Wh.write=Wh.read=void 0,Wh.read=function(e,t){var r=Iu.readByte(e);if(void 0===t[r])throw new va.IllegalArgumentError("Unable to decode enum value "+r);return t[t[r]]},Wh.write=function(e,t){"number"==typeof t?Iu.writeByte(e,t):Iu.writeByte(e,t.id)};var zh,Qh={};Object.defineProperty(Qh,"__esModule",{value:!0}),Qh.SessionLockOptions=Qh.SessionLockScope=void 0,function(e){e[e.UNLOCK_ON_SESSION_LOSS=0]="UNLOCK_ON_SESSION_LOSS",e[e.UNLOCK_ON_CONNECTION_LOSS=1]="UNLOCK_ON_CONNECTION_LOSS"}(zh=Qh.SessionLockScope||(Qh.SessionLockScope={})),Qh.SessionLockOptions={SessionLockScope:zh};var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0}),Kh.SessionLockAcquisition=void 0;var Jh=function(e,t,r){this.lockName=e,this.sequence=t,this.scope=r};Kh.SessionLockAcquisition=Jh;var $h={},Xh=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty($h,"__esModule",{value:!0}),$h.SessionLockAcquisitionSerialiser=void 0;var Zh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xh(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=Iu.readInt64(e),n=Wh.read(e,Qh.SessionLockScope);return new Kh.SessionLockAcquisition(t,r,n)},t.prototype.write=function(e,t){Iu.writeString(e,t.lockName),Iu.writeInt64(e,t.sequence),Wh.write(e,t.scope)},t}(Fu.AbstractSerialiser);$h.SessionLockAcquisitionSerialiser=new Zh;var ed={},td=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ed,"__esModule",{value:!0}),ed.SessionLockRequestSerialiser=void 0;var rd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return td(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.lockName),Iu.writeInt64(e,t.requestId),Wh.write(e,t.scope)},t}(Fu.AbstractSerialiser);ed.SessionLockRequestSerialiser=new rd;var nd={};Object.defineProperty(nd,"__esModule",{value:!0}),nd.RELEASE_SESSION_LOCK=nd.ACQUIRE_SESSION_LOCK=void 0,nd.ACQUIRE_SESSION_LOCK={id:114,request:ed.SessionLockRequestSerialiser,response:$h.SessionLockAcquisitionSerialiser},nd.RELEASE_SESSION_LOCK={id:116,request:$h.SessionLockAcquisitionSerialiser,response:Hh.BooleanSerialiser};var od={};Object.defineProperty(od,"__esModule",{value:!0}),od.responseSuccess=void 0,od.responseSuccess=function(e,t){return!e};var id={},sd=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},ad=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(id,"__esModule",{value:!0}),id.InternalSessionLocks=void 0;var ud=Xu.create("diffusion.locks.SessionLocks"),cd=function(){function e(e,t,r){var n=this;this.owned=!0,this.acquisition=e,this.unlockSessionLock=r,t.setOwned=function(e){n.owned=e}}return e.prototype.toString=function(){return"SessionLock [name="+this.acquisition.lockName+", sequence="+this.acquisition.sequence+", scope="+this.acquisition.scope+", owned="+this.owned+"]"},e.prototype.getName=function(){return this.acquisition.lockName},e.prototype.getSequence=function(){return this.acquisition.sequence},e.prototype.isOwned=function(){return this.owned},e.prototype.getScope=function(){return this.acquisition.scope},e.prototype.unlock=function(){return this.owned?(this.owned=!1,this.unlockSessionLock(this.acquisition)):Promise.resolve(!1)},e}(),ld=function(){function e(e,t){var r=this;this.locks={},this.nextRequestId=0,this.serviceLocator=e.getServiceLocator(),this.ACQUIRE_SESSION_LOCK=this.serviceLocator.obtain(nd.ACQUIRE_SESSION_LOCK),this.RELEASE_SESSION_LOCK=this.serviceLocator.obtain(nd.RELEASE_SESSION_LOCK);var n=null;t.on("change",(function(t,o){return sd(r,void 0,void 0,(function(){var t,r=this;return ad(this,(function(i){switch(i.label){case 0:return t=function(e){e.ownedSetter.setOwned(!1),e.onRemoveLock()},o!==Ba.InternalSessionState.DISCONNECTED?[3,2]:(Object.values(this.locks).filter((function(e){return e.lock.getScope()===Qh.SessionLockScope.UNLOCK_ON_CONNECTION_LOSS})).forEach(t),[4,e.getConversationSet().newConversation({onOpen:function(){},onResponse:function(){return!0},onDiscard:function(){Object.values(r.locks).forEach(t),r.locks={}}})]);case 1:return n=i.sent(),[3,3];case 2:o===Ba.InternalSessionState.CONNECTED?null!==n&&(e.getConversationSet().respondIfPresent(n,null),n=null):o===Ba.InternalSessionState.CLOSED&&(Object.values(this.locks).forEach(t),this.locks={}),i.label=3;case 3:return[2]}}))}))}))}return e.prototype.handleAcquisistion=function(e,t,r){var n,o=this.locks[e];return void 0!==o?o.lock.getSequence().equals(t.sequence)?n=o.lock:(o.ownedSetter.setOwned(!1),n=this.createLock(e,t,r)):n=this.createLock(e,t,r),n},e.prototype.createLock=function(e,t,r){var n={setOwned:function(){throw Error("Session lock ownedSetter must be implemented")}},o=new cd(t,n,this.unlock.bind(this)),i=r?{lock:o,ownedSetter:{setOwned:function(e){n.setOwned(e),r.onOwned(e)}},onRemoveLock:function(){r.onRemoveLock()}}:{lock:o,ownedSetter:n,onRemoveLock:function(){}};return this.locks[e]=i,o},e.prototype.unlock=function(e){var t=this;return new Promise((function(r,n){t.RELEASE_SESSION_LOCK.send(e,(function(o,i){o?(ud.debug("Release session lock failed"),n(o)):(void 0!==t.locks[e.lockName]&&t.locks[e.lockName].lock.getSequence().toString(10)===e.sequence.toString(10)&&delete t.locks[e.lockName],r(i))}))}))},e.prototype.lock=function(e,t,r){var n=this;return void 0===t&&(t=Qh.SessionLockScope.UNLOCK_ON_SESSION_LOSS),new Promise((function(o,i){if(void 0!==n.locks[e]&&n.locks[e].lock.isOwned())r?i(new Error("Cannot register the same lock in different shared sessions")):o(n.locks[e].lock);else{var s=n.nextRequestId++;n.ACQUIRE_SESSION_LOCK.send({lockName:e,requestId:s,scope:t},(function(t,s){if(od.responseSuccess(t,s)){var a=n.handleAcquisistion(e,s,r);o(a)}else ud.debug("Acquire session lock failed"),i(t)}))}}))},e}();id.InternalSessionLocks=ld;var pd={};function fd(){return{type:ic.PROTOCOL.TYPE,version:ic.PROTOCOL.CURRENT_VERSION,capabilities:ic.PROTOCOL.CAPABILITIES}}Object.defineProperty(pd,"__esModule",{value:!0}),pd.reconnect=pd.connect=void 0,pd.connect=fd,pd.reconnect=function(e,t,r){return Object.assign(fd(),{token:e,availableClientSequence:t,lastServerSequence:r})};var hd={};function dd(e,t){return{id:e,message:t}}Object.defineProperty(hd,"__esModule",{value:!0}),hd.isSuccess=hd.responseCodes=void 0,hd.responseCodes={OK:dd(100,"Connected successfully"),DOWNGRADE:dd(102,"Server does not support the requested protocol level"),RECONNECTED:dd(105,"Reconnected successfully"),RECONNECTED_WITH_MESSAGE_LOSS:dd(106,"Reconnected with message loss"),LICENSE_EXCEEDED:dd(113,"Connection rejected due to license limit"),RECONNECTION_UNSUPPORTED:dd(114,"Reconnection not supported by connector"),CONNECTION_PROTOCOL_ERROR:dd(115,"Connection failed - protocol error"),AUTHENTICATION_FAILED:dd(116,"Connection failed - authentication failed"),UNKNOWN_SESSION:dd(117,"Reconnection failed - the session is unknown"),RECONNECTION_FAILED_MESSAGE_LOSS:dd(118,"Reconnection failed due to message loss"),REJECTED_SERVER_INITIALISING:dd(119,"Connection rejected because the server is not ready")},Sc.enumerize(hd.responseCodes),hd.isSuccess=function(e){switch(e){case hd.responseCodes.OK:case hd.responseCodes.RECONNECTED:case hd.responseCodes.RECONNECTED_WITH_MESSAGE_LOSS:return!0;default:return!1}};var yd={};function vd(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=e.length);for(var o=r;o<n;++o)e[o]=t}Object.defineProperty(yd,"__esModule",{value:!0}),yd.ofSize=yd.fill=yd.remove=void 0,yd.remove=function(e,t){var r=e.indexOf(t);return r>-1&&(e.splice(r,1),!0)},yd.fill=vd,yd.ofSize=function(e,t){var r=[];return r.length=e,void 0!==t&&vd(r,t),r};var Sd={};Object.defineProperty(Sd,"__esModule",{value:!0}),Sd.StreamRegistryImpl=void 0;var _d=function(){function e(e){this.streams=new Map,this.fallbacks=[],this.topicCache=e}return e.prototype.add=function(e,t){var r=this.streams.get(e);r?r.push(t):this.streams.set(e,[t]),this.topicCache.newStream(e,t,this),t.onOpen()},e.prototype.addFallback=function(e){this.fallbacks.push(e)},e.prototype.getFallbacks=function(e){return this.fallbacks.filter((function(t){return t.selects(e)}))},e.prototype.remove=function(e){var t=this;yd.remove(this.fallbacks,e),this.streams.forEach((function(r,n){yd.remove(r,e)&&t.topicCache.removeStream(e,t),0===r.length&&t.streams.delete(n)}))},e.prototype.streamsFor=function(e,t){var r=[];return this.streams.forEach((function(n,o){o.selects(e)&&(r=r.concat(n.filter((function(e){return e.selects(t)})).map((function(e){return e.adapter?e.adapter(t):e}))))})),r},e.prototype.close=function(){this.topicCache.clear(),this.streams.forEach((function(e){e.forEach((function(e){e.onSubscriptionError(_c.ErrorReason.SESSION_CLOSED)}))})),this.fallbacks.forEach((function(e){e.onSubscriptionError(_c.ErrorReason.SESSION_CLOSED)}))},e}();Sd.StreamRegistryImpl=_d;var Ed={};Object.defineProperty(Ed,"__esModule",{value:!0}),Ed.TopicCacheEntry=void 0;var wd=Xu.create("TopicCacheEntry"),md=function(){function e(e,t,r){this.streams=e,this.path=t,this.specification=r}return e.prototype.proxies=function(e,t){return 0===this.streams.length?t.getFallbacks(e).map((function(t){return t.adapter?t.adapter(e):t})):this.streams},e.prototype.getTopicPath=function(){return this.path},e.prototype.getTopicSpecification=function(){return this.specification},e.prototype.notifyInitialSubscription=function(e){var t=this;this.proxies(this.specification,e).forEach((function(e){e.onSubscription(t.path,t.specification)}))},e.prototype.notifySubscription=function(e){e.onSubscription(this.path,this.specification),this.notifyValueToNewStream(this.path,this.specification,e)},e.prototype.notifyUnsubscription=function(e,t){var r=this;this.proxies(this.specification,t).forEach((function(t){t.onUnsubscription(r.path,r.specification,e)}))},e.prototype.notifyValue=function(e,t,r,n,o){var i=this;this.proxies(this.specification,o).forEach((function(o){try{o.onValue(i.path,i.specification,e,t,r,n)}catch(e){wd.error("Invalid data",e)}}))},e.prototype.notifyDelta=function(e,t,r,n,o,i){var s=this;this.proxies(this.specification,i).forEach((function(i){i.onDelta(s.path,s.specification,e,t,r,n,o)}))},e.prototype.addStream=function(e,t){var r=this;0===this.streams.length&&t.getFallbacks(this.specification).forEach((function(e){e.onUnsubscription(r.path,r.specification,Uc.UnsubscribeReasonEnum.STREAM_CHANGE)})),this.streams.indexOf(e)<0&&(this.streams.push(e),this.notifySubscription(e))},e.prototype.removeStream=function(e,t){var r=this;yd.remove(this.streams,e),0===this.streams.length&&t.getFallbacks(this.specification).forEach((function(e){try{r.notifySubscription(e)}catch(e){wd.error("Invalid data",e)}}))},e.prototype.removeAllStreams=function(){this.streams.length=0},e}();Ed.TopicCacheEntry=md;var gd={},Td=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gd,"__esModule",{value:!0}),gd.DatatypeCacheEntry=void 0;var Od=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n)||this;return i.datatype=o,n.properties&&n.properties.DONT_RETAIN_VALUE&&(i.dontRetainValue=JSON.parse(n.properties.DONT_RETAIN_VALUE)),i}return Td(t,e),t.prototype.handleValue=function(e,t,r){var n=this.value,o=this.buffer||null;try{var i=this.datatype.readValue(e);this.notifyValue(o,e,n,i,t),this.dontRetainValue||(this.value=i,this.buffer=e)}catch(e){r(e)}},t.prototype.handleDelta=function(e,t,r){var n=this.value,o=this.buffer||null;try{var i=this.datatype.deltaType("binary"),s=i.readDelta(e),a=i.applyImpl(n,s,this.buffer?new sl.BufferSlice(this.buffer):void 0),u=a.value,c=a.cbor;this.value=u,this.buffer=c.$buffer,this.notifyDelta(o,c.$buffer,s,n,this.value,t)}catch(e){r(e)}},t.prototype.notifyValueToNewStream=function(e,t,r){this.buffer&&r.onValue(e,t,null,this.buffer,null,this.value)},t}(Ed.TopicCacheEntry);gd.DatatypeCacheEntry=Od;var Id={},bd=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Id,"__esModule",{value:!0}),Id.NoValueEntry=void 0;var Rd=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return bd(t,e),t.prototype.handleValue=function(e,t){this.notifyValue(null,e,null,e,t)},t.prototype.handleDelta=function(e,t){this.notifyDelta(null,e,null,null,e,t)},t.prototype.notifyValueToNewStream=function(){},t}(Ed.TopicCacheEntry);Id.NoValueEntry=Rd;var Cd={},Ad=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Cd,"__esModule",{value:!0}),Cd.TimeSeriesCacheEntry=void 0;var Pd=f({}),Nd=function(e){function t(t,r,n,o){return e.call(this,t,r,n,Pd.TimeSeriesEventDataType.create(o))||this}return Ad(t,e),t}(gd.DatatypeCacheEntry);Cd.TimeSeriesCacheEntry=Nd;var Md={},Dd=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Md,"__esModule",{value:!0}),Md.TopicCache=void 0;var jd=function(){function e(e){this.byPath={},this.byId={},this.datatypes=e}return e.prototype.handleSubscription=function(e,t){var r,n=e.path,o=t.streamsFor(n,e.specification);switch(e.specification.type){case Dc.TopicTypeEnum.JSON:case Dc.TopicTypeEnum.BINARY:case Dc.TopicTypeEnum.STRING:case Dc.TopicTypeEnum.DOUBLE:case Dc.TopicTypeEnum.INT64:case Dc.TopicTypeEnum.RECORD_V2:var i=this.datatypes.get(e.specification.type);if(null===i)throw new va.InternalError("Invalid topic type");r=new gd.DatatypeCacheEntry(o,n,e.specification,i);break;case Dc.TopicTypeEnum.TIME_SERIES:var s=this.datatypes.get(e.specification.properties.TIME_SERIES_EVENT_VALUE_TYPE);if(null===s)throw new va.InternalError("Invalid timeseries event type");r=new Cd.TimeSeriesCacheEntry(o,n,e.specification,s);break;default:r=new Id.NoValueEntry(o,n,e.specification)}var a=this.byPath[n];if(this.byPath[n]=r,a)throw new va.InternalError("Existing cache entry for "+n);var u=this.byId[e.id];if(this.byId[e.id]=r,u)throw new va.InternalError("Existing cache entry for "+e.id);r.notifyInitialSubscription(t)},e.prototype.notifyUnsubscriptionOfAllTopics=function(e){for(var t in this.byId)this.byId[t].notifyUnsubscription(Uc.UnsubscribeReasonEnum.SUBSCRIPTION_REFRESH,e);this.byPath={},this.byId={}},e.prototype.handleValue=function(e,t,r,n){var o=n.getErrorHandler(),i=this.byId[e];i?i.handleValue(t,r,o):o(new va.SessionError("Data loss on topic with ID: "+e+" - possibly due to reconnection"))},e.prototype.handleDelta=function(e,t,r,n){var o=n.getErrorHandler(),i=this.byId[e];i?i.handleDelta(t,r,o):o(new va.SessionError("Data loss on topic with ID: "+e+" - possibly due to reconnection"))},e.prototype.handleUnsubscription=function(e,t,r){var n=this.byId[e];if(delete this.byId[e],n){var o=n.getTopicPath();delete this.byPath[o],n.notifyUnsubscription(t,r)}},e.prototype.newStream=function(e,t,r){for(var n in this.byPath)if(this.byPath.hasOwnProperty(n)){var o=this.byPath[n],i=o.getTopicSpecification();e.selects(n)&&t.selects(i)&&o.addStream(t.adapter?t.adapter(i):t,r)}},e.prototype.removeStream=function(e,t){for(var r in this.byPath)this.byPath.hasOwnProperty(r)&&this.byPath[r].removeStream(e,t)},e.prototype.removeAllStreams=function(){var e,t;try{for(var r=Dd(Object.getOwnPropertyNames(this.byPath)),n=r.next();!n.done;n=r.next()){var o=n.value;this.byPath[o].removeAllStreams()}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.clear=function(){this.byPath={},this.byId={}},e}();Md.TopicCache=jd;var Ld={};Object.defineProperty(Ld,"__esModule",{value:!0}),Ld.cidFromHeaders=void 0,Ld.cidFromHeaders=function(e){if(!e||0===e.length)throw new va.IOError("Empty headers, expected at least 1");return fu.ConversationId.fromString(e[e.length-1])};var xd={};Object.defineProperty(xd,"__esModule",{value:!0}),xd.TopicRouting=void 0;var Ud=Xu.create("V4 Client Routing"),Bd=function(){function e(e,t,r,n,o){this.errorHandler=e,this.serviceAdapter=t,this.conversationSet=r,this.cache=n,this.registry=o}return e.prototype.route=function(e){switch(e.type){case cc.types.FETCH_REPLY:var t=Ld.cidFromHeaders(e.headers);this.conversationSet.respondIfPresent(t,e);break;case cc.types.SERVICE_REQUEST:case cc.types.SERVICE_RESPONSE:case cc.types.SERVICE_ERROR:this.serviceAdapter.onMessage(e.type,e.getInputStream());break;case cc.types.TOPIC_VALUE:this.cache.handleValue(e.id,e.data,this.registry,this.errorHandler);break;case cc.types.TOPIC_DELTA:this.cache.handleDelta(e.id,e.data,this.registry,this.errorHandler);break;default:Ud.debug("Unhandled V4 message: "+e.type,e)}},e.prototype.subscribe=function(e){this.cache.handleSubscription(e,this.registry)},e.prototype.unsubscribe=function(e,t){this.cache.handleUnsubscription(e,t,this.registry)},e}();xd.TopicRouting=Bd;var qd={};Object.defineProperty(qd,"__esModule",{value:!0}),qd.SessionId=void 0;var Vd=function(){function e(e,t){this.server=e,this.value=t}return e.fromString=function(t){var r,n=t.split("-");if(2!==n.length)throw new va.IllegalArgumentError("SessionId must consist of two hexadecimal parts, joined with a '-'");try{r=new e(ka.fromString(n[0],!1,16),ka.fromString(n[1],!1,16))}catch(e){throw new va.IllegalArgumentError("SessionId must consist of two hexadecimal parts, joined with a '-'")}return r},e.validate=function(t){if(t instanceof e)return t;if(0===t.length||t.indexOf("-")<0||t.indexOf(" ")>=0)return!1;try{return e.fromString(t)}catch(e){return!1}},e.prototype.toString=function(){var e="0000000000000000"+this.server.toUnsigned().toString(16),t="0000000000000000"+this.value.toUnsigned().toString(16);return(e.substr(e.length-16)+"-"+t.substr(t.length-16)).toLowerCase()},e}();qd.SessionId=Vd;var kd={};Object.defineProperty(kd,"__esModule",{value:!0}),kd.SessionToken=kd.TOKEN_LENGTH=void 0,kd.TOKEN_LENGTH=24;var Fd=function(){function e(e){this.external=e}return e.prototype.toString=function(){return Ou.uint8ToAscii(this.external)},e}();kd.SessionToken=Fd;var Gd={};Object.defineProperty(Gd,"__esModule",{value:!0}),Gd.readSessionToken=void 0,Gd.readSessionToken=function(e){return new kd.SessionToken(e.readMany(kd.TOKEN_LENGTH))};var Hd={},Yd=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Hd,"__esModule",{value:!0}),Hd.deserialise=Hd.DeserialisationErrorReason=void 0;var Wd,zd=Xu.create("Cascading");!function(e){e[e.UNRECOGNISED_PROTOCOL_BYTE=0]="UNRECOGNISED_PROTOCOL_BYTE",e[e.PROTOCOL_VERSION_MISMATCH=1]="PROTOCOL_VERSION_MISMATCH"}(Wd=Hd.DeserialisationErrorReason||(Hd.DeserialisationErrorReason={}));var Qd=function(e){function t(t,r){var n=e.call(this,t)||this;return n.reason=r,n}return Yd(t,e),t}(Error);Hd.deserialise=function(e){var t=new tc.BufferInputStream(e),r=t.read();if(r!==ic.PROTOCOL.PROTOCOL_BYTE)throw new Qd("Unrecognised protocol byte: "+r,Wd.UNRECOGNISED_PROTOCOL_BYTE);var n=t.read();if(n!==ic.PROTOCOL.CURRENT_VERSION){if(zd.debug("Server responded with protocol version "+n+". Client version is "+ic.PROTOCOL.CURRENT_VERSION+"."),n<ic.PROTOCOL.CURRENT_VERSION)throw new Qd("Unrecognised protocol version: "+n,Wd.PROTOCOL_VERSION_MISMATCH);if(n>ic.PROTOCOL.CURRENT_VERSION)throw new Qd("Unsupported protocol version: "+n,Wd.PROTOCOL_VERSION_MISMATCH)}var o=Wh.read(t,hd.responseCodes);if(hd.isSuccess(o)){var i=new qd.SessionId(t.readUInt64(),t.readUInt64()),s=Gd.readSessionToken(t),a=t.readInt64(),u=0,c=-1;return o===hd.responseCodes.RECONNECTED?u=t.readInt32():c=t.readInt32(),{response:o,identity:i,token:s,systemPingPeriod:a,version:n,success:!0,sequence:u,maximumMessageSize:c}}return{response:o,version:n,identity:null,token:null,systemPingPeriod:null,success:!1,sequence:0,maximumMessageSize:-1}};var Kd={};Object.defineProperty(Kd,"__esModule",{value:!0}),Kd.connectionResponse=void 0;var Jd=Xu.create("Parsing");Kd.connectionResponse=function(e,t,r){Jd.trace("Received connection handshake response");try{return e(Hd.deserialise(r))}catch(e){return t(e),null}};var $d={},Xd={};Object.defineProperty(Xd,"__esModule",{value:!0}),Xd.Subtransports=void 0;var Zd=Xu.create("Transports");function ey(){return"function"==typeof WebSocket?(Zd.debug("Using native websocket"),{factory:WebSocket,enabled:!0,allowsOptions:!1}):"function"==typeof $d?(Zd.debug("Using Node WS library"),{factory:$d,enabled:!0,allowsOptions:!0}):(Zd.debug("Websocket transport not available"),{enabled:!1,allowsOptions:!1})}function ty(){return"function"==typeof XMLHttpRequest?(Zd.debug("Using native XHR"),{factory:XMLHttpRequest,enabled:!0,allowsOptions:!1}):(Zd.debug("XHR transport not available"),{enabled:!1,allowsOptions:!1})}Xd.Subtransports=Object.freeze({WS:ey(),XHR:ty(),WEBSOCKET:ey(),HTTP_POLLING:ty()});var ry,ny={};Object.defineProperty(ny,"__esModule",{value:!0}),ny.write=ny.read=void 0,function(e){e[e.NONE=0]="NONE",e[e.PLAIN=1]="PLAIN",e[e.CUSTOM=2]="CUSTOM"}(ry||(ry={})),ny.read=function(e){switch(Wh.read(e,ry)){case ry.PLAIN:return Iu.readString(e)||null;case ry.CUSTOM:return Iu.readBytes(e);case ry.NONE:default:return Iu.readBytes(e),null}},ny.write=function(e,t){null!=t?"string"==typeof t?(Wh.write(e,ry.PLAIN),Iu.writeString(e,t)):(Wh.write(e,ry.CUSTOM),Iu.writeBytes(e,t)):(Wh.write(e,ry.NONE),Iu.writeInt32(e,0))};var oy={};Object.defineProperty(oy,"__esModule",{value:!0}),oy.encodeAsString=void 0,oy.encodeAsString=function(e){var t=new nc.BufferOutputStream;return ny.write(t,e),t.getBase64()};var iy={},sy=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ay=this&&this.__assign||function(){return(ay=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(iy,"__esModule",{value:!0}),iy.WSTransport=void 0;var uy=Xu.create("Websocket transport");var cy=function(e){function t(t,r,n){var o=this,i=Gh.Emitter.create();return(o=e.call(this,i)||this).emitter=i.emitter(o),o.opts=t,o.ws=r,o.allowsOptions=n,o}return sy(t,e),t.prototype.handler=function(e){e.data.length>this.opts.maxMessageSize?this.emitter.error(new Error("Received message of size: "+e.data.length+", exceeding max message size: "+this.opts.maxMessageSize)):this.emitter.immediate("data",new Uint8Array(e.data))},t.prototype.connect=function(e,t){var r=this,n={};if(void 0!==this.opts.httpProxyAgent){if(!this.allowsOptions)throw new va.IllegalArgumentError("httpProxyAgent option is not allowed");n.agent=this.opts.httpProxyAgent}if(void 0!==this.opts.tlsOptions){if(!this.allowsOptions)throw new va.IllegalArgumentError("tlsOptions option are not allowed");n=ay(ay({},n),this.opts.tlsOptions)}try{var o=function(e,t){var r=(t.secure?"wss":"ws")+"://"+t.host+":"+t.port+t.path;return r+="?ty="+e.type,r+="&v="+e.version,r+="&ca="+e.capabilities,r+="&r="+t.reconnect.timeout,e.token&&(r+="&c="+encodeURIComponent(e.token),r+="&cs="+e.availableClientSequence,r+="&ss="+e.lastServerSequence),t.properties&&(r+="&sp="+encodeURIComponent(JSON.stringify(t.properties))),void 0!==t.principal&&(r+="&username="+encodeURIComponent(t.principal),r+="&password="+encodeURIComponent(oy.encodeAsString(t.credentials))),r}(e,this.opts);this.socket=0===Object.keys(n).length?new this.ws(o):new this.ws(o,n),uy.debug("Created websocket",o)}catch(e){throw new va.RuntimeError("Unable to construct WebSocket "+e)}this.socket.binaryType="arraybuffer",this.socket.onmessage=function(e){r.socket.onmessage=r.handler.bind(r),r.socket.onerror=function(e){r.emitter.error(e)},t(new Uint8Array(e.data))},this.socket.onclose=function(e){r.emitter.close(e)},this.socket.onerror=function(e){r.emitter.close(e)}},t.prototype.dispatch=function(e){uy.debug("Sending websocket message",e);try{return this.socket.send(e),!0}catch(e){return uy.error("Websocket send error",e),!1}},t.prototype.close=function(){var e=this;if(uy.debug("Closing websocket"),void 0!==this.socket)try{this.socket.onerror=function(t){e.emitter.close(t)},this.socket.close(1e3)}catch(e){}return this},t}(Vh.StreamImpl);iy.WSTransport=cy;var ly={};Object.defineProperty(ly,"__esModule",{value:!0}),ly.Queue=void 0;var py=function(){function e(){this.messages=[]}return e.prototype.length=function(){return this.messages.length},e.prototype.add=function(e){this.messages.push(e)},e.prototype.drain=function(){return this.messages.splice(0,this.messages.length)},e.prototype.isEmpty=function(){return 0===this.messages.length},e}();ly.Queue=py;var fy={},hy=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dy=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(fy,"__esModule",{value:!0}),fy.XHRTransport=void 0;var yy=Xu.create("XHR transport");var vy=function(e){function t(t,r){var n=this,o=Gh.Emitter.create();return(n=e.call(this,o)||this).emitter=o.emitter(n),n.opts=t,n.protocolVersion=null,n.pollSequence=0,n.pingSequence=0,n.pollRequest=null,n.aborted=!1,n.isSending=!1,n.queue=new ly.Queue,n.xhr=r,n}return hy(t,e),t.prototype.connect=function(e,t){var r=this;try{var n=function(e,t){var r=(t.secure?"https":"http")+"://"+t.host+":"+t.port+t.path,n={m:"0",ty:"B",ca:e.capabilities,r:t.reconnect.timeout,v:e.version};return void 0!==e.token&&(n.c=e.token,n.cs=e.availableClientSequence,n.ss=e.lastServerSequence),t.properties&&(n.sp=encodeURIComponent(JSON.stringify(t.properties))),void 0!==t.principal&&(n.username=encodeURIComponent(t.principal),n.password=oy.encodeAsString(t.credentials)),{uri:r,headers:n}}(e,this.opts);this.protocolVersion=n.headers.v,this.URI=n.uri;var o=this.createRequest(n.headers,n.uri);yy.debug("Created XHR",n.uri),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){var e=o.responseText,n=t(Ou.uint8FromBinary(e));if(!n)return;r.token=n.token;var i=n.response;hd.isSuccess(i)?r.poll():(yy.debug(i.id+" - "+i.message),r.emitter.close())}else r.emitter.close()},o.send(null)}catch(e){throw new va.RuntimeError("Unable to create polling transport "+e)}},t.prototype.close=function(){return yy.trace("Closing XHR transport"),this.pollRequest&&(this.aborted=!0,this.pollRequest.abort()),this.queue=new ly.Queue,this.emitter.close(),this},t.prototype.createRequest=function(e,t){var r,n,o=new this.xhr;o.open("POST",t,!0),o.overrideMimeType("text/plain; charset=x-user-defined");try{for(var i=dy(Object.getOwnPropertyNames(e)),s=i.next();!s.done;s=i.next()){var a=s.value;try{o.setRequestHeader(a,e[a])}catch(t){yy.warn("Can't set header "+a+":"+e.join(":"))}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},t.prototype.poll=function(){var e=this,t=this.createRequest({m:"1",c:this.token,s:this.pollSequence++,v:this.protocolVersion},this.URI);t.onreadystatechange=function(){if(4===t.readyState)if("reconnect"===t.getResponseHeader("diffusion-connection"))e.emitter.close();else if(200===t.status){e.aborted||e.poll();for(var r=t.responseText,n=new tc.BufferInputStream(Ou.uint8FromBase64(r));n.pos!==n.count;){var o=n.readInt32();if(o>e.opts.maxMessageSize)return void e.emitter.error(new Error("Received message of size: "+o+", exceeding max message size: "+e.opts.maxMessageSize));var i=n.read(),s=n.readMany(o),a=new Uint8Array(s.length+1);a[0]=i,a.set(s,1),e.emitter.emit("data",a)}}else e.emitter.close()},this.pollRequest=t,t.send(null)},t.prototype.dispatch=function(e){return!this.aborted&&(this.queue.add(e),!!this.isSending||void this.flush())},t.prototype.flush=function(){var e=this;if(!this.queue.isEmpty()){var t=function(e){var t,r,n=new nc.BufferOutputStream;try{for(var o=dy(e),i=o.next();!i.done;i=o.next()){var s=i.value;n.writeInt32(s.length-1),n.writeMany(s,0,s.length)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n.getBuffer()}(this.queue.drain()),r=this.createRequest({m:"2",c:this.token,s:this.pingSequence++,v:this.protocolVersion},this.URI);r.onreadystatechange=function(){4===r.readyState&&("reconnect"===r.getResponseHeader("diffusion-connection")?e.emitter.close():200===r.status?(e.isSending=!1,e.flush()):e.emitter.close())},this.isSending=!0,r.send(Ou.uint8ToBase64(t))}},t}(Vh.StreamImpl);fy.XHRTransport=vy;var Sy={},_y=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ey=this&&this.__assign||function(){return(Ey=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},wy=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},my=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};Object.defineProperty(Sy,"__esModule",{value:!0}),Sy.Transports=void 0;var gy=Xu.create("Cascading"),Ty=Object.freeze({WS:iy.WSTransport,XHR:fy.XHRTransport,WEBSOCKET:iy.WSTransport,HTTP_POLLING:fy.XHRTransport});function Oy(e,t,r){var n=Ty[r],o=e[r];if(n&&o&&o.enabled)return new n(t,o.factory,o.allowsOptions);throw new va.InternalError("Unknown transport name: "+r)}var Iy=function(e){function t(t,r,n,o){var i=this,s=Gh.Emitter.create();return(i=e.call(this,s)||this).emitter=s.emitter(i),i.transports=n,i.remainingTransports=my([],wy(n)),i.cascadeNotifications=o,i.name=null,i.req=null,i.responseReceived=!1,i.transportFactory=Oy.bind(null,t,r),i.transport=i.selectTransport(),i.onData=i.onData.bind(i),i.onClose=i.onClose.bind(i),i.onError=i.onError.bind(i),i.onConnectionResponse=i.onConnectionResponse.bind(i),i.onParsingError=i.onParsingError.bind(i),i.retryStrategy=Ey({},r.retry),i}return _y(t,e),t.prototype.onData=function(e){this.emitter.immediate("data",e)},t.prototype.onClose=function(e){!this.responseReceived&&this.cascade(!0)||this.emitter.emit("close",e)},t.prototype.onError=function(e){this.emitter.emit("error",e)},t.prototype.onConnectionResponse=function(e){return this.responseReceived=!0,function(e){return e===hd.responseCodes.ERROR}(e.response)&&this.cascade()?null:this.onHandshakeSuccess(e)},t.prototype.onParsingError=function(e){this.responseReceived=!0,this.cascade()||this.onHandshakeError(e)},t.prototype.closeQuietly=function(){this.transport&&(this.transport.off("data",this.onData),this.transport.off("close",this.onClose),this.transport.off("error",this.onError),this.transport.close(),this.transport=null)},t.prototype.selectTransport=function(e){return void 0===e&&(e=!1),0===this.remainingTransports.length?(this.name=null,this.transport=null,gy.debug("Transports exhausted"),this.retryStrategy.attempts<=0&&(this.cascadeNotifications.emit("transports-exhausted"),e||this.emitter.emit("close")),null):(this.name=this.remainingTransports.shift(),this.transport=this.transportFactory(this.name),gy.debug("Selecting transport",this.name),this.cascadeNotifications.emit("transport-selected",this.name),this.transport)},t.prototype.internalConnect=function(){if(null===this.transport)throw new va.InternalError("Unable to connect when no transport is set");this.responseReceived=!1,gy.debug("Attempting to connect"),this.cascadeNotifications.emit("cascading-connect"),this.transport.on("data",this.onData),this.transport.on("close",this.onClose),this.transport.on("error",this.onError);try{this.transport.connect(this.req,Kd.connectionResponse.bind(null,this.onConnectionResponse,this.onParsingError))}catch(e){if(!this.cascade())throw e}return!0},t.prototype.cascade=function(e){var t=this;return this.closeQuietly(),this.selectTransport(e)?(this.cascadeNotifications.emit("cascade"),this.internalConnect()):!(this.retryStrategy.attempts!==Sl.MAX_SAFE_INTEGER&&--this.retryStrategy.attempts<0)&&(this.remainingTransports=my([],wy(this.transports)),!!this.selectTransport(e)&&(setTimeout((function(){t.cascadeNotifications.emit("cascade"),t.internalConnect()}),this.retryStrategy.interval),!0))},t.prototype.connect=function(e,t,r){this.req=e,this.onHandshakeSuccess=t,this.onHandshakeError=r,this.internalConnect()},t.prototype.dispatch=function(e){if(null===this.transport)throw new va.InternalError("Unable to send message when no transport is set");this.transport.dispatch(e)},t.prototype.close=function(){return null!==this.transport&&(this.responseReceived=!0,this.transport.close(),this.transport=null),this},t}(Vh.StreamImpl),by=function(e){function t(t){var r=this,n=Gh.Emitter.create();return(r=e.call(this,n)||this).emitter=n.emitter(r),r.subtransports=t,r}return _y(t,e),t.create=function(e){return new t(e||Xd.Subtransports)},t.prototype.get=function(e){var t,r,n=(t=e.transports,r=this.subtransports,t.filter((function(e){return e&&Ty.hasOwnProperty(e)&&r[e].enabled})));return 0===n.length?(gy.warn("No valid transports found"),null):new Iy(this.subtransports,e,n,this.emitter)},t}(Vh.StreamImpl);Sy.Transports=by;var Ry={},Cy=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Ry,"__esModule",{value:!0}),Ry.FSM=void 0;var Ay=function(e){function t(t,r){var n=this,o=Gh.Emitter.create();return(n=e.call(this,o)||this).emitter=o.emitter(n),n.states=r,n.current=r[t],n.state=t,n}return Cy(t,e),t.prototype.change=function(e){return this.state===e||!(!this.states[e]||!("*"===this.current||this.current.indexOf(e)>-1))&&(this.emitter.emit("change",this.state,e),this.current=this.states[e],this.state=e,!0)},t}(Vh.StreamImpl);Ry.FSM=Ay;var Py={};Object.defineProperty(Py,"__esModule",{value:!0}),Py.version=void 0,Py.version="6.11.2";var Ny={};Object.defineProperty(Ny,"__esModule",{value:!0}),Ny.ClientCloseReason=Ny.CloseReasonEnum=void 0,Ny.CloseReasonEnum={CLOSED_BY_CLIENT:new kc.CloseReasonImpl(0,"The session was closed by the client",!1),CLOSED_BY_SERVER:new kc.CloseReasonImpl(1,"The session was closed by the server",!1),RECONNECT_ABORTED:new kc.CloseReasonImpl(2,"Client aborted a reconnect attempt",!1),CONNECTION_TIMEOUT:new kc.CloseReasonImpl(3,"The connection attempt timed out",!1),HANDSHAKE_REJECTED:new kc.CloseReasonImpl(4,"The connection handshake was rejected by the server",!1),HANDSHAKE_ERROR:new kc.CloseReasonImpl(5,"There was an error parsing the handshake response",!1),TRANSPORT_ERROR:new kc.CloseReasonImpl(6,"There was an unexpected error with the connection",!0),CONNECTION_ERROR:new kc.CloseReasonImpl(7,"The client could not establish a connection to the server",!0),IDLE_CONNECTION:new kc.CloseReasonImpl(8,"The activity monitor detected the connection was idle",!0),LOST_MESSAGES:new kc.CloseReasonImpl(16,"Loss of messages has been detected",!1),PROTOCOL_VERSION_MISMATCH:new kc.CloseReasonImpl(17,"Client version rejected : Client should be downgraded to use server compatible version or server upgraded to client version in use",!1),LICENSE_EXCEEDED:new kc.CloseReasonImpl(18,"The license limit was exceeded",!1),ACCESS_DENIED:new kc.CloseReasonImpl(99,"The connection attempt was rejected by the server because authentication failed",!1)},Sc.enumerize(Ny.CloseReasonEnum),function(e){e[e.CONNECTION_LOST=0]="CONNECTION_LOST",e[e.IO_EXCEPTION=1]="IO_EXCEPTION",e[e.CLIENT_UNRESPONSIVE=2]="CLIENT_UNRESPONSIVE",e[e.MESSAGE_QUEUE_LIMIT_REACHED=3]="MESSAGE_QUEUE_LIMIT_REACHED",e[e.CLOSED_BY_CLIENT=4]="CLOSED_BY_CLIENT",e[e.MESSAGE_TOO_LARGE=5]="MESSAGE_TOO_LARGE",e[e.INTERNAL_ERROR=6]="INTERNAL_ERROR",e[e.INVALID_INBOUND_MESSAGE=7]="INVALID_INBOUND_MESSAGE",e[e.ABORTED=8]="ABORTED",e[e.LOST_MESSAGES=9]="LOST_MESSAGES",e[e.CLOSED_BY_CONTROLLER=10]="CLOSED_BY_CONTROLLER",e[e.FAILED_OVER=11]="FAILED_OVER",e[e.SESSION_TAKEN_OVER=12]="SESSION_TAKEN_OVER"}(Ny.ClientCloseReason||(Ny.ClientCloseReason={}));var My={},Dy=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(My,"__esModule",{value:!0}),My.InternalSessionImpl=void 0;var jy=p({}),Ly=Ba.InternalSessionState.INITIALISING,xy=Ba.InternalSessionState.CONNECTING,Uy=Ba.InternalSessionState.CONNECTED,By=Ba.InternalSessionState.DISCONNECTED,qy=Ba.InternalSessionState.RECONNECTING,Vy=Ba.InternalSessionState.CLOSING,ky=Ba.InternalSessionState.CLOSED,Fy=Xu.create("Internal Session"),Gy=function(e){function t(t,r,n,o,i){var s;void 0===i&&(i=xa.sessionActivityMonitorFactory);var a=this,u=Gh.Emitter.create();return(a=e.call(this,u)||this).emitter=u.emitter(a),a.version=Py.version,a.principal="",a.conversationSetFactory=t,a.conversationSet=t(),a.serviceRegistry=r,a.opts=o,a.sessionActivityMonitorFactory=i,a.fsm=new Ry.FSM(Ly,((s={})[Ly]=[xy],s[xy]=[Uy,Vy],s[Uy]=[By,Vy,ky],s[By]=[qy,Vy],s[qy]=[Uy,Vy],s[Vy]=[ky],s[ky]=[],s)),a.fsm.on("change",(function(e,t){Fy.debug("State changed: "+e+" -> "+t)})),a.transports=Sy.Transports.create(),a.transports.on({"transport-selected":function(e){a.emitter.emit("transport-selected",e)},cascade:function(){a.emitter.emit("cascade")}}),a.connection=n(a.transports,a.opts.reconnect.timeout,256),a.serviceAdapter=new Ec.ServiceAdapter(a,(function(e){a.connection.send(e)})),a.serviceLocator=new Tc.ServiceLocatorImpl(a,a.serviceAdapter),a.topicCache=new Md.TopicCache(jy.DataTypes),a.topicStreamRegistry=new Sd.StreamRegistryImpl(a.topicCache),a.topicRouting=new xd.TopicRouting(a,a.serviceAdapter,a.conversationSet,a.topicCache,a.topicStreamRegistry),a.serviceRegistry.addListener(a.serviceAdapter.addService.bind(a.serviceAdapter)),void 0!==id.InternalSessionLocks&&(a.sessionLocksFeature=new id.InternalSessionLocks(a,a.fsm)),a.attempts=0,a}return Dy(t,e),Object.defineProperty(t.prototype,"sessionLocks",{get:function(){if(void 0===this.sessionLocksFeature){if(void 0===id.InternalSessionLocks)throw new va.RuntimeError("Session Locks feature has not been loaded");this.sessionLocksFeature=new id.InternalSessionLocks(this,this.fsm)}return this.sessionLocksFeature},enumerable:!1,configurable:!0}),t.prototype.getOptions=function(){return this.opts},t.prototype.getState=function(){return this.fsm.state},t.prototype.onStateChange=function(e){this.fsm.on("change",e)},t.prototype.getConversationSet=function(){return this.conversationSet},t.prototype.isConnected=function(){return this.fsm.state===Uy},t.prototype.getServiceRegistry=function(){return this.serviceRegistry},t.prototype.getSessionId=function(){return this.sessionID},t.prototype.getServerMaximumMessageSize=function(){return this.serverMaximumMessageSize},t.prototype.checkConnected=function(e){return!!this.isConnected()||(e(new Error("The session is not connected. Operations are not possible at this time.")),!1)},t.prototype.internalClose=function(e){this.fsm.change(ky)?(this.topicStreamRegistry.close(),this.conversationSet.discardAll(e),this.emitter.close(e)):Fy.debug("Unable to handle session close, session state: ",this.fsm.state)},t.prototype.reconnect=function(e,t){if(this.fsm.change(qy)){Fy.info("Reconnect attempt ("+ ++this.attempts+")");var r=pd.reconnect(t,this.connection.getAvailableSequence(),this.connection.lastReceivedSequence);this.connection.connect(r,e,e.reconnect.timeout)}else Fy.debug("Unable to attempt reconnect, session state: ",this.fsm.state)},t.prototype.abort=function(e){void 0===e&&(e=Ny.CloseReasonEnum.RECONNECT_ABORTED),this.fsm.change(Vy)?(Fy.debug("Aborting reconnect"),this.internalClose(e)):Fy.debug("Unable to abort reconnect, session state: ",this.fsm.state)},t.prototype.replaceConversationSet=function(e){var t=this.conversationSet;this.conversationSet=this.conversationSetFactory(),t.discardAll(e),Fy.debug("Replaced conversation set",e)},t.prototype.connect=function(){var e=this;if(this.fsm.change(xy)){var t,r=pd.connect();this.connection.on("data",this.topicRouting.route.bind(this.topicRouting)),this.connection.on("close",this.internalClose.bind(this)),this.sessionActivityMonitor=this.opts.activityMonitor?this.sessionActivityMonitorFactory.create(ja.connectionActivityMonitorFactory):this.sessionActivityMonitorFactory.NOOP,this.connection.on("disconnect",(function(r){Fy.debug("Connection disconnected, reason: ",r),e.fsm.change(By)||e.fsm.state===qy?(e.sessionActivityMonitor.onConnectionClosed(),e.opts.reconnect.timeout>0&&r.canReconnect?(e.fsm.state===By&&(e.emitter.emit("disconnect",r),t=setTimeout((function(){e.fsm.state!==Uy&&e.abort(Ny.CloseReasonEnum.CONNECTION_TIMEOUT)}),e.opts.reconnect.timeout)),e.opts.reconnect.strategy(e.reconnect.bind(e,e.opts,e.token),e.abort.bind(e),r)):e.abort(r)):e.fsm.change(Vy)?e.internalClose(r):(e.sessionActivityMonitor.onConnectionClosed(),Fy.debug("Unable to handle session disconnect, session state: ",e.fsm.state))})),this.connection.on("connect",(function(r){e.fsm.change(Uy)?(e.token=r.token,r.response===hd.responseCodes.OK?(e.sessionID=r.identity,e.serverMaximumMessageSize=r.maximumMessageSize,e.sessionActivityMonitor.onNewConnection(e.connection,r),e.emitter.emit("connect",r.identity)):r.response!==hd.responseCodes.RECONNECTED&&r.response!==hd.responseCodes.RECONNECTED_WITH_MESSAGE_LOSS||(e.attempts=0,clearTimeout(t),r.response===hd.responseCodes.RECONNECTED_WITH_MESSAGE_LOSS?(e.connection.resetSequences(),e.replaceConversationSet(new Error("Peer is disconnected")),e.topicCache.notifyUnsubscriptionOfAllTopics(e.topicStreamRegistry),Fy.info("Reconnected session, but messages may have been lost")):Fy.info("Reconnected session"),e.sessionActivityMonitor.onNewConnection(e.connection,r),e.emitter.emit("reconnect"))):Fy.trace("Unknown connection response: ",r)})),Fy.debug("Connecting with options:",this.opts),Fy.trace("Connecting with request:",r);try{this.connection.connect(r,this.opts,this.opts.connectionTimeout)}catch(e){Fy.warn("Connection error",e),this.emitter.emit("error",e),this.fsm.change(Vy)&&this.internalClose(Ny.CloseReasonEnum.CONNECTION_ERROR)}this.opts.principal&&(this.principal=this.opts.principal)}else Fy.warn("Unable to connect, session state: ",this.fsm.state),this.emitter.emit("error",new Error("Unable to connect, session state: "+this.fsm.state))},t.prototype.close=function(){return this.fsm.change(Vy)?(this.sessionActivityMonitor.onConnectionClosed(),this.connection.close(Ny.CloseReasonEnum.CLOSED_BY_CLIENT)):Fy.debug("Unable to close, session state: ",this.fsm.state),this},t.prototype.getErrorHandler=function(){return function(e){Fy.error("Session error:",e.message)}},t.prototype.getServiceLocator=function(){return this.serviceLocator},t.prototype.getServiceAdapter=function(){return this.serviceAdapter},t.prototype.getPrincipal=function(){return this.principal},t.prototype.setPrincipal=function(e){this.principal=e},t.prototype.getStreamRegistry=function(){return this.topicStreamRegistry},t.prototype.getRouting=function(){return this.topicRouting},t.prototype.onSystemPing=function(){this.sessionActivityMonitor.onSystemPing()},t.prototype.lock=function(e,t,r){return this.sessionLocks.lock(e,t,r)},t.prototype.unlock=function(e){return this.sessionLocks.unlock(e)},t.prototype.isShared=function(){return!1},t.prototype.getContext=function(){return Uh.sessionContext},t.prototype.updateFeatures=function(){void 0===this.sessionLocks&&void 0!==id.InternalSessionLocks&&(this.sessionLocks=new id.InternalSessionLocks(this,this.fsm))},t}(Vh.StreamImpl);My.InternalSessionImpl=Gy;var Hy={};Object.defineProperty(Hy,"__esModule",{value:!0}),Hy.ServiceRegistryImpl=void 0;var Yy=function(){function e(){this.services=new Map,this.listeners=[]}return e.prototype.add=function(e,t){if(this.services.has(e))throw new va.RuntimeError("Service already exists for "+e);this.services.set(e,t),this.listeners.forEach((function(r){r(e,t)}))},e.prototype.addListener=function(e){this.listeners.push(e),this.services.forEach((function(t,r){e(r,t)}))},e}();Hy.ServiceRegistryImpl=Yy;var Wy={};Object.defineProperty(Wy,"__esModule",{value:!0}),Wy.monitoredPingService=void 0,Wy.monitoredPingService={onRequest:function(e,t,r){r.respond(),e.onSystemPing()}};var zy={};Object.defineProperty(zy,"__esModule",{value:!0}),zy.notifySubscriptionService=void 0,zy.notifySubscriptionService={onRequest:function(e,t,r){r.respond(),e.getRouting().subscribe(t)}};var Qy={};Object.defineProperty(Qy,"__esModule",{value:!0}),Qy.notifyUnsubscriptionService=void 0,Qy.notifyUnsubscriptionService={onRequest:function(e,t,r){r.respond(),e.getRouting().unsubscribe(t.id,t.reason)}};var Ky={};Object.defineProperty(Ky,"__esModule",{value:!0}),Ky.pingService=void 0,Ky.pingService={onRequest:function(e,t,r){r.respond()}};var Jy={},$y=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xy=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},Zy=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ev=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Jy,"__esModule",{value:!0}),Jy.create=Jy.ConversationSet=Jy.Result=void 0;var tv,rv=function(){var e=new ka(0);return function(){return Xy(void 0,void 0,void 0,(function(){return Zy(this,(function(t){return e=e.add(1),[2,new fu.ConversationId(e)]}))}))}}();!function(e){e[e.ALREADY_FINISHED=0]="ALREADY_FINISHED",e[e.HANDLED_AND_ACTIVE=1]="HANDLED_AND_ACTIVE",e[e.HANDLED_AND_FINISHED=2]="HANDLED_AND_FINISHED"}(tv=Jy.Result||(Jy.Result={}));var nv=Xu.create("Conversation Set"),ov=function(e){function t(t){var r=e.call(this,t)||this;return r.name="NoSuchConversationError",r}return $y(t,e),t}(Error),iv=function(){function e(e,t){this.reserved=!1,this.closed=!1,this.handler=e,this.completedExceptionally=t}return e.prototype.open=function(e){this.handler.onOpen(e)},e.prototype.respond=function(e,t){if(this.closed)return tv.ALREADY_FINISHED;var r,n=this.reserved;this.reserved=!0;try{r=this.handler.onResponse(e,t)}catch(t){throw this.completedExceptionally(e,this,t),t}return this.closed?(nv.debug("Conversation already closed",e),tv.HANDLED_AND_FINISHED):r?(nv.debug("Response handler closed conversation",e),this.closed=!0,tv.HANDLED_AND_FINISHED):this.pendingDiscard?(nv.debug("Conversation closed with pending reason",e),this.notifyDiscard(e,this.pendingDiscard),tv.HANDLED_AND_FINISHED):(this.reserved=n,tv.HANDLED_AND_ACTIVE)},e.prototype.discard=function(e,t){this.reserved?this.pendingDiscard=t:this.notifyDiscard(e,t)},e.prototype.close=function(){this.closed=!0},e.prototype.notifyDiscard=function(e,t){if(!this.closed){this.closed=!0;try{this.handler.onDiscard(e,t)}catch(t){throw nv.error("Application handler threw exception [cid="+e+"]",t.stack),t}}},e}(),sv=function(){function e(e){this.nextCID=e,this.conversations={}}return e.prototype.completedExceptionally=function(e,t,r){nv.debug("Application handler threw exception [cid="+e+"]",r.stack),t.close(),delete this.conversations[e.toString()]},e.prototype.newConversation=function(e){return Xy(this,void 0,void 0,(function(){var t,r;return Zy(this,(function(n){switch(n.label){case 0:return t=new iv(e,this.completedExceptionally.bind(this)),[4,this.nextCID()];case 1:r=n.sent(),this.conversations[r.toString()]=t;try{t.open(r)}catch(e){throw this.completedExceptionally(r,t,e),e}return void 0!==this.discardReason&&this.discard(r,this.discardReason),[2,r]}}))}))},e.prototype.respond=function(e,t){var r=this.conversations[e.toString()];if(void 0===r)throw nv.debug("No conversation for cid: "+e+", response: ",t),new ov("No such conversation");switch(r.respond(e,t)){case tv.ALREADY_FINISHED:throw new ov("No such conversation");case tv.HANDLED_AND_ACTIVE:break;default:delete this.conversations[e.toString()]}},e.prototype.respondIfPresent=function(e,t){try{this.respond(e,t)}catch(e){if("NoSuchConversationError"!==e.name)throw e}},e.prototype.discard=function(e,t){var r=this.conversations[e.toString()];delete this.conversations[e.toString()],r&&r.discard(e,t)},e.prototype.discardAll=function(e){var t,r;if(void 0===this.discardReason){this.discardReason=e;try{for(var n=ev(Object.keys(this.conversations)),o=n.next();!o.done;o=n.next()){var i=o.value;this.discard(fu.ConversationId.fromString(i),e)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}}},e.prototype.size=function(){return Object.keys(this.conversations).length},e}();Jy.ConversationSet=sv,Jy.create=function(){return new sv(rv)};var av={};Object.defineProperty(av,"__esModule",{value:!0}),av.NullSerialiser=void 0,av.NullSerialiser={read:function(){return null},write:function(){}};var uv={};Object.defineProperty(uv,"__esModule",{value:!0}),uv.USER_PING=uv.SYSTEM_PING=void 0,uv.SYSTEM_PING={id:55,request:av.NullSerialiser,response:av.NullSerialiser},uv.USER_PING={id:56,request:av.NullSerialiser,response:av.NullSerialiser};var cv={};Object.defineProperty(cv,"__esModule",{value:!0}),cv.DEFAULT=cv.ControlGroup=void 0;var lv=function(e){this.name=e};cv.ControlGroup=lv,cv.DEFAULT=Object.freeze(new lv("default"));var pv={},fv=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(pv,"__esModule",{value:!0}),pv.ControlGroupSerialiser=void 0;var hv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fv(t,e),t.prototype.read=function(e){var t=Iu.readString(e);return new cv.ControlGroup(t)},t.prototype.write=function(e,t){Iu.writeString(e,t.name)},t}(Fu.AbstractSerialiser);pv.ControlGroupSerialiser=new hv;var dv={},yv=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(dv,"__esModule",{value:!0}),dv.MessageReceiverControlRegistrationParamsSerialiser=void 0;var vv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yv(t,e),t.prototype.write=function(e,t){Iu.writeInt32(e,t.definition.id),pv.ControlGroupSerialiser.write(e,t.group),Iu.writeString(e,t.path),Iu.writeCollection(e,t.keys,Iu.writeString)},t}(Fu.AbstractSerialiser);dv.MessageReceiverControlRegistrationParamsSerialiser=new vv;var Sv={},_v=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Sv,"__esModule",{value:!0}),Sv.MessageReceiverControlRegistrationRequestSerialiser=void 0;var Ev=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _v(t,e),t.prototype.write=function(e,t){dv.MessageReceiverControlRegistrationParamsSerialiser.write(e,t.params),Vu.CIDSerialiser.write(e,t.cid)},t}(Fu.AbstractSerialiser);Sv.MessageReceiverControlRegistrationRequestSerialiser=new Ev;var wv={},mv=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(wv,"__esModule",{value:!0}),wv.TopicControlRegistrationParamsSerialiser=void 0;var gv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mv(t,e),t.prototype.write=function(e,t){Iu.writeInt32(e,t.definition.id),pv.ControlGroupSerialiser.write(e,t.group),Iu.writeString(e,t.path)},t}(Fu.AbstractSerialiser);wv.TopicControlRegistrationParamsSerialiser=new gv;var Tv={},Ov=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Tv,"__esModule",{value:!0}),Tv.TopicControlRegistrationRequestSerialiser=void 0;var Iv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ov(t,e),t.prototype.write=function(e,t){wv.TopicControlRegistrationParamsSerialiser.write(e,t.params),Vu.CIDSerialiser.write(e,t.cid)},t}(Fu.AbstractSerialiser);Tv.TopicControlRegistrationRequestSerialiser=new Iv;var bv={};Object.defineProperty(bv,"__esModule",{value:!0}),bv.write=bv.read=void 0,bv.read=function(e){return Iu.readInt32(e)},bv.write=function(e,t){Iu.writeInt32(e,t)};var Rv={};Object.defineProperty(Rv,"__esModule",{value:!0}),Rv.UnsubscriptionNotification=void 0;var Cv=function(e,t){this.id=e,this.reason=t};Rv.UnsubscriptionNotification=Cv;var Av={},Pv=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Av,"__esModule",{value:!0}),Av.UnsubscriptionNotificationSerialiser=void 0;var Nv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Pv(t,e),t.prototype.read=function(e){var t=bv.read(e),r=Wh.read(e,Uc.UnsubscribeReasonEnum);return new Rv.UnsubscriptionNotification(t,r)},t.prototype.write=function(e,t){if(bv.write(e,t.id),void 0===t.reason.id)throw new va.IOError("Cannot serialise UnsubscribeReason ${value.reason.reason}");Wh.write(e,t.reason)},t}(Fu.AbstractSerialiser);Av.UnsubscriptionNotificationSerialiser=new Nv;var Mv={};Object.defineProperty(Mv,"__esModule",{value:!0}),Mv.TopicSpecificationInfo=void 0;var Dv=function(e,t,r){this.id=e,this.path=t,this.specification=r};Mv.TopicSpecificationInfo=Dv;var jv,Lv,xv,Uv={};Object.defineProperty(Uv,"__esModule",{value:!0}),Uv.write=Uv.read=void 0,Uv.read=function(e){if(Lv){var t=e.buffer.subarray(e.pos,e.pos+xv);if(Ou.isEqualUint8Arrays(t,Lv))return e.readMany(xv),jv}var r=e.pos,n=Wh.read(e,Dc.TopicTypeEnum),o=Iu.readDictionary(e,Iu.readString),i=new Cc.TopicSpecification(n,o);return xv=e.pos-r,Lv=Uint8Array.from(e.buffer.subarray(r,e.pos)),jv=Object.freeze(i),i},Uv.write=function(e,t){Wh.write(e,t.type),Iu.writeDictionary(e,t.properties,Iu.writeString)};var Bv={},qv=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Bv,"__esModule",{value:!0}),Bv.TopicSpecificationInfoSerialiser=void 0;var Vv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qv(t,e),t.prototype.read=function(e){var t=Iu.readInt32(e),r=Iu.readString(e),n=Uv.read(e);return new Mv.TopicSpecificationInfo(t,r,n)},t.prototype.write=function(e,t){Iu.writeInt32(e,t.id),Iu.writeString(e,t.path),Uv.write(e,t.specification)},t}(Fu.AbstractSerialiser);Bv.TopicSpecificationInfoSerialiser=new Vv;var kv={};Object.defineProperty(kv,"__esModule",{value:!0}),kv.MESSAGING_RECEIVER_CONTROL_DEREGISTRATION=kv.MESSAGING_RECEIVER_CONTROL_REGISTRATION=kv.NOTIFY_SUBSCRIPTION=kv.UNSUBSCRIPTION_NOTIFICATION=kv.TOPIC_CONTROL_DEREGISTRATION=kv.TOPIC_CONTROL_REGISTRATION=void 0,kv.TOPIC_CONTROL_REGISTRATION={id:20,request:Tv.TopicControlRegistrationRequestSerialiser,response:av.NullSerialiser},kv.TOPIC_CONTROL_DEREGISTRATION={id:21,request:wv.TopicControlRegistrationParamsSerialiser,response:av.NullSerialiser},kv.UNSUBSCRIPTION_NOTIFICATION={id:42,request:Av.UnsubscriptionNotificationSerialiser,response:av.NullSerialiser},Sv.MessageReceiverControlRegistrationRequestSerialiser,av.NullSerialiser,dv.MessageReceiverControlRegistrationParamsSerialiser,av.NullSerialiser,kv.NOTIFY_SUBSCRIPTION={id:87,request:Bv.TopicSpecificationInfoSerialiser,response:av.NullSerialiser},kv.MESSAGING_RECEIVER_CONTROL_REGISTRATION={id:97,request:Sv.MessageReceiverControlRegistrationRequestSerialiser,response:av.NullSerialiser},kv.MESSAGING_RECEIVER_CONTROL_DEREGISTRATION={id:98,request:dv.MessageReceiverControlRegistrationParamsSerialiser,response:av.NullSerialiser};var Fv={};Object.defineProperty(Fv,"__esModule",{value:!0}),Fv.RecoveryBuffer=void 0;function Gv(e){return e>>10}function Hv(e,t){return e&t-1}var Yv=function(){function e(e,t){this.messagesLength=Sl.findNextPowerOfTwo(e),this.indexCapacity=Sl.findNextPowerOfTwo(t),this.messagesMask=Vl.curryR(Hv,this.messagesLength),this.indexMask=Vl.curryR(Hv,this.indexCapacity),this.messages=yd.ofSize(this.messagesLength),this.indices=yd.ofSize(this.indexCapacity,-1),this.times=yd.ofSize(this.indexCapacity),this.timesHead=0,this.timesTail=0,this.messagesTail=this.messagesMask(0),this.messagesSize=0}return e.prototype.size=function(){return this.messagesSize},e.prototype.put=function(e){if(this.messages[this.messagesTail]=e,this.messagesTail=this.messagesMask(this.messagesTail+1),this.messagesSize<this.messagesLength)this.messagesSize=this.messagesSize+1;else for(;this.indices[this.timesHead]===this.messagesTail;)this.indices[this.timesHead]=-1,this.timesHead=this.indexMask(this.timesHead+1)},e.prototype.recover=function(e,t){if(e<0||e>this.messagesSize)return!1;for(var r=e;r>=1;--r)t(this.messages[this.messagesMask(this.messagesTail-r)]);return!0},e.prototype.clear=function(){yd.fill(this.messages,null),yd.fill(this.indices,-1),this.timesHead=0,this.timesTail=0,this.messagesSize=0},e.prototype.removeElements=function(e){var t,r=this.messagesMask(this.messagesTail-this.messagesSize);r<e?(yd.fill(this.messages,null,r,e),t=this.messagesSize-e+r):r>e?(yd.fill(this.messages,null,r,this.messagesLength),yd.fill(this.messages,null,0,e),t=this.messagesSize-r+e):(yd.fill(this.messages,null),t=0),this.messagesSize=t},e.prototype.markTime=function(e){if(this.messagesSize>0){var t=this.timesHead,r=this.timesTail,n=this.indices[t],o=Gv(e);if(n>=0){var i=this.indexMask(r-1);if(this.indices[i]===this.messagesTail)return;if(this.times[i]===o)return void(this.indices[i]=this.messagesTail)}this.timesTail=this.indexMask(r+1),this.times[r]=o,this.indices[r]=this.messagesTail,t===r&&n>=0&&(this.removeElements(n),this.timesHead=this.timesTail)}},e.prototype.flush=function(e){if(!(0===this.messagesSize||this.indices[this.timesHead]<0)){var t=this.timesTail,r=Gv(e);do{var n=t;if(t=this.indexMask(t-1),this.times[t]<=r)return this.removeElements(this.indices[t]),this.timesHead<=n?yd.fill(this.indices,-1,this.timesHead,n):(yd.fill(this.indices,-1,this.timesHead,this.indexCapacity),yd.fill(this.indices,-1,0,n)),void(this.timesHead=n)}while(t!==this.timesHead)}},e}();Fv.RecoveryBuffer=Yv;var Wv={};(function(e){(function(){"use strict";var t=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Wv,"__esModule",{value:!0}),Wv.Connection=void 0;var r=Xu.create("Connection"),n=e.DIFFUSION_CLOSE_TIMEOUT||1e3,o=e.DIFFUSION_RECOVERY_BUFFER_INDEX_SIZE||8,i=function(e){function i(t,n,i){var s=this,a=Gh.Emitter.create();return(s=e.call(this,a)||this).emitter=a.emitter(s),s.fsm=new Ry.FSM("disconnected",{connecting:["connected","disconnected","closed"],connected:["disconnecting","disconnected","closed"],disconnecting:["disconnected"],disconnected:["connecting","closed"],closed:[]}),s.transports=t,s.reconnectTimeout=n,s.lastSentSequence=0,s.lastReceivedSequence=0,s.recoveryBuffer=new Fv.RecoveryBuffer(i,o),s.fsm.on("change",(function(e,t){r.debug("State changed: "+e+" -> "+t)})),s}return t(i,e),i.prototype.onData=function(e){var t=this;r.debug("Received message from transport",e),cc.parse(e,(function(e,n){if(!e&&n){if(n.type===cc.types.ABORT_NOTIFICATION)return"disconnecting"!==t.fsm.state&&(t.closeReason=Ny.CloseReasonEnum.CLOSED_BY_SERVER),void t.transport.close();t.lastReceivedSequence++,t.emitter.emit("data",n)}else r.warn("Unable to parse message",e),t.fsm.change("closed")&&(t.closeReason=Ny.CloseReasonEnum.CONNECTION_ERROR,t.transport.close())}))},i.prototype.onClose=function(){this.fsm.change("disconnected")||this.fsm.change("closed")?(clearInterval(this.scheduledRecoveryBufferTrim),clearTimeout(this.scheduledClose),r.trace("Transport closed: ",this.closeReason),"disconnected"===this.fsm.state?this.emitter.emit("disconnect",this.closeReason):this.emitter.close(this.closeReason)):r.debug("Unable to disconnect, current state: ",this.fsm.state)},i.prototype.onError=function(e){r.error("Error from transport",e),this.fsm.change("closed")&&(this.closeReason=Ny.CloseReasonEnum.TRANSPORT_ERROR,this.transport.close())},i.prototype.onHandshakeSuccess=function(e){if(e.response===hd.responseCodes.RECONNECTED){var t=this.lastSentSequence-e.sequence+1;if(!this.recoveryBuffer.recover(t,this.dispatch.bind(this))){var n=this.lastSentSequence-this.recoveryBuffer.size()-e.sequence+1;return r.warn("Unable to reconnect due to lost messages ("+n+")"),this.fsm.change("disconnected")&&(this.closeReason=Ny.CloseReasonEnum.LOST_MESSAGES,this.transport.close()),e}this.recoveryBuffer.clear(),this.lastSentSequence=e.sequence-1}if(e.success&&this.fsm.change("connected"))r.trace("Connection response: ",e.response),this.closeReason=Ny.CloseReasonEnum.TRANSPORT_ERROR,this.emitter.emit("connect",e);else{switch(r.error("Connection failed: ",e.response),e.response){case hd.responseCodes.AUTHENTICATION_FAILED:this.closeReason=Ny.CloseReasonEnum.ACCESS_DENIED;break;case hd.responseCodes.LICENSE_EXCEEDED:this.closeReason=Ny.CloseReasonEnum.LICENSE_EXCEEDED;break;case hd.responseCodes.DOWNGRADE:this.closeReason=Ny.CloseReasonEnum.PROTOCOL_VERSION_MISMATCH;break;default:this.closeReason=Ny.CloseReasonEnum.HANDSHAKE_REJECTED}this.transport.close()}return clearTimeout(this.scheduledClose),e},i.prototype.onHandshakeError=function(e){e.reason===Hd.DeserialisationErrorReason.PROTOCOL_VERSION_MISMATCH?this.closeReason=Ny.CloseReasonEnum.PROTOCOL_VERSION_MISMATCH:this.closeReason=Ny.CloseReasonEnum.HANDSHAKE_ERROR,clearTimeout(this.scheduledClose),r.trace("Unable to deserialise handshake response",e)},i.prototype.connect=function(e,t,n){var o=this;if("disconnected"===this.fsm.state){if(this.fsm.change("connecting")){if(this.closeReason=Ny.CloseReasonEnum.CONNECTION_ERROR,this.transport=this.transports.get(t),null===this.transport)throw new va.IllegalArgumentError("No valid transports requested");this.transport.on("data",this.onData.bind(this)),this.transport.on("close",this.onClose.bind(this)),this.transport.on("error",this.onError.bind(this)),this.transport.connect(e,this.onHandshakeSuccess.bind(this),this.onHandshakeError.bind(this)),this.scheduledClose=setTimeout((function(){r.debug("Timed out connection attempt after "+n),o.closeReason=Ny.CloseReasonEnum.CONNECTION_TIMEOUT,o.transport.close()}),n),this.scheduledRecoveryBufferTrim=setInterval((function(){"connected"===o.fsm.state&&o.recoveryBuffer.flush(Date.now()-o.reconnectTimeout)}),this.reconnectTimeout)}}else r.warn("Cannot connect, current state: ",this.fsm.state)},i.prototype.resetSequences=function(){this.recoveryBuffer.clear(),this.lastSentSequence=0,this.lastReceivedSequence=0},i.prototype.getAvailableSequence=function(){return this.lastSentSequence+1-this.recoveryBuffer.size()},i.prototype.dispatch=function(e){var t=new nc.BufferOutputStream;cc.writeToBuffer(e,t),this.lastSentSequence+=1,this.recoveryBuffer.put(e),this.recoveryBuffer.markTime(Date.now()),this.transport.dispatch(t.getBuffer())},i.prototype.send=function(e){return"connected"===this.fsm.state&&(this.dispatch(e),!0)},i.prototype.close=function(e){return this.closeReason=e,"disconnected"===this.fsm.state?this.onClose():this.fsm.change("disconnecting")&&(this.dispatch(cc.create(cc.types.CLOSE_REQUEST)),this.scheduledClose=setTimeout(this.transport.close.bind(this.transport),n)),this},i.prototype.closeIdleConnection=function(){this.fsm.change("disconnecting")&&(r.debug("Connection detected as idle"),this.closeReason=Ny.CloseReasonEnum.IDLE_CONNECTION,this.transport.close())},i.prototype.getState=function(){return this.fsm.state},i}(Vh.StreamImpl);Wv.Connection=i}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var zv={};Object.defineProperty(zv,"__esModule",{value:!0}),zv.create=void 0,zv.create=function(e,t,r){return new Wv.Connection(e,t,r)};var Qv={};Object.defineProperty(Qv,"__esModule",{value:!0}),Qv.BufferSerialiser=void 0;var Kv=function(){function e(){}return e.prototype.read=function(e){return e.readMany(e.count-e.pos)},e.prototype.write=function(e,t){e.writeMany(t)},e}();Qv.BufferSerialiser=new Kv;var Jv={};(function(e){(function(){"use strict";var t,r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Jv,"__esModule",{value:!0}),Jv.OptionsImpl=Jv.MIN_MAX_MESSAGE_SIZE=Jv.DEFAULT_RETRY_STRATEGY=void 0;var o="undefined"!=typeof window&&window.location.hostname?window.location.hostname:"localhost",i="undefined"!=typeof window&&"http:"===window.location.protocol&&window.location.port?parseInt(window.location.port,10):80,s="undefined"!=typeof window&&"https:"===window.location.protocol&&window.location.port?parseInt(window.location.port,10):443,a="undefined"==typeof window||"http:"!==window.location.protocol,u=null!==(t=e.DIFFUSION_CONNECT_TIMEOUT)&&void 0!==t?t:1e4;Jv.DEFAULT_RETRY_STRATEGY={attempts:0,interval:0};var c=function(e){setTimeout(e,5e3)},l=function(e,t){t()},p="undefined"==typeof window?["WEBSOCKET"]:["WEBSOCKET","XHR"];Jv.MIN_MAX_MESSAGE_SIZE=1024;var f=function(){function e(e){var t,n;if(void 0===e&&(e={}),void 0===e.host)e.host=o;else if(1===(e.host.match(/:/g)||[]).length||e.host.match(/^\[[^\]]*\]:\d+$/)){var f=e.host.lastIndexOf(":");void 0===e.port&&(e.port=parseInt(e.host.substr(f+1),10)),e.host=e.host.substr(0,f)}e.host.indexOf(":")>-1&&!e.host.match(/^\[/)&&(e.host="["+e.host+"]"),void 0===e.path?e.path="/diffusion":("/"!==e.path[0]&&(e.path="/"+e.path),"/diffusion"!==e.path.substring(e.path.length-"/diffusion".length)&&("/"===e.path[e.path.length-1]&&(e.path=e.path.substring(0,e.path.length-1)),e.path=e.path+"/diffusion")),void 0!==e.port&&"string"==typeof e.port&&(isNaN(parseInt(e.port,10))?e.port=void 0:e.port=parseInt(e.port,10)),void 0===e.secure&&(void 0===e.port?e.secure=a:e.secure=e.port===s),void 0===e.port&&(e.port=e.secure?s:i),this.host=e.host,this.port=e.port,this.path=e.path,this.secure=e.secure,this.connectionTimeout=null!==(t=e.connectionTimeout)&&void 0!==t?t:u,e.retry?null===e.retry.attempts||void 0===e.retry.attempts?null===e.retry.interval||void 0===e.retry.interval?this.retry=r({},Jv.DEFAULT_RETRY_STRATEGY):this.retry={attempts:Sl.MAX_SAFE_INTEGER,interval:e.retry.interval}:(Zl.requireNonNull(e.retry.interval,"options.retry.interval"),this.retry=e.retry):this.retry=r({},Jv.DEFAULT_RETRY_STRATEGY),void 0===e.reconnect||"boolean"==typeof e.reconnect&&e.reconnect?this.reconnect={timeout:6e4,strategy:c}:"number"==typeof e.reconnect?this.reconnect={timeout:e.reconnect,strategy:c}:"function"==typeof e.reconnect?this.reconnect={timeout:6e4,strategy:e.reconnect}:"object"==typeof e.reconnect?this.reconnect={timeout:void 0===e.reconnect.timeout?6e4:e.reconnect.timeout,strategy:e.reconnect.strategy||c}:this.reconnect={timeout:0,strategy:l},void 0!==e.principal&&(this.principal=e.principal||"","string"==typeof e.credentials?this.credentials=e.credentials:(n=e.credentials)instanceof Int8Array||n instanceof Int16Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Uint16Array||n instanceof Uint32Array||n instanceof Float32Array||n instanceof Float64Array?this.credentials=new Uint8Array(e.credentials.buffer,e.credentials.byteOffset,e.credentials.byteLength):Array.isArray(e.credentials)?(e.credentials.forEach((function(e){if("number"!=typeof e||e>127||e<-128)throw new va.IllegalArgumentError("Custom credentials invalid. Element must be octet.")})),this.credentials=Uint8Array.from(e.credentials)):this.credentials=""),"string"==typeof e.transports?this.transports=[e.transports]:"object"==typeof e.transports&&e.transports instanceof Array&&e.transports.length>0?this.transports=e.transports.slice():this.transports=p.slice(),this.transports=this.transports.slice().map((function(e){return e.toUpperCase()}));var h=e.maxMessageSize&&e.maxMessageSize>Jv.MIN_MAX_MESSAGE_SIZE?e.maxMessageSize:2147483647;if(this.maxMessageSize=h,this.activityMonitor=void 0===e.activityMonitor||e.activityMonitor,void 0!==e.properties){var d={};Object.getOwnPropertyNames(e.properties).forEach((function(t){d[t]=e.properties[t].toString()})),this.properties=d}if(this.httpProxyAgent=e.httpProxyAgent,void 0!==e.tlsOptions){var y=e.tlsOptions;this.tlsOptions=["ca","cert","ciphers","clientCertEngine","crl","dhparam","ecdhCurve","honorCipherOrder","key","passphrase","pfx","secureOptions","secureProtocol","sessionIdContext","rejectUnauthorized"].filter((function(e){return e in y})).reduce((function(e,t){return e[t]=y[t],e}),{})}}return e.prototype.with=function(t){var r,o,i,s,a,u={};try{for(var c=n(Object.getOwnPropertyNames(this)),l=c.next();!l.done;l=c.next())u[a=l.value]=this[a]}catch(e){r={error:e}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}try{for(var p=n(Object.getOwnPropertyNames(t)),f=p.next();!f.done;f=p.next())u[a=f.value]=t[a]}catch(e){i={error:e}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(i)throw i.error}}return new e(u)},e}();Jv.OptionsImpl=f}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var $v={};Object.defineProperty($v,"__esModule",{value:!0}),$v.WorkerStreamCommand=$v.WorkerSessionLockCommand=$v.WorkerCommand=void 0,function(e){e.CONNECT="connect",e.CONNECT_EXISTING="connect-existing",e.CLOSE="close",e.MESSAGE="message",e.STREAM="stream",e.SERVICE="service",e.LOCK="lock",e.CID="cid"}($v.WorkerCommand||($v.WorkerCommand={})),function(e){e.ACQUIRED="acquired",e.ACQUIRE_ERROR="acquire_error",e.OWNED="owned",e.REMOVED="removed",e.RELEASED="released",e.RELEASE_ERROR="release_error"}($v.WorkerSessionLockCommand||($v.WorkerSessionLockCommand={})),function(e){e.OPEN="open",e.VALUE="value",e.SUBSCRIPTION="subscription",e.UNSUBSCRIPTION="unsubscription",e.SUBSCRIPTION_ERROR="subscription_error"}($v.WorkerStreamCommand||($v.WorkerStreamCommand={}));var Xv={},Zv=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(Xv,"__esModule",{value:!0}),Xv.InternalSessionLocksProxy=void 0;var eS=Xu.create("InternalSessionLocksProxy"),tS=function(){function e(e,t,r,n,o){var i=this;this.owned=!0,this.name=e,this.sequence=t,this.scope=r,this.releaseLock=o,n.setOwned=function(e){i.owned=e}}return e.prototype.getName=function(){return this.name},e.prototype.getSequence=function(){return this.sequence},e.prototype.isOwned=function(){return this.owned},e.prototype.getScope=function(){return this.scope},e.prototype.unlock=function(){return this.owned?(this.owned=!1,this.releaseLock(this)):Promise.resolve(!1)},e}(),rS=function(){function e(e){var t=this;this.activeRequests={},this.releaseRequests={},this.locks={},this.nextRequestId=0,this.connector=e,this.connector.on("lock_event",(function(e){var r=Zv(e,3),n=r[0],o=r[1],i=r[2];switch(o){case $v.WorkerSessionLockCommand.ACQUIRED:t.onLockAcquired(n,i);break;case $v.WorkerSessionLockCommand.ACQUIRE_ERROR:t.onLockAcquireError(n,i);break;case $v.WorkerSessionLockCommand.OWNED:t.onLockOwned(n,i);break;case $v.WorkerSessionLockCommand.REMOVED:t.onLockRemoved(n);break;case $v.WorkerSessionLockCommand.RELEASED:t.onLockReleased(i);break;case $v.WorkerSessionLockCommand.RELEASE_ERROR:t.onLockReleaseError(i);break;default:eS.error("Unrecognised lock_event "+o)}}))}return e.prototype.onLockAcquired=function(e,t){var r=Zv(t,3),n=r[0],o=r[1],i=r[2];void 0!==this.activeRequests[n]&&(this.activeRequests[n](void 0,e,ka.fromString(o,10),i),delete this.activeRequests[n])},e.prototype.onLockAcquireError=function(e,t){var r=Zv(t,2),n=r[0],o=r[1];void 0!==this.activeRequests[n]&&(this.activeRequests[n](o,e),delete this.activeRequests[n])},e.prototype.onLockOwned=function(e,t){void 0!==this.locks[e]&&this.locks[e].ownedSetter.setOwned(t)},e.prototype.onLockRemoved=function(e){delete this.locks[e]},e.prototype.onLockReleased=function(e){var t=Zv(e,2),r=t[0],n=t[1];this.releaseRequests[r](void 0,n)},e.prototype.onLockReleaseError=function(e){var t=Zv(e,2),r=t[0],n=t[1];this.releaseRequests[r](n)},e.prototype.handleAcquisition=function(e,t,r){var n=this.locks[e];if(void 0!==n&&n.lock.getSequence().equals(t))return n.lock;var o={setOwned:function(){throw Error("Session lock ownedSetter must be implemented")}},i=new tS(e,t,r,o,this.releaseLock.bind(this));return this.locks[e]={lock:i,ownedSetter:o},i},e.prototype.releaseLock=function(e){var t=this;return new Promise((function(r,n){var o=t.nextRequestId++;t.releaseRequests[o]=function(e,i){delete t.releaseRequests[o],e?(eS.debug("Release shared-session lock failed"),n(e)):r(i)},t.connector.send($v.WorkerCommand.LOCK,JSON.stringify({action:"release",requestId:o,name:e.getName(),sequence:e.getSequence().toString(10),scope:e.getScope()}))}))},e.prototype.lock=function(e,t){var r=this;return new Promise((function(n,o){if(void 0!==r.locks[e]&&r.locks[e].lock.isOwned())n(r.locks[e].lock);else{var i=r.nextRequestId++;r.activeRequests[i]=function(e,t,s,a){delete r.activeRequests[i],e?(eS.debug("Acquire shared-session lock failed"),o(e)):n(r.handleAcquisition(t,s,a))},r.connector.send($v.WorkerCommand.LOCK,JSON.stringify({action:"acquire",requestId:i,name:e,scope:t}))}}))},e}();Xv.InternalSessionLocksProxy=rS;var nS={};Object.defineProperty(nS,"__esModule",{value:!0}),nS.ValueStreamWorkerReceiver=void 0;var oS=p({}),iS=Xu.create("ValueStreamWorkerReceiver");function sS(e){var t=new tc.BufferInputStream(Ou.uint8FromBase64(e));return Uv.read(t)}function aS(e,t,r){return e?"any"===t.name()?(r.type===Dc.TopicTypeEnum.TIME_SERIES?oS.DataTypes.timeseries(oS.DataTypes.get(r.properties.TIME_SERIES_EVENT_VALUE_TYPE)):oS.DataTypes.get(r.type)).readValue(e):t.readValue(e):null}var uS=function(){function e(e,t){this.stream=e,this.datatype=t}return e.prototype.onOpen=function(){this.stream.onOpen()},e.prototype.onValue=function(e){try{var t=JSON.parse(e),r=sS(t.specification),n=t.oldValue?Ou.uint8FromBase64(t.oldValue):null,o=Ou.uint8FromBase64(t.newValue);this.stream.onValue(t.path,r,n,o,aS(n,this.datatype,r),aS(o,this.datatype,r))}catch(e){iS.error("Invalid data",e)}},e.prototype.onSubscription=function(e){var t=JSON.parse(e);this.stream.onSubscription(t.path,sS(t.specification))},e.prototype.onUnsubscription=function(e){var t=JSON.parse(e),r=void 0!==t.reason?Uc.UnsubscribeReasonEnum[Uc.UnsubscribeReasonEnum[t.reason]]:Uc.UnsubscribeReasonEnum.UNKNOWN_UNSUBSCRIBE_REASON;this.stream.onUnsubscription(t.path,sS(t.specification),r)},e.prototype.onSubscriptionError=function(e){this.stream.onSubscriptionError(_c.ErrorReason[_c.ErrorReason[parseInt(e,10)]])},e}();nS.ValueStreamWorkerReceiver=uS;var cS={},lS=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},pS=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(cS,"__esModule",{value:!0}),cS.StreamRegistryWebworkerProxy=void 0;var fS=function(){var e=new ka(0);return function(){return e=e.add(1),new fu.ConversationId(e)}}(),hS=function(){function e(e){var t=this;this.connector=e,this.adapters={},this.connector.on({stream_event:function(e){var r=lS(e,4),n=r[0],o=r[1],i=r[2],s=r[3],a=t.adapters[n];if(a)switch(o){case $v.WorkerStreamCommand.OPEN:a.onOpen();break;case $v.WorkerStreamCommand.VALUE:a.onValue(s);break;case $v.WorkerStreamCommand.SUBSCRIPTION:a.onSubscription(s);break;case $v.WorkerStreamCommand.UNSUBSCRIPTION:a.onUnsubscription(s);break;case $v.WorkerStreamCommand.SUBSCRIPTION_ERROR:a.onSubscriptionError(i)}}})}return e.prototype.add=function(e,t,r){var n=fS();this.adapters[n.toString()]=new nS.ValueStreamWorkerReceiver(t,r);var o={action:"add",adapterId:n.toString(),topic:e.expression,datatype:r.name()};this.connector.send($v.WorkerCommand.STREAM,JSON.stringify(o))},e.prototype.addFallback=function(e,t){var r=fS();this.adapters[r.toString()]=new nS.ValueStreamWorkerReceiver(e,t);var n={action:"add_fallback",adapterId:r.toString(),datatype:t.name()};this.connector.send($v.WorkerCommand.STREAM,JSON.stringify(n))},e.prototype.remove=function(e){var t,r;try{for(var n=pS(Object.getOwnPropertyNames(this.adapters)),o=n.next();!o.done;o=n.next()){var i=o.value;if(this.adapters[i].stream===e){var s={action:"remove",adapterId:i.toString()};this.connector.send($v.WorkerCommand.STREAM,JSON.stringify(s)),delete this.adapters[i]}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.close=function(){this.connector.send($v.WorkerCommand.STREAM,JSON.stringify({action:"close_registry"}))},e}();cS.StreamRegistryWebworkerProxy=hS;var dS={},yS=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),vS=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},SS=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty(dS,"__esModule",{value:!0}),dS.InternalSessionWebworkerProxy=void 0;var _S=Xu.create("InternalSessionWebworkerProxy"),ES=function(e){function t(t,r,n,o){var i=this,s=Gh.Emitter.create();return(i=e.call(this,s)||this).emitter=s.emitter(i),i.connector=n,i.opts=o,i.connected=!1,i.state=Ba.InternalSessionState.INITIALISING,i.connector.on({connect_event:function(e){var t=SS(e,3),r=t[0],n=t[1],o=t[2];try{i.serverMaximumMessageSize=parseInt(o,10),i.opts=JSON.parse(n),i.sessionID=qd.SessionId.fromString(r),i.connected=!0,i.emitter.emit("connect",i.sessionID,new Jv.OptionsImpl(i.opts))}catch(e){_S.error("Unable to parse options from shared session",e),i.emitter.emit("error",new Error("Unable to parse options from shared session"))}},connect_error:function(e){i.connector.disconnect(),i.emitter.emit("error",Ny.CloseReasonEnum[e]||new Error(e))},reconnect_event:function(){i.connected=!0,i.emitter.emit("reconnect")},disconnect_event:function(e){i.connected=!1;var t=Ny.CloseReasonEnum[e];i.emitter.emit("disconnect",Ny.CloseReasonEnum[t])},close_event:function(e){i.connector.disconnect(),i.connected=!1;var t=Ny.CloseReasonEnum[e];i.emitter.close(Ny.CloseReasonEnum[t])},error_event:function(e){i.connector.disconnect(),i.connected=!1,i.emitter.emit("error",new Error(e))},command_response:function(e){var t=SS(e,2),r=t[0],n=t[1],o=fu.ConversationId.fromString(r),s=new tc.BufferInputStream(Ou.uint8FromBase64(n));i.conversationSet.respondIfPresent(o,s)},command_error:function(e){var t,r=SS(e,2),n=r[0],o=r[1],s=fu.ConversationId.fromString(n);try{t=JSON.parse(o)}catch(e){t=new Error("Could not parse error response")}i.conversationSet.discard(s,t)},service_request:function(e){var t=SS(e,3),r=t[0],n=t[1],o=t[2],s=fu.ConversationId.fromString(n),a=new nc.BufferOutputStream;Wu.CommandHeaderSerialiser.write(a,new Hu.CommandHeader(parseInt(r,10),s)),Qv.BufferSerialiser.write(a,Ou.uint8FromBase64(o));var u=new tc.BufferInputStream(a.getBuffer());i.serviceAdapter.onMessage(cc.types.SERVICE_REQUEST,u)},state_change:function(e){i.state=e}}),i.serviceAdapter=new Ec.ServiceAdapter(i,(function(e){i.connector.sendMessage(e)})),i.serviceLocator=new Tc.ServiceLocatorImpl(i,i.serviceAdapter),i.serviceRegistry=r,i.serviceRegistry.addListener(i.serviceAdapter.addService.bind(i.serviceAdapter)),i.serviceRegistry.addListener((function(e){i.connector.send($v.WorkerCommand.SERVICE,JSON.stringify({action:"add",serviceId:e.id}))})),i.topicStreamRegistry=new cS.StreamRegistryWebworkerProxy(i.connector),i.conversationSet=t(),i.sessionLocks=new Xv.InternalSessionLocksProxy(i.connector),i}return yS(t,e),t.prototype.connect=function(){var e=this;if(this.opts){var t=this.opts,r=t.credentials,n=t.reconnect,o=vS(t,["credentials","reconnect"]),i=r instanceof Uint8Array,s=i?Ou.uint8ToBase64(r):r;o.reconnect=n.timeout,this.connector.send($v.WorkerCommand.CONNECT,JSON.stringify([o,i,s]))}else this.connector.send($v.WorkerCommand.CONNECT_EXISTING);var a=!1;this.connector.on("connect_ack",(function(){a=!0})),setTimeout((function(){a||(e.emitter.emit("error",new Error("Unable to connect to shared worker")),e.connector.close())}),1e3)},t.prototype.close=function(){return this.state!==Ba.InternalSessionState.CLOSED&&this.connector.send($v.WorkerCommand.CLOSE),this},t.prototype.isConnected=function(){return this.connected},t.prototype.checkConnected=function(e){return!!this.isConnected()||(e(new Error("The session is not connected. Operations are not possible at this time.")),!1)},t.prototype.getSessionId=function(){return this.sessionID},t.prototype.getPrincipal=function(){if(void 0===this.opts)throw new va.IllegalStateError("Shared session is not connected");return this.opts.principal||""},t.prototype.setPrincipal=function(e){if(void 0===this.opts)throw new va.IllegalStateError("Shared session is not connected");this.opts.principal=e},t.prototype.getOptions=function(){if(void 0===this.opts)throw new va.IllegalStateError("Shared session is not connected");return this.opts},t.prototype.getState=function(){return this.state},t.prototype.getServerMaximumMessageSize=function(){return this.serverMaximumMessageSize},t.prototype.lock=function(e,t){return this.sessionLocks.lock(e,t)},t.prototype.onSystemPing=function(){throw new va.InternalError("Method not implemented.")},t.prototype.getStreamRegistry=function(){return this.topicStreamRegistry},t.prototype.getServiceRegistry=function(){return this.serviceRegistry},t.prototype.getRouting=function(){throw new va.InternalError("Method not implemented.")},t.prototype.getServiceLocator=function(){return this.serviceLocator},t.prototype.getConversationSet=function(){return this.conversationSet},t.prototype.isShared=function(){return!0},t.prototype.getContext=function(){return Uh.sessionContext},t.prototype.updateFeatures=function(){},t}(Vh.StreamImpl);dS.InternalSessionWebworkerProxy=ES;var wS={},mS=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),gS=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},TS=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},OS=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};Object.defineProperty(wS,"__esModule",{value:!0}),wS.getSharedConversationSetFactory=wS.SharedSessionConnector=void 0;var IS=function(){function e(e){var t=this;this.listeners={},this.worker=new SharedWorker(e),this.worker.port.onmessage=function(e){var r,n,o=e.data[0];if(void 0!==t.listeners[o])try{for(var i=gS(t.listeners[o]),s=i.next();!s.done;s=i.next()){s.value.apply(void 0,OS([e.data[1]],TS(e.data.slice(2))))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}}return e.prototype.getWorker=function(){return this.worker},e.prototype.addListener=function(e,t){void 0===this.listeners[e]?this.listeners[e]=[t]:this.listeners[e].push(t)},e.prototype.removeListener=function(e,t){void 0!==this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((function(e){return e!==t})))},e}(),bS={};function RS(e){if(!window||!window.SharedWorker)throw new va.RuntimeError("SharedWorker could not be found!");return void 0===bS[e]&&(bS[e]=new IS(e)),bS[e]}var CS=function(e){function t(t,r){var n=this,o=Gh.Emitter.create();return(n=e.call(this,o)||this).emitter=o.emitter(n),n.sessionName=t,n.router=RS(r),n.worker=n.router.getWorker(),n.listener=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t.length<2?n.emitter.emit(e,t[0]):n.emitter.emit(e,t)},n.router.addListener(t,n.listener),n}return mS(t,e),t.prototype.send=function(e,t){this.worker.port.postMessage([this.sessionName,e,t])},t.prototype.sendMessage=function(e){var t={type:e.type,encoding:e.encoding,data:Ou.uint8ToBase64(e.data),stream:Ou.uint8ToBase64(e.getBuffer()),headers:e.headers,id:e.id,topic:e.topic};this.send($v.WorkerCommand.MESSAGE,JSON.stringify(t))},t.prototype.disconnect=function(){this.router.removeListener(this.sessionName,this.listener)},t}(Vh.StreamImpl);wS.SharedSessionConnector=CS,wS.getSharedConversationSetFactory=function(e){var t=[];function r(){return new Promise((function(r){t.push(r),e.send($v.WorkerCommand.CID)}))}return e.on("cid_event",(function(e){t.length>0&&t.shift()(new fu.ConversationId(ka.fromString(e)))})),function(){return new Jy.ConversationSet(r)}};var AS={};function PS(e){e=Zl.requireNonNull(e,"options");var t=new Hy.ServiceRegistryImpl;return t.add(uv.USER_PING,Ky.pingService),t.add(uv.SYSTEM_PING,Wy.monitoredPingService),t.add(kv.NOTIFY_SUBSCRIPTION,zy.notifySubscriptionService),t.add(kv.UNSUBSCRIPTION_NOTIFICATION,Qy.notifyUnsubscriptionService),new My.InternalSessionImpl(Jy.create,t,zv.create,e)}function NS(e,t){var r=new Hy.ServiceRegistryImpl,n=new wS.SharedSessionConnector(e,t),o=wS.getSharedConversationSetFactory(n);return function(e){return new dS.InternalSessionWebworkerProxy(o,r,n,e)}}Object.defineProperty(AS,"__esModule",{value:!0}),AS.create=AS.createShared=void 0,AS.createShared=NS,AS.create=function(e,t){if(void 0===e&&void 0===t)return PS;if(void 0!==e&&void 0!==t)return NS(e,t);throw new va.NullValueError('Missing parameter "name" or "workerJs" when creating a shared session')};var MS={};Object.defineProperty(MS,"__esModule",{value:!0}),MS.RemoteServerType=MS.ConnectionState=MS.ConnectionOption=void 0,function(e){e[e.CONNECTION_TIMEOUT=1]="CONNECTION_TIMEOUT",e[e.INPUT_BUFFER_SIZE=2]="INPUT_BUFFER_SIZE",e[e.MAXIMUM_QUEUE_SIZE=3]="MAXIMUM_QUEUE_SIZE",e[e.OUTPUT_BUFFER_SIZE=4]="OUTPUT_BUFFER_SIZE",e[e.RECONNECTION_TIMEOUT=5]="RECONNECTION_TIMEOUT",e[e.RECOVERY_BUFFER_SIZE=6]="RECOVERY_BUFFER_SIZE",e[e.RETRY_DELAY=7]="RETRY_DELAY",e[e.WRITE_TIMEOUT=8]="WRITE_TIMEOUT"}(MS.ConnectionOption||(MS.ConnectionOption={})),function(e){e[e.INACTIVE=1]="INACTIVE",e[e.CONNECTED=2]="CONNECTED",e[e.RETRYING=3]="RETRYING",e[e.FAILED=4]="FAILED",e[e.MISSING=5]="MISSING"}(MS.ConnectionState||(MS.ConnectionState={})),function(e){e[e.SECONDARY_INITIATOR=1]="SECONDARY_INITIATOR",e[e.PRIMARY_INITIATOR=2]="PRIMARY_INITIATOR",e[e.SECONDARY_ACCEPTOR=3]="SECONDARY_ACCEPTOR"}(MS.RemoteServerType||(MS.RemoteServerType={}));var DS={},jS=this&&this.__assign||function(){return(jS=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(DS,"__esModule",{value:!0}),DS.SessionEventParametersBuilderImpl=void 0;var LS=function(){function e(){this.sessionEventParameters={}}return e.prototype.filter=function(e){return this.sessionEventParameters=jS(jS({},this.sessionEventParameters),{filter:e}),this},e.prototype.properties=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return"string"==typeof e&&(e=[e].concat(t)),this.sessionEventParameters=jS(jS({},this.sessionEventParameters),{properties:new Set(e)}),this},e.prototype.after=function(e){return this.sessionEventParameters=jS(jS({},this.sessionEventParameters),{after:e instanceof Date?e.getTime():e}),this},e.prototype.build=function(){return{filter:this.sessionEventParameters.filter,properties:this.sessionEventParameters.properties,after:this.sessionEventParameters.after}},e}();DS.SessionEventParametersBuilderImpl=LS;var xS={};Object.defineProperty(xS,"__esModule",{value:!0}),xS.AbstractMetricCollector=void 0;var US=function(e,t,r){if(0===(null==e?void 0:e.length))throw new va.IllegalArgumentError("name cannot be empty");if(r<1)throw new va.IllegalArgumentError("maximumGroups must be positive: "+r);this.name=e,this.maximumGroups=r,this.exportToPrometheus=t};xS.AbstractMetricCollector=US;var BS={},qS=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(BS,"__esModule",{value:!0}),BS.SessionMetricCollectorImpl=void 0;var VS=function(e){function t(t,r,n,o,i,s){var a=e.call(this,t,r,n)||this;return a.sessionFilter=i,a.groupByProperties=s,a.removeMetricsWithNoMatches=o,a}return qS(t,e),t}(xS.AbstractMetricCollector);BS.SessionMetricCollectorImpl=VS;var kS={};Object.defineProperty(kS,"__esModule",{value:!0}),kS.SessionMetricCollectorBuilderImpl=void 0;var FS=function(){function e(){this.reset()}return e.prototype.reset=function(){return this.exportToPrometheusProp=!1,this.maximumGroupsProp=Sl.MAX_INT32,this.groupByPropertiesProp=[],this.removesMetricsWithNoMatchesProp=!1,this},e.prototype.exportToPrometheus=function(e){return this.exportToPrometheusProp=e,this},e.prototype.maximumGroups=function(e){return this.maximumGroupsProp=e,this},e.prototype.groupByProperty=function(e){return this.groupByPropertiesProp.push(Zl.requireNonNull(e,"propertyName")),this},e.prototype.groupByProperties=function(e){return this.groupByPropertiesProp=Zl.requireNonNull(e,"propertyNames"),this},e.prototype.removeMetricsWithNoMatches=function(e){return this.removesMetricsWithNoMatchesProp=e,this},e.prototype.create=function(e,t){return new BS.SessionMetricCollectorImpl(Zl.requireNonNull(e,"name"),this.exportToPrometheusProp,this.maximumGroupsProp,this.removesMetricsWithNoMatchesProp,Zl.requireNonNull(t,"sessionFilter"),this.groupByPropertiesProp)},e}();kS.SessionMetricCollectorBuilderImpl=FS;var GS={},HS=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(GS,"__esModule",{value:!0}),GS.TopicMetricCollectorImpl=void 0;var YS=function(e){function t(t,r,n,o,i,s,a){var u=e.call(this,t,r,n)||this;if(u.topicSelector=o,u.groupByTopicType=i,u.groupByTopicView=s,a<0)throw new va.IllegalArgumentError("groupByPathPrefixParts must be non-negative: "+a);return u.groupByPathPrefixParts=a,u}return HS(t,e),t}(xS.AbstractMetricCollector);GS.TopicMetricCollectorImpl=YS;var WS={};Object.defineProperty(WS,"__esModule",{value:!0}),WS.TopicMetricCollectorBuilderImpl=void 0;var zS=function(){function e(){this.exportToPrometheusProp=!1,this.groupByTopicTypeProp=!1,this.groupByTopicViewProp=!1,this.groupByPathPrefixPartsProp=0,this.reset()}return e.prototype.reset=function(){return this.exportToPrometheusProp=!1,this.maximumGroupsProp=Sl.MAX_INT32,this.groupByTopicTypeProp=!1,this.groupByTopicViewProp=!1,this.groupByPathPrefixPartsProp=0,this},e.prototype.exportToPrometheus=function(e){return this.exportToPrometheusProp=e,this},e.prototype.maximumGroups=function(e){return this.maximumGroupsProp=e,this},e.prototype.groupByTopicType=function(e){return this.groupByTopicTypeProp=e,this},e.prototype.groupByTopicView=function(e){return this.groupByTopicViewProp=e,this},e.prototype.groupByPathPrefixParts=function(e){return this.groupByPathPrefixPartsProp=e,this},e.prototype.create=function(e,t){return Zl.requireNonNull(t,"topicSelector"),new GS.TopicMetricCollectorImpl(Zl.requireNonNull(e,"name"),this.exportToPrometheusProp,this.maximumGroupsProp,"string"==typeof t?t:t.expression,this.groupByTopicTypeProp,this.groupByTopicViewProp,this.groupByPathPrefixPartsProp)},e}();WS.TopicMetricCollectorBuilderImpl=zS;var QS={};Object.defineProperty(QS,"__esModule",{value:!0}),QS.RemoteServerDefinitionImpl=void 0;var KS=function(){function e(e,t,r,n,o,i,s,a){var u;this.type=e,this.name=t,this.url=r[0],this.urls=r,this.principal=n,this.credentials=i,this.connectionOptions=o,this.connector=s,this.missingTopicNotificationFilter=a,this.primaryHostName=r[0],this.retryDelay=parseInt(null!==(u=o[MS.ConnectionOption.RETRY_DELAY])&&void 0!==u?u:"1000",10)}return e.createPrimaryDefinition=function(t,r,n,o){var i;return new e(MS.RemoteServerType.PRIMARY_INITIATOR,t,r,"",((i={})[MS.ConnectionOption.RETRY_DELAY]=""+n,i),null,o)},e.createSecondaryDefinition=function(t,r,n,o,i,s,a){return new e(t,r,[n],o,i,a,void 0,s)},e.createDefinition=function(t,r){return new e(t.type,t.name,t.urls,t.principal,t.connectionOptions,r,t.connector,t.missingTopicNotificationFilter)},e.prototype.withOptions=function(t){return new e(this.type,this.name,this.urls,this.principal,t,this.credentials,this.connector,this.missingTopicNotificationFilter)},e}();QS.RemoteServerDefinitionImpl=KS;var JS={};Object.defineProperty(JS,"__esModule",{value:!0}),JS.RemoteServerBuilderBaseImpl=void 0;var $S=function(){function e(e){this.type=e}return e.validateName=function(e){Zl.requireNonNull(e,"name");var t=e.trim();if(0===t.length)throw new va.IllegalArgumentError("Non whitespace name must be supplied");return t},e.prototype.validateUrl=function(e){Zl.requireNonNull(e,"url");var t,r=e.trim();try{t=new URL(r)}catch(e){throw new va.IllegalArgumentError("Invalid URL")}if("ws:"!==t.protocol&&"wss:"!==t.protocol)throw new va.IllegalArgumentError("Transport for url "+e+" must be ws");if(this.type===MS.RemoteServerType.PRIMARY_INITIATOR&&"wss:"===t.protocol)throw new va.IllegalArgumentError("Invalid url "+e+" - secure connection not supported for primary initiator connections");if(this.type===MS.RemoteServerType.SECONDARY_ACCEPTOR&&"wss:"!==t.protocol)throw new va.IllegalArgumentError("Invalid url "+e+" - connection must be secure for secondary acceptor connections");return r},e}();JS.RemoteServerBuilderBaseImpl=$S;var XS={},ZS=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(XS,"__esModule",{value:!0}),XS.PrimaryInitiatorBuilderImpl=void 0;var e_=function(e){function t(){var t=e.call(this,MS.RemoteServerType.PRIMARY_INITIATOR)||this;return t.theRetryDelay=1e3,t}return ZS(t,e),t.validateConnector=function(e){Zl.requireNonNull(e,"connector");var t=e.trim();if(0===t.length)throw new va.IllegalArgumentError("Non whitespace connector must be supplied");return t},t.prototype.validateUrls=function(e){var t=this;if(0===e.length)throw new va.IllegalArgumentError("urls is empty");return e.map((function(e){return t.validateUrl(e)}))},t.prototype.retryDelay=function(e){if(Zl.requireNonNull(e,"delay"),e<0)throw new va.IllegalArgumentError("delay is invalid");return this.theRetryDelay=e,this},t.prototype.reset=function(){return this.theRetryDelay=1e3,this},t.prototype.build=function(e,r,n){return QS.RemoteServerDefinitionImpl.createPrimaryDefinition(t.validateName(e),this.validateUrls(Zl.requireNonNull(r,"urls")),this.theRetryDelay,t.validateConnector(n))},t}(JS.RemoteServerBuilderBaseImpl);XS.PrimaryInitiatorBuilderImpl=e_;var t_={},r_=this&&this.__assign||function(){return(r_=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t_,"__esModule",{value:!0}),t_.RemoteServerBuilderImpl=void 0;var n_=function(){function e(e){this.thePrincipal="",this.theCredentials=void 0,this.theConnectionOptions={},this.theMissingTopicNotificationFilter=void 0,this.theTopicSelectors=e}return e.prototype.principal=function(e){return this.thePrincipal=Zl.requireNonNull(e,"principal"),this},e.prototype.credentials=function(e){return this.theCredentials=e,this},e.prototype.connectionOptions=function(e){return Zl.requireNonNull(e,"connectionOptions"),this.theConnectionOptions=r_({},e),this},e.prototype.connectionOption=function(e,t){return null==t?delete this.theConnectionOptions[Zl.requireNonNull(e,"connectionOption")]:this.theConnectionOptions[Zl.requireNonNull(e,"connectionOption")]=t,this},e.prototype.missingTopicNotificationFilter=function(e){if(null!==e)try{this.theTopicSelectors.parse(e)}catch(e){throw new va.IllegalArgumentError("filter is invalid: "+e)}return this.theMissingTopicNotificationFilter=null===e?void 0:e,this},e.prototype.reset=function(){return this.thePrincipal="",this.theCredentials=void 0,this.theConnectionOptions={},this.theMissingTopicNotificationFilter=void 0,this},e.prototype.create=function(e,t){var r=Zl.requireNonNull(e,"name").trim();if(0===r.length)throw new va.IllegalArgumentError("Non whitespace name must be supplied");var n=Zl.requireNonNull(t,"url").trim();if(0===n.length)throw new va.IllegalArgumentError("Non whitespace url must be supplied");return new QS.RemoteServerDefinitionImpl(MS.RemoteServerType.SECONDARY_INITIATOR,r,[n],this.thePrincipal,this.theConnectionOptions,this.theCredentials,void 0,this.theMissingTopicNotificationFilter)},e}();t_.RemoteServerBuilderImpl=n_;var o_={};Object.defineProperty(o_,"__esModule",{value:!0}),o_.limitTimeout=void 0;var i_=Xu.create("Internal Session");o_.limitTimeout=function(e,t){return t>36e5?(i_.warn("CONFIG_EXCESSIVE_TIMEOUT",t,e,36e5),36e5):t};var s_={},a_=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u_=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c_=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s};function l_(e){var t=Number.parseInt(e.trim(),10);if(Number.isNaN(t))throw new va.IllegalArgumentError(e+" is not a number");return t}Object.defineProperty(s_,"__esModule",{value:!0}),s_.SecondaryBuilderImpl=void 0;var p_=function(e){function t(t,r){var n=e.call(this,t)||this;return n.thePrincipal="",n.theCredentials=void 0,n.theConnectionOptions={},n.theMissingTopicNotificationFilter=void 0,n.topicSelectors=r,n}return a_(t,e),t.minimumValueOption=function(e,t,r){var n;try{n=l_(t)}catch(r){throw new va.IllegalArgumentError("Connection Option '"+MS.ConnectionOption[e]+"' value '"+t+"' is invalid")}if(n<r)throw new va.IllegalArgumentError("Connection Option '"+MS.ConnectionOption[e]+"' value '"+t+"' cannot be less than "+r);return n.toString()},t.timeoutOption=function(e,t){try{return o_.limitTimeout(e.toString(),l_(t)).toString()}catch(r){throw new va.IllegalArgumentError("Connection Option '"+MS.ConnectionOption[e]+"' value '"+t+"' is invalid")}},t.prototype.validateConnectionOption=function(e,r){switch(this.validateOption(e,r),e){case MS.ConnectionOption.CONNECTION_TIMEOUT:case MS.ConnectionOption.WRITE_TIMEOUT:case MS.ConnectionOption.RECONNECTION_TIMEOUT:return t.timeoutOption(e,r);case MS.ConnectionOption.INPUT_BUFFER_SIZE:case MS.ConnectionOption.OUTPUT_BUFFER_SIZE:return t.minimumValueOption(e,r,Jv.MIN_MAX_MESSAGE_SIZE);case MS.ConnectionOption.MAXIMUM_QUEUE_SIZE:return t.minimumValueOption(e,r,1);case MS.ConnectionOption.RECOVERY_BUFFER_SIZE:case MS.ConnectionOption.RETRY_DELAY:return t.minimumValueOption(e,r,0);default:throw new va.IllegalArgumentError("Unknown option "+e)}},t.prototype.validateOption=function(e,r){if(null==r)throw new va.IllegalArgumentError("Connection Option '"+MS.ConnectionOption[e]+"' value is null");if(this.type===MS.RemoteServerType.SECONDARY_ACCEPTOR&&t.INVALID_ACCEPTOR_OPTIONS.includes(e))throw new va.IllegalArgumentError("Connection Option '"+MS.ConnectionOption[e]+"' cannot be specified for SECONDARY_ACCEPTOR servers")},t.prototype.getPrincipal=function(){return this.thePrincipal},t.prototype.getCredentials=function(){return this.theCredentials},t.prototype.getConnectionOptions=function(){return this.theConnectionOptions},t.prototype.getMissingTopicNotificationFilter=function(){return this.theMissingTopicNotificationFilter},t.prototype.principal=function(e){return this.thePrincipal=null!=e?e:"",this},t.prototype.credentials=function(e){return this.theCredentials=e||void 0,this},t.prototype.connectionOptions=function(e){var t,r,n={};try{for(var o=u_(Object.entries(e)),i=o.next();!i.done;i=o.next()){var s=c_(i.value,2),a=s[0],u=s[1],c=parseInt(a,10);n[c]=this.validateConnectionOption(c,u)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return this.theConnectionOptions=n,this},t.prototype.connectionOption=function(e,t){return Zl.requireNonNull(e,"connectionOption"),null==t?delete this.theConnectionOptions[e]:this.theConnectionOptions[e]=this.validateConnectionOption(e,t),this},t.prototype.missingTopicNotificationFilter=function(e){if(null!=e)try{this.topicSelectors.parse(e)}catch(e){throw new va.IllegalArgumentError("filter is invalid: "+e)}return this.theMissingTopicNotificationFilter=e||void 0,this},t.prototype.reset=function(){return this.thePrincipal="",this.theCredentials=void 0,this.theConnectionOptions={},this.theMissingTopicNotificationFilter=void 0,this},t.INVALID_ACCEPTOR_OPTIONS=[MS.ConnectionOption.RECONNECTION_TIMEOUT,MS.ConnectionOption.RETRY_DELAY,MS.ConnectionOption.RECOVERY_BUFFER_SIZE],t}(JS.RemoteServerBuilderBaseImpl);s_.SecondaryBuilderImpl=p_;var f_={},h_=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(f_,"__esModule",{value:!0}),f_.SecondaryAcceptorBuilderImpl=void 0;var d_=function(e){function t(t){return e.call(this,MS.RemoteServerType.SECONDARY_ACCEPTOR,t)||this}return h_(t,e),t.prototype.build=function(e,r){return QS.RemoteServerDefinitionImpl.createSecondaryDefinition(MS.RemoteServerType.SECONDARY_ACCEPTOR,t.validateName(e),Zl.requireNonNull(r,"primaryHostName"),this.getPrincipal(),this.getConnectionOptions(),this.getMissingTopicNotificationFilter(),this.getCredentials())},t}(s_.SecondaryBuilderImpl);f_.SecondaryAcceptorBuilderImpl=d_;var y_={},v_=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(y_,"__esModule",{value:!0}),y_.SecondaryInitiatorBuilderImpl=void 0;var S_=function(e){function t(t){return e.call(this,MS.RemoteServerType.SECONDARY_INITIATOR,t)||this}return v_(t,e),t.prototype.build=function(e,r){return QS.RemoteServerDefinitionImpl.createSecondaryDefinition(MS.RemoteServerType.SECONDARY_INITIATOR,t.validateName(e),this.validateUrl(r),this.getPrincipal(),this.getConnectionOptions(),this.getMissingTopicNotificationFilter(),this.getCredentials())},t}(s_.SecondaryBuilderImpl);y_.SecondaryInitiatorBuilderImpl=S_;var __={};Object.defineProperty(__,"__esModule",{value:!0}),__.BranchMappingTableImpl=void 0;var E_=function(){function e(e,t){this.sessionTreeBranch=e,this.branchMappings=t}return e.prototype.getSessionTreeBranch=function(){return this.sessionTreeBranch},e.prototype.getBranchMappings=function(){return this.branchMappings},e}();__.BranchMappingTableImpl=E_;var w_={},m_=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},g_=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};Object.defineProperty(w_,"__esModule",{value:!0}),w_.BranchMappingTableBuilderImpl=void 0;var T_=function(){function e(){this.mappings=[]}return e.prototype.reset=function(){return this.mappings=[],this},e.prototype.addBranchMapping=function(e,t){return this.mappings.push({sessionFilter:e,topicTreeBranch:t}),this},e.prototype.create=function(e){return new __.BranchMappingTableImpl(e,g_([],m_(this.mappings)))},e}();w_.BranchMappingTableBuilderImpl=T_;var O_={};Object.defineProperty(O_,"__esModule",{value:!0}),O_.newSessionEventParametersBuilder=O_.newRemoteServerBuilder=O_.newTopicMetricCollectorBuilder=O_.newSessionMetricCollectorBuilder=O_.newBranchMappingTableBuilder=O_.rolesToString=O_.stringToRoles=O_.escape=void 0,O_.escape=function(e){return Sh.escape(Zl.requireNonNull(e,"string"))},O_.stringToRoles=function(e){return Sh.stringToSet(Zl.requireNonNull(e,"string"))},O_.rolesToString=function(e){return Sh.collectionToString(Zl.requireNonNull(e,"roles"))},O_.newBranchMappingTableBuilder=function(){return new w_.BranchMappingTableBuilderImpl},O_.newSessionMetricCollectorBuilder=function(){return new kS.SessionMetricCollectorBuilderImpl},O_.newTopicMetricCollectorBuilder=function(){return new WS.TopicMetricCollectorBuilderImpl},O_.newRemoteServerBuilder=function(e,t){switch(t){case void 0:return new t_.RemoteServerBuilderImpl(e);case MS.RemoteServerType.PRIMARY_INITIATOR:return new XS.PrimaryInitiatorBuilderImpl;case MS.RemoteServerType.SECONDARY_ACCEPTOR:return new f_.SecondaryAcceptorBuilderImpl(e);case MS.RemoteServerType.SECONDARY_INITIATOR:return new y_.SecondaryInitiatorBuilderImpl(e);default:throw new va.IllegalArgumentError("Unknown remote server type")}},O_.newSessionEventParametersBuilder=function(){return new DS.SessionEventParametersBuilderImpl};var I_={},b_=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),R_=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},C_=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},A_=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},P_=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};Object.defineProperty(I_,"__esModule",{value:!0}),I_.registerTopicHandler=I_.registerRequestHandler=I_.registerHandler=I_.registrationCallback=I_.responseHandler=I_.ResponseHandlerState=void 0;var N_,M_=Xu.create("Registration");!function(e){e[e.REGISTERING=0]="REGISTERING",e[e.ACTIVE=1]="ACTIVE",e[e.CLOSED=2]="CLOSED"}(N_=I_.ResponseHandlerState||(I_.ResponseHandlerState={}));var D_=function(e){function t(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e.apply(this,P_([],A_(r)))||this;return o.cause=t,o}return b_(t,e),t}(Error);function j_(e,t,r){var n,o=N_.REGISTERING;return{onDiscard:function(r,n){try{n instanceof e.getContext().CloseReason?t.close():t.close(n)}catch(n){M_.error("REGISTERED_HANDLER_EXCEPTION",n)}o=N_.CLOSED},onOpen:function(t){n=function(){return new Promise((function(n,i){o!==N_.CLOSED?r(t,(function(r){r?(e.getConversationSet().discard(t,r),i(r)):(e.getConversationSet().respondIfPresent(t,N_.CLOSED),n())})):i(new Error("Handler already closed"))}))}},onResponse:function(r,i){if(i===N_.CLOSED){try{t.close()}catch(e){M_.error("REGISTERED_HANDLER_EXCEPTION",e)}return o=i,!0}try{return i===N_.ACTIVE?(t.active(n,r),o=i,!1):t.respond(i)}catch(t){M_.error("REGISTERED_HANDLER_EXCEPTION",t),e.getConversationSet().discard(r,new D_(t,"An error was thrown by the handler")),n().catch((function(e){M_.debug("Failed to deregister with the server",e)}))}return!0}}}function L_(e,t,r,n){return function(o){o?(e.discard(t,o),n(o)):(e.respondIfPresent(t,N_.ACTIVE),r())}}function x_(e,t,r,n,o){return R_(this,void 0,void 0,(function(){var i,s,a,u,c;return C_(this,(function(l){switch(l.label){case 0:return i=e.getConversationSet(),s=e.getServiceLocator(),a=s.obtain(n),u=s.obtain(o),[4,i.newConversation(j_(e,r,(function(e,r){u.send(t,r)})))];case 1:return c=l.sent(),[2,new Promise((function(e,r){a.send({params:t,cid:c},L_(i,c,e,r))}))]}}))}))}I_.responseHandler=j_,I_.registrationCallback=L_,I_.registerHandler=x_,I_.registerRequestHandler=function(e,t,r){return x_(e,t,r,kv.MESSAGING_RECEIVER_CONTROL_REGISTRATION,kv.MESSAGING_RECEIVER_CONTROL_DEREGISTRATION)},I_.registerTopicHandler=function(e,t,r){return x_(e,t,r,kv.TOPIC_CONTROL_REGISTRATION,kv.TOPIC_CONTROL_DEREGISTRATION)};var U_={};Object.defineProperty(U_,"__esModule",{value:!0}),U_.SessionFetchResultImpl=void 0;var B_=function(){function e(e,t){this.resultList=e,this.totalSelectedCount=t,this.hasMoreFlag=e.length<t}return e.prototype.results=function(){return this.resultList},e.prototype.hasMore=function(){return this.hasMoreFlag},e.prototype.size=function(){return this.resultList.length},e.prototype.totalSelected=function(){return this.totalSelectedCount},e.prototype.isEmpty=function(){return 0===this.resultList.length},e}();U_.SessionFetchResultImpl=B_;var q_={};Object.defineProperty(q_,"__esModule",{value:!0}),q_.StringSerialiser=void 0;var V_=function(){function e(){}return e.prototype.read=function(e){return Iu.readString(e)},e.prototype.write=function(e,t){Iu.writeString(e,t)},e}();q_.StringSerialiser=new V_;var k_={},F_=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(k_,"__esModule",{value:!0}),k_.TopicSelectorSerialiser=void 0;var G_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return F_(t,e),t.prototype.read=function(e){return xh.parseSelector(Iu.readString(e))},t.prototype.write=function(e,t){Iu.writeString(e,t.expression)},t}(Fu.AbstractSerialiser);k_.TopicSelectorSerialiser=new G_;var H_={};Object.defineProperty(H_,"__esModule",{value:!0}),H_.ClientFilterSubscribeRequest=void 0;var Y_=function(e,t){this.filter=e,this.selector=t};H_.ClientFilterSubscribeRequest=Y_;var W_={},z_=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(W_,"__esModule",{value:!0}),W_.ClientFilterSubscribeRequestSerialiser=void 0;var Q_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return z_(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=k_.TopicSelectorSerialiser.read(e);return new H_.ClientFilterSubscribeRequest(t,r)},t.prototype.write=function(e,t){Iu.writeString(e,t.filter),k_.TopicSelectorSerialiser.write(e,t.selector)},t}(Fu.AbstractSerialiser);W_.ClientFilterSubscribeRequestSerialiser=new Q_;var K_={};Object.defineProperty(K_,"__esModule",{value:!0}),K_.ErrorReportImpl=void 0;var J_=function(){function e(e,t,r){this.message=Zl.requireNonNull(e,"message"),this.line=t||0,this.column=r||0}return e.prototype.toString=function(){return"ErrorReport ["+this.message+" at ["+this.line+":"+this.column+"]]"},e}();K_.ErrorReportImpl=J_;var $_={},X_=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty($_,"__esModule",{value:!0}),$_.ErrorReportSerialiser=void 0;var Z_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return X_(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=Iu.readInt32(e),n=Iu.readInt32(e);return new K_.ErrorReportImpl(t,r,n)},t.prototype.write=function(e,t){Iu.writeString(e,t.message),Iu.writeInt32(e,t.line),Iu.writeInt32(e,t.column)},t}(Fu.AbstractSerialiser);$_.ErrorReportSerialiser=new Z_;var eE={};Object.defineProperty(eE,"__esModule",{value:!0}),eE.ClientFilterSubscribeResponse=void 0;var tE=function(){function e(e,t){this.selected=e,this.errors=t}return e.prototype.isSuccess=function(){return 0===this.errors.length},e}();eE.ClientFilterSubscribeResponse=tE;var rE={},nE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(rE,"__esModule",{value:!0}),rE.ClientFilterSubscribeResponseSerialiser=void 0;var oE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nE(t,e),t.prototype.read=function(e){if(Iu.readByte(e)){var t=Iu.readCollection(e,$_.ErrorReportSerialiser.read);return new eE.ClientFilterSubscribeResponse(0,t)}var r=Iu.readInt32(e);return new eE.ClientFilterSubscribeResponse(r,[])},t.prototype.write=function(e,t){t.isSuccess()?(Iu.writeByte(e,0),Iu.writeInt32(e,t.selected)):(Iu.writeByte(e,1),Iu.writeCollection(e,t.errors,$_.ErrorReportSerialiser.write))},t}(Fu.AbstractSerialiser);rE.ClientFilterSubscribeResponseSerialiser=new oE;var iE={};Object.defineProperty(iE,"__esModule",{value:!0}),iE.SessionIdSerialiser=void 0;var sE=function(){function e(){}return e.prototype.read=function(e){var t=Iu.readInt64(e),r=Iu.readInt64(e);return new qd.SessionId(t,r)},e.prototype.write=function(e,t){Iu.writeInt64(e,t.server),Iu.writeInt64(e,t.value)},e}();iE.SessionIdSerialiser=new sE;var aE={};Object.defineProperty(aE,"__esModule",{value:!0}),aE.ClientSubscribeRequest=void 0;var uE=function(e,t){this.sessionID=e,this.selector=t};aE.ClientSubscribeRequest=uE;var cE={},lE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(cE,"__esModule",{value:!0}),cE.ClientSubscribeRequestSerialiser=void 0;var pE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lE(t,e),t.prototype.read=function(e){var t=iE.SessionIdSerialiser.read(e),r=k_.TopicSelectorSerialiser.read(e);return new aE.ClientSubscribeRequest(t,r)},t.prototype.write=function(e,t){iE.SessionIdSerialiser.write(e,t.sessionID),k_.TopicSelectorSerialiser.write(e,t.selector)},t}(Fu.AbstractSerialiser);cE.ClientSubscribeRequestSerialiser=new pE;var fE={},hE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(fE,"__esModule",{value:!0}),fE.ChangeAuthorisationRolesFilterRequestSerialiser=void 0;var dE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return hE(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.filter),Iu.writeCollection(e,t.rolesToRemove,Iu.writeString),Iu.writeCollection(e,t.rolesToAdd,Iu.writeString)},t}(Fu.AbstractSerialiser);fE.ChangeAuthorisationRolesFilterRequestSerialiser=new dE;var yE={},vE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(yE,"__esModule",{value:!0}),yE.ChangeAuthorisationRolesRequestSerialiser=void 0;var SE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vE(t,e),t.prototype.write=function(e,t){if(void 0===t.sessionID||null===t.sessionID)throw new va.NullValueError("Session ID is null or undefined");iE.SessionIdSerialiser.write(e,t.sessionID),Iu.writeCollection(e,t.rolesToRemove,Iu.writeString),Iu.writeCollection(e,t.rolesToAdd,Iu.writeString)},t}(Fu.AbstractSerialiser);yE.ChangeAuthorisationRolesRequestSerialiser=new SE;var _E={};Object.defineProperty(_E,"__esModule",{value:!0}),_E.CloseClientRequest=void 0;var EE=function(){function e(e){this.sessionID=e}return e.prototype.toString=function(){return"CloseClientRequest ["+this.sessionID+"]"},e}();_E.CloseClientRequest=EE;var wE={},mE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(wE,"__esModule",{value:!0}),wE.CloseClientRequestSerialiser=void 0;var gE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mE(t,e),t.prototype.read=function(e){var t=iE.SessionIdSerialiser.read(e);return new _E.CloseClientRequest(t)},t.prototype.write=function(e,t){iE.SessionIdSerialiser.write(e,t.sessionID)},t}(Fu.AbstractSerialiser);wE.CloseClientRequestSerialiser=new gE;var TE={},OE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(TE,"__esModule",{value:!0}),TE.GetSessionPropertiesRequestSerialiser=void 0;var IE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return OE(t,e),t.prototype.write=function(e,t){if(void 0===t.sessionID||null===t.sessionID)throw new va.NullValueError("session ID is null or undefined");iE.SessionIdSerialiser.write(e,t.sessionID),void 0!==t.propertyKeys&&null!==t.propertyKeys?Iu.writeCollection(e,t.propertyKeys,Iu.writeString):Iu.writeCollection(e,[],Iu.writeString)},t}(Fu.AbstractSerialiser);TE.GetSessionPropertiesRequestSerialiser=new IE;var bE={};Object.defineProperty(bE,"__esModule",{value:!0}),bE.GetSessionPropertiesResponse=void 0;var RE=function(){function e(e){this.properties=e}return e.prototype.toString=function(){return"GetSessionPropertiesResponse []"},e}();bE.GetSessionPropertiesResponse=RE;var CE={},AE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(CE,"__esModule",{value:!0}),CE.GetSessionPropertiesResponseSerialiser=void 0;var PE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return AE(t,e),t.prototype.read=function(e){return Iu.readBoolean(e)?new bE.GetSessionPropertiesResponse(Iu.readDictionary(e,Iu.readString)):null},t}(Fu.AbstractSerialiser);CE.GetSessionPropertiesResponseSerialiser=new PE;var NE={};Object.defineProperty(NE,"__esModule",{value:!0}),NE.SessionPropertiesEventType=void 0,function(e){e[e.OPEN=0]="OPEN",e[e.UPDATE=1]="UPDATE",e[e.CLOSE=2]="CLOSE"}(NE.SessionPropertiesEventType||(NE.SessionPropertiesEventType={}));var ME,DE={},jE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(DE,"__esModule",{value:!0}),DE.SessionPropertiesEventSerialiser=void 0,function(e){e[e.NEW=1]="NEW",e[e.CHANGE=2]="CHANGE",e[e.REMOVE=3]="REMOVE",e[e.SAME=4]="SAME"}(ME||(ME={}));var LE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return jE(t,e),t.prototype.read=function(e){var t=iE.SessionIdSerialiser.read(e),r=Wh.read(e,NE.SessionPropertiesEventType);switch(r){case NE.SessionPropertiesEventType.OPEN:var n=Iu.readDictionary(e,Iu.readString);return{sessionId:t,type:NE.SessionPropertiesEventType.OPEN,oldProperties:n};case NE.SessionPropertiesEventType.UPDATE:return function(e,t){for(var r=Iu.readByte(e),n={},o={},i=Iu.readInt32(e),s=0;s<i;++s){var a=Iu.readString(e);switch(Wh.read(e,ME)){case ME.NEW:n[a]=null,o[a]=Iu.readString(e);break;case ME.CHANGE:n[a]=Iu.readString(e),o[a]=Iu.readString(e);break;case ME.REMOVE:n[a]=Iu.readString(e);break;case ME.SAME:o[a]=Iu.readString(e);break;default:throw new va.IOError("Invalid update entry type: type")}}return{sessionId:t,type:NE.SessionPropertiesEventType.UPDATE,updateType:r,oldProperties:n,newProperties:o}}(e,t);case NE.SessionPropertiesEventType.CLOSE:var o=Wh.read(e,Ny.ClientCloseReason),i=Iu.readDictionary(e,Iu.readString);return{sessionId:t,type:NE.SessionPropertiesEventType.CLOSE,oldProperties:i,closeReason:o};default:throw new va.IOError("Unknown session properties event type: "+r)}},t}(Fu.AbstractSerialiser);DE.SessionPropertiesEventSerialiser=new LE;var xE={};Object.defineProperty(xE,"__esModule",{value:!0}),xE.SessionPropertiesEventBatch=void 0;var UE=function(e,t){this.cid=e,this.events=t};xE.SessionPropertiesEventBatch=UE;var BE={},qE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(BE,"__esModule",{value:!0}),BE.SessionPropertiesEventBatchSerialiser=void 0;var VE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qE(t,e),t.prototype.read=function(e){var t=Vu.CIDSerialiser.read(e),r=Iu.readCollection(e,DE.SessionPropertiesEventSerialiser.read);return new xE.SessionPropertiesEventBatch(t,r)},t}(Fu.AbstractSerialiser);BE.SessionPropertiesEventBatchSerialiser=new VE;var kE={},FE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(kE,"__esModule",{value:!0}),kE.SetClientConflationFilterRequestSerialiser=void 0;var GE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return FE(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.filter),Iu.writeBoolean(e,t.conflate)},t}(Fu.AbstractSerialiser);kE.SetClientConflationFilterRequestSerialiser=new GE;var HE={},YE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(HE,"__esModule",{value:!0}),HE.SetClientConflationRequestSerialiser=void 0;var WE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return YE(t,e),t.prototype.write=function(e,t){iE.SessionIdSerialiser.write(e,t.sessionID),Iu.writeBoolean(e,t.conflate)},t}(Fu.AbstractSerialiser);HE.SetClientConflationRequestSerialiser=new WE;var zE={},QE=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(zE,"__esModule",{value:!0}),zE.SetSessionPropertiesFilterRequestSerialiser=void 0;var KE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return QE(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.filter),0===Object.keys(t.overwriteProperties).length?Iu.writeByte(e,0):(Iu.writeByte(e,1),Iu.writeDictionary(e,t.overwriteProperties,Iu.writeString)),0===Object.keys(t.removeProperties).length?Iu.writeByte(e,0):(Iu.writeByte(e,1),Iu.writeCollection(e,t.removeProperties,Iu.writeString))},t}(Fu.AbstractSerialiser);zE.SetSessionPropertiesFilterRequestSerialiser=new KE;var JE={},$E=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(JE,"__esModule",{value:!0}),JE.SetSessionPropertiesListenerSerialiser=void 0;var XE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $E(t,e),t.prototype.write=function(e,t){t.properties?(Iu.writeInt32(e,0),Iu.writeCollection(e,t.properties,Iu.writeString)):Iu.writeInt32(e,1),Vu.CIDSerialiser.write(e,t.cid)},t}(Fu.AbstractSerialiser);JE.SetSessionPropertiesListenerSerialiser=new XE;var ZE={},ew=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ZE,"__esModule",{value:!0}),ZE.SetSessionPropertiesRequestSerialiser=void 0;var tw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ew(t,e),t.prototype.write=function(e,t){if(void 0===t.sessionID||null===t.sessionID)throw new va.NullValueError("Session ID is null or undefined");iE.SessionIdSerialiser.write(e,t.sessionID),0===Object.keys(t.overwriteProperties).length?Iu.writeByte(e,0):(Iu.writeByte(e,1),Iu.writeDictionary(e,t.overwriteProperties,Iu.writeString)),0===Object.keys(t.removeProperties).length?Iu.writeByte(e,0):(Iu.writeByte(e,1),Iu.writeCollection(e,t.removeProperties,Iu.writeString))},t}(Fu.AbstractSerialiser);ZE.SetSessionPropertiesRequestSerialiser=new tw;var rw={},nw=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(rw,"__esModule",{value:!0}),rw.SetSessionPropertiesResult=void 0;var ow=function(e,t){var r,n,o,i;this.properties={};try{for(var s=nw(Object.getOwnPropertyNames(e)),a=s.next();!a.done;a=s.next()){var u=a.value;this.properties[u]=e[u]}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}try{for(var c=nw(t),l=c.next();!l.done;l=c.next()){var p=l.value;this.properties[p]=null}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}};rw.SetSessionPropertiesResult=ow;var iw={},sw=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(iw,"__esModule",{value:!0}),iw.SetSessionPropertiesResultSerialiser=void 0;var aw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return sw(t,e),t.prototype.read=function(e){var t,r;return t=0===Iu.readByte(e)?{}:Iu.readDictionary(e,Iu.readString),r=0===Iu.readByte(e)?[]:Iu.readCollection(e,Iu.readString),new rw.SetSessionPropertiesResult(t,r)},t}(Fu.AbstractSerialiser);iw.SetSessionPropertiesResultSerialiser=new aw;var uw={};Object.defineProperty(uw,"__esModule",{value:!0}),uw.CountOrParserErrors=void 0;var cw=function(e,t){this.count=Zl.requireNonNull(e,"count"),this.errors=Zl.requireNonNull(t,"errors")};uw.CountOrParserErrors=cw;var lw={},pw=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(lw,"__esModule",{value:!0}),lw.CountOrParserErrorsSerialiser=void 0;var fw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pw(t,e),t.prototype.read=function(e){var t=Iu.readInt32(e),r=Iu.readCollection(e,$_.ErrorReportSerialiser.read);return new uw.CountOrParserErrors(t,r)},t.prototype.write=function(e,t){Iu.writeInt32(e,t.count),Iu.writeCollection(e,t.errors,$_.ErrorReportSerialiser.write)},t}(Fu.AbstractSerialiser);lw.CountOrParserErrorsSerialiser=new fw;var hw={};Object.defineProperty(hw,"__esModule",{value:!0}),hw.ErrorReportList=void 0;var dw=function(){function e(e){this.errors=Zl.requireNonNull(e,"errors")}return e.prototype.toString=function(){return"ErrorReportList ["+this.errors+"]"},e}();hw.ErrorReportList=dw;var yw={},vw=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(yw,"__esModule",{value:!0}),yw.ErrorReportListSerialiser=void 0;var Sw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vw(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,$_.ErrorReportSerialiser.read);return new hw.ErrorReportList(t)},t.prototype.write=function(e,t){Iu.writeCollection(e,t.errors,$_.ErrorReportSerialiser.write)},t}(Fu.AbstractSerialiser);yw.ErrorReportListSerialiser=new Sw;var _w={};Object.defineProperty(_w,"__esModule",{value:!0}),_w.SessionFetchQueryResult=void 0;var Ew=function(e,t,r){this.results=e,this.totalCount=t,this.errors=r};_w.SessionFetchQueryResult=Ew;var ww={},mw=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function gw(e){var t=null;1===Iu.readByte(e)&&(t=Iu.readInt64(e));var r=Iu.readDictionary(e,Iu.readString);return t&&(r.$StartTime=t.toString()),r}Object.defineProperty(ww,"__esModule",{value:!0}),ww.SessionFetchQueryResultSerialiser=void 0;var Tw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return mw(t,e),t.prototype.read=function(e){if(0===Iu.readByte(e)){var t=Iu.readCollection(e,gw),r=Iu.readInt32(e);return new _w.SessionFetchQueryResult(t,r)}var n=yw.ErrorReportListSerialiser.read(e);return new _w.SessionFetchQueryResult(void 0,void 0,n)},t}(Fu.AbstractSerialiser);ww.SessionFetchQueryResultSerialiser=new Tw;var Ow={},Iw=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),bw=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},Rw=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};function Cw(e,t){void 0===t?Iu.writeByte(e,0):(Iu.writeByte(e,1),Iu.writeInt64(e,t))}Object.defineProperty(Ow,"__esModule",{value:!0}),Ow.SessionFetchQuerySerialiser=void 0;var Aw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Iw(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.filter),function(e,t){null===t?Iu.writeByte(e,0):(Iu.writeByte(e,1),Iu.writeCollection(e,Rw([],bw(t)),Iu.writeString))}(e,t.withProperties),function(e,t){Cw(e,t.from),Cw(e,t.to)}(e,t.range),function(e,t){t===Sl.MAX_INT32?Iu.writeByte(e,0):(Iu.writeByte(e,1),Iu.writeInt32(e,t))}(e,t.limit),Iu.writeInt32(e,t.maximumResultSize),Iu.writeBoolean(e,t.requiresStartTime)},t}(Fu.AbstractSerialiser);Ow.SessionFetchQuerySerialiser=new Aw;var Pw={},Nw=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Mw=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},Dw=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};Object.defineProperty(Pw,"__esModule",{value:!0}),Pw.SessionEventListenerRegistrationRequestSerialiser=void 0;var jw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nw(t,e),t.prototype.write=function(e,t){Iu.writeBoolean(e,t.isClusterAware),Iu.writeOptional(e,t.sessionFilter,Iu.writeString),Iu.writeOptional(e,t.requestedProperties,(function(e,t){Iu.writeCollection(e,Dw([],Mw(t.values())),Iu.writeString)}),(function(e){return null!=e&&e.size>0})),Iu.writeOptional(e,t.sessionStartTime,Iu.writeInt64,(function(e){return null!=e&&ka.fromValue(e)!==ka.ZERO})),Vu.CIDSerialiser.write(e,t.conversationId)},t}(Fu.AbstractSerialiser);Pw.SessionEventListenerRegistrationRequestSerialiser=new jw;var Lw={};Object.defineProperty(Lw,"__esModule",{value:!0}),Lw.SESSION_EVENT_DEREGISTRATION=Lw.SESSION_EVENT_REGISTRATION=Lw.SESSION_FETCH=Lw.SET_CLIENT_CONFLATION_FILTER=Lw.CLOSE_CLIENT_FILTER=Lw.CHANGE_AUTHORISATION_ROLES_FILTER=Lw.CHANGE_AUTHORISATION_ROLES=Lw.SET_SESSION_PROPERTIES_FILTER=Lw.SET_SESSION_PROPERTIES=Lw.SESSION_PROPERTIES_EVENT_2=Lw.SESSION_PROPERTIES_REGISTRATION_2=Lw.GET_SESSION_PROPERTIES=Lw.FILTER_UNSUBSCRIBE=Lw.FILTER_SUBSCRIBE=Lw.SET_CLIENT_CONFLATION=Lw.CLOSE_CLIENT=Lw.UNSUBSCRIBE_CLIENT=Lw.SUBSCRIBE_CLIENT=void 0,Lw.SUBSCRIBE_CLIENT={id:10,request:cE.ClientSubscribeRequestSerialiser,response:av.NullSerialiser},Lw.UNSUBSCRIBE_CLIENT={id:11,request:cE.ClientSubscribeRequestSerialiser,response:av.NullSerialiser},Lw.CLOSE_CLIENT={id:14,request:wE.CloseClientRequestSerialiser,response:av.NullSerialiser},Lw.SET_CLIENT_CONFLATION={id:15,request:HE.SetClientConflationRequestSerialiser,response:av.NullSerialiser},Lw.FILTER_SUBSCRIBE={id:65,request:W_.ClientFilterSubscribeRequestSerialiser,response:rE.ClientFilterSubscribeResponseSerialiser},Lw.FILTER_UNSUBSCRIBE={id:66,request:W_.ClientFilterSubscribeRequestSerialiser,response:rE.ClientFilterSubscribeResponseSerialiser},Lw.GET_SESSION_PROPERTIES={id:67,request:TE.GetSessionPropertiesRequestSerialiser,response:CE.GetSessionPropertiesResponseSerialiser},Lw.SESSION_PROPERTIES_REGISTRATION_2={id:81,request:JE.SetSessionPropertiesListenerSerialiser,response:av.NullSerialiser},Lw.SESSION_PROPERTIES_EVENT_2={id:82,request:BE.SessionPropertiesEventBatchSerialiser,response:av.NullSerialiser},Lw.SET_SESSION_PROPERTIES={id:105,request:ZE.SetSessionPropertiesRequestSerialiser,response:iw.SetSessionPropertiesResultSerialiser},Lw.SET_SESSION_PROPERTIES_FILTER={id:106,request:zE.SetSessionPropertiesFilterRequestSerialiser,response:lw.CountOrParserErrorsSerialiser},Lw.CHANGE_AUTHORISATION_ROLES={id:123,request:yE.ChangeAuthorisationRolesRequestSerialiser,response:av.NullSerialiser},Lw.CHANGE_AUTHORISATION_ROLES_FILTER={id:124,request:fE.ChangeAuthorisationRolesFilterRequestSerialiser,response:lw.CountOrParserErrorsSerialiser},Lw.CLOSE_CLIENT_FILTER={id:162,request:q_.StringSerialiser,response:lw.CountOrParserErrorsSerialiser},Lw.SET_CLIENT_CONFLATION_FILTER={id:163,request:kE.SetClientConflationFilterRequestSerialiser,response:lw.CountOrParserErrorsSerialiser},Lw.SESSION_FETCH={id:168,request:Ow.SessionFetchQuerySerialiser,response:ww.SessionFetchQueryResultSerialiser},Lw.SESSION_EVENT_REGISTRATION={id:189,request:Pw.SessionEventListenerRegistrationRequestSerialiser,response:yw.ErrorReportListSerialiser},Lw.SESSION_EVENT_DEREGISTRATION={id:190,request:Vu.CIDSerialiser,response:av.NullSerialiser};var xw={};Object.defineProperty(xw,"__esModule",{value:!0}),xw.SessionFetchQuery=void 0;var Uw=function(e,t,r,n,o,i){this.filter=e,this.range=t,this.withProperties=r,this.limit=n,this.maximumResultSize=o,this.requiresStartTime=i};xw.SessionFetchQuery=Uw;var Bw={};Object.defineProperty(Bw,"__esModule",{value:!0}),Bw.SessionState=Bw.SessionEventStreamEventType=Bw.SessionEventType=void 0,function(e){e[e.UPDATED=0]="UPDATED",e[e.RECONNECTED=1]="RECONNECTED",e[e.FAILED_OVER=2]="FAILED_OVER",e[e.DISCONNECTED=3]="DISCONNECTED"}(Bw.SessionEventType||(Bw.SessionEventType={})),function(e){e[e.STATE=0]="STATE",e[e.PROPERTIES=1]="PROPERTIES"}(Bw.SessionEventStreamEventType||(Bw.SessionEventStreamEventType={})),function(e){e[e.ACTIVE=0]="ACTIVE",e[e.DISCONNECTED=1]="DISCONNECTED",e[e.RECONNECTED=2]="RECONNECTED",e[e.FAILED_OVER=3]="FAILED_OVER",e[e.CLOSED=4]="CLOSED"}(Bw.SessionState||(Bw.SessionState={}));var qw={};Object.defineProperty(qw,"__esModule",{value:!0}),qw.ClientControlOptions=void 0,qw.ClientControlOptions={PropertyKeys:Object.freeze({ALL_FIXED_PROPERTIES:["*F"],ALL_USER_PROPERTIES:["*U"],ALL_PROPERTIES:["*F","*U"],SESSION_ID:"$SessionId",PRINCIPAL:"$Principal",CONNECTOR:"$Connector",TRANSPORT:"$Transport",CLIENT_TYPE:"$ClientType",COUNTRY:"$Country",LANGUAGE:"$Language",SERVER_NAME:"$ServerName",CLIENT_IP:"$ClientIP",LATITUDE:"$Latitude",LONGITUDE:"$Longitude",START_TIME:"$StartTime",ROLES:"$Roles",MQTT_CLIENT_ID:"$MQTTClientId",GATEWAY_TYPE:"$GatewayType",GATEWAY_ID:"$GatewayId",ENVIRONMENT:"$Environment"}),ANONYMOUS:"",CloseReason:Ny.CloseReasonEnum,SessionEventStreamEventType:Bw.SessionEventStreamEventType,SessionState:Bw.SessionState};var Vw={};Object.defineProperty(Vw,"__esModule",{value:!0}),Vw.SessionFetchRequestImpl=void 0;var kw=Xu.create("Session Fetch Request"),Fw=function(){function e(e,t){this.from=e,this.to=t}return e.prototype.isUnbounded=function(){return void 0===this.from&&void 0===this.to},e}();function Gw(e,t){if(!Number.isInteger(e)||e<0)throw new va.IllegalArgumentError("Invalid argument '"+t+"': "+e);return e}function Hw(e,t){if(e instanceof ka&&e.gte(0))return e;if("number"==typeof e&&Number.isInteger(e)&&e>=0)return ka.fromNumber(e);throw new va.IllegalArgumentError("Invalid argument '"+t+"': "+e)}var Yw=function(){function e(e,t){var r={range:new Fw,filter:"all",withProperties:null,limit:Sl.MAX_INT32,maximumResultSize:e.getOptions().maxMessageSize};this.internal=e,this.options=Object.assign(r,t)}return e.prototype.copyOptions=function(){return{range:new Fw(this.options.range.from,this.options.range.to),filter:this.options.filter,withProperties:this.options.withProperties,limit:this.options.limit,maximumResultSize:this.options.maximumResultSize}},e.prototype.from=function(t){var r=Hw(t,"time");return new e(this.internal,Object.assign(this.copyOptions(),{range:new Fw(r,this.options.range.to)}))},e.prototype.to=function(t){var r=Hw(t,"time");return new e(this.internal,Object.assign(this.copyOptions(),{range:new Fw(this.options.range.from,r)}))},e.prototype.withProperties=function(t){return new e(this.internal,Object.assign(this.copyOptions(),{withProperties:t}))},e.prototype.first=function(t){return new e(this.internal,Object.assign(this.copyOptions(),{limit:Gw(t,"count")}))},e.prototype.last=function(t){return new e(this.internal,Object.assign(this.copyOptions(),{limit:0-Gw(t,"count")}))},e.prototype.maximumResultSize=function(t){return new e(this.internal,Object.assign(this.copyOptions(),{maximumResultSize:Math.min(Gw(t,"maximumSize"),this.internal.getOptions().maxMessageSize)}))},e.prototype.filter=function(t){return new e(this.internal,Object.assign(this.copyOptions(),{filter:t}))},e.prototype.fetch=function(){var e=this.internal.getServiceLocator().obtain(Lw.SESSION_FETCH),t=this.options.withProperties&&new Set(this.options.withProperties),r=!t||t.has(qw.ClientControlOptions.PropertyKeys.START_TIME)||t.has(qw.ClientControlOptions.PropertyKeys.ALL_FIXED_PROPERTIES[0]),n=new xw.SessionFetchQuery(this.options.filter,this.options.range,t,this.options.limit,this.options.maximumResultSize,r);return new Promise((function(t,r){e.send(n,(function(e,n){od.responseSuccess(e,n)?n.errors?(kw.debug("Session fetch query failed"),r(n.errors.errors)):t(new U_.SessionFetchResultImpl(n.results||[],n.totalCount||0)):(kw.debug("Session fetch query failed"),r(e))}))}))},e}();Vw.SessionFetchRequestImpl=Yw;var Ww={};Object.defineProperty(Ww,"__esModule",{value:!0}),Ww.ChangeAuthorisationRolesFilterRequest=void 0;var zw=function(e,t,r){this.filter=e,this.rolesToRemove=t,this.rolesToAdd=r};Ww.ChangeAuthorisationRolesFilterRequest=zw;var Qw={};Object.defineProperty(Qw,"__esModule",{value:!0}),Qw.ChangeAuthorisationRolesRequest=void 0;var Kw=function(e,t,r){this.sessionID=e,this.rolesToRemove=t,this.rolesToAdd=r};Qw.ChangeAuthorisationRolesRequest=Kw;var Jw={};Object.defineProperty(Jw,"__esModule",{value:!0}),Jw.SetClientConflationFilterRequest=void 0;var $w=function(e,t){this.filter=e,this.conflate=t};Jw.SetClientConflationFilterRequest=$w;var Xw={};Object.defineProperty(Xw,"__esModule",{value:!0}),Xw.SetClientConflationRequest=void 0;var Zw=function(e,t){this.sessionID=e,this.conflate=t};Xw.SetClientConflationRequest=Zw;var em={};Object.defineProperty(em,"__esModule",{value:!0}),em.SetSessionPropertiesFilterRequest=void 0;var tm=function(e,t,r){this.filter=e,this.overwriteProperties=t,this.removeProperties=r};em.SetSessionPropertiesFilterRequest=tm;var rm={};Object.defineProperty(rm,"__esModule",{value:!0}),rm.SessionEventListenerRegistrationRequest=void 0;var nm=function(e,t,r,n,o){this.isClusterAware=e,this.sessionFilter=t,this.requestedProperties=r,this.sessionStartTime=n,this.conversationId=o};rm.SessionEventListenerRegistrationRequest=nm;var om={},im=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},sm=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},am=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},um=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},cm=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};Object.defineProperty(om,"__esModule",{value:!0}),om.ClientControlImpl=void 0;var lm=Xu.create("Session.Clients");function pm(e){switch(e.type){case NE.SessionPropertiesEventType.CLOSE:return Bw.SessionState.CLOSED;case NE.SessionPropertiesEventType.OPEN:return Bw.SessionState.ACTIVE;case NE.SessionPropertiesEventType.UPDATE:default:switch(e.updateType){case Bw.SessionEventType.DISCONNECTED:return Bw.SessionState.DISCONNECTED;case Bw.SessionEventType.FAILED_OVER:return Bw.SessionState.FAILED_OVER;case Bw.SessionEventType.RECONNECTED:return Bw.SessionState.RECONNECTED;case Bw.SessionEventType.UPDATED:default:return Bw.SessionState.ACTIVE}}}var fm=function(){function e(e){this.SessionEventType=Bw.SessionEventType,this.internal=e,this.serviceLocator=e.getServiceLocator(),this.SET_CLIENT_CONFLATION=this.serviceLocator.obtain(Lw.SET_CLIENT_CONFLATION),this.SET_CLIENT_CONFLATION_FILTER=this.serviceLocator.obtain(Lw.SET_CLIENT_CONFLATION_FILTER),this.GET_SESSION_PROPERTIES=this.serviceLocator.obtain(Lw.GET_SESSION_PROPERTIES),this.SESSION_PROPERTIES_REGISTRATION=this.serviceLocator.obtain(Lw.SESSION_PROPERTIES_REGISTRATION_2),this.CHANGE_AUTHORISATION_ROLES=this.serviceLocator.obtain(Lw.CHANGE_AUTHORISATION_ROLES),this.CHANGE_AUTHORISATION_ROLES_FILTER=this.serviceLocator.obtain(Lw.CHANGE_AUTHORISATION_ROLES_FILTER),this.SET_SESSION_PROPERTIES_FILTER=this.serviceLocator.obtain(Lw.SET_SESSION_PROPERTIES_FILTER),this.SESSION_EVENT_REGISTRATION=this.serviceLocator.obtain(Lw.SESSION_EVENT_REGISTRATION),this.SESSION_EVENT_DEREGISTRATION=this.serviceLocator.obtain(Lw.SESSION_EVENT_DEREGISTRATION),this.internal.getServiceRegistry().add(Lw.SESSION_PROPERTIES_EVENT_2,{onRequest:function(e,t,r){e.getConversationSet().respondIfPresent(t.cid,t),r.respond()}})}return e.prototype.close=function(e){var t=this;return new Promise((function(r,n){try{Zl.requireNonNull(e,"sessions")}catch(e){return void n(e)}if(t.internal.checkConnected(n)){var o=qd.SessionId.validate(e);o?t.serviceLocator.obtain(Lw.CLOSE_CLIENT).send({sessionID:o},(function(e,t){e?n(e):r(1)})):"string"==typeof e?t.serviceLocator.obtain(Lw.CLOSE_CLIENT_FILTER).send(e,(function(e,t){od.responseSuccess(e,t)?t.errors.length>0?n(t.errors):r(t.count):n(e)})):n(new Error("Invalid SessionID: "+e))}}))},e.prototype.subscribe=function(e,t){var r=this;return new Promise((function(n,o){try{e=Zl.requireNonNull(e,"SessionID or Session Filter"),t=Zl.requireNonNull(t,"Topic Selector")}catch(e){return void o(e)}if(r.internal.checkConnected(o)){var i=void 0;try{i=r.internal.getContext().parseSelector(t)}catch(e){return void o(e)}var s=qd.SessionId.validate(e);s?r.serviceLocator.obtain(Lw.SUBSCRIBE_CLIENT).send({sessionID:s,selector:i},(function(e){e?o(e):n()})):r.serviceLocator.obtain(Lw.FILTER_SUBSCRIBE).send({filter:e,selector:i},(function(e,t){od.responseSuccess(e,t)?t.isSuccess()?n(t.selected):o(t.errors):o(e)}))}}))},e.prototype.unsubscribe=function(e,t){var r=this;return new Promise((function(n,o){try{Zl.requireNonNull(e,"SessionID or Session Filter"),Zl.requireNonNull(t,"Topic Selector")}catch(e){return void o(e)}if(r.internal.checkConnected(o)){var i=void 0;try{i=r.internal.getContext().parseSelector(t)}catch(e){return void o(e)}var s=qd.SessionId.validate(e);s?r.serviceLocator.obtain(Lw.UNSUBSCRIBE_CLIENT).send({sessionID:s,selector:i},(function(e){e?o(e):n()})):r.serviceLocator.obtain(Lw.FILTER_UNSUBSCRIBE).send({filter:e,selector:i},(function(e,t){od.responseSuccess(e,t)?t.isSuccess()?n(t.selected):o(t.errors):o(e)}))}}))},e.prototype.getSessionProperties=function(e,t){var r=this;return void 0===t&&(t=[]),new Promise((function(n,o){"string"==typeof e&&(e=qd.SessionId.fromString(e)),r.internal.checkConnected(o)&&r.GET_SESSION_PROPERTIES.send({sessionID:e,propertyKeys:t},(function(e,t){od.responseSuccess(e,t)?null===t?o(new Error("Invalid session ID")):n(t.properties):o(e)}))}))},e.prototype.setSessionProperties=function(e,t){var r=this;return new Promise((function(n,o){try{Zl.requireNonNull(e,"sessionId"),Zl.requireNonNull(t,"properties")}catch(e){return void o(e)}if("string"==typeof e&&(e=qd.SessionId.fromString(e)),r.internal.checkConnected(o)){var i={},s=[];r.extractOverwriteAndRemoveProperties(i,s,t),r.serviceLocator.obtain(Lw.SET_SESSION_PROPERTIES).send({sessionID:e,overwriteProperties:i,removeProperties:s},(function(e,t){od.responseSuccess(e,t)?n(t.properties):o(e)}))}}))},e.prototype.setOverwriteOrRemoveProperty=function(e,t,r,n){null===n?t.push(r):e[r]=n},e.prototype.extractOverwriteAndRemoveProperties=function(e,t,r){var n,o,i=this;if(r.forEach instanceof Function)r.forEach((function(r,n){i.setOverwriteOrRemoveProperty(e,t,r,n)}));else try{for(var s=am(Object.getOwnPropertyNames(r)),a=s.next();!a.done;a=s.next()){var u=a.value;this.setOverwriteOrRemoveProperty(e,t,u,r[u])}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},e.prototype.setSessionPropertiesByFilter=function(e,t){var r=this;return new Promise((function(n,o){try{Zl.requireNonNull(e,"filter"),Zl.requireNonNull(t,"properties")}catch(e){return void o(e)}if(r.internal.checkConnected(o)){var i={},s=[],a=new em.SetSessionPropertiesFilterRequest(e,i,s);r.extractOverwriteAndRemoveProperties(i,s,t),r.SET_SESSION_PROPERTIES_FILTER.send(a,(function(e,t){od.responseSuccess(e,t)?t.errors.length>0?o(t.errors):n(t.count):o(e)}))}}))},e.prototype.setSessionPropertiesListener=function(e,t){var r=this;return new Promise((function(n,o){return im(r,void 0,void 0,(function(){var r,i,s,a=this;return sm(this,(function(u){switch(u.label){case 0:return t||o(new Error("Session Properties listener is null or undefined")),this.internal.checkConnected(o)?(lm.debug("Adding Session Properties Listener"),r={active:function(e){lm.debug("Session Properties Listener active"),t.onActive(e)},respond:function(e){var r,n;try{for(var o=am(e.events),i=o.next();!i.done;i=o.next()){var s=i.value;switch(s.type){case NE.SessionPropertiesEventType.OPEN:t.onSessionOpen(s.sessionId,s.oldProperties);break;case NE.SessionPropertiesEventType.UPDATE:t.onSessionEvent(s.sessionId,s.updateType,s.newProperties,s.oldProperties);break;case NE.SessionPropertiesEventType.CLOSE:t.onSessionClose(s.sessionId,s.oldProperties,s.closeReason);break;default:lm.debug("Unknown event type received for session properties listener",s.type)}}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1},close:function(e){lm.debug("Session Properties Listener closed"),e?t.onError(e):t.onClose()}},[4,(i=this.internal.getConversationSet()).newConversation(I_.responseHandler(this.internal,r,(function(e,t){a.SESSION_PROPERTIES_REGISTRATION.send({cid:e},t)})))]):[3,2];case 1:s=u.sent(),this.SESSION_PROPERTIES_REGISTRATION.send({cid:s,properties:e},I_.registrationCallback(i,s,n,o)),u.label=2;case 2:return[2]}}))}))}))},e.prototype.addSessionEventListener=function(e,t){var r=this;return new Promise((function(n,o){return im(r,void 0,void 0,(function(){var r,i,s,a,u=this;return sm(this,(function(c){switch(c.label){case 0:return e?t?this.internal.checkConnected(o)?(lm.debug("Adding Session Event Listener"),r={active:function(e){lm.debug("Session Event Listener active"),n({close:e})},respond:function(t){var r,n,o;try{for(var i=am(t.events),s=i.next();!s.done;s=i.next()){var a=s.value;e.onSessionEvent({sessionId:(o=a).sessionId,type:o.type===NE.SessionPropertiesEventType.UPDATE?Bw.SessionEventStreamEventType.PROPERTIES:Bw.SessionEventStreamEventType.STATE,properties:o.type!==NE.SessionPropertiesEventType.UPDATE?o.oldProperties:o.newProperties,state:pm(o),changedProperties:o.type===NE.SessionPropertiesEventType.UPDATE?o.oldProperties:{},closeReason:o.type===NE.SessionPropertiesEventType.CLOSE?o.closeReason:void 0,isOpenEvent:function(){return this.type===Bw.SessionEventStreamEventType.STATE&&this.state===Bw.SessionState.ACTIVE}})}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return!1},close:function(t){lm.debug("Session Properties Listener closed"),t?e.onError(t instanceof qa.ErrorReason?t:_c.ErrorReason.COMMUNICATION_FAILURE):e.onClose()}},[4,(i=this.internal.getConversationSet()).newConversation(I_.responseHandler(this.internal,r,(function(e,t){u.SESSION_EVENT_DEREGISTRATION.send(s,t)})))]):[3,2]:(o(new va.NullValueError("parameters is null or undefined")),[2]):(o(new va.NullValueError("listener is null or undefined")),[2]);case 1:s=c.sent(),this.SESSION_EVENT_REGISTRATION.send(new rm.SessionEventListenerRegistrationRequest(!0,t.filter,t.properties,ka.fromNumber(null!==(a=t.after)&&void 0!==a?a:0),s),(function(e,t){e?(i.discard(s,e),o(e)):(null==t?void 0:t.errors.length)?(i.discard(s,t.errors),o(new Error("Session filter is invalid"))):i.respondIfPresent(s,I_.ResponseHandlerState.ACTIVE)})),c.label=2;case 2:return[2]}}))}))}))},e.prototype.changeRoles=function(e,t,r){var n=this,o=Array.isArray(t)?t:cm([],um(t)),i=Array.isArray(r)?r:cm([],um(r));if(0===o.length&&0===i.length)throw new va.IllegalArgumentError("rolesToRemove and rolesToAdd cannot both be empty");Zl.requireNonNull(e,"sessions");var s=qd.SessionId.validate(e);return new Promise((function(t,r){if(n.internal.checkConnected(r))if(!1===s){var a=new Ww.ChangeAuthorisationRolesFilterRequest(e,o,i);n.CHANGE_AUTHORISATION_ROLES_FILTER.send(a,(function(e,n){e?r(e):n.errors.length>0?r(n.errors):t(n.count)}))}else{a=new Qw.ChangeAuthorisationRolesRequest(s,o,i);n.CHANGE_AUTHORISATION_ROLES.send(a,(function(e){e?r(e):t(1)}))}}))},e.prototype.setConflated=function(e,t){var r=this;return new Promise((function(n,o){try{Zl.requireNonNull(e,"sessions")}catch(e){return void o(e)}if(r.internal.checkConnected(o)){var i=qd.SessionId.validate(e);if(i){var s=new Xw.SetClientConflationRequest(i,t);r.SET_CLIENT_CONFLATION.send(s,(function(e){e?o(e):n(1)}))}else if("string"==typeof e){s=new Jw.SetClientConflationFilterRequest(e,t);r.SET_CLIENT_CONFLATION_FILTER.send(s,(function(e,t){od.responseSuccess(e,t)?t.errors.length>0?o(t.errors):n(t.count):o(e)}))}else o(new Error("Invalid SessionID: "+e))}}))},e.prototype.fetchRequest=function(){return new Vw.SessionFetchRequestImpl(this.internal)},e}();om.ClientControlImpl=fm;var hm={};Object.defineProperty(hm,"__esModule",{value:!0}),hm.BaseGatewayClientRequest=void 0;var dm=function(e){this.sessionId=e};hm.BaseGatewayClientRequest=dm;var ym={};Object.defineProperty(ym,"__esModule",{value:!0}),ym.GatewayRequestType=void 0,function(e){e[e.GET_CONFIGURATION=1]="GET_CONFIGURATION",e[e.GET_STATUS=2]="GET_STATUS",e[e.GET_OPERATIONS=3]="GET_OPERATIONS",e[e.GET_OPERATION_DETAIL=4]="GET_OPERATION_DETAIL",e[e.INVOKE_OPERATION=5]="INVOKE_OPERATION",e[e.ADD_SERVICE=6]="ADD_SERVICE",e[e.UPDATE_SERVICE=7]="UPDATE_SERVICE",e[e.REMOVE_SERVICE=8]="REMOVE_SERVICE",e[e.GET_SERVICES=9]="GET_SERVICES",e[e.GET_SERVICE_TYPES=10]="GET_SERVICE_TYPES",e[e.GET_SERVICE_CONFIGURATION=11]="GET_SERVICE_CONFIGURATION",e[e.GET_SERVICE_STATUS=12]="GET_SERVICE_STATUS",e[e.GET_SERVICE_OPERATIONS=13]="GET_SERVICE_OPERATIONS",e[e.GET_SERVICE_OPERATION_DETAIL=14]="GET_SERVICE_OPERATION_DETAIL",e[e.INVOKE_SERVICE_OPERATION=15]="INVOKE_SERVICE_OPERATION"}(ym.GatewayRequestType||(ym.GatewayRequestType={}));var vm={},Sm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(vm,"__esModule",{value:!0}),vm.GatewayClientAddServiceRequest=void 0;var _m=function(e){function t(t,r){var n=e.call(this,t)||this;return n.type=ym.GatewayRequestType.ADD_SERVICE,n.serviceDetails=r,n}return Sm(t,e),t}(hm.BaseGatewayClientRequest);vm.GatewayClientAddServiceRequest=_m;var Em={},wm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Em,"__esModule",{value:!0}),Em.GatewayClientGetConfigurationRequest=void 0;var mm=function(e){function t(t){var r=e.call(this,t)||this;return r.type=ym.GatewayRequestType.GET_CONFIGURATION,r}return wm(t,e),t}(hm.BaseGatewayClientRequest);Em.GatewayClientGetConfigurationRequest=mm;var gm={},Tm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gm,"__esModule",{value:!0}),gm.GatewayClientGetServiceTypesRequest=void 0;var Om=function(e){function t(t){var r=e.call(this,t)||this;return r.type=ym.GatewayRequestType.GET_SERVICE_TYPES,r}return Tm(t,e),t}(hm.BaseGatewayClientRequest);gm.GatewayClientGetServiceTypesRequest=Om;var Im={},bm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Im,"__esModule",{value:!0}),Im.GatewayClientGetServicesRequest=void 0;var Rm=function(e){function t(t){var r=e.call(this,t)||this;return r.type=ym.GatewayRequestType.GET_SERVICES,r}return bm(t,e),t}(hm.BaseGatewayClientRequest);Im.GatewayClientGetServicesRequest=Rm;var Cm={},Am=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Cm,"__esModule",{value:!0}),Cm.GatewayClientGetStatusRequest=void 0;var Pm=function(e){function t(t){var r=e.call(this,t)||this;return r.type=ym.GatewayRequestType.GET_STATUS,r}return Am(t,e),t}(hm.BaseGatewayClientRequest);Cm.GatewayClientGetStatusRequest=Pm;var Nm={},Mm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Nm,"__esModule",{value:!0}),Nm.GatewayClientUpdateServiceRequest=void 0;var Dm=function(e){function t(t,r){var n=e.call(this,t)||this;return n.type=ym.GatewayRequestType.UPDATE_SERVICE,n.serviceDetails=r,n}return Mm(t,e),t}(hm.BaseGatewayClientRequest);Nm.GatewayClientUpdateServiceRequest=Dm;var jm={},Lm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(jm,"__esModule",{value:!0}),jm.GatewayClientGetOperationDetailRequest=void 0;var xm=function(e){function t(t,r){var n=e.call(this,t)||this;return n.type=ym.GatewayRequestType.GET_OPERATION_DETAIL,n.operationName=r,n}return Lm(t,e),t}(hm.BaseGatewayClientRequest);jm.GatewayClientGetOperationDetailRequest=xm;var Um={},Bm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Um,"__esModule",{value:!0}),Um.GatewayClientGetOperationsRequest=void 0;var qm=function(e){function t(t){var r=e.call(this,t)||this;return r.type=ym.GatewayRequestType.GET_OPERATIONS,r}return Bm(t,e),t}(hm.BaseGatewayClientRequest);Um.GatewayClientGetOperationsRequest=qm;var Vm={},km=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Vm,"__esModule",{value:!0}),Vm.GatewayClientInvokeOperationRequest=void 0;var Fm=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.type=ym.GatewayRequestType.INVOKE_OPERATION,o.operationName=r,o.input=n,o}return km(t,e),t}(hm.BaseGatewayClientRequest);Vm.GatewayClientInvokeOperationRequest=Fm;var Gm={},Hm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Gm,"__esModule",{value:!0}),Gm.BaseGatewayServiceRequest=void 0;var Ym=function(e){function t(t,r){var n=e.call(this,t)||this;return n.serviceId=r,n}return Hm(t,e),t}(hm.BaseGatewayClientRequest);Gm.BaseGatewayServiceRequest=Ym;var Wm={},zm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Wm,"__esModule",{value:!0}),Wm.GatewayClientRemoveServiceRequest=void 0;var Qm=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.type=ym.GatewayRequestType.REMOVE_SERVICE,n}return zm(t,e),t}(Gm.BaseGatewayServiceRequest);Wm.GatewayClientRemoveServiceRequest=Qm;var Km={},Jm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Km,"__esModule",{value:!0}),Km.GatewayServiceGetConfigurationRequest=void 0;var $m=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.type=ym.GatewayRequestType.GET_SERVICE_CONFIGURATION,n}return Jm(t,e),t}(Gm.BaseGatewayServiceRequest);Km.GatewayServiceGetConfigurationRequest=$m;var Xm={},Zm=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Xm,"__esModule",{value:!0}),Xm.GatewayServiceGetOperationDetailRequest=void 0;var eg=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.type=ym.GatewayRequestType.GET_SERVICE_OPERATION_DETAIL,o.operationName=n,o}return Zm(t,e),t}(Gm.BaseGatewayServiceRequest);Xm.GatewayServiceGetOperationDetailRequest=eg;var tg={},rg=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(tg,"__esModule",{value:!0}),tg.GatewayServiceGetOperationsRequest=void 0;var ng=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.type=ym.GatewayRequestType.GET_SERVICE_OPERATIONS,n}return rg(t,e),t}(Gm.BaseGatewayServiceRequest);tg.GatewayServiceGetOperationsRequest=ng;var og={},ig=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(og,"__esModule",{value:!0}),og.GatewayServiceGetStatusRequest=void 0;var sg=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.type=ym.GatewayRequestType.GET_SERVICE_STATUS,n}return ig(t,e),t}(Gm.BaseGatewayServiceRequest);og.GatewayServiceGetStatusRequest=sg;var ag={},ug=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ag,"__esModule",{value:!0}),ag.GatewayServiceInvokeOperationRequest=void 0;var cg=function(e){function t(t,r,n,o){var i=e.call(this,t,r)||this;return i.type=ym.GatewayRequestType.INVOKE_SERVICE_OPERATION,i.operationName=n,i.input=o,i}return ug(t,e),t}(Gm.BaseGatewayServiceRequest);ag.GatewayServiceInvokeOperationRequest=cg;var lg={},pg=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(lg,"__esModule",{value:!0}),lg.GatewayClientDetailListRequestSerialiser=void 0;var fg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pg(t,e),t.prototype.read=function(e){return{types:Iu.readByte(e)?Iu.readCollection(e,Iu.readString):void 0,ids:Iu.readByte(e)?Iu.readCollection(e,Iu.readString):void 0}},t.prototype.write=function(e,t){void 0!==t.types&&null!==t.types?(Iu.writeByte(e,1),Iu.writeCollection(e,t.types,Iu.writeString)):Iu.writeByte(e,0),void 0!==t.ids&&null!==t.ids?(Iu.writeByte(e,1),Iu.writeCollection(e,t.ids,Iu.writeString)):Iu.writeByte(e,0)},t}(Fu.AbstractSerialiser);lg.GatewayClientDetailListRequestSerialiser=new fg;var hg={},dg=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(hg,"__esModule",{value:!0}),hg.GatewayClientKeySerialiser=void 0;var yg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dg(t,e),t.prototype.read=function(e){return{type:Iu.readString(e),id:Iu.readString(e)}},t.prototype.write=function(e,t){Iu.writeString(e,t.type),Iu.writeString(e,t.id)},t}(Fu.AbstractSerialiser);hg.GatewayClientKeySerialiser=new yg;var vg={},Sg=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(vg,"__esModule",{value:!0}),vg.GatewayClientListSerialiser=void 0;var _g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Sg(t,e),t.prototype.read=function(e){return{clients:Iu.readCollection(e,hg.GatewayClientKeySerialiser.read)}},t}(Fu.AbstractSerialiser);vg.GatewayClientListSerialiser=new _g;var Eg={},wg=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Eg,"__esModule",{value:!0}),Eg.GatewayServiceIdSerialiser=void 0;var mg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wg(t,e),t.prototype.read=function(e){return{type:Iu.readString(e),name:Iu.readString(e)}},t.prototype.write=function(e,t){Iu.writeString(e,t.type),Iu.writeString(e,t.name)},t}(Fu.AbstractSerialiser);Eg.GatewayServiceIdSerialiser=new mg;var gg={},Tg=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gg,"__esModule",{value:!0}),gg.GatewayServiceSerialiser=void 0;var Og=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tg(t,e),t.prototype.read=function(e){return{id:Eg.GatewayServiceIdSerialiser.read(e),description:Iu.readByte(e)?Iu.readString(e):void 0,configuration:Iu.readByte(e)?Iu.readString(e):void 0}},t.prototype.write=function(e,t){Eg.GatewayServiceIdSerialiser.write(e,t.id),void 0!==t.description&&null!==t.description?(Iu.writeByte(e,1),Iu.writeString(e,t.description)):Iu.writeByte(e,0),void 0!==t.configuration&&null!==t.configuration?(Iu.writeByte(e,1),Iu.writeString(e,t.configuration)):Iu.writeByte(e,0)},t}(Fu.AbstractSerialiser);gg.GatewayServiceSerialiser=new Og;var Ig={},bg=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Ig,"__esModule",{value:!0}),Ig.GatewayClientRequestSerialiser=Ig.UnknownGatewayRequestTypeError=void 0;var Rg=function(e){function t(t){return e.call(this,"Cannot serialise unknown gateway request type: "+t.type)||this}return bg(t,e),t}(Error);Ig.UnknownGatewayRequestTypeError=Rg;var Cg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return bg(t,e),t.prototype.write=function(e,t){switch(t.type in ym.GatewayRequestType&&(iE.SessionIdSerialiser.write(e,t.sessionId),Wh.write(e,t.type),t instanceof Gm.BaseGatewayServiceRequest&&Eg.GatewayServiceIdSerialiser.write(e,t.serviceId)),t.type){case ym.GatewayRequestType.GET_CONFIGURATION:case ym.GatewayRequestType.GET_SERVICE_CONFIGURATION:case ym.GatewayRequestType.GET_STATUS:case ym.GatewayRequestType.GET_SERVICE_STATUS:case ym.GatewayRequestType.GET_OPERATIONS:case ym.GatewayRequestType.GET_SERVICE_OPERATIONS:case ym.GatewayRequestType.GET_SERVICES:case ym.GatewayRequestType.GET_SERVICE_TYPES:break;case ym.GatewayRequestType.ADD_SERVICE:case ym.GatewayRequestType.UPDATE_SERVICE:gg.GatewayServiceSerialiser.write(e,t.serviceDetails);break;case ym.GatewayRequestType.REMOVE_SERVICE:Eg.GatewayServiceIdSerialiser.write(e,t.serviceId);break;case ym.GatewayRequestType.GET_OPERATION_DETAIL:case ym.GatewayRequestType.GET_SERVICE_OPERATION_DETAIL:Iu.writeString(e,t.operationName);break;case ym.GatewayRequestType.INVOKE_OPERATION:case ym.GatewayRequestType.INVOKE_SERVICE_OPERATION:Iu.writeString(e,t.operationName),null===t.input||void 0===t.input?Iu.writeByte(e,0):(Iu.writeByte(e,1),Iu.writeString(e,t.input));break;default:throw new Rg(t)}},t}(Fu.AbstractSerialiser);Ig.GatewayClientRequestSerialiser=new Cg;var Ag={};Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.GetConfigurationResponse=void 0;var Pg=function(e,t,r,n){this.type=e,this.config=n,this.schemaType=t,this.schema=r};Ag.GetConfigurationResponse=Pg;var Ng={};Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.GetStatusResponse=void 0;var Mg=function(e,t){this.type=e,this.items=t};Ng.GetStatusResponse=Mg;var Dg={};Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.GetOperationDetailResponse=void 0;var jg=function(e,t,r,n){this.type=e,this.description=t,this.inputSchema=r,this.outputSchema=n};Dg.GetOperationDetailResponse=jg;var Lg={};Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.GetOperationsResponse=void 0;var xg=function(e,t){this.type=e,this.operations=t};Lg.GetOperationsResponse=xg;var Ug={};Object.defineProperty(Ug,"__esModule",{value:!0}),Ug.InvokeOperationResponse=void 0;var Bg=function(e,t){this.type=e,this.output=t};Ug.InvokeOperationResponse=Bg;var qg={},Vg=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(qg,"__esModule",{value:!0}),qg.GatewayOperationSerialiser=void 0;var kg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Vg(t,e),t.prototype.read=function(e){return{name:Iu.readString(e),summary:Iu.readString(e)}},t.prototype.write=function(e,t){Iu.writeString(e,t.name),Iu.writeString(e,t.summary)},t}(Fu.AbstractSerialiser);qg.GatewayOperationSerialiser=new kg;var Fg={};Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.AddUpdateServiceResponse=void 0;var Gg=function(e,t){this.type=e,this.service=t};Fg.AddUpdateServiceResponse=Gg;var Hg={};Object.defineProperty(Hg,"__esModule",{value:!0}),Hg.GetServiceTypesResponse=void 0;var Yg=function(e){this.type=ym.GatewayRequestType.GET_SERVICE_TYPES,this.serviceTypes=e};Hg.GetServiceTypesResponse=Yg;var Wg={};Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.GetServicesResponse=void 0;var zg=function(e){this.type=ym.GatewayRequestType.GET_SERVICES,this.services=e};Wg.GetServicesResponse=zg;var Qg={},Kg=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Qg,"__esModule",{value:!0}),Qg.GatewayServiceTypeSerialiser=void 0;var Jg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Kg(t,e),t.prototype.read=function(e){return{name:Iu.readString(e),description:Iu.readString(e),schema:Iu.readString(e),isSharedConfig:Iu.readBoolean(e)}},t.prototype.write=function(e,t){Iu.writeString(e,t.name),Iu.writeString(e,t.description),Iu.writeString(e,t.schema),Iu.writeBoolean(e,t.isSharedConfig)},t}(Fu.AbstractSerialiser);Qg.GatewayServiceTypeSerialiser=new Jg;var $g={};Object.defineProperty($g,"__esModule",{value:!0}),$g.EntriesFetchRequest=void 0;var Xg=function(e,t){this.firstEntry=e,this.entryCount=t};$g.EntriesFetchRequest=Xg;var Zg={},eT=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Zg,"__esModule",{value:!0}),Zg.EntriesFetchRequestSerialiser=void 0;var tT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eT(t,e),t.prototype.read=function(e){var t=Iu.readInt64(e),r=Iu.readInt64(e);return new $g.EntriesFetchRequest(t,r)},t.prototype.write=function(e,t){Iu.writeInt64(e,t.firstEntry),Iu.writeInt64(e,t.entryCount)},t}(Fu.AbstractSerialiser);Zg.EntriesFetchRequestSerialiser=new tT;var rT={};Object.defineProperty(rT,"__esModule",{value:!0}),rT.EntriesFetchResponse=void 0;var nT=function(e,t,r,n,o,i){this.firstEntry=e,this.entryCount=t,this.fileId=r,this.maxEntriesAvailable=n,this.firstLineNumber=o,this.entries=i};rT.EntriesFetchResponse=nT;var oT={},iT=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(oT,"__esModule",{value:!0}),oT.EntriesFetchResponseSerialiser=void 0;var sT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return iT(t,e),t.prototype.read=function(e){var t=Iu.readInt64(e),r=Iu.readInt64(e),n=Iu.readInt64(e),o=Iu.readInt64(e),i=Iu.readBytes(e),s=Iu.readInt64(e);return new rT.EntriesFetchResponse(t,r,s,n,o,i)},t.prototype.write=function(e,t){Iu.writeInt64(e,t.firstEntry),Iu.writeInt64(e,t.entryCount),Iu.writeInt64(e,t.maxEntriesAvailable),Iu.writeInt64(e,t.firstLineNumber),Iu.writeBytes(e,t.entries),Iu.writeInt64(e,t.fileId)},t}(Fu.AbstractSerialiser);oT.EntriesFetchResponseSerialiser=new sT;var aT={};Object.defineProperty(aT,"__esModule",{value:!0}),aT.FETCH_LOG_ENTRIES_SERVICE=void 0,aT.FETCH_LOG_ENTRIES_SERVICE={id:132,request:Zg.EntriesFetchRequestSerialiser,response:oT.EntriesFetchResponseSerialiser};var uT={};Object.defineProperty(uT,"__esModule",{value:!0}),uT.LogRetrieval=void 0;var cT=function(){function e(e){this.internal=e,this.FETCH_LOG_ENTRIES_SERVICE=e.getServiceLocator().obtain(aT.FETCH_LOG_ENTRIES_SERVICE)}return e.prototype.fetchEntries=function(e,t){var r=this;return new Promise((function(n,o){r.internal.checkConnected(o)&&r.FETCH_LOG_ENTRIES_SERVICE.send(new $g.EntriesFetchRequest(e,t),(function(e,t){e?o(e):n(t)}))}))},e}();uT.LogRetrieval=cT;var lT={};Object.defineProperty(lT,"__esModule",{value:!0}),lT.create=void 0,lT.create=function(e){return{onRequest:function(t,r,n){try{e(t,r,n)}catch(e){n.fail(t.getContext().ErrorReason.CALLBACK_EXCEPTION,e.message)}}}};var pT={};Object.defineProperty(pT,"__esModule",{value:!0}),pT.MessagingClientForwardSendRequest=void 0;var fT=function(e,t,r,n,o,i){this.cid=e,this.sessionID=t,this.path=r,this.properties=n,this.dataType=o,this.content=i};pT.MessagingClientForwardSendRequest=fT;var hT={},dT=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(hT,"__esModule",{value:!0}),hT.MessagingClientForwardSendRequestSerialiser=void 0;var yT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dT(t,e),t.prototype.read=function(e){var t=Vu.CIDSerialiser.read(e),r=iE.SessionIdSerialiser.read(e),n=Iu.readString(e),o=Iu.readDictionary(e,Iu.readString),i=Iu.readString(e),s=Iu.readBytes(e);return new pT.MessagingClientForwardSendRequest(t,r,n,o,i,s)},t}(Fu.AbstractSerialiser);hT.MessagingClientForwardSendRequestSerialiser=new yT;var vT={},ST=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(vT,"__esModule",{value:!0}),vT.MessagingClientSendRequestSerialiser=void 0;var _T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ST(t,e),t.prototype.write=function(e,t){iE.SessionIdSerialiser.write(e,t.sessionId),Iu.writeString(e,t.path),Iu.writeString(e,t.dataType),Iu.writeBytes(e,t.request)},t}(Fu.AbstractSerialiser);vT.MessagingClientSendRequestSerialiser=new _T;var ET={};Object.defineProperty(ET,"__esModule",{value:!0}),ET.MessagingFilterResponse=void 0;var wT=function(e,t,r,n){this.cid=e,this.sessionID=t,this.response=r,this.errorReason=n};ET.MessagingFilterResponse=wT;var mT={};Object.defineProperty(mT,"__esModule",{value:!0}),mT.MessagingResponse=void 0;var gT=function(e,t){this.responseDataType=e,this.data=t};mT.MessagingResponse=gT;var TT={},OT=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(TT,"__esModule",{value:!0}),TT.MessagingResponseSerialiser=void 0;var IT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return OT(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=Iu.readBytes(e);return new mT.MessagingResponse(t,r)},t.prototype.write=function(e,t){Iu.writeString(e,t.responseDataType),Iu.writeBytes(e,t.data)},t}(Fu.AbstractSerialiser);TT.MessagingResponseSerialiser=new IT;var bT={},RT=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(bT,"__esModule",{value:!0}),bT.ErrorReasonSerialiser=void 0;var CT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return RT(t,e),t.prototype.read=function(e){var t=Iu.readInt32(e),r=Iu.readString(e);return new qa.ErrorReason(t,r)},t.prototype.write=function(e,t){Iu.writeInt32(e,t.id),Iu.writeString(e,t.reason)},t}(Fu.AbstractSerialiser);bT.ErrorReasonSerialiser=new CT;var AT={},PT=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(AT,"__esModule",{value:!0}),AT.MessagingFilterResponseSerialiser=void 0;var NT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return PT(t,e),t.prototype.read=function(e){var t=Vu.CIDSerialiser.read(e),r=iE.SessionIdSerialiser.read(e);switch(Iu.readByte(e)){case 0:var n=TT.MessagingResponseSerialiser.read(e);return new ET.MessagingFilterResponse(t,r,n);default:var o=bT.ErrorReasonSerialiser.read(e);return new ET.MessagingFilterResponse(t,r,null,o)}},t}(Fu.AbstractSerialiser);AT.MessagingFilterResponseSerialiser=new NT;var MT={},DT=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(MT,"__esModule",{value:!0}),MT.MessagingFilterSendRequestSerialiser=void 0;var jT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return DT(t,e),t.prototype.write=function(e,t){Vu.CIDSerialiser.write(e,t.cid),Iu.writeString(e,t.filter),Iu.writeString(e,t.path),Iu.writeString(e,t.dataType.name()),Iu.writeBytes(e,t.request)},t}(Fu.AbstractSerialiser);MT.MessagingFilterSendRequestSerialiser=new jT;var LT={};Object.defineProperty(LT,"__esModule",{value:!0}),LT.MessagingFilterSendResponse=void 0;var xT=function(e,t){this.numberSent=e,this.errors=t,this.isSuccess=0===t.length};LT.MessagingFilterSendResponse=xT;var UT={},BT=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(UT,"__esModule",{value:!0}),UT.MessagingFilterSendResponseSerialiser=void 0;var qT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return BT(t,e),t.prototype.read=function(e){if(0===Iu.readByte(e)){var t=Iu.readInt32(e);return new LT.MessagingFilterSendResponse(t,[])}var r=Iu.readCollection(e,$_.ErrorReportSerialiser.read);return new LT.MessagingFilterSendResponse(0,r)},t}(Fu.AbstractSerialiser);UT.MessagingFilterSendResponseSerialiser=new qT;var VT={};Object.defineProperty(VT,"__esModule",{value:!0}),VT.MessagingSendRequest=void 0;var kT=function(e,t,r){this.path=e,this.dataType=t,this.request=r};VT.MessagingSendRequest=kT;var FT={},GT=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(FT,"__esModule",{value:!0}),FT.MessagingSendRequestSerialiser=void 0;var HT=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return GT(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=Iu.readString(e),n=Iu.readBytes(e);return new VT.MessagingSendRequest(t,r,n)},t.prototype.write=function(e,t){Iu.writeString(e,t.path),Iu.writeString(e,t.dataType),Iu.writeBytes(e,t.request)},t}(Fu.AbstractSerialiser);FT.MessagingSendRequestSerialiser=new HT;var YT={};Object.defineProperty(YT,"__esModule",{value:!0}),YT.FILTER_RESPONSE=YT.MESSAGING_FILTER_SEND=YT.MESSAGING_RECEIVER_CLIENT=YT.MESSAGING_RECEIVER_SERVER=YT.MESSAGING_SEND=void 0,YT.MESSAGING_SEND={id:85,request:FT.MessagingSendRequestSerialiser,response:TT.MessagingResponseSerialiser},YT.MESSAGING_RECEIVER_SERVER={id:86,request:vT.MessagingClientSendRequestSerialiser,response:TT.MessagingResponseSerialiser},YT.MESSAGING_RECEIVER_CLIENT={id:88,request:hT.MessagingClientForwardSendRequestSerialiser,response:TT.MessagingResponseSerialiser},YT.MESSAGING_FILTER_SEND={id:102,request:MT.MessagingFilterSendRequestSerialiser,response:UT.MessagingFilterSendResponseSerialiser},YT.FILTER_RESPONSE={id:103,request:AT.MessagingFilterResponseSerialiser,response:av.NullSerialiser};var WT={},zT=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},QT=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(WT,"__esModule",{value:!0}),WT.MessagesImpl=void 0;var KT=Xu.create("Session.Messages"),JT=function(e,t,r){this.reqType=e,this.resType=t,this.stream=r},$T=function(){function e(e,t,r){this.callback=e,this.context=t,this.responseType=r}return e.prototype.respond=function(e){var t=this.context.DataTypes;if(0===arguments.length)throw new va.IllegalArgumentError("No argument provided to the responder");if(null==e&&!this.responseType)throw new va.IllegalArgumentError("No response type has been provided and the value provided is null. Unable to determine the response type.");var r=this.responseType?t.getChecked(this.responseType):t.getByValue(e);if(void 0===r)throw new va.IllegalArgumentError("Unable to determine the response type.");var n=r.writeValueToArray(e);this.callback.respond({responseDataType:r.name(),data:n})},e.prototype.reject=function(e){this.callback.fail(_c.ErrorReason.REJECTED_REQUEST,e)},e}();var XT=function(){function e(e){var t=this;this.requestStreams={},this.internal=e;var r=this.internal.getContext().DataTypes,n=e.getServiceLocator();this.MESSAGING_SEND=n.obtain(YT.MESSAGING_SEND),this.MESSAGING_FILTER_SEND=n.obtain(YT.MESSAGING_FILTER_SEND),this.MESSAGING_RECEIVER_SERVER=n.obtain(YT.MESSAGING_RECEIVER_SERVER),this.deregisterRequestHandler=n.obtain(kv.MESSAGING_RECEIVER_CONTROL_DEREGISTRATION);var o=e.getServiceRegistry();o.add(YT.MESSAGING_SEND,lT.create((function(n,o,i){var s=t.requestStreams[o.path];if(void 0!==s){var a,u,c=new $T(i,e.getContext(),s.resType),l=r.get(o.dataType),p=s.reqType?s.reqType:l.valueClass;if(l.canReadAs(p)){var f=void 0;try{f=l.readAs(p,o.request)}catch(e){return KT.error("Failed to convert "+l.name()+" datatype to "+p),s.stream.onError(_c.ErrorReason.INVALID_DATA),void delete t.requestStreams[o.path]}try{s.stream.onRequest(o.path,f,c)}catch(e){KT.error("Messaging request stream threw an error",e),i.fail(_c.ErrorReason.CALLBACK_EXCEPTION,e.stack)}}else{var h="Messaging request for path '"+o.path+"' with "+l.name()+" datatype is incompatible for stream ("+p.name+")";KT.debug(h),i.fail(_c.ErrorReason.INCOMPATIBLE_DATATYPE,h)}}else i.fail(_c.ErrorReason.UNHANDLED_MESSAGE,(a=n.getSessionId(),u=o.path,"Session "+a+" has no registered streams for message sent to path '"+u+"'"))}))),o.add(YT.FILTER_RESPONSE,lT.create((function(e,t,r){r.respond(),e.getConversationSet().respondIfPresent(t.cid,t)}))),o.add(YT.MESSAGING_RECEIVER_CLIENT,lT.create((function(e,t,r){e.getConversationSet().respondIfPresent(t.cid,{request:t,callback:r.respond,fail:r.fail})})))}return e.prototype.addRequestHandler=function(e,t,r,n){var o=this,i=this.internal.getContext().DataTypes;return new Promise((function(s,a){if(o.internal.checkConnected(a)){try{Zl.requireNonNull(e,"Message path"),Zl.requireNonNull(t,"Request handler")}catch(e){return void a(e)}KT.debug("Adding request handler",e);var u={definition:YT.MESSAGING_RECEIVER_CLIENT,group:cv.DEFAULT,path:e,keys:void 0!==r?r:[]},c={active:function(r,n){KT.debug("Request handler active",e),s({close:function(){return new Promise((function(e){o.deregisterRequestHandler.send(u,(function(r,i){r?(o.internal.getConversationSet().discard(n,r),KT.debug("Error with request handler deregistration: ",r)):(t.onClose(),o.internal.getConversationSet().respondIfPresent(n,i)),e()}))}))}})},respond:function(r){KT.debug("Request handler pair.request",e);var o={sessionId:r.request.sessionID,path:r.request.path,properties:r.request.properties};try{var s=(n||i.getChecked(r.request.dataType)).readValue(r.request.content),a={respond:function(e,t){var n=i.getChecked(void 0!==t?t:e);r.callback({responseDataType:n.name(),data:n.writeValueToArray(e)})},reject:function(e){r.fail(_c.ErrorReason.REJECTED_REQUEST,e,!1)}};return t.onRequest(s,o,a),!1}catch(e){return KT.info("An exception has occurred whilst processing the request:",e),t.onError(e),r.fail(_c.ErrorReason.CALLBACK_EXCEPTION,e&&e.message),!1}},close:function(){KT.debug("Request handler closed",e),t.onClose()}};I_.registerRequestHandler(o.internal,u,c).then(void 0,(function(e){a(e)}))}}))},e.prototype.sendRequestToController=function(e,t,r,n,o,i){var s,a=this.internal.getContext().DataTypes;try{Zl.requireNonNull(r,"Message path"),Zl.requireNonNull(n,"Request")}catch(e){return void t(e)}try{s=o?a.getChecked(o):a.getByValue(n)}catch(e){return void t(e)}void 0!==s?(KT.debug("Sending request to server",n),this.MESSAGING_SEND.send({path:r,dataType:s.name(),request:s.writeValueToArray(n)},(function(n,o){var s;if(od.responseSuccess(n,o)){KT.debug("Request complete",r);try{s=a.getChecked(i||o.responseDataType),e(s.readValue(o.data))}catch(e){t(e)}}else KT.debug("Request failed",r),t(n)}))):t(new Error("Could not determine request type"))},e.prototype.sendRequestToSession=function(e,t,r,n,o,i,s){var a,u=this.internal.getContext().DataTypes;try{Zl.requireNonNull(o,"Session ID"),Zl.requireNonNull(r,"Message path"),Zl.requireNonNull(n,"Request")}catch(e){return void t(e)}try{a=i?u.getChecked(i):u.getByValue(n)}catch(e){return void t(e)}void 0!==a?(KT.debug("Sending request to session",o,n),this.MESSAGING_RECEIVER_SERVER.send({sessionId:o,path:r,dataType:a.name(),request:a.writeValueToArray(n)},(function(n,o){var i;if(od.responseSuccess(n,o)){KT.debug("Request complete",r);try{i=u.getChecked(s||o.responseDataType),e(i.readValue(o.data))}catch(e){t(e)}}else KT.debug("Request failed",r),t(n)}))):t(new Error("Could not determine request type"))},e.prototype.sendRequest=function(e,t,r,n,o){var i=this;return new Promise((function(s,a){if(i.internal.checkConnected(a))try{if(r instanceof qd.SessionId)i.sendRequestToSession(s,a,e,t,r,n,o);else if("string"==typeof r){var u=function(e){try{return qd.SessionId.fromString(e)}catch(e){return!1}}(r);u?i.sendRequestToSession(s,a,e,t,u,n,o):i.sendRequestToController(s,a,e,t,r,n)}else i.sendRequestToController(s,a,e,t,r,n)}catch(e){a(e)}}))},e.prototype.sendRequestToFilter=function(e,t,r,n,o,i){var s=this,a=this.internal.getContext().DataTypes;return new Promise((function(u,c){return zT(s,void 0,void 0,(function(){var s,l,p,f,h,d,y=this;return QT(this,(function(v){switch(v.label){case 0:if(!this.internal.checkConnected(c))return[3,2];try{Zl.requireNonNull(t,"Message path"),Zl.requireNonNull(e,"Session filter"),Zl.requireNonNull(r,"Request"),Zl.requireNonNull(n,"Response callback")}catch(e){return c(e),[2]}s=void 0;try{s=o?a.getChecked(o):a.getByValue(r)}catch(e){return c(e),[2]}return void 0===s?(c(new Error("Could not determine request type")),[2]):(l=0,p=-1,f=function(){return l>=p&&-1!==p||0===p},[4,this.internal.getConversationSet().newConversation({onOpen:function(){},onResponse:function(e,t){if(null===t)return!0;if("number"==typeof t)return p=t,f();var r=t.sessionID;if(l++,t.errorReason)n.onResponseError(r,t.errorReason);else{var o=a.getByName(t.response.responseDataType),s=void 0;try{s=a.getChecked(i||t.response.responseDataType)}catch(e){return n.onResponseError(r,e),f()}if(o.canReadAs(s.valueClass)){var u=void 0;try{u=o.readAs(s.valueClass,t.response.data)}catch(e){return n.onResponseError(r,e),f()}try{n.onResponse(r,u)}catch(e){KT.error("Exception within messaging filter callback",e)}}else n.onResponseError(r,new Error("The received response was a "+o+", which cannot be read as: "+s))}return f()},onDiscard:function(){}})]);case 1:h=v.sent(),KT.debug("Sending filter request to server",r),d=void 0;try{d=s.writeValueToArray(r)}catch(e){return c(e),[2]}this.MESSAGING_FILTER_SEND.send({cid:h,path:t,filter:e,dataType:s,request:d},(function(e,r){od.responseSuccess(e,r)?r.isSuccess?(KT.debug("Request complete",t),y.internal.getConversationSet().respondIfPresent(h,r.numberSent),u(r.numberSent)):(KT.debug("Request failed",t),y.internal.getConversationSet().respondIfPresent(h,null),c(r.errors)):(KT.debug("Request failed",t),y.internal.getConversationSet().respondIfPresent(h,null),c(e))})),v.label=2;case 2:return[2]}}))}))}))},e.prototype.setRequestStream=function(e,t,r,n){var o=this.internal.getContext().DataTypes,i=new JT(r?o.getValueClassChecked(r):void 0,n?o.getValueClassChecked(n):void 0,t),s=this.requestStreams[e];return this.requestStreams[e]=i,s?s.stream:void 0},e.prototype.removeRequestStream=function(e){var t=this.requestStreams[e];return delete this.requestStreams[e],t?t.stream:void 0},e}();WT.MessagesImpl=XT;var ZT={};Object.defineProperty(ZT,"__esModule",{value:!0}),ZT.JMXFetchRequest=void 0;var eO=function(e,t){this.names=e,this.isClustered=t};ZT.JMXFetchRequest=eO;var tO={},rO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(tO,"__esModule",{value:!0}),tO.JMXFetchRequestSerialiser=void 0;var nO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return rO(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,Iu.readString),r=Iu.readBoolean(e);return new ZT.JMXFetchRequest(t,r)},t.prototype.write=function(e,t){Iu.writeCollection(e,t.names,Iu.writeString),Iu.writeBoolean(e,t.isClustered)},t}(Fu.AbstractSerialiser);tO.JMXFetchRequestSerialiser=new nO;var oO={},iO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(oO,"__esModule",{value:!0}),oO.MBeanValuesSerialiser=void 0;var sO=new dl.Encoder,aO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return iO(t,e),t.prototype.read=function(e){var t=Iu.readBytes(e);return new pl.Decoder(t).nextValueExpecting((function(e){return e===Xc.types.MAP}))},t.prototype.write=function(e,t){sO.encode(t),Iu.writeBytes(e,sO.flush())},t}(Fu.AbstractSerialiser);oO.MBeanValuesSerialiser=new aO;var uO={},cO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(uO,"__esModule",{value:!0}),uO.JMXFetchResponseSerialiser=void 0;var lO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return cO(t,e),t.prototype.read=function(e){return Iu.readDictionary(e,this.readWrapper.bind(this))},t.prototype.write=function(e,t){Iu.writeDictionary(e,t,this.writeWrapper.bind(this))},t.prototype.readWrapper=function(e){switch(Iu.readByte(e)){case 0:return oO.MBeanValuesSerialiser.read(e);default:case 1:return bT.ErrorReasonSerialiser.read(e)}},t.prototype.writeWrapper=function(e,t){this.isErrorReason(t)?(Iu.writeByte(e,1),bT.ErrorReasonSerialiser.write(e,t)):(Iu.writeByte(e,0),oO.MBeanValuesSerialiser.write(e,t))},t.prototype.isErrorReason=function(e){return"reason"in e},t}(Fu.AbstractSerialiser);uO.JMXFetchResponseSerialiser=new lO;var pO={};Object.defineProperty(pO,"__esModule",{value:!0}),pO.MetricType=void 0,function(e){e[e.COUNTER=0]="COUNTER",e[e.GAUGE=1]="GAUGE",e[e.INFO=2]="INFO",e[e.HISTOGRAM=3]="HISTOGRAM",e[e.GAUGE_HISTOGRAM=4]="GAUGE_HISTOGRAM",e[e.STATE_SET=5]="STATE_SET",e[e.SUMMARY=6]="SUMMARY",e[e.UNKNOWN=7]="UNKNOWN"}(pO.MetricType||(pO.MetricType={}));var fO={};Object.defineProperty(fO,"__esModule",{value:!0}),fO.MetricsResultImpl=void 0;var hO=function(){function e(e){this.sampleCollections=e}return e.prototype.getServerNames=function(){return new Set(Object.keys(this.sampleCollections))},e.prototype.getMetrics=function(e){return this.sampleCollections[e]},e}();fO.MetricsResultImpl=hO;var dO={},yO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function vO(e){var t=function(e){var t=Iu.readInt64(e),r=new DataView(new ArrayBuffer(8));return r.setUint32(0,t.getLowBits(),!0),r.setUint32(4,t.getHighBits(),!0),r.getFloat64(0,!0)}(e),r=Iu.readInt64(e);return{name:Iu.readString(e),labelNames:Iu.readCollection(e,Iu.readString),labelValues:Iu.readCollection(e,Iu.readString),timestamp:r.equals(-1)?void 0:r,value:t}}function SO(e){return{name:Iu.readString(e),unit:Iu.readString(e),type:Wh.read(e,pO.MetricType),samples:Iu.readCollection(e,vO)}}function _O(e){return Iu.readCollection(e,SO)}Object.defineProperty(dO,"__esModule",{value:!0}),dO.MetricsResultSerialiser=void 0;var EO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yO(t,e),t.prototype.read=function(e){var t=Iu.readDictionary(e,_O);return new fO.MetricsResultImpl(t)},t}(Fu.AbstractSerialiser);dO.MetricsResultSerialiser=new EO;var wO={};Object.defineProperty(wO,"__esModule",{value:!0}),wO.SessionMetricCollectorListImpl=void 0;var mO=function(e){this.collectors=e};wO.SessionMetricCollectorListImpl=mO;var gO={},TO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gO,"__esModule",{value:!0}),gO.SessionMetricCollectorSerialiser=void 0;var OO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return TO(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=Iu.readBoolean(e),n=Iu.readInt32(e),o=Iu.readBoolean(e),i=Iu.readString(e),s=Iu.readCollection(e,Iu.readString);return new BS.SessionMetricCollectorImpl(t,r,n,o,i,s)},t.prototype.write=function(e,t){Iu.writeString(e,t.name),Iu.writeBoolean(e,t.exportToPrometheus),Iu.writeInt32(e,t.maximumGroups),Iu.writeBoolean(e,t.removeMetricsWithNoMatches),Iu.writeString(e,t.sessionFilter),Iu.writeCollection(e,t.groupByProperties,Iu.writeString)},t}(Fu.AbstractSerialiser);gO.SessionMetricCollectorSerialiser=new OO;var IO={},bO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(IO,"__esModule",{value:!0}),IO.SessionMetricCollectorListSerialiser=void 0;var RO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return bO(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,gO.SessionMetricCollectorSerialiser.read);return new wO.SessionMetricCollectorListImpl(t)},t.prototype.write=function(e,t){Iu.writeCollection(e,t.collectors,gO.SessionMetricCollectorSerialiser.write)},t}(Fu.AbstractSerialiser);IO.SessionMetricCollectorListSerialiser=new RO;var CO={};Object.defineProperty(CO,"__esModule",{value:!0}),CO.TopicMetricCollectorListImpl=void 0;var AO=function(e){this.collectors=e};CO.TopicMetricCollectorListImpl=AO;var PO={},NO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(PO,"__esModule",{value:!0}),PO.TopicMetricCollectorSerialiser=void 0;var MO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return NO(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=Iu.readBoolean(e),n=Iu.readInt32(e),o=Iu.readString(e),i=Iu.readBoolean(e),s=Iu.readBoolean(e),a=Iu.readInt32(e);return new GS.TopicMetricCollectorImpl(t,r,n,o,i,s,a)},t.prototype.write=function(e,t){Iu.writeString(e,t.name),Iu.writeBoolean(e,t.exportToPrometheus),Iu.writeInt32(e,t.maximumGroups),Iu.writeString(e,t.topicSelector),Iu.writeBoolean(e,t.groupByTopicType),Iu.writeBoolean(e,t.groupByTopicView),Iu.writeInt32(e,t.groupByPathPrefixParts)},t}(Fu.AbstractSerialiser);PO.TopicMetricCollectorSerialiser=new MO;var DO={},jO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(DO,"__esModule",{value:!0}),DO.TopicMetricCollectorListSerialiser=void 0;var LO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return jO(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,PO.TopicMetricCollectorSerialiser.read);return new CO.TopicMetricCollectorListImpl(t)},t.prototype.write=function(e,t){Iu.writeCollection(e,t.collectors,PO.TopicMetricCollectorSerialiser.write)},t}(Fu.AbstractSerialiser);DO.TopicMetricCollectorListSerialiser=new LO;var xO={};Object.defineProperty(xO,"__esModule",{value:!0}),xO.MeasuredEntityClassMetrics=void 0;var UO=function(e,t){this.metricNames=e,this.values=t};xO.MeasuredEntityClassMetrics=UO;var BO={},qO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function VO(e,t){return Iu.readMap(e,(function(e){return Iu.readCollection(e,Iu.readString)}),t)}function kO(e,t,r){Iu.writeMap(e,t,(function(e,t){return Iu.writeCollection(e,t,Iu.writeString)}),r)}Object.defineProperty(BO,"__esModule",{value:!0}),BO.MeasuredEntityClassMetricsSerialiser=void 0;var FO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qO(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,Iu.readString),r=VO(e,(function(e){return VO(e,(function(e){return Iu.readCollection(e,Iu.readInt64)}))}));return new xO.MeasuredEntityClassMetrics(t,r)},t.prototype.write=function(e,t){Iu.writeCollection(e,t.metricNames,Iu.writeString),kO(e,t.values,(function(e,t){return kO(e,t,(function(e,t){return Iu.writeCollection(e,t,Iu.writeInt64)}))}))},t}(Fu.AbstractSerialiser);BO.MeasuredEntityClassMetricsSerialiser=new FO;var GO={};Object.defineProperty(GO,"__esModule",{value:!0}),GO.MeasuredEntityClassRequest=void 0;var HO=function(e,t){this.entityClass=e,this.serverName=t};GO.MeasuredEntityClassRequest=HO;var YO={},WO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(YO,"__esModule",{value:!0}),YO.MeasuredEntityClassRequestSerialiser=void 0;var zO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return WO(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=1===Iu.readByte(e)?Iu.readString(e):void 0;return new GO.MeasuredEntityClassRequest(t,r)},t.prototype.write=function(e,t){Iu.writeString(e,t.entityClass),void 0!==t.serverName?(Iu.writeByte(e,1),Iu.writeString(e,t.serverName)):Iu.writeByte(e,0)},t}(Fu.AbstractSerialiser);YO.MeasuredEntityClassRequestSerialiser=new zO;var QO={},KO=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(QO,"__esModule",{value:!0}),QO.ServerMetricsSerialiser=void 0;var JO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return KO(t,e),t.prototype.read=function(e){return Iu.readDictionary(e,(function(e){return Iu.readDictionary(e,Iu.readInt64)}))},t.prototype.write=function(e,t){Iu.writeDictionary(e,t,(function(e,t){return Iu.writeDictionary(e,t,Iu.writeInt64)}))},t}(Fu.AbstractSerialiser);QO.ServerMetricsSerialiser=new JO;var $O={},XO=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},ZO=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},eI=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s};Object.defineProperty($O,"__esModule",{value:!0}),$O.MetricsImpl=void 0;var tI=t({}),rI=n({}),nI=function(){function e(e){this.internal=e}return e.prototype.callService=function(e,t){var r=this;return new Promise((function(n,o){r.internal.checkConnected(o)&&r.internal.getServiceLocator().obtain(e).send(t,(function(e,t){e?o(e):n(null===t?void 0:t)}))}))},e.prototype.putSessionMetricCollector=function(e){return XO(this,void 0,void 0,(function(){var t;return ZO(this,(function(r){switch(r.label){case 0:return Zl.requireNonNull(e,"sessionMetricCollector"),[4,this.callService(tI.PUT_SESSION_METRIC_COLLECTOR,e)];case 1:if(0!==(t=r.sent()).errors.length)throw new va.InvalidFilterError("Invalid filter: "+t.toString());return[2]}}))}))},e.prototype.removeSessionMetricCollector=function(e){return XO(this,void 0,void 0,(function(){return ZO(this,(function(t){return Zl.requireNonNull(e,"sessionMetricCollectorName"),[2,this.callService(tI.REMOVE_SESSION_METRIC_COLLECTOR,e)]}))}))},e.prototype.listSessionMetricCollectors=function(){return this.callService(tI.LIST_SESSION_METRIC_COLLECTORS,null)},e.prototype.putTopicMetricCollector=function(e){return XO(this,void 0,void 0,(function(){return ZO(this,(function(t){return Zl.requireNonNull(e,"topicMetricCollector"),[2,this.callService(tI.PUT_TOPIC_METRIC_COLLECTOR,e)]}))}))},e.prototype.removeTopicMetricCollector=function(e){return XO(this,void 0,void 0,(function(){return ZO(this,(function(t){return Zl.requireNonNull(e,"topicMetricCollectorName"),[2,this.callService(tI.REMOVE_TOPIC_METRIC_COLLECTOR,e)]}))}))},e.prototype.listTopicMetricCollectors=function(){return this.callService(tI.LIST_TOPIC_METRIC_COLLECTORS,null)},e.prototype.getServerMetrics=function(){return this.callService(tI.GET_SERVER_METRICS,null)},e.prototype.getMeasuredEntityClassMetrics=function(e,t){return this.callService(tI.GET_MEASURED_ENTITY_CLASS_METRICS,new GO.MeasuredEntityClassRequest(e,t))},e.prototype.fetchJMXValues=function(e){return this.callService(tI.FETCH_JMX_VALUES,new ZT.JMXFetchRequest(e,!1)).then((function(e){var t=eI(Object.keys(e)),r=t[0],n=t.slice(1),o=e[r];if(!n.length&&!("reason"in o))return o;throw _c.ErrorReason.INVALID_DATA}))},e.prototype.fetchClusterJMXValues=function(e){return this.callService(tI.FETCH_JMX_VALUES,new ZT.JMXFetchRequest(e,!0))},e.prototype.metricsRequest=function(){return rI.MetricsRequestImpl.create(this.internal)},e}();$O.MetricsImpl=nI;var oI={};Object.defineProperty(oI,"__esModule",{value:!0}),oI.PingImpl=void 0;var iI=function(){function e(e,t){void 0===t&&(t=Date.now),this.currentTime=Date.now,this.internal=e,this.currentTime=t,this.ping=e.getServiceLocator().obtain(uv.USER_PING)}return e.prototype.pingServer=function(){var e=this;return new Promise((function(t,r){if(e.internal.checkConnected(r)){var n=e.currentTime();e.ping.send(null,(function(o){if(o)r(o);else{var i=e.currentTime()-n;t({timestamp:n,rtt:i})}}))}}))},e}();oI.PingImpl=iI;var sI={};Object.defineProperty(sI,"__esModule",{value:!0}),sI.CheckRemoteServerResult=void 0;var aI=function(e){this.status=e};sI.CheckRemoteServerResult=aI;var uI={};Object.defineProperty(uI,"__esModule",{value:!0}),uI.readRemoteServerStatus=void 0,uI.readRemoteServerStatus=function(e){return{connectionState:Wh.read(e,MS.ConnectionState),failureMessage:Iu.readString(e)}};var cI={},lI=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(cI,"__esModule",{value:!0}),cI.CheckRemoteServerResultSerialiser=void 0;var pI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lI(t,e),t.prototype.read=function(e){var t=uI.readRemoteServerStatus(e);return new sI.CheckRemoteServerResult(t)},t}(Fu.AbstractSerialiser);cI.CheckRemoteServerResultSerialiser=new pI;var fI={};Object.defineProperty(fI,"__esModule",{value:!0}),fI.RemoteServerImpl=void 0;var hI=function(){function e(e,t,r,n,o,i,s){this.type=e,this.name=t,this.urls=r,this.url=r[0],this.primaryHostName=r[0],this.principal=n,this.connectionOptions=o,this.missingTopicNotificationFilter=i,this.connector=s}return e.prototype.getRetryDelay=function(){var e=this.connectionOptions[MS.ConnectionOption.RETRY_DELAY];return void 0===e?1e3:Number.parseInt(e,10)},e}();fI.RemoteServerImpl=hI;var dI={};Object.defineProperty(dI,"__esModule",{value:!0}),dI.readRemoteServer=void 0,dI.readRemoteServer=function(e){var t=Wh.read(e,MS.RemoteServerType),r=Iu.readString(e),n=Iu.readCollection(e,Iu.readString),o=Iu.readString(e),i=Iu.readObject(e,(function(e){return Wh.read(e,MS.ConnectionOption)}),Iu.readString),s=Iu.readString(e),a=Iu.readString(e);return new fI.RemoteServerImpl(t,r,n,o,i,""!==s?s:void 0,""!==a?a:void 0)};var yI={};Object.defineProperty(yI,"__esModule",{value:!0}),yI.CreateRemoteServerResult=void 0;var vI=function(e,t){this.server=e,this.errors=t};yI.CreateRemoteServerResult=vI;var SI={},_I=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(SI,"__esModule",{value:!0}),SI.CreateRemoteServerResultSerialiser=void 0;var EI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _I(t,e),t.prototype.read=function(e){if(0===e.peek()){Iu.readByte(e);var t=dI.readRemoteServer(e);return new yI.CreateRemoteServerResult(t)}var r=yw.ErrorReportListSerialiser.read(e);return new yI.CreateRemoteServerResult(void 0,r)},t}(Fu.AbstractSerialiser);SI.CreateRemoteServerResultSerialiser=new EI;var wI={};Object.defineProperty(wI,"__esModule",{value:!0}),wI.ListRemoteServersResult=void 0;var mI=function(e){this.result=e};wI.ListRemoteServersResult=mI;var gI={},TI=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gI,"__esModule",{value:!0}),gI.ListRemoteServersResultSerialiser=void 0;var OI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return TI(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,dI.readRemoteServer);return new wI.ListRemoteServersResult(t)},t}(Fu.AbstractSerialiser);gI.ListRemoteServersResultSerialiser=new OI;var II={},bI=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(II,"__esModule",{value:!0}),II.RemoteServerDefinitionSerialiser=void 0;var RI=function(e,t){return Iu.writeByte(e,parseInt(t,10))},CI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return bI(t,e),t.prototype.write=function(e,t){Wh.write(e,t.type),Iu.writeString(e,t.name),Iu.writeCollection(e,t.urls,Iu.writeString),Iu.writeString(e,t.principal),Iu.writeObject(e,t.connectionOptions,RI,Iu.writeString),Iu.writeString(e,void 0!==t.missingTopicNotificationFilter?t.missingTopicNotificationFilter:""),Iu.writeString(e,void 0!==t.connector?t.connector:""),ny.write(e,t.credentials)},t}(Fu.AbstractSerialiser);II.RemoteServerDefinitionSerialiser=new CI;var AI={};Object.defineProperty(AI,"__esModule",{value:!0}),AI.CHECK_REMOTE_SERVER=AI.LIST_REMOTE_SERVERS=AI.REMOVE_REMOTE_SERVER=AI.CREATE_REMOTE_SERVER=void 0,AI.CREATE_REMOTE_SERVER={id:157,request:II.RemoteServerDefinitionSerialiser,response:SI.CreateRemoteServerResultSerialiser},AI.REMOVE_REMOTE_SERVER={id:158,request:q_.StringSerialiser,response:av.NullSerialiser},AI.LIST_REMOTE_SERVERS={id:164,request:av.NullSerialiser,response:gI.ListRemoteServersResultSerialiser},AI.CHECK_REMOTE_SERVER={id:165,request:q_.StringSerialiser,response:cI.CheckRemoteServerResultSerialiser};var PI={};Object.defineProperty(PI,"__esModule",{value:!0}),PI.RemoteServersImpl=void 0;var NI=Xu.create("RemoteServers"),MI=function(){function e(e){this.internal=e;var t=e.getServiceLocator();this.CREATE_REMOTE_SERVER=t.obtain(AI.CREATE_REMOTE_SERVER),this.LIST_REMOTE_SERVERS=t.obtain(AI.LIST_REMOTE_SERVERS),this.CHECK_REMOTE_SERVER=t.obtain(AI.CHECK_REMOTE_SERVER),this.REMOVE_REMOTE_SERVER=t.obtain(AI.REMOVE_REMOTE_SERVER)}return e.prototype.createRemoteServer=function(e){var t=this;return new Promise((function(r,n){Zl.requireNonNull(e,"remoteServer"),t.internal.checkConnected(n)&&t.CREATE_REMOTE_SERVER.send(e,(function(e,t){od.responseSuccess(e,t)?t.errors?(n(t.errors.errors),NI.debug("Create remote server failed")):r(t.server):(n(e),NI.debug("Create remote server failed"))}))}))},e.prototype.checkRemoteServer=function(e){var t=this;return new Promise((function(r,n){t.internal.checkConnected(n)&&t.CHECK_REMOTE_SERVER.send(Zl.requireNonNull(e,"name"),(function(e,t){e?(n(e),NI.debug("Check remote server failed")):r(t.status)}))}))},e.prototype.listRemoteServers=function(){var e=this;return new Promise((function(t,r){e.internal.checkConnected(r)&&e.LIST_REMOTE_SERVERS.send(null,(function(e,n){od.responseSuccess(e,n)?t(n.result):(r(e),NI.debug("List remote servers failed"))}))}))},e.prototype.removeRemoteServer=function(e){var t=this;return new Promise((function(r,n){t.internal.checkConnected(n)&&t.REMOVE_REMOTE_SERVER.send(Zl.requireNonNull(e,"name"),(function(e){e?(n(e),NI.debug("Remove remote server failed")):r()}))}))},e}();PI.RemoteServersImpl=MI;var DI={};Object.defineProperty(DI,"__esModule",{value:!0}),DI.BytesSerialiser=void 0;var jI=function(){function e(){}return e.prototype.read=function(e){return Iu.readBytes(e)},e.prototype.write=function(e,t){Iu.writeBytes(e,t)},e}();DI.BytesSerialiser=new jI;var LI={};Object.defineProperty(LI,"__esModule",{value:!0}),LI.ReplaceLicenceResponse=void 0;var xI=function(e,t){this.type=e,this.resString=t};LI.ReplaceLicenceResponse=xI;var UI={},BI=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(UI,"__esModule",{value:!0}),UI.ReplaceLicenceResponseSerialiser=void 0;var qI=function(e){function t(){var t=e.call(this)||this;return t.responseCode=[],t.responseCode[0]="The license was replaced successfully.",t.responseCode[1]="The provided license does not match this version of Diffusion.",t.responseCode[2]="Diffusion was unable to find the IP address provided within the license.",t.responseCode[3]="The provided license has expired.",t.responseCode[4]="The date on the provided license is not valid.",t.responseCode[5]="The license file is missing.Please check the read / write permissions of your Diffusion server.",t.responseCode[6]="The licencing service has encountered an unknown error.",t.responseCode[7]="The provided license is not valid for the given IP address(es).",t.responseCode[8]="The provided license is not valid for the given MAC address(es).",t.responseCode[9]="The license file provided cannot be read, and may be corrupt.",t.responseCode[10]="The new license has an non-matching feature set to the current license.\nPlease shut down the server and replace the license manually.",t}return BI(t,e),t.prototype.read=function(e){var t=Iu.readByte(e),r=t in this.responseCode?this.responseCode[t]:"An unknown response was received from the server.";return new LI.ReplaceLicenceResponse(t,r)},t}(Fu.AbstractSerialiser);UI.ReplaceLicenceResponseSerialiser=new qI;var VI={};Object.defineProperty(VI,"__esModule",{value:!0}),VI.UPDATE_LICENSE=void 0,VI.UPDATE_LICENSE={id:159,request:DI.BytesSerialiser,response:UI.ReplaceLicenceResponseSerialiser};var kI={};Object.defineProperty(kI,"__esModule",{value:!0}),kI.LicenceUpdater=void 0;var FI=function(){function e(e){this.LICENCE_UPDATE=e.getServiceLocator().obtain(VI.UPDATE_LICENSE)}return e.prototype.updateLicence=function(e){var t=this,r=new Uint8Array(e);return new Promise((function(e,n){t.LICENCE_UPDATE.send(r,(function(t,r){t?n(t):e(r)}))}))},e}();kI.LicenceUpdater=FI;var GI={},HI=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function YI(e){var t,r,n="";if(e.indexOf("'")<0&&e.indexOf("\\")<0)n+=e;else try{for(var o=HI(e),i=o.next();!i.done;i=o.next()){var s=i.value;"'"!==s&&"\\"!==s||(n+="\\"),n+=s}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return"'"+n+"'"}Object.defineProperty(GI,"__esModule",{value:!0}),GI.permissionsToString=GI.setToString=GI.quoteAndEscape=void 0,GI.quoteAndEscape=YI,GI.setToString=function(e){return"["+e.map(YI).join(" ")+"]"},GI.permissionsToString=function(e){return"["+e.join(" ")+"]"};var WI={};Object.defineProperty(WI,"__esModule",{value:!0}),WI.SecurityScriptBuilderImpl=void 0;var zI=function(){function e(){this.commands=""}return e.prototype.maybeApppendNewLine=function(){this.commands.length>0&&(this.commands+="\n")},e.prototype.build=function(){return this.commands},e.prototype.toString=function(){return"ConfigurationScriptBuilder ["+this.commands+"]"},e.prototype.setRolesForAnonymousSessions=function(e){var t=Zl.requireNonNull(e,"roles");return this.maybeApppendNewLine(),this.commands+="set roles for anonymous sessions ",this.commands+=GI.setToString(t),this},e.prototype.setRolesForNamedSessions=function(e){var t=Zl.requireNonNull(e,"roles");return this.maybeApppendNewLine(),this.commands+="set roles for named sessions ",this.commands+=GI.setToString(t),this},e.prototype.setGlobalPermissions=function(e,t){var r=Zl.requireNonNull(e,"role"),n=Zl.requireNonNull(t,"permissions");return this.maybeApppendNewLine(),this.commands+="set "+GI.quoteAndEscape(r)+" permissions ",this.commands+=GI.permissionsToString(n),this},e.prototype.setDefaultPathPermissions=function(e,t){var r=Zl.requireNonNull(e,"role"),n=Zl.requireNonNull(t,"permissions");return this.maybeApppendNewLine(),this.commands+="set "+GI.quoteAndEscape(r)+" default path permissions ",this.commands+=GI.permissionsToString(n),this},e.prototype.removePathPermissions=function(e,t){var r=Zl.requireNonNull(e,"role"),n=Zl.requireNonNull(t,"path");return this.maybeApppendNewLine(),this.commands+="remove "+GI.quoteAndEscape(r)+" permissions for path "+GI.quoteAndEscape(n),this},e.prototype.setPathPermissions=function(e,t,r){var n=Zl.requireNonNull(e,"role"),o=Zl.requireNonNull(t,"path"),i=Zl.requireNonNull(r,"permissions");return this.maybeApppendNewLine(),this.commands+="set "+GI.quoteAndEscape(n)+" path "+GI.quoteAndEscape(o)+" permissions ",this.commands+=GI.permissionsToString(i),this},e.prototype.setRoleIncludes=function(e,t){var r=Zl.requireNonNull(e,"role"),n=Zl.requireNonNull(t,"includedRoles");return this.maybeApppendNewLine(),this.commands+="set "+GI.quoteAndEscape(r)+" includes ",this.commands+=GI.setToString(n),this},e.prototype.setRoleLockedByPrincipal=function(e,t){var r=Zl.requireNonNull(e,"role"),n=Zl.requireNonNull(t,"lockingPrincipal");return this.maybeApppendNewLine(),this.commands+="set role "+GI.quoteAndEscape(r)+" locked by principal "+GI.quoteAndEscape(n),this},e.prototype.isolatePath=function(e){var t=Zl.requireNonNull(e,"path");return this.maybeApppendNewLine(),this.commands+="isolate path "+GI.quoteAndEscape(t),this},e.prototype.deisolatePath=function(e){var t=Zl.requireNonNull(e,"path");return this.maybeApppendNewLine(),this.commands+="deisolate path "+GI.quoteAndEscape(t),this},e}();WI.SecurityScriptBuilderImpl=zI;var QI={};Object.defineProperty(QI,"__esModule",{value:!0}),QI.SystemAuthenticationScriptBuilderImpl=void 0;var KI=function(){function e(){this.commands=""}return e.prototype.maybeApppendNewLine=function(){this.commands.length>0&&(this.commands+="\n")},e.prototype.build=function(){return this.commands},e.prototype.toString=function(){return"SystemAuthenticationScriptBuilder ["+this.commands+"]"},e.prototype.assignRoles=function(e,t){var r=Zl.requireNonNull(t,"roles"),n=Zl.requireNonNull(e,"principal");return this.maybeApppendNewLine(),this.commands+="assign roles "+GI.quoteAndEscape(n)+" ",this.commands+=GI.setToString(r),this},e.prototype.addPrincipal=function(e,t,r,n){void 0===r&&(r=[]);var o=Zl.requireNonNull(r,"roles"),i=Zl.requireNonNull(e,"principal"),s=Zl.requireNonNull(t,"password");return this.maybeApppendNewLine(),this.commands+="add principal "+GI.quoteAndEscape(i)+" "+GI.quoteAndEscape(s),o.length&&(this.commands+=" ",this.commands+=GI.setToString(o)),n&&(this.commands+=" locked by "+GI.quoteAndEscape(n)),this},e.prototype.setPassword=function(e,t){var r=Zl.requireNonNull(e,"principal"),n=Zl.requireNonNull(t,"password");return this.maybeApppendNewLine(),this.commands+="set password "+GI.quoteAndEscape(r)+" "+GI.quoteAndEscape(n),this},e.prototype.verifyPassword=function(e,t){var r=Zl.requireNonNull(e,"principal"),n=Zl.requireNonNull(t,"password");return this.maybeApppendNewLine(),this.commands+="verify password "+GI.quoteAndEscape(r)+" "+GI.quoteAndEscape(n),this},e.prototype.removePrincipal=function(e){var t=Zl.requireNonNull(e,"principal");return this.maybeApppendNewLine(),this.commands+="remove principal "+GI.quoteAndEscape(t),this},e.prototype.allowAnonymousConnections=function(e){var t=Zl.requireNonNull(e,"roles");return this.maybeApppendNewLine(),this.commands+="allow anonymous connections"+(e?" ":""),this.commands+=GI.setToString(t),this},e.prototype.denyAnonymousConnections=function(){return this.maybeApppendNewLine(),this.commands+="deny anonymous connections",this},e.prototype.abstainAnonymousConnections=function(){return this.maybeApppendNewLine(),this.commands+="abstain anonymous connections",this},e.prototype.trustClientProposedPropertyIn=function(e,t){var r=Zl.requireNonNull(e,"propertyName"),n=Zl.requireNonNull(t,"allowedValues");return this.maybeApppendNewLine(),this.commands+="trust client proposed property "+GI.quoteAndEscape(r)+" if value in ",this.commands+=GI.setToString(n),this},e.prototype.trustClientProposedPropertyMatches=function(e,t){var r=Zl.requireNonNull(e,"propertyName"),n=Zl.requireNonNull(t,"regex");return this.maybeApppendNewLine(),this.commands+="trust client proposed property "+GI.quoteAndEscape(r)+" if value matches "+GI.quoteAndEscape(n),this},e.prototype.ignoreClientProposedProperty=function(e){var t=Zl.requireNonNull(e,"propertyName");return this.maybeApppendNewLine(),this.commands+="ignore client proposed property "+GI.quoteAndEscape(t),this},e}();QI.SystemAuthenticationScriptBuilderImpl=KI;var JI={};Object.defineProperty(JI,"__esModule",{value:!0}),JI.SecurityCommandScript=void 0;var $I=function(){function e(e){this.script=Zl.requireNonNull(e,"script")}return e.prototype.toString=function(){return"SecurityCommandScript ["+this.script+"]"},e}();JI.SecurityCommandScript=$I;var XI={};Object.defineProperty(XI,"__esModule",{value:!0}),XI.ChangePrincipalRequest=void 0;var ZI=function(e,t){this.principal=e,this.credentials=t};XI.ChangePrincipalRequest=ZI;var eb={},tb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(eb,"__esModule",{value:!0}),eb.SecurityCommandScriptSerialiser=void 0;var rb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tb(t,e),t.prototype.read=function(e){var t=Iu.readString(e);return new JI.SecurityCommandScript(t)},t.prototype.write=function(e,t){Iu.writeString(e,t.script)},t}(Fu.AbstractSerialiser);eb.SecurityCommandScriptSerialiser=new rb;var nb={};Object.defineProperty(nb,"__esModule",{value:!0}),nb.connectionActionFromString=nb.CONNECTION_ACTION=nb.SystemAuthentication=void 0;var ob=function(){function e(e,t,r,n){void 0===e&&(e=[]),void 0===r&&(r=[]),void 0===n&&(n={}),this.principals=e,this.anonymous={action:t,roles:r},this.trustedClientProposedProperties=n}return e.prototype.toString=function(){return"SystemAuthenticationConfiguration [principals="+this.principals+", anonymous="+this.anonymous+"]"},e}();nb.SystemAuthentication=ob,nb.CONNECTION_ACTION={ALLOW:{id:0,value:"allow"},DENY:{id:1,value:"deny"},ABSTAIN:{id:2,value:"abstain"}},Sc.enumerize(nb.CONNECTION_ACTION),nb.connectionActionFromString=function(e){return nb.CONNECTION_ACTION[e.toUpperCase()]};var ib={};Object.defineProperty(ib,"__esModule",{value:!0}),ib.SessionPropertyValidationImpl=void 0;var sb=function(e){this.type=e};ib.SessionPropertyValidationImpl=sb;var ab={};Object.defineProperty(ab,"__esModule",{value:!0}),ab.ValidationType=ab.PathPermission=ab.GlobalPermission=void 0,function(e){e.AUTHENTICATE="AUTHENTICATE",e.VIEW_SESSION="VIEW_SESSION",e.MODIFY_SESSION="MODIFY_SESSION",e.REGISTER_HANDLER="REGISTER_HANDLER",e.VIEW_SERVER="VIEW_SERVER",e.CONTROL_SERVER="CONTROL_SERVER",e.VIEW_SECURITY="VIEW_SECURITY",e.MODIFY_SECURITY="MODIFY_SECURITY",e.UNKNOWN_GLOBAL_PERMISSION="UNKNOWN_GLOBAL_PERMISSION",e.READ_TOPIC_VIEWS="READ_TOPIC_VIEWS",e.MODIFY_TOPIC_VIEWS="MODIFY_TOPIC_VIEWS"}(ab.GlobalPermission||(ab.GlobalPermission={})),function(e){e.READ_TOPIC="READ_TOPIC",e.UPDATE_TOPIC="UPDATE_TOPIC",e.MODIFY_TOPIC="MODIFY_TOPIC",e.SEND_TO_MESSAGE_HANDLER="SEND_TO_MESSAGE_HANDLER",e.SEND_TO_SESSION="SEND_TO_SESSION",e.SELECT_TOPIC="SELECT_TOPIC",e.QUERY_OBSOLETE_TIME_SERIES_EVENTS="QUERY_OBSOLETE_TIME_SERIES_EVENTS",e.EDIT_TIME_SERIES_EVENTS="EDIT_TIME_SERIES_EVENTS",e.EDIT_OWN_TIME_SERIES_EVENTS="EDIT_OWN_TIME_SERIES_EVENTS",e.ACQUIRE_LOCK="ACQUIRE_LOCK",e.EXPOSE_BRANCH="EXPOSE_BRANCH",e.UNKNOWN_PATH_PERMISSION="UNKNOWN_PATH_PERMISSION"}(ab.PathPermission||(ab.PathPermission={})),function(e){e[e.REGEX=0]="REGEX",e[e.VALUES=1]="VALUES"}(ab.ValidationType||(ab.ValidationType={}));var ub={},cb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ub,"__esModule",{value:!0}),ub.MatchesSessionPropertyValidationImpl=void 0;var lb=function(e){function t(t){var r=e.call(this,ab.ValidationType.REGEX)||this;return r.regex=t,r}return cb(t,e),t.prototype.toString=function(){return"SessionPropertyValidation [type="+this.type+", regex="+this.regex+"]"},t}(ib.SessionPropertyValidationImpl);ub.MatchesSessionPropertyValidationImpl=lb;var pb={},fb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(pb,"__esModule",{value:!0}),pb.ValuesSessionPropertyValidationImpl=void 0;var hb=function(e){function t(t){var r=e.call(this,ab.ValidationType.VALUES)||this;return r.values=t,r}return fb(t,e),t.prototype.toString=function(){return"SessionPropertyValidation [type="+this.type+", values="+this.values+"]"},t}(ib.SessionPropertyValidationImpl);pb.ValuesSessionPropertyValidationImpl=hb;var db={},yb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(db,"__esModule",{value:!0}),db.SessionPropertyValidationSerialiser=void 0;var vb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.read=function(e){if(Wh.read(e,ab.ValidationType)===ab.ValidationType.REGEX)return new ub.MatchesSessionPropertyValidationImpl(Iu.readString(e));var t=Iu.readCollection(e,Iu.readString);return new pb.ValuesSessionPropertyValidationImpl(t)},t.prototype.write=function(e,t){var r=t.type;if(Iu.writeByte(e,r),r===ab.ValidationType.REGEX){var n=t;Iu.writeString(e,n.regex)}else{var o=t;Iu.writeCollection(e,o.values,Iu.writeString)}},t}(Fu.AbstractSerialiser);db.SessionPropertyValidationSerialiser=new vb;var Sb={};Object.defineProperty(Sb,"__esModule",{value:!0}),Sb.SystemPrincipalImpl=void 0;var _b=function(){function e(e,t,r){this.name=e,this.roles=t||[],this.lockingPrincipal=r}return e.prototype.toString=function(){return"SystemPrincipal ["+this.name+", "+this.roles+"]"},e}();Sb.SystemPrincipalImpl=_b;var Eb={},wb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Eb,"__esModule",{value:!0}),Eb.SystemPrincipalSerialiser=void 0;var mb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wb(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=Iu.readCollection(e,Iu.readString),n=Iu.readBoolean(e)?Iu.readString(e):void 0;return new Sb.SystemPrincipalImpl(t,r,n)},t.prototype.write=function(e,t){Iu.writeString(e,t.name),Iu.writeCollection(e,t.roles,Iu.writeString),Iu.writeBoolean(e,!!t.lockingPrincipal),t.lockingPrincipal&&Iu.writeString(e,t.lockingPrincipal)},t}(Fu.AbstractSerialiser);Eb.SystemPrincipalSerialiser=new mb;var gb={},Tb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gb,"__esModule",{value:!0}),gb.SystemAuthenticationConfigurationSerialiser=void 0;var Ob=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tb(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,Eb.SystemPrincipalSerialiser.read),r=Wh.read(e,nb.CONNECTION_ACTION),n=Iu.readCollection(e,Iu.readString),o=Iu.readDictionary(e,db.SessionPropertyValidationSerialiser.read);return new nb.SystemAuthentication(t,r.value,n,o)},t.prototype.write=function(e,t){Iu.writeCollection(e,t.principals,Eb.SystemPrincipalSerialiser.write);var r=nb.connectionActionFromString(t.anonymous.action);Iu.writeByte(e,r.id),Iu.writeCollection(e,t.anonymous.roles,Iu.writeString),Iu.writeDictionary(e,t.trustedClientProposedProperties,db.SessionPropertyValidationSerialiser.write)},t}(Fu.AbstractSerialiser);gb.SystemAuthenticationConfigurationSerialiser=new Ob;var Ib={},bb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Ib,"__esModule",{value:!0}),Ib.ChangePrincipalRequestSerialiser=void 0;var Rb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return bb(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.principal),ny.write(e,t.credentials)},t}(Fu.AbstractSerialiser);Ib.ChangePrincipalRequestSerialiser=new Rb;var Cb={};Object.defineProperty(Cb,"__esModule",{value:!0}),Cb.ControlRegistrationParams=void 0;var Ab=function(e,t){this.definition=e,this.group=t};Cb.ControlRegistrationParams=Ab;var Pb={},Nb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Pb,"__esModule",{value:!0}),Pb.ControlRegistrationParamsSerialiser=void 0;var Mb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nb(t,e),t.prototype.read=function(e){var t=Iu.readInt32(e),r=pv.ControlGroupSerialiser.read(e);return new Cb.ControlRegistrationParams({id:t},r)},t.prototype.write=function(e,t){Iu.writeInt32(e,t.definition.id),pv.ControlGroupSerialiser.write(e,t.group)},t}(Fu.AbstractSerialiser);Pb.ControlRegistrationParamsSerialiser=new Mb;var Db={},jb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Db,"__esModule",{value:!0}),Db.AuthenticatorRegistrationParameters=void 0;var Lb=function(e){function t(t,r,n){var o=e.call(this,r,n)||this;return o.name=t,o}return jb(t,e),t}(Cb.ControlRegistrationParams);Db.AuthenticatorRegistrationParameters=Lb;var xb={},Ub=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(xb,"__esModule",{value:!0}),xb.AuthenticatorRegistrationParametersSerialiser=void 0;var Bb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ub(t,e),t.prototype.read=function(e){var t=Pb.ControlRegistrationParamsSerialiser.read(e),r=Iu.readString(e);return new Db.AuthenticatorRegistrationParameters(r,t.definition,t.group)},t.prototype.write=function(e,t){Pb.ControlRegistrationParamsSerialiser.write(e,t),Iu.writeString(e,t.name)},t}(Fu.AbstractSerialiser);xb.AuthenticatorRegistrationParametersSerialiser=new Bb;var qb={};Object.defineProperty(qb,"__esModule",{value:!0}),qb.AuthenticatorRegistrationRequest=void 0;var Vb=function(e,t){this.params=e,this.cid=t};qb.AuthenticatorRegistrationRequest=Vb;var kb={},Fb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(kb,"__esModule",{value:!0}),kb.AuthenticatorRegistrationRequestSerialiser=void 0;var Gb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fb(t,e),t.prototype.read=function(e){var t=xb.AuthenticatorRegistrationParametersSerialiser.read(e),r=Vu.CIDSerialiser.read(e);return new qb.AuthenticatorRegistrationRequest(t,r)},t.prototype.write=function(e,t){xb.AuthenticatorRegistrationParametersSerialiser.write(e,t.params),Vu.CIDSerialiser.write(e,t.cid)},t}(Fu.AbstractSerialiser);kb.AuthenticatorRegistrationRequestSerialiser=new Gb;var Hb={};Object.defineProperty(Hb,"__esModule",{value:!0}),Hb.AuthenticatorRequest=void 0;var Yb=function(e,t,r,n,o){this.principal=e,this.credentials=t,this.sessionProperties=r,this.proposedProperties=n,this.cid=o};Hb.AuthenticatorRequest=Yb;var Wb={},zb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Wb,"__esModule",{value:!0}),Wb.AuthenticatorRequestSerialiser=void 0;var Qb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zb(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=ny.read(e),n=Iu.readDictionary(e,Iu.readString),o=Iu.readDictionary(e,Iu.readString),i=Vu.CIDSerialiser.read(e);return new Hb.AuthenticatorRequest(t,r,n,o,i)},t}(Fu.AbstractSerialiser);Wb.AuthenticatorRequestSerialiser=new Qb;var Kb,Jb={};Object.defineProperty(Jb,"__esModule",{value:!0}),Jb.ABSTAIN=Jb.DENY=Jb.AuthenticatorResponse=Jb.TypeCode=void 0,function(e){e[e.DENY=0]="DENY",e[e.ABSTAIN=1]="ABSTAIN",e[e.ALLOW=2]="ALLOW"}(Kb=Jb.TypeCode||(Jb.TypeCode={}));var $b=function(e,t){this.type=e,this.properties=t};Jb.AuthenticatorResponse=$b,Jb.DENY=Object.freeze(new $b(Kb.DENY)),Jb.ABSTAIN=Object.freeze(new $b(Kb.ABSTAIN));var Xb={},Zb=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Xb,"__esModule",{value:!0}),Xb.AuthenticatorResponseSerialiser=void 0;var eR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zb(t,e),t.prototype.read=function(e){switch(Wh.read(e,Jb.TypeCode)){case Jb.TypeCode.ABSTAIN:return Jb.ABSTAIN;case Jb.TypeCode.ALLOW:var t=Iu.readDictionary(e,Iu.readString);return new Jb.AuthenticatorResponse(Jb.TypeCode.ALLOW,t);default:return Jb.DENY}},t.prototype.write=function(e,t){Wh.write(e,t.type),t.type===Jb.TypeCode.ALLOW&&Iu.writeDictionary(e,t.properties||{},Iu.writeString)},t}(Fu.AbstractSerialiser);Xb.AuthenticatorResponseSerialiser=new eR;var tR={};Object.defineProperty(tR,"__esModule",{value:!0}),tR.PathPermissionCode=tR.GlobalPermissionCode=void 0,function(e){e[e.AUTHENTICATE=0]="AUTHENTICATE",e[e.VIEW_SESSION=1]="VIEW_SESSION",e[e.MODIFY_SESSION=2]="MODIFY_SESSION",e[e.REGISTER_HANDLER=3]="REGISTER_HANDLER",e[e.VIEW_SERVER=4]="VIEW_SERVER",e[e.CONTROL_SERVER=5]="CONTROL_SERVER",e[e.VIEW_SECURITY=6]="VIEW_SECURITY",e[e.MODIFY_SECURITY=7]="MODIFY_SECURITY",e[e.UNKNOWN_GLOBAL_PERMISSION=8]="UNKNOWN_GLOBAL_PERMISSION",e[e.READ_TOPIC_VIEWS=9]="READ_TOPIC_VIEWS",e[e.MODIFY_TOPIC_VIEWS=10]="MODIFY_TOPIC_VIEWS"}(tR.GlobalPermissionCode||(tR.GlobalPermissionCode={})),function(e){e[e.READ_TOPIC=0]="READ_TOPIC",e[e.UPDATE_TOPIC=1]="UPDATE_TOPIC",e[e.MODIFY_TOPIC=2]="MODIFY_TOPIC",e[e.SEND_TO_MESSAGE_HANDLER=3]="SEND_TO_MESSAGE_HANDLER",e[e.SEND_TO_SESSION=4]="SEND_TO_SESSION",e[e.SELECT_TOPIC=5]="SELECT_TOPIC",e[e.QUERY_OBSOLETE_TIME_SERIES_EVENTS=6]="QUERY_OBSOLETE_TIME_SERIES_EVENTS",e[e.EDIT_TIME_SERIES_EVENTS=7]="EDIT_TIME_SERIES_EVENTS",e[e.EDIT_OWN_TIME_SERIES_EVENTS=8]="EDIT_OWN_TIME_SERIES_EVENTS",e[e.ACQUIRE_LOCK=9]="ACQUIRE_LOCK",e[e.UNKNOWN_PATH_PERMISSION=10]="UNKNOWN_PATH_PERMISSION",e[e.EXPOSE_BRANCH=11]="EXPOSE_BRANCH"}(tR.PathPermissionCode||(tR.PathPermissionCode={}));var rR={};Object.defineProperty(rR,"__esModule",{value:!0}),rR.ListGlobalPermissionsResult=void 0;var nR=function(e){this.permissions=e};rR.ListGlobalPermissionsResult=nR;var oR={},iR=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(oR,"__esModule",{value:!0}),oR.ListGlobalPermissionsResultSerialiser=void 0;var sR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return iR(t,e),t.prototype.read=function(e){return new rR.ListGlobalPermissionsResult(Iu.readCollection(e,(function(){var t=tR.GlobalPermissionCode[e.read()];return ab.GlobalPermission[t]})))},t}(Fu.AbstractSerialiser);oR.ListGlobalPermissionsResultSerialiser=new sR;var aR={};Object.defineProperty(aR,"__esModule",{value:!0}),aR.ListPathPermissionsResult=void 0;var uR=function(e){this.permissions=e};aR.ListPathPermissionsResult=uR;var cR={},lR=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(cR,"__esModule",{value:!0}),cR.ListPathPermissionsResultSerialiser=void 0;var pR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lR(t,e),t.prototype.read=function(e){return new aR.ListPathPermissionsResult(Iu.readCollection(e,(function(){var t=tR.PathPermissionCode[e.read()];return ab.PathPermission[t]})))},t}(Fu.AbstractSerialiser);cR.ListPathPermissionsResultSerialiser=new pR;var fR={};Object.defineProperty(fR,"__esModule",{value:!0}),fR.SecurityConfigurationImpl=void 0;var hR=function(){function e(e,t,r,n){this.anonymous=e,this.named=t,this.roles=r,this.isolatedPaths=n}return e.prototype.toString=function(){return"SecurityConfiguration [anonymous=${this.anonymous}, named=${this.named}, roles=${this.roles}, isolatedPaths=${this.isolatedPaths}]"},e}();fR.SecurityConfigurationImpl=hR;var dR={};Object.defineProperty(dR,"__esModule",{value:!0}),dR.RoleImpl=void 0;var yR=function(e,t,r,n,o,i){this.name=e,this.global=t,this.default=r,this.topic=n,this.roles=o,this.lockingPrincipal=i};dR.RoleImpl=yR;var vR={};Object.defineProperty(vR,"__esModule",{value:!0}),vR.read=void 0,vR.read=function(e){var t=Iu.readString(e),r=Iu.readCollection(e,(function(){return Wh.read(e,tR.GlobalPermissionCode)})).map((function(e){return tR.GlobalPermissionCode[e]})),n=Iu.readCollection(e,(function(){return Wh.read(e,tR.PathPermissionCode)})).map((function(e){return tR.PathPermissionCode[e]})),o=Iu.readDictionary(e,(function(){return Iu.readCollection(e,(function(){return Wh.read(e,tR.PathPermissionCode)})).map((function(e){return tR.PathPermissionCode[e]}))})),i=Iu.readCollection(e,Iu.readString),s=Iu.readBoolean(e)?Iu.readString(e):void 0;return new dR.RoleImpl(t,r,n,o,i,s)};var SR={},_R=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(SR,"__esModule",{value:!0}),SR.SecurityConfigurationSerialiser=void 0;var ER=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _R(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,Iu.readString),r=Iu.readCollection(e,Iu.readString),n=Iu.readCollection(e,vR.read),o=Iu.readCollection(e,Iu.readString);return new fR.SecurityConfigurationImpl(t,r,n,o)},t}(Fu.AbstractSerialiser);SR.SecurityConfigurationSerialiser=new ER;var wR={};Object.defineProperty(wR,"__esModule",{value:!0}),wR.LIST_PATH_PERMISSIONS=wR.LIST_GLOBAL_PERMISSIONS=wR.AUTHENTICATOR_DEREGISTRATION=wR.AUTHENTICATOR=wR.AUTHENTICATOR_REGISTRATION=wR.UPDATE_SECURITY_CONFIGURATION=wR.GET_SECURITY_CONFIGURATION=wR.UPDATE_SYSTEM_AUTHENTICATION=wR.GET_SYSTEM_AUTHENTICATION=wR.CHANGE_PRINCIPAL=void 0,wR.CHANGE_PRINCIPAL={id:5,request:Ib.ChangePrincipalRequestSerialiser,response:Hh.BooleanSerialiser},wR.GET_SYSTEM_AUTHENTICATION={id:57,request:av.NullSerialiser,response:gb.SystemAuthenticationConfigurationSerialiser},wR.UPDATE_SYSTEM_AUTHENTICATION={id:58,request:eb.SecurityCommandScriptSerialiser,response:yw.ErrorReportListSerialiser},wR.GET_SECURITY_CONFIGURATION={id:59,request:av.NullSerialiser,response:SR.SecurityConfigurationSerialiser},wR.UPDATE_SECURITY_CONFIGURATION={id:60,request:eb.SecurityCommandScriptSerialiser,response:yw.ErrorReportListSerialiser},wR.AUTHENTICATOR_REGISTRATION={id:119,request:kb.AuthenticatorRegistrationRequestSerialiser,response:av.NullSerialiser},wR.AUTHENTICATOR={id:120,request:Wb.AuthenticatorRequestSerialiser,response:Xb.AuthenticatorResponseSerialiser},wR.AUTHENTICATOR_DEREGISTRATION={id:121,request:xb.AuthenticatorRegistrationParametersSerialiser,response:av.NullSerialiser},wR.LIST_GLOBAL_PERMISSIONS={id:143,request:av.NullSerialiser,response:oR.ListGlobalPermissionsResultSerialiser},wR.LIST_PATH_PERMISSIONS={id:144,request:q_.StringSerialiser,response:cR.ListPathPermissionsResultSerialiser};var mR={},gR=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(mR,"__esModule",{value:!0}),mR.SecurityImpl=void 0;var TR=Xu.create("Session.Security"),OR=function(){function e(e){this.GlobalPermission=ab.GlobalPermission,this.PathPermission=ab.PathPermission,this.internal=e;var t=e.getServiceLocator();this.CHANGE_PRINCIPAL=t.obtain(wR.CHANGE_PRINCIPAL),this.GET_SECURITY_CONFIGURATION=t.obtain(wR.GET_SECURITY_CONFIGURATION),this.GET_SYSTEM_AUTHENTICATION=t.obtain(wR.GET_SYSTEM_AUTHENTICATION),this.UPDATE_SECURITY_CONFIGURATION=t.obtain(wR.UPDATE_SECURITY_CONFIGURATION),this.UPDATE_SYSTEM_AUTHENTICATION=t.obtain(wR.UPDATE_SYSTEM_AUTHENTICATION),this.AUTHENTICATOR_DEREGISTRATION=t.obtain(wR.AUTHENTICATOR_DEREGISTRATION),this.LIST_GLOBAL_PERMISSIONS=t.obtain(wR.LIST_GLOBAL_PERMISSIONS),this.LIST_PATH_PERMISSIONS=t.obtain(wR.LIST_PATH_PERMISSIONS),e.getServiceRegistry().add(wR.AUTHENTICATOR,lT.create((function(e,t,r){e.getConversationSet().respondIfPresent(t.cid,{req:t,callback:r})})))}return e.prototype.getPrincipal=function(){return this.internal.getPrincipal()},e.prototype.changePrincipal=function(e,t){var r=this;return new Promise((function(n,o){r.internal.checkConnected(o)&&(TR.debug("Changing principal",e),r.CHANGE_PRINCIPAL.send(new XI.ChangePrincipalRequest(e,t),(function(t,i){t?o(t):i?(r.internal.setPrincipal(e),n()):o(new Error("Unable to change principal due to authentication failure"))})))}))},e.prototype.getSecurityConfiguration=function(){var e=this;return new Promise((function(t,r){e.internal.checkConnected(r)&&(TR.debug("Getting security configuration"),e.GET_SECURITY_CONFIGURATION.send(null,(function(e,n){e?r(e):t(n)})))}))},e.prototype.getSystemAuthenticationConfiguration=function(){var e=this;return new Promise((function(t,r){e.internal.checkConnected(r)&&(TR.debug("Getting system authentication"),e.GET_SYSTEM_AUTHENTICATION.send(null,(function(e,n){e?r(e):t(n)})))}))},e.prototype.setAuthenticator=function(e,t){var r=this;return new Promise((function(n,o){var i=!1;if(r.internal.checkConnected(o)){try{Zl.requireNonNull(e,"handlerName"),Zl.requireNonNull(t,"authenticator")}catch(e){return void o(e)}"function"==typeof t.authenticate&&"function"==typeof t.onError&&"function"==typeof t.onClose||o(new Error("authenticator does not implement the Authenticator interface")),TR.debug("Adding authenticator",e);var s={name:e,definition:wR.AUTHENTICATOR,group:cv.DEFAULT},a={active:function(o,a){TR.debug("Authenticator active",e),n({close:function(){return new Promise((function(e){i=!0,r.AUTHENTICATOR_DEREGISTRATION.send(s,(function(n,o){n?(r.internal.getConversationSet().discard(a,n),TR.debug("Error with authenticator deregistration: ",n)):(r.internal.getConversationSet().respondIfPresent(a,o),t.onClose()),e()}))}))}})},respond:function(e){if(i)return!0;var r=e.req,n=e.callback;try{t.authenticate(r.principal,r.credentials,r.sessionProperties,r.proposedProperties,{allow:function(e){var t,o;if(e){e=Object.assign({},e);try{for(var i=gR(Object.getOwnPropertyNames(r.sessionProperties)),s=i.next();!s.done;s=i.next()){var a=s.value;e[a]===r.sessionProperties[a]&&delete e[a]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}}n.respond(new Jb.AuthenticatorResponse(Jb.TypeCode.ALLOW,e))},abstain:function(){n.respond(Jb.ABSTAIN)},deny:function(){n.respond(Jb.DENY)}})}catch(e){throw t.onError(e),n.fail(_c.ErrorReason.CALLBACK_EXCEPTION,e&&e.message),e}return!1},close:function(r){r?(TR.debug("'Authenticator closed with error for \""+e+"\"'"),t.onError(r)):(TR.debug("'Authentication Handler closed for \""+e+"\"'"),t.onClose())}};I_.registerHandler(r.internal,s,a,wR.AUTHENTICATOR_REGISTRATION,wR.AUTHENTICATOR_DEREGISTRATION).then(void 0,(function(e){o(e)}))}}))},e.prototype.updateStoreCallback=function(e,t,r,n){e?n(e):t.errors.length>0?n(t.errors):r()},e.prototype.updateStore=function(e,t){var r=this;return new Promise((function(n,o){""===t?n():t&&"string"==typeof t?r.internal.checkConnected(o)&&e.send(new JI.SecurityCommandScript(t),(function(e,t){r.updateStoreCallback(e,t,n,o)})):o(new Error("Invalid argument for script: "+t))}))},e.prototype.updateSecurityStore=function(e){return TR.debug("Updating security store"),this.updateStore(this.UPDATE_SECURITY_CONFIGURATION,e)},e.prototype.updateAuthenticationStore=function(e){return TR.debug("Updating authentication store"),this.updateStore(this.UPDATE_SYSTEM_AUTHENTICATION,e)},e.prototype.securityScriptBuilder=function(){return new WI.SecurityScriptBuilderImpl},e.prototype.authenticationScriptBuilder=function(){return new QI.SystemAuthenticationScriptBuilderImpl},e.prototype.getGlobalPermissions=function(){var e=this;return new Promise((function(t,r){e.internal.checkConnected(r)&&(TR.debug("Getting global permissions"),e.LIST_GLOBAL_PERMISSIONS.send(null,(function(e,n){e?r(e):t(n.permissions)})))}))},e.prototype.getPathPermissions=function(e){var t=this;return new Promise((function(r,n){t.internal.checkConnected(n)&&(TR.debug("Getting path permissions"),t.LIST_PATH_PERMISSIONS.send(e,(function(e,t){e?n(e):r(t.permissions)})))}))},e}();mR.SecurityImpl=OR;var IR={},bR=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function RR(e,t){Iu.writeString(e,t.sessionFilter),Iu.writeString(e,t.topicTreeBranch)}function CR(e){return{sessionFilter:Iu.readString(e),topicTreeBranch:Iu.readString(e)}}Object.defineProperty(IR,"__esModule",{value:!0}),IR.BranchMappingTableSerialiser=void 0;var AR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return bR(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=Iu.readCollection(e,CR);return new __.BranchMappingTableImpl(t,r)},t.prototype.write=function(e,t){Iu.writeString(e,t.getSessionTreeBranch()),Iu.writeCollection(e,t.getBranchMappings(),RR)},t}(Fu.AbstractSerialiser);IR.BranchMappingTableSerialiser=new AR;var PR={};Object.defineProperty(PR,"__esModule",{value:!0}),PR.SessionTreeBranchList=void 0;var NR=function(e){this.paths=e};PR.SessionTreeBranchList=NR;var MR={},DR=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(MR,"__esModule",{value:!0}),MR.SessionTreeBranchListSerialiser=void 0;var jR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return DR(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,Iu.readString);return new PR.SessionTreeBranchList(t)},t}(Fu.AbstractSerialiser);MR.SessionTreeBranchListSerialiser=new jR;var LR={};Object.defineProperty(LR,"__esModule",{value:!0}),LR.GET_BRANCH_MAPPING_TABLE=LR.GET_SESSION_TREE_BRANCHES_WITH_MAPPINGS=LR.PUT_BRANCH_MAPPING_TABLE=void 0,LR.PUT_BRANCH_MAPPING_TABLE={id:176,request:IR.BranchMappingTableSerialiser,response:av.NullSerialiser},LR.GET_SESSION_TREE_BRANCHES_WITH_MAPPINGS={id:177,request:av.NullSerialiser,response:MR.SessionTreeBranchListSerialiser},LR.GET_BRANCH_MAPPING_TABLE={id:178,request:q_.StringSerialiser,response:IR.BranchMappingTableSerialiser};var xR={};Object.defineProperty(xR,"__esModule",{value:!0}),xR.SessionTreesImpl=void 0;var UR=Xu.create("SessionTrees"),BR=function(){function e(e){this.internal=e;var t=e.getServiceLocator();this.PUT_BRANCH_MAPPING_TABLE=t.obtain(LR.PUT_BRANCH_MAPPING_TABLE),this.GET_SESSION_TREE_BRANCHES_WITH_MAPPINGS=t.obtain(LR.GET_SESSION_TREE_BRANCHES_WITH_MAPPINGS),this.GET_BRANCH_MAPPING_TABLE=t.obtain(LR.GET_BRANCH_MAPPING_TABLE)}return e.prototype.putBranchMappingTable=function(e){var t=this;return new Promise((function(r,n){Zl.requireNonNull(e,"branchMappingTable"),t.internal.checkConnected(n)&&t.PUT_BRANCH_MAPPING_TABLE.send(e,(function(e,t){od.responseSuccess(e,t)?r():(n(e),UR.debug("Put branch mapping table failed"))}))}))},e.prototype.getSessionTreeBranchesWithMappings=function(){var e=this;return new Promise((function(t,r){e.internal.checkConnected(r)&&e.GET_SESSION_TREE_BRANCHES_WITH_MAPPINGS.send(null,(function(e,n){od.responseSuccess(e,n)?t(n.paths):(r(e),UR.debug("Get session tree branches with mappings failed"))}))}))},e.prototype.getBranchMappingTable=function(e){var t=this;return new Promise((function(r,n){Zl.requireNonNull(e,"sessionTreeBranch"),t.internal.checkConnected(n)&&t.GET_BRANCH_MAPPING_TABLE.send(e,(function(e,t){od.responseSuccess(e,t)?r(t):(n(e),UR.debug("Get branch mapping table failed"))}))}))},e}();xR.SessionTreesImpl=BR;var qR={};function VR(e,t){var r=Zl.requireNonNull(e,t);if(r<0)throw new va.IllegalArgumentError(t+" is negative: "+e);return r}Object.defineProperty(qR,"__esModule",{value:!0}),qR.Point=qR.Types=void 0;var kR=function(e,t,r,n){this.id=e,this.anchorOperator=t,this.spanOperator=r,this.unitsSuffix=n};qR.Types={ABSOLUTE_START:new kR(0,"fromStart","toStart",""),ABSOLUTE_SEQUENCE:new kR(1,"from","to",""),ABSOLUTE_TIME:new kR(2,"from","to"," ms"),OFFSET_SEQUENCE:new kR(3,"fromLast","untilLast",""),OFFSET_TIME:new kR(4,"fromLast","untilLast"," ms"),NEXT_COUNT:new kR(5,null,"next",""),NEXT_TIME:new kR(6,null,"next"," ms"),PREVIOUS_COUNT:new kR(7,null,"previous",""),PREVIOUS_TIME:new kR(8,null,"previous"," ms")},Sc.enumerize(qR.Types);var FR=function(){function e(e,t){this.value=e,this.type=t}return e.at=function(t){return t instanceof Date?new e(t.getTime(),qR.Types.ABSOLUTE_TIME):new e(VR(t,"Sequence"),qR.Types.ABSOLUTE_SEQUENCE)},e.atStart=function(){return GR},e.offset=function(t){return new e(VR(t,"Count"),qR.Types.OFFSET_SEQUENCE)},e.offsetMillis=function(t){return new e(VR(t,"Timespan"),qR.Types.OFFSET_TIME)},e.next=function(t){return new e(VR(t,"Count"),qR.Types.NEXT_COUNT)},e.nextMillis=function(t){return new e(VR(t,"Timespan"),qR.Types.NEXT_TIME)},e.previous=function(t){return new e(VR(t,"Count"),qR.Types.PREVIOUS_COUNT)},e.previousMillis=function(t){return new e(VR(t,"Timespan"),qR.Types.PREVIOUS_TIME)},e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.value===t.value&&this.type===t.type)},e}();qR.Point=FR;var GR=new FR(0,qR.Types.ABSOLUTE_START),HR={};Object.defineProperty(HR,"__esModule",{value:!0}),HR.DEFAULT_RANGE=HR.Range=void 0;var YR=function(){function e(e,t){this.anchor=e,this.span=t}return e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.anchor.equals(t.anchor)&&this.span.equals(t.span))},e.prototype.from=function(t){return new e(qR.Point.at(t),this.span)},e.prototype.fromStart=function(){return new e(qR.Point.atStart(),this.span)},e.prototype.fromLast=function(t){return new e(qR.Point.offset(t),this.span)},e.prototype.fromLastMillis=function(t){return new e(qR.Point.offsetMillis(t),this.span)},e.prototype.to=function(t){return new e(this.anchor,qR.Point.at(t))},e.prototype.toStart=function(){return new e(this.anchor,qR.Point.atStart())},e.prototype.untilLast=function(t){return new e(this.anchor,qR.Point.offset(t))},e.prototype.untilLastMillis=function(t){return new e(this.anchor,qR.Point.offsetMillis(t))},e.prototype.next=function(t){return new e(this.anchor,qR.Point.next(t))},e.prototype.nextMillis=function(t){return new e(this.anchor,qR.Point.nextMillis(t))},e.prototype.previous=function(t){return new e(this.anchor,qR.Point.previous(t))},e.prototype.previousMillis=function(t){return new e(this.anchor,qR.Point.previousMillis(t))},e}();HR.Range=YR,HR.DEFAULT_RANGE=new YR(qR.Point.atStart(),qR.Point.offset(0));var WR={};Object.defineProperty(WR,"__esModule",{value:!0}),WR.DEFAULT_RANGE_QUERY=WR.RangeQueryParameters=WR.QueryTypes=WR.StreamStructures=void 0;var zR=function(){function e(e,t){this.id=e,this.name=t}return e.prototype.toString=function(){return this.name},e}();WR.StreamStructures={VALUE_EVENT_STREAM:new zR(1,"VALUE_EVENT_STREAM"),EDIT_EVENT_STREAM:new zR(2,"EDIT_EVENT_STREAM")},Sc.enumerize(WR.StreamStructures),Object.freeze(WR.StreamStructures);var QR=function(e,t){this.id=e,this.streamStructure=t};WR.QueryTypes={VALUES:new QR(0,WR.StreamStructures.VALUE_EVENT_STREAM),ALL_EDITS:new QR(1,WR.StreamStructures.EDIT_EVENT_STREAM),LATEST_EDITS:new QR(2,WR.StreamStructures.EDIT_EVENT_STREAM)},Sc.enumerize(WR.QueryTypes),Object.freeze(WR.QueryTypes);var KR=function(){function e(e,t,r,n){this.queryType=e,this.viewRange=t,this.editRange=r,this.limit=n}return e.prototype.withViewRange=function(t){return new e(this.queryType,t,this.editRange,this.limit)},e.prototype.withEditRange=function(t){return new e(this.queryType,this.viewRange,t,this.limit)},e.prototype.withLimit=function(t){return new e(this.queryType,this.viewRange,this.editRange,function(e,t){if(e<0)throw new va.IllegalArgumentError(t+'" is negative: '+e);return e}(t,"limit"))},e.prototype.withQueryType=function(t){return new e(t,this.viewRange,this.editRange,this.limit)},e.prototype.equals=function(t){return!!(t&&t instanceof e)&&(this.queryType===t.queryType&&this.viewRange.equals(t.viewRange)&&this.editRange.equals(t.editRange)&&this.limit===t.limit)},e}();WR.RangeQueryParameters=KR,WR.DEFAULT_RANGE_QUERY=Object.freeze(new KR(WR.QueryTypes.VALUES,HR.DEFAULT_RANGE,HR.DEFAULT_RANGE,Sl.MAX_SAFE_INTEGER));var JR={};function $R(e,t){return e.withViewRange(t(e.viewRange))}function XR(e,t){return e.withEditRange(t(e.editRange))}Object.defineProperty(JR,"__esModule",{value:!0}),JR.RangeQueryImpl=void 0;var ZR=function(){function e(e,t,r,n){this.context=e,this.valueType=t,this.parameters=r,this.mode=n}return e.createDefault=function(t){return new e(t,Bl.BytesImpl,WR.DEFAULT_RANGE_QUERY,$R)},e.prototype.withCurrentRange=function(t){return new e(this.context,this.valueType,this.mode(this.parameters,t),this.mode)},e.prototype.selectFrom=function(e){var t=this;return new Promise((function(r,n){if(e){var o={topicPath:e,parameters:t.parameters};t.context.send(o,(function(e,o){if(od.responseSuccess(e,o))try{r(o.createQueryResult(t.valueType,t.parameters.queryType.streamStructure))}catch(e){n(_c.ErrorReason.INVALID_DATA)}else n(e)}))}else n(new Error("Topic path is null"))}))},e.prototype.forValues=function(){return new e(this.context,this.valueType,this.parameters.withQueryType(WR.QueryTypes.VALUES).withViewRange(HR.DEFAULT_RANGE),$R)},e.prototype.forEdits=function(){return new e(this.context,this.valueType,this.parameters.withQueryType(WR.QueryTypes.ALL_EDITS).withViewRange(HR.DEFAULT_RANGE),$R)},e.prototype.editRange=function(){if(this.parameters.queryType!==WR.QueryTypes.VALUES)throw new va.IllegalStateError(".editRange() cannot be applied to this edit range query");return new e(this.context,this.valueType,this.parameters,XR)},e.prototype.allEdits=function(){if(this.parameters.queryType===WR.QueryTypes.VALUES)throw new va.IllegalStateError(".allEdits() cannot be applied to this value range query");return new e(this.context,this.valueType,this.parameters.withQueryType(WR.QueryTypes.ALL_EDITS),XR)},e.prototype.latestEdits=function(){if(this.parameters.queryType===WR.QueryTypes.VALUES)throw new va.IllegalStateError(".latestEdits() cannot be applied to this value range query");return new e(this.context,this.valueType,this.parameters.withQueryType(WR.QueryTypes.LATEST_EDITS),XR)},e.prototype.limit=function(t){return new e(this.context,this.valueType,this.parameters.withLimit(t),this.mode)},e.prototype.as=function(t){if(Zl.requireNonNull(t,"Value type"),t&&t.valueClass)return new e(this.context,t.valueClass,this.parameters,this.mode);if(t instanceof Function)return new e(this.context,t,this.parameters,this.mode);throw new va.IllegalArgumentError("Invalid value type: "+t)},e.prototype.from=function(e){return this.withCurrentRange((function(t){return t.from(e)}))},e.prototype.fromStart=function(){return this.withCurrentRange((function(e){return e.fromStart()}))},e.prototype.fromLast=function(e){return this.withCurrentRange((function(t){return t.fromLast(e)}))},e.prototype.fromLastMillis=function(e){return this.withCurrentRange((function(t){return t.fromLastMillis(e)}))},e.prototype.to=function(e){return this.withCurrentRange((function(t){return t.to(e)}))},e.prototype.toStart=function(){return this.withCurrentRange((function(e){return e.toStart()}))},e.prototype.untilLast=function(e){return this.withCurrentRange((function(t){return t.untilLast(e)}))},e.prototype.untilLastMillis=function(e){return this.withCurrentRange((function(t){return t.untilLastMillis(e)}))},e.prototype.next=function(e){return this.withCurrentRange((function(t){return t.next(e)}))},e.prototype.nextMillis=function(e){return this.withCurrentRange((function(t){return t.nextMillis(e)}))},e.prototype.previous=function(e){return this.withCurrentRange((function(t){return t.previous(e)}))},e.prototype.previousMillis=function(e){return this.withCurrentRange((function(t){return t.previousMillis(e)}))},e.prototype.equals=function(t){return!!(t&&t instanceof e)&&this.parameters.equals(t.parameters)},e.prototype.toString=function(){return this.parameters.toString()},e}();JR.RangeQueryImpl=ZR;var eC={};function tC(e){var t=Iu.readInt64(e),r=Wh.read(e,qR.Types);return new qR.Point(t,r)}function rC(e){var t=tC(e),r=tC(e);return new HR.Range(t,r)}function nC(e,t){Iu.writeInt64(e,t.value),Wh.write(e,t.type)}function oC(e,t){nC(e,t.anchor),nC(e,t.span)}Object.defineProperty(eC,"__esModule",{value:!0}),eC.write=eC.read=void 0,eC.read=function(e){var t=Wh.read(e,WR.QueryTypes),r=rC(e),n=rC(e),o=Iu.readInt64(e);return new WR.RangeQueryParameters(t,r,n,o)},eC.write=function(e,t){Wh.write(e,t.queryType),oC(e,t.viewRange),oC(e,t.editRange),Iu.writeInt64(e,t.limit)};var iC={};Object.defineProperty(iC,"__esModule",{value:!0}),iC.RangeQueryRequest=void 0;var sC=function(e,t){this.topicPath=e,this.parameters=t};iC.RangeQueryRequest=sC;var aC={},uC=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(aC,"__esModule",{value:!0}),aC.RangeQueryRequestSerialiser=void 0;var cC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return uC(t,e),t.prototype.read=function(e){var t=Iu.readString(e),r=eC.read(e);return new iC.RangeQueryRequest(t,r)},t.prototype.write=function(e,t){Iu.writeString(e,t.topicPath),eC.write(e,t.parameters)},t}(Fu.AbstractSerialiser);aC.RangeQueryRequestSerialiser=new cC;var lC={};function pC(e){return!!e}function fC(e,t){return e.originalEvent.sequence!==t.originalEvent.sequence?e.originalEvent.sequence-t.originalEvent.sequence:e.sequence-t.sequence}Object.defineProperty(lC,"__esModule",{value:!0}),lC.QueryResultImpl=void 0;var hC=function(){function e(e,t,r,n){this.events=n,this.selectedCount=e.toNumber(),this.isComplete=e.equals(t),this.streamStructure=r}return e.prototype.merge=function(t){var r,n,o=this.events.concat(t.events).sort(fC).map((r=this.events.concat(t.events),n={},r.forEach((function(e){var t=e.originalEvent.sequence.toString(10);(!n[t]||n[t].sequence<e.sequence)&&(n[t]=e)})),function(e){var t=e.originalEvent.sequence.toString(10),r=n[t];return r?e.isEditEvent?e.sequence.equals(r.sequence)?(delete n[t],e):null:(delete n[t],r):null})).filter(pC),i=ka.fromNumber(o.length);return new e(i,i,WR.StreamStructures.VALUE_EVENT_STREAM,o)},e}();lC.QueryResultImpl=hC;var dC={};Object.defineProperty(dC,"__esModule",{value:!0}),dC.RangeQueryResult=void 0;var yC=function(){function e(e,t,r){this.valueDataType=e,this.selectedCount=t,this.events=r}return e.prototype.createQueryResult=function(e,t){var r=this;if(!this.valueDataType.canReadAs(e))throw new va.InvalidDataError("Time series topic has an incompatible event data type: "+this.valueDataType);return new lC.QueryResultImpl(this.selectedCount,ka.fromNumber(this.events.length),t,this.events.map((function(t){return t.withValue(r.valueDataType.readAs(e,t.value))})))},e}();dC.RangeQueryResult=yC;var vC={},SC=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(vC,"__esModule",{value:!0}),vC.RangeQueryResultSerialiserClass=void 0;var _C=function(e,t){this.sequence=e,this.timestamp=t};function EC(e,t,r){var n=Iu.readInt64(e).add(t.sequence),o=Iu.readInt64(e).add(t.timestamp),i=Iu.readBytes(e),s=r[i.toString()],a=s||Ou.uint8toUtf8(i);return new Wf.EventMetadataImpl(n.toNumber(),o.toNumber(),a)}function wC(e,t,r){var n=EC(e,t,r);return Hf.EventImpl.create(n,n,Iu.readBytes(e))}function mC(e,t,r){var n=EC(e,t,r),o=EC(e,t,r);return Hf.EventImpl.create(o,n,Iu.readBytes(e))}function gC(e,t){t[Iu.readBytes(e).toString()]=Iu.readString(e)}var TC=function(e){function t(t){var r=e.call(this)||this;return r.datatypes=t,r}return SC(t,e),t.prototype.read=function(e){var t=this.datatypes.get(Iu.readString(e));if(null===t)throw new va.IOError("Received unexpected data type");for(var r,n=Iu.readInt64(e),o=new _C(ka.ZERO,ka.ZERO),i={},s=[],a=Iu.readInt32(e),u=0;u<a;++u)switch(Iu.readByte(e)){case 0:s.push(wC(e,o,i));break;case 1:s.push(mC(e,o,i));break;case 2:r=e,o=new _C(Iu.readInt64(r),Iu.readInt64(r));break;case 3:gC(e,i);break;default:gC(e,i)}return new dC.RangeQueryResult(t,n,s)},t}(Fu.AbstractSerialiser);vC.RangeQueryResultSerialiserClass=TC;var OC={},IC=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(OC,"__esModule",{value:!0}),OC.TimeSeriesAppendRequestSerialiser=void 0;var bC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return IC(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.path),Iu.writeString(e,t.dataType.name()),Iu.writeBytes(e,t.value)},t}(Fu.AbstractSerialiser);OC.TimeSeriesAppendRequestSerialiser=new bC;var RC={},CC=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(RC,"__esModule",{value:!0}),RC.TimeSeriesEditRequestSerialiser=void 0;var AC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return CC(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.path),Iu.writeString(e,t.dataType.name()),Iu.writeInt64(e,t.sequence),Iu.writeBytes(e,t.value)},t}(Fu.AbstractSerialiser);RC.TimeSeriesEditRequestSerialiser=new AC;var PC={},NC=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(PC,"__esModule",{value:!0}),PC.TimeSeriesTimestampAppendRequestSerialiser=void 0;var MC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return NC(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.path),Iu.writeString(e,t.dataType.name()),Iu.writeBytes(e,t.value),Iu.writeInt64(e,t.timestamp)},t}(Fu.AbstractSerialiser);PC.TimeSeriesTimestampAppendRequestSerialiser=new MC;var DC={};Object.defineProperty(DC,"__esModule",{value:!0}),DC.TIME_SERIES_TIMESTAMP_APPEND=DC.TIME_SERIES_EDIT=DC.TIME_SERIES_APPEND=DC.rangeQueryFactory=void 0,DC.rangeQueryFactory=function(e){return{id:84,request:aC.RangeQueryRequestSerialiser,response:new vC.RangeQueryResultSerialiserClass(e)}},DC.TIME_SERIES_APPEND={id:99,request:OC.TimeSeriesAppendRequestSerialiser,response:Qf.EventMetadataImplSerialiser},DC.TIME_SERIES_EDIT={id:100,request:RC.TimeSeriesEditRequestSerialiser,response:Qf.EventMetadataImplSerialiser},DC.TIME_SERIES_TIMESTAMP_APPEND={id:166,request:PC.TimeSeriesTimestampAppendRequestSerialiser,response:Qf.EventMetadataImplSerialiser};var jC={};Object.defineProperty(jC,"__esModule",{value:!0}),jC.TimeSeriesAppendRequest=void 0;var LC=function(e,t,r){this.path=e,this.dataType=t,this.value=r};jC.TimeSeriesAppendRequest=LC;var xC={};Object.defineProperty(xC,"__esModule",{value:!0}),xC.TimeSeriesTimestampAppendRequest=void 0;var UC=function(e,t,r,n){this.path=e,this.dataType=t,this.value=r,this.timestamp=n};xC.TimeSeriesTimestampAppendRequest=UC;var BC={};Object.defineProperty(BC,"__esModule",{value:!0}),BC.TimeSeriesImpl=void 0;var qC=function(){function e(e){this.internal=e;var t=e.getServiceLocator();this.defaultRangeQuery=JR.RangeQueryImpl.createDefault(t.obtain(DC.rangeQueryFactory(e.getContext().DataTypes))),this.appendService=t.obtain(DC.TIME_SERIES_APPEND),this.appendTimestampService=t.obtain(DC.TIME_SERIES_TIMESTAMP_APPEND),this.editService=t.obtain(DC.TIME_SERIES_EDIT)}return e.prototype.rangeQuery=function(){return this.defaultRangeQuery},e.prototype.edit=function(e,t,r,n){var o=this,i=this.internal.getContext().DataTypes;return new Promise((function(s,a){var u,c;try{u=n instanceof o.internal.getContext().AbstractDataType?n:n?i.getByClass(n):i.getByValue(r),Zl.requireNonNull(e,"Path"),Zl.requireNonNull(r,"Value"),Zl.requireNonNull(t,"Sequence"),c=(u=Zl.requireNonNull(u,"Data type")).writeValueToArray(r)}catch(e){return void a(e)}o.editService.send({path:e,sequence:t,dataType:u,value:c},(function(e,t){e?a(e):s(t)}))}))},e.prototype.append=function(e,t,r,n){var o=this,i=this.internal.getContext().DataTypes;return new Promise((function(s,a){var u,c;try{u=r instanceof o.internal.getContext().AbstractDataType?r:r?i.getByClass(r):i.getByValue(t),Zl.requireNonNull(e,"Path"),Zl.requireNonNull(t,"Value"),c=(u=Zl.requireNonNull(u,"Data type")).writeValueToArray(t)}catch(e){return void a(e)}var l=function(e,t){e?a(e):s(t)};void 0===n?o.appendService.send(new jC.TimeSeriesAppendRequest(e,u,c),l):o.appendTimestampService.send(new xC.TimeSeriesTimestampAppendRequest(e,u,c,"number"==typeof n?ka.fromNumber(n):n),l)}))},e}();BC.TimeSeriesImpl=qC;var VC={};Object.defineProperty(VC,"__esModule",{value:!0}),VC.RemoveTopic=void 0;var kC=function(e){this.selector=e};VC.RemoveTopic=kC;var FC={};Object.defineProperty(FC,"__esModule",{value:!0}),FC.TopicAddResponse=FC.TopicAddResponseStatus=void 0,function(e){e[e.OK=0]="OK",e[e.EXISTS=1]="EXISTS"}(FC.TopicAddResponseStatus||(FC.TopicAddResponseStatus={}));var GC=function(e){this.status=e};FC.TopicAddResponse=GC;var HC={};Object.defineProperty(HC,"__esModule",{value:!0}),HC.IntegerSerialiser=void 0;var YC=function(){function e(){}return e.prototype.read=function(e){return Iu.readInt32(e)},e.prototype.write=function(e,t){Iu.writeInt32(e,t)},e}();HC.IntegerSerialiser=new YC;var WC={};Object.defineProperty(WC,"__esModule",{value:!0}),WC.MissingTopicRequest=void 0;var zC=function(e,t,r,n){this.selector=e,this.sessionProperties=t,this.serverNames=r,this.cid=n};WC.MissingTopicRequest=zC;var QC={},KC=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(QC,"__esModule",{value:!0}),QC.MissingTopicRequestSerialiser=void 0;var JC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return KC(t,e),t.prototype.read=function(e){var t=k_.TopicSelectorSerialiser.read(e),r=Iu.readDictionary(e,Iu.readString),n=Iu.readCollection(e,Iu.readString),o=Vu.CIDSerialiser.read(e);return new WC.MissingTopicRequest(t,r,n,o)},t.prototype.write=function(e,t){k_.TopicSelectorSerialiser.write(e,t.selector),Iu.writeDictionary(e,t.sessionProperties,Iu.writeString),Iu.writeCollection(e,t.serverNames,Iu.writeString),Vu.CIDSerialiser.write(e,t.cid)},t}(Fu.AbstractSerialiser);QC.MissingTopicRequestSerialiser=new JC;var $C={},XC=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty($C,"__esModule",{value:!0}),$C.RemoveTopicSerialiser=void 0;var ZC=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return XC(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.selector.expression)},t}(Fu.AbstractSerialiser);$C.RemoveTopicSerialiser=new ZC;var eA={},tA=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(eA,"__esModule",{value:!0}),eA.TopicAddRequestSerialiser=void 0;var rA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tA(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.path),Uv.write(e,t.specification)},t}(Fu.AbstractSerialiser);eA.TopicAddRequestSerialiser=new rA;var nA={},oA=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(nA,"__esModule",{value:!0}),nA.TopicAddResponseSerialiser=void 0;var iA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oA(t,e),t.prototype.read=function(e){var t=Iu.readByte(e);return new FC.TopicAddResponse(t)},t}(Fu.AbstractSerialiser);nA.TopicAddResponseSerialiser=new iA;var sA={};Object.defineProperty(sA,"__esModule",{value:!0}),sA.TOPIC_ADD=sA.TOPIC_REMOVAL=sA.MISSING_TOPIC=void 0,sA.MISSING_TOPIC={id:50,request:QC.MissingTopicRequestSerialiser,response:Hh.BooleanSerialiser},sA.TOPIC_REMOVAL={id:83,request:$C.RemoveTopicSerialiser,response:HC.IntegerSerialiser},sA.TOPIC_ADD={id:112,request:eA.TopicAddRequestSerialiser,response:nA.TopicAddResponseSerialiser};var aA={};Object.defineProperty(aA,"__esModule",{value:!0}),aA.TopicControlImpl=void 0;var uA=Xu.create("Session.Topics"),cA=function(){function e(e){this.internal=e;var t=e.getServiceLocator();this.TOPIC_ADD_SERVICE=t.obtain(sA.TOPIC_ADD),this.TOPIC_REMOVAL=t.obtain(sA.TOPIC_REMOVAL);var r=e.getContext().TopicAddFailReasonEnum;this.errorReasonIdToAddFailReason={103:r.PERMISSIONS_FAILURE,110:r.CLUSTER_REPARTITION,9004:r.EXISTS_MISMATCH,9005:r.INVALID_NAME,9006:r.INVALID_DETAILS,9007:r.EXCEEDED_LICENSE_LIMIT,9010:r.EXISTS_INCOMPATIBLE,9011:r.UNEXPECTED_ERROR},e.getServiceRegistry().add(sA.MISSING_TOPIC,lT.create((function(e,t,r){r.respond(!0),e.getConversationSet().respondIfPresent(t.cid,{request:t,callback:r})})))}return e.prototype.isSupportedTopicType=function(e){var t=this.internal.getContext().TopicTypeEnum;return Object.keys(t).some((function(r){return t[r]===e}))},e.prototype.add=function(e,t){var r=this,n=this.internal.getContext().TopicSpecification;return new Promise((function(o,i){if(e){if(r.internal.checkConnected(i)){uA.debug("Adding topic",e);var s=r.isSupportedTopicType(t)?new n(t):t;if(!(s instanceof n))throw new va.IllegalArgumentError("Invalid topic specification or type");r.TOPIC_ADD_SERVICE.send({path:e,specification:s},(function(t,n){t?i(r.errorReasonIdToAddFailReason[t.id]):o({topic:e,added:n.status===FC.TopicAddResponseStatus.OK})}))}}else i({id:0,reason:"Path cannot be empty or null"})}))},e.prototype.remove=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=arguments,i=this.internal.getContext().parseSelector;return new Promise((function(r,n){if(t.internal.checkConnected(n)){uA.debug("Removing topics",e);try{t.TOPIC_REMOVAL.send(new VC.RemoveTopic(o.length>1?i(Array.prototype.slice.call(o)):i(e)),(function(t,o){t?(uA.debug("Topic removal failed",e),n(t)):(uA.debug("Topic removal complete",e),r({removedCount:o}))}))}catch(t){uA.debug("Error parsing selector",e),n(t)}}}))},e.prototype.addMissingTopicHandler=function(e,t){var r=this;return new Promise((function(n,o){if(t){if(r.internal.checkConnected(o)){var i={active:function(r){uA.debug("Missing Topic Handler registered for "+e),t.onRegister(e,r),n()},respond:function(r){var n=r.callback;uA.debug("Missing Topic Handler notification for "+r.request.sessionID+" using "+r.request.selector);try{var o=r.request;t.onMissingTopic({path:o.selector.prefix,selector:o.selector,sessionID:qd.SessionId.fromString(o.sessionProperties.$SessionId),sessionProperties:o.sessionProperties,serverNames:o.serverNames})}catch(r){throw t.onError(e,r),n.fail(_c.ErrorReason.CALLBACK_EXCEPTION,r&&r.message),r}return!1},close:function(r){uA.debug("Missing Topic Handler closed for "+e),r?t.onError(e,r):t.onClose(e)}},s={definition:sA.MISSING_TOPIC,group:cv.DEFAULT,path:e};n(I_.registerTopicHandler(r.internal,s,i))}}else o(new Error("Missing Topic handler is null or undefined"))}))},e}();aA.TopicControlImpl=cA;var lA={},pA=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(lA,"__esModule",{value:!0}),lA.TopicNotificationDeregistrationRequestSerialiser=void 0;var fA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pA(t,e),t.prototype.write=function(e,t){Vu.CIDSerialiser.write(e,t.cid)},t}(Fu.AbstractSerialiser);lA.TopicNotificationDeregistrationRequestSerialiser=new fA;var hA={};Object.defineProperty(hA,"__esModule",{value:!0}),hA.TopicNotificationType=void 0,function(e){e[e.ADDED=0]="ADDED",e[e.SELECTED=1]="SELECTED",e[e.REMOVED=2]="REMOVED",e[e.DESELECTED=3]="DESELECTED"}(hA.TopicNotificationType||(hA.TopicNotificationType={}));var dA={};Object.defineProperty(dA,"__esModule",{value:!0}),dA.TopicNotificationDescendantEvent=void 0;var yA=function(e,t,r){this.cid=e,this.path=t,this.type=r,this.isDescendantEvent=!0};dA.TopicNotificationDescendantEvent=yA;var vA={},SA=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(vA,"__esModule",{value:!0}),vA.TopicNotificationDescendantEventSerialiser=void 0;var _A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return SA(t,e),t.prototype.read=function(e){var t=Vu.CIDSerialiser.read(e),r=Iu.readString(e),n=Wh.read(e,hA.TopicNotificationType);return new dA.TopicNotificationDescendantEvent(t,r,n)},t}(Fu.AbstractSerialiser);vA.TopicNotificationDescendantEventSerialiser=new _A;var EA={},wA=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(EA,"__esModule",{value:!0}),EA.TopicNotificationDeselectionSerialiser=void 0;var mA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wA(t,e),t.prototype.write=function(e,t){Vu.CIDSerialiser.write(e,t.cid),k_.TopicSelectorSerialiser.write(e,t.selector)},t}(Fu.AbstractSerialiser);EA.TopicNotificationDeselectionSerialiser=new mA;var gA={};Object.defineProperty(gA,"__esModule",{value:!0}),gA.TopicNotificationEvent=void 0;var TA=function(e,t,r,n){this.cid=e,this.path=t,this.type=r,this.specification=n,this.isDescendantEvent=!1};gA.TopicNotificationEvent=TA;var OA={},IA=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(OA,"__esModule",{value:!0}),OA.TopicNotificationEventSerialiser=void 0;var bA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return IA(t,e),t.prototype.read=function(e){var t=Vu.CIDSerialiser.read(e),r=Iu.readString(e),n=Wh.read(e,hA.TopicNotificationType),o=Uv.read(e);return new gA.TopicNotificationEvent(t,r,n,o)},t}(Fu.AbstractSerialiser);OA.TopicNotificationEventSerialiser=new bA;var RA={},CA=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(RA,"__esModule",{value:!0}),RA.TopicNotificationSelectionSerialiser=void 0;var AA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return CA(t,e),t.prototype.write=function(e,t){Vu.CIDSerialiser.write(e,t.cid),k_.TopicSelectorSerialiser.write(e,t.selector)},t}(Fu.AbstractSerialiser);RA.TopicNotificationSelectionSerialiser=new AA;var PA={};Object.defineProperty(PA,"__esModule",{value:!0}),PA.TOPIC_NOTIFICATION_DESELECTION=PA.TOPIC_NOTIFICATION_SELECTION=PA.TOPIC_DESCENDANT_EVENTS=PA.TOPIC_NOTIFICATION_EVENTS=PA.TOPIC_NOTIFICATION_DEREGISTRATION=void 0,PA.TOPIC_NOTIFICATION_DEREGISTRATION={id:91,request:lA.TopicNotificationDeregistrationRequestSerialiser,response:av.NullSerialiser},PA.TOPIC_NOTIFICATION_EVENTS={id:92,request:OA.TopicNotificationEventSerialiser,response:av.NullSerialiser},PA.TOPIC_DESCENDANT_EVENTS={id:93,request:vA.TopicNotificationDescendantEventSerialiser,response:av.NullSerialiser},PA.TOPIC_NOTIFICATION_SELECTION={id:94,request:RA.TopicNotificationSelectionSerialiser,response:av.NullSerialiser},PA.TOPIC_NOTIFICATION_DESELECTION={id:95,request:EA.TopicNotificationDeselectionSerialiser,response:av.NullSerialiser};var NA={},MA=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},DA=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(NA,"__esModule",{value:!0}),NA.TopicNotificationsImpl=void 0;var jA=Xu.create("Session.Notifications"),LA=function(){function e(e){this.TopicNotificationType=hA.TopicNotificationType,this.internal=e;var t=e.getServiceLocator();this.conversationSet=e.getConversationSet(),this.TOPIC_NOTIFICATION_SELECTION=t.obtain(PA.TOPIC_NOTIFICATION_SELECTION),this.TOPIC_NOTIFICATION_DESELECTION=t.obtain(PA.TOPIC_NOTIFICATION_DESELECTION),this.TOPIC_NOTIFICATION_DEREGISTRATION=t.obtain(PA.TOPIC_NOTIFICATION_DEREGISTRATION);var r=e.getServiceRegistry(),n=lT.create((function(e,t,r){r.respond(),e.getConversationSet().respond(t.cid,t)}));r.add(PA.TOPIC_NOTIFICATION_EVENTS,n),r.add(PA.TOPIC_DESCENDANT_EVENTS,n)}return e.prototype.addListener=function(e){var t=this,r=this.internal.getContext().parseSelector;return new Promise((function(n,o){return MA(t,void 0,void 0,(function(){var t,i,s=this;return DA(this,(function(a){switch(a.label){case 0:return e?this.internal.checkConnected(o)?(jA.debug("Adding Topic Notification Listener"),t={active:function(t,o){jA.debug("Topic Notification Listener active"),n({select:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Promise((function(n,i){if(Zl.requireNonNull(e,"topicSelector"),e)try{var a=t.length>0?r([e].concat(t)):r(e);s.TOPIC_NOTIFICATION_SELECTION.send({cid:o,selector:a},(function(e){e?(s.conversationSet.discard(o,e),i(e)):n()}))}catch(e){i(e)}else i(new va.IllegalArgumentError("No topic selector provided"))}))},deselect:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Promise((function(n,i){if(Zl.requireNonNull(e,"topicSelector"),e)try{var a=t.length>0?r([e].concat(t)):r(e);s.TOPIC_NOTIFICATION_DESELECTION.send({cid:o,selector:a},(function(e){e?(s.conversationSet.discard(o,e),i(e)):n()}))}catch(e){i(e)}else i(new va.IllegalArgumentError("No topic selector provided"))}))},close:function(){s.TOPIC_NOTIFICATION_DEREGISTRATION.send({cid:o},(function(t,r){t?(s.conversationSet.discard(o,t),jA.debug("Error with topic notification deregistration: ",t)):(e.onClose(),s.conversationSet.respondIfPresent(o,r))}))}})},respond:function(t){return t.isDescendantEvent?e.onDescendantNotification(t.path,t.type):e.onTopicNotification(t.path,t.specification,t.type),!1},close:function(t){jA.debug("Topic Notification Listener closed"),t?e.onError(t):e.onClose()}},[4,this.conversationSet.newConversation(I_.responseHandler(this.internal,t,(function(e,t){s.TOPIC_NOTIFICATION_DEREGISTRATION.send({cid:e},t)})))]):[3,2]:(o(new Error("Topic Notification Listener is null or undefined")),[2]);case 1:i=a.sent(),I_.registrationCallback(this.conversationSet,i,(function(){}),(function(){}))(void 0),a.label=2;case 2:return[2]}}))}))}))},e}();NA.TopicNotificationsImpl=LA;var xA,UA={},BA=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(UA,"__esModule",{value:!0}),UA.Locked=UA.NoValueConstraint=UA.TopicConstraint=UA.CompoundConstraint=UA.Unconstrained=UA.ConstraintValueType=UA.ConstraintType=void 0,function(e){e[e.UNCONSTRAINED=0]="UNCONSTRAINED",e[e.CONJUNCTION=1]="CONJUNCTION",e[e.TOPIC_VALUE=2]="TOPIC_VALUE",e[e.NO_VALUE=3]="NO_VALUE",e[e.LOCKED=4]="LOCKED",e[e.NO_TOPIC=5]="NO_TOPIC",e[e.PARTIAL_JSON=6]="PARTIAL_JSON",e[e.DISJUNCTION=7]="DISJUNCTION"}(xA=UA.ConstraintType||(UA.ConstraintType={})),function(e){e[e.NULL=0]="NULL",e[e.STRING=1]="STRING",e[e.INT64=2]="INT64",e[e.DOUBLE=3]="DOUBLE",e[e.BINARY=4]="BINARY",e[e.JSON=5]="JSON",e[e.RECORD_V2=6]="RECORD_V2",e[e.BOOLEAN=7]="BOOLEAN"}(UA.ConstraintValueType||(UA.ConstraintValueType={}));var qA=function(){function e(e){this.id=e}return e.prototype.and=function(e){if(this===e)throw new va.IllegalArgumentError("Cannot 'and' a constraint with itself");if(this.andBlockedFor(e))throw new va.IllegalArgumentError("Constraint could not be satisfied");return new HA(this,e)},e.prototype.or=function(e){if(this===e)throw new va.IllegalArgumentError("Cannot 'or' a constraint with itself");return new YA(this,e)},e.prototype.getConstraintType=function(){return this.id},e.prototype.andBlockedFor=function(e){return!1},e}(),VA=function(e){function t(){return e.call(this,xA.UNCONSTRAINED)||this}return BA(t,e),t}(qA);UA.Unconstrained=VA;var kA=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.left=r,o.right=n,o}return BA(t,e),t}(qA);UA.CompoundConstraint=kA;var FA=function(e){function t(t){return e.call(this,t)||this}return BA(t,e),t}(qA);UA.TopicConstraint=FA;var GA=function(e){function t(t){return e.call(this,t)||this}return BA(t,e),t.prototype.andBlockedFor=function(e){return e instanceof FA||e instanceof kA&&e.andBlockedFor(this)},t}(FA);UA.NoValueConstraint=GA;var HA=function(e){function t(t,r){return e.call(this,xA.CONJUNCTION,t,r)||this}return BA(t,e),t.prototype.andBlockedFor=function(e){return(e instanceof FA||e instanceof t&&e.hasNoValueConstraint())&&this.hasNoValueConstraint()},t.prototype.hasNoValueConstraint=function(){return this.left instanceof GA||this.right instanceof GA||(this.left instanceof t&&this.left.hasNoValueConstraint()||this.right instanceof t&&this.right.hasNoValueConstraint())},t}(kA),YA=function(e){function t(t,r){return e.call(this,xA.DISJUNCTION,t,r)||this}return BA(t,e),t}(kA),WA=function(e){function t(t){var r=e.call(this,xA.LOCKED)||this;return r.lock=t,r.lockName=t.getName(),r.sequence=t.getSequence(),r}return BA(t,e),t.prototype.getLockName=function(){return this.lockName},t.prototype.getSequence=function(){return this.sequence},t}(qA);UA.Locked=WA;var zA={};Object.defineProperty(zA,"__esModule",{value:!0}),zA.write=void 0,zA.write=function(e,t,r){r(e,t.left),r(e,t.right)};var QA={};Object.defineProperty(QA,"__esModule",{value:!0}),QA.write=void 0,QA.write=function(e,t){Iu.writeString(e,t.getLockName()),Iu.writeInt64(e,t.getSequence())};var KA={};Object.defineProperty(KA,"__esModule",{value:!0}),KA.write=void 0,KA.write=function(){};var JA={};Object.defineProperty(JA,"__esModule",{value:!0}),JA.write=void 0,JA.write=function(){};var $A={};Object.defineProperty($A,"__esModule",{value:!0}),$A.write=void 0,$A.write=function(e,t){Iu.writeByte(e,t.operator),Iu.writeByte(e,t.valueType),Iu.writeBytes(e,t.buffer)};var XA={};Object.defineProperty(XA,"__esModule",{value:!0}),XA.write=void 0,XA.write=function(e,t){Iu.writeObject(e,t.getWithValues(),Iu.writeString,$A.write),Iu.writeCollection(e,Array.from(t.getWithoutValues()),Iu.writeString)};var ZA={};Object.defineProperty(ZA,"__esModule",{value:!0}),ZA.write=void 0,ZA.write=function(e,t){Iu.writeByte(e,t.operator),Iu.writeByte(e,t.valueType),Iu.writeBytes(e,t.bytes.asArray())};var eP={};Object.defineProperty(eP,"__esModule",{value:!0}),eP.write=void 0,eP.write=function(){};var tP,rP={};Object.defineProperty(rP,"__esModule",{value:!0}),rP.write=void 0;var nP=((tP={})[UA.ConstraintType.UNCONSTRAINED]=eP,tP[UA.ConstraintType.CONJUNCTION]=zA,tP[UA.ConstraintType.TOPIC_VALUE]=ZA,tP[UA.ConstraintType.NO_VALUE]=JA,tP[UA.ConstraintType.LOCKED]=QA,tP[UA.ConstraintType.NO_TOPIC]=KA,tP[UA.ConstraintType.PARTIAL_JSON]=XA,tP[UA.ConstraintType.DISJUNCTION]=zA,tP);rP.write=function e(t,r){if(void 0===r.getConstraintType||void 0===UA.ConstraintType[r.getConstraintType()])throw new va.IOError("Unknown constraint type");Iu.writeByte(t,r.getConstraintType()),nP[r.getConstraintType()].write(t,r,e)};var oP={},iP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(oP,"__esModule",{value:!0}),oP.AddAndSetTopicRequestSerialiser=void 0;var sP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return iP(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.path),Uv.write(e,t.topicSpecification),Iu.writeBytes(e,t.value),rP.write(e,t.constraint)},t}(Fu.AbstractSerialiser);oP.AddAndSetTopicRequestSerialiser=new sP;var aP={};Object.defineProperty(aP,"__esModule",{value:!0}),aP.UpdateConstraintOperator=void 0,function(e){e[e.IS=1]="IS",e[e.EQ=2]="EQ",e[e.NE=3]="NE",e[e.GT=4]="GT",e[e.GE=5]="GE",e[e.LT=6]="LT",e[e.LE=7]="LE"}(aP.UpdateConstraintOperator||(aP.UpdateConstraintOperator={}));var uP,cP={};Object.defineProperty(cP,"__esModule",{value:!0}),cP.TopicUpdateNamespace=cP.TopicCreationResult=void 0,function(e){e[e.CREATED=1]="CREATED",e[e.EXISTS=2]="EXISTS"}(uP=cP.TopicCreationResult||(cP.TopicCreationResult={})),cP.TopicUpdateNamespace={TopicCreationResult:uP,UpdateConstraintOperator:aP.UpdateConstraintOperator};var lP={};Object.defineProperty(lP,"__esModule",{value:!0}),lP.AddTopicResult=void 0;var pP=function(e){this.result=e};lP.AddTopicResult=pP;var fP,hP={},dP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(hP,"__esModule",{value:!0}),hP.AddTopicResultSerialiser=void 0,function(e){e[e.CREATED=0]="CREATED",e[e.EXISTS=1]="EXISTS"}(fP||(fP={}));var yP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dP(t,e),t.prototype.read=function(e){var t=Wh.read(e,fP)===fP.CREATED?cP.TopicCreationResult.CREATED:cP.TopicCreationResult.EXISTS;return new lP.AddTopicResult(t)},t}(Fu.AbstractSerialiser);hP.AddTopicResultSerialiser=new yP;var vP={},SP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(vP,"__esModule",{value:!0}),vP.ApplyJsonPatchRequestSerialiser=void 0;var _P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return SP(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.path),Iu.writeString(e,t.patch),rP.write(e,t.constraint)},t}(Fu.AbstractSerialiser);vP.ApplyJsonPatchRequestSerialiser=new _P;var EP={},wP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(EP,"__esModule",{value:!0}),EP.CreateUpdateStreamAndSetRequestSerialiser=void 0;var mP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wP(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.path),Wh.write(e,t.topicType),Iu.writeBytes(e,t.value),rP.write(e,t.constraint)},t}(Fu.AbstractSerialiser);EP.CreateUpdateStreamAndSetRequestSerialiser=new mP;var gP={},TP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(gP,"__esModule",{value:!0}),gP.CreateUpdateStreamRequestSerialiser=void 0;var OP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return TP(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.path),Wh.write(e,t.topicType),rP.write(e,t.constraint)},t}(Fu.AbstractSerialiser);gP.CreateUpdateStreamRequestSerialiser=new OP;var IP={};Object.defineProperty(IP,"__esModule",{value:!0}),IP.CreateUpdateStreamResponse=void 0;var bP=function(e,t,r){this.streamId=e,this.retainsValue=t,this.supportsConflation=r};IP.CreateUpdateStreamResponse=bP;var RP={};Object.defineProperty(RP,"__esModule",{value:!0}),RP.UpdateStreamId=void 0;var CP=function(e,t,r,n,o){this.topicId=e,this.instanceId=t,this.clustered=r,this.partitionId=n,this.generationId=o};RP.UpdateStreamId=CP;var AP={},PP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(AP,"__esModule",{value:!0}),AP.UpdateStreamIdSerialiser=void 0;var NP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return PP(t,e),t.prototype.read=function(e){var t=Iu.readInt32(e),r=Iu.readInt32(e),n=Iu.readInt32(e),o=Iu.readInt32(e),i=0!==n;return new RP.UpdateStreamId(t,r,i,i?n-1:0,i?o:0)},t.prototype.write=function(e,t){Iu.writeInt32(e,t.topicId),Iu.writeInt32(e,t.instanceId),t.clustered?(Iu.writeInt32(e,t.partitionId+1),Iu.writeInt32(e,t.generationId)):(Iu.writeInt32(e,0),Iu.writeInt32(e,0))},t}(Fu.AbstractSerialiser);AP.UpdateStreamIdSerialiser=new NP;var MP={},DP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(MP,"__esModule",{value:!0}),MP.CreateUpdateStreamResponseSerialiser=void 0;var jP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return DP(t,e),t.prototype.read=function(e){var t=AP.UpdateStreamIdSerialiser.read(e),r=Iu.readByte(e),n=(1&r)>0,o=(2&r)>0;return new IP.CreateUpdateStreamResponse(t,n,o)},t}(Fu.AbstractSerialiser);MP.CreateUpdateStreamResponseSerialiser=new jP;var LP={};Object.defineProperty(LP,"__esModule",{value:!0}),LP.JsonPatchResult=void 0;var xP=function(e){this.failedOperation=e<0?void 0:e};LP.JsonPatchResult=xP;var UP={},BP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(UP,"__esModule",{value:!0}),UP.JsonPatchResultSerialiser=void 0;var qP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return BP(t,e),t.prototype.read=function(e){var t=Iu.readInt32(e);return new LP.JsonPatchResult(t)},t}(Fu.AbstractSerialiser);UP.JsonPatchResultSerialiser=new qP;var VP={},kP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(VP,"__esModule",{value:!0}),VP.SetTopicRequestSerialiser=void 0;var FP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return kP(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.path),Wh.write(e,t.topicType),Iu.writeBytes(e,t.value),rP.write(e,t.constraint)},t}(Fu.AbstractSerialiser);VP.SetTopicRequestSerialiser=new FP;var GP={},HP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(GP,"__esModule",{value:!0}),GP.UpdateStreamAddTopicRequestSerialiser=void 0;var YP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return HP(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.path),Uv.write(e,t.topicSpecification),rP.write(e,t.constraint)},t}(Fu.AbstractSerialiser);GP.UpdateStreamAddTopicRequestSerialiser=new YP;var WP={};Object.defineProperty(WP,"__esModule",{value:!0}),WP.UpdateStreamAddTopicResponse=void 0;var zP=function(e,t,r,n){this.creationResult=e,this.streamId=t,this.retainsValue=r,this.supportsConflation=n};WP.UpdateStreamAddTopicResponse=zP;var QP={},KP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(QP,"__esModule",{value:!0}),QP.UpdateStreamAddTopicResponseSerialiser=void 0;var JP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return KP(t,e),t.prototype.read=function(e){var t=hP.AddTopicResultSerialiser.read(e),r=AP.UpdateStreamIdSerialiser.read(e),n=Iu.readByte(e),o=(1&n)>0,i=(2&n)>0;return new WP.UpdateStreamAddTopicResponse(t.result,r,o,i)},t}(Fu.AbstractSerialiser);QP.UpdateStreamAddTopicResponseSerialiser=new JP;var $P={},XP=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty($P,"__esModule",{value:!0}),$P.UpdateStreamRequestSerialiser=void 0;var ZP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return XP(t,e),t.prototype.write=function(e,t){AP.UpdateStreamIdSerialiser.write(e,t.streamId),Iu.writeBytes(e,t.update)},t}(Fu.AbstractSerialiser);$P.UpdateStreamRequestSerialiser=new ZP;var eN={};Object.defineProperty(eN,"__esModule",{value:!0}),eN.STREAM_ADD_AND_SET_TOPIC_SERVICE=eN.STREAM_ADD_TOPIC_SERVICE=eN.STREAM_APPLY_DELTA_SERVICE=eN.STREAM_SET_TOPIC_SERVICE=eN.CHECK_UPDATE_STREAM=eN.CREATE_UPDATE_STREAM_AND_SET=eN.CREATE_UPDATE_STREAM=eN.APPLY_JSON_PATCH=eN.ADD_AND_SET_TOPIC=eN.SET_TOPIC=void 0,eN.SET_TOPIC={id:118,request:VP.SetTopicRequestSerialiser,response:av.NullSerialiser},eN.ADD_AND_SET_TOPIC={id:122,request:oP.AddAndSetTopicRequestSerialiser,response:hP.AddTopicResultSerialiser},eN.APPLY_JSON_PATCH={id:151,request:vP.ApplyJsonPatchRequestSerialiser,response:UP.JsonPatchResultSerialiser},eN.CREATE_UPDATE_STREAM={id:125,request:gP.CreateUpdateStreamRequestSerialiser,response:MP.CreateUpdateStreamResponseSerialiser},eN.CREATE_UPDATE_STREAM_AND_SET={id:126,request:EP.CreateUpdateStreamAndSetRequestSerialiser,response:MP.CreateUpdateStreamResponseSerialiser},eN.CHECK_UPDATE_STREAM={id:127,request:AP.UpdateStreamIdSerialiser,response:av.NullSerialiser},eN.STREAM_SET_TOPIC_SERVICE={id:128,request:$P.UpdateStreamRequestSerialiser,response:av.NullSerialiser},eN.STREAM_APPLY_DELTA_SERVICE={id:129,request:$P.UpdateStreamRequestSerialiser,response:av.NullSerialiser},eN.STREAM_ADD_TOPIC_SERVICE={id:130,request:GP.UpdateStreamAddTopicRequestSerialiser,response:QP.UpdateStreamAddTopicResponseSerialiser},eN.STREAM_ADD_AND_SET_TOPIC_SERVICE={id:131,request:oP.AddAndSetTopicRequestSerialiser,response:QP.UpdateStreamAddTopicResponseSerialiser};var tN={};Object.defineProperty(tN,"__esModule",{value:!0}),tN.AddAndSetTopicRequest=void 0;var rN=function(e,t,r,n){this.path=e,this.topicSpecification=t,this.value=r,this.constraint=n};tN.AddAndSetTopicRequest=rN;var nN={};Object.defineProperty(nN,"__esModule",{value:!0}),nN.UpdateStreamAddTopicRequest=void 0;var oN=function(e,t,r){this.path=e,this.topicSpecification=t,this.constraint=r};nN.UpdateStreamAddTopicRequest=oN;var iN={};Object.defineProperty(iN,"__esModule",{value:!0}),iN.UpdateStreamRequest=void 0;var sN=function(e,t){this.streamId=e,this.update=t};iN.UpdateStreamRequest=sN;var aN={};Object.defineProperty(aN,"__esModule",{value:!0}),aN.InvalidSetStream=void 0;var uN=function(){function e(e,t){this.value=t,this.err=e}return e.prototype.set=function(){return Promise.reject(this.err)},e.prototype.get=function(){return this.value},e.prototype.validate=function(){return Promise.reject(this.err)},e.prototype.onSetComplete=function(){},e.prototype.onSetFailed=function(){},e.prototype.onValidateComplete=function(){},e.prototype.onValidateFailed=function(){},e}();aN.InvalidSetStream=uN;var cN={};Object.defineProperty(cN,"__esModule",{value:!0}),cN.SetStream=void 0;var lN=Xu.create("diffusion.TopicUpdate"),pN=function(){function e(e,t,r,n,o){this.streamServices=e,this.options=t,this.stream=r,this.streamId=n,this.cache=o}return e.prototype.set=function(e){var t=this;return this.options.checkOperation(e),new Promise((function(r,n){var o=t.options.toBuffer(t.cache,e);t.cache=e,t.options.deltaService.send(new iN.UpdateStreamRequest(t.streamId,o),(function(e){e?(lN.debug("Set update stream failed"),t.stream.onSetFailed(e),n(e)):(t.stream.onSetComplete(t.streamId,t.options.retainsValue,t.options.supportsConflation),r())}))}))},e.prototype.get=function(){return this.cache},e.prototype.validate=function(){var e=this;return new Promise((function(t,r){e.streamServices.CHECK_UPDATE_STREAM.send(e.streamId,(function(n){n?(lN.debug("Validate update stream failed"),e.stream.onValidateFailed(n),r(n)):(e.stream.onValidateComplete(e.streamId,e.options.retainsValue,e.options.supportsConflation),t(cP.TopicCreationResult.EXISTS))}))}))},e.prototype.onSetComplete=function(){},e.prototype.onSetFailed=function(e){this.stream.setDelegate(new aN.InvalidSetStream(e,this.cache))},e.prototype.onValidateComplete=function(){},e.prototype.onValidateFailed=function(e){this.stream.setDelegate(new aN.InvalidSetStream(e,this.cache))},e}();cN.SetStream=pN;var fN={};Object.defineProperty(fN,"__esModule",{value:!0}),fN.PendingSetStream=void 0;var hN=function(){function e(e,t,r,n,o){this.streamServices=e,this.options=t,this.stream=r,this.pendingResult=n,this.deferredResolvers=[],this.value=o,this.nextValue=o}return e.prototype.set=function(e){var t=this;return this.options.checkOperation(e),this.nextValue=e,new Promise((function(r,n){t.deferredResolvers.push({value:e,resolve:r,reject:n})}))},e.prototype.get=function(){return this.nextValue},e.prototype.validate=function(){var e=this;return new Promise((function(t,r){e.pendingResult.then((function(e){return t(cP.TopicCreationResult.EXISTS),e}),(function(e){r(e)}))}))},e.prototype.onSetComplete=function(e,t,r){var n=this;this.options.retainsValue=t,this.options.supportsConflation=r,t||(this.options.toBuffer=function(e,t){return n.options.dataType.toBytes(t).asArray()},this.options.deltaService=this.streamServices.STREAM_SET_TOPIC_SERVICE),this.stream.setDelegate(new cN.SetStream(this.streamServices,this.options,this.stream,e,this.nextValue)),t&&r?this.processPendingUpdatesRetainsValue(e):this.processPendingUpdatesDoesntRetainValue(e)},e.prototype.processPendingUpdatesRetainsValue=function(e){var t=this,r=this.options.dataType.toBytes(this.value).asArray(),n=this.options.dataType.toBytes(this.nextValue).asArray();if(Ou.isEqualUint8Arrays(r,n))this.deferredResolvers.forEach((function(e){e.resolve()}));else{var o=this.options.toBuffer(this.value,this.nextValue);this.options.deltaService.send(new iN.UpdateStreamRequest(e,o),(function(e){e?t.deferredResolvers.forEach((function(t){t.reject(e)})):t.deferredResolvers.forEach((function(e){e.resolve()}))}))}},e.prototype.processPendingUpdatesDoesntRetainValue=function(e){var t=this,r=this.value;this.deferredResolvers.forEach((function(n){var o=t.options.toBuffer(r,n.value);r=n.value,t.options.deltaService.send(new iN.UpdateStreamRequest(e,o),(function(e){e?n.reject(e):n.resolve()}))}))},e.prototype.onSetFailed=function(e){this.stream.setDelegate(new aN.InvalidSetStream(e,this.nextValue)),this.deferredResolvers.forEach((function(t){t.reject(e)}))},e.prototype.onValidateComplete=function(){throw new va.IllegalStateError("No validate request has been sent")},e.prototype.onValidateFailed=function(){throw new va.IllegalStateError("No validate request has been sent")},e}();fN.PendingSetStream=hN;var dN={};Object.defineProperty(dN,"__esModule",{value:!0}),dN.InvalidUnsetStream=void 0;var yN=function(){function e(e){this.err=e}return e.prototype.set=function(){return Promise.reject(this.err)},e.prototype.get=function(){throw new va.IllegalStateError("No value has been set")},e.prototype.validate=function(){return Promise.reject(this.err)},e.prototype.onSetComplete=function(){},e.prototype.onSetFailed=function(){},e.prototype.onValidateComplete=function(){},e.prototype.onValidateFailed=function(){},e}();dN.InvalidUnsetStream=yN;var vN={};Object.defineProperty(vN,"__esModule",{value:!0}),vN.PendingValidateAndSetStream=void 0;var SN=function(){function e(e,t,r,n,o,i){this.streamServices=e,this.options=t,this.stream=r,this.pendingResult=n,this.deferredResolvers=[o],this.nextValue=i}return e.prototype.set=function(e){var t=this;return this.options.checkOperation(e),this.nextValue=e,new Promise((function(r,n){t.deferredResolvers.push({value:e,resolve:r,reject:n})}))},e.prototype.get=function(){return this.nextValue},e.prototype.validate=function(){var e=this;return new Promise((function(t,r){e.pendingResult.then((function(e){return t(cP.TopicCreationResult.EXISTS),e}),(function(e){r(e)}))}))},e.prototype.onSetComplete=function(){throw new va.IllegalStateError("No set request has been sent")},e.prototype.onSetFailed=function(){throw new va.IllegalStateError("No set request has been sent")},e.prototype.onValidateComplete=function(e,t,r){var n=this;this.options.retainsValue=t,this.options.supportsConflation=r,t||(this.options.toBuffer=function(e,t){return n.options.dataType.toBytes(t).asArray()},this.options.deltaService=this.streamServices.STREAM_SET_TOPIC_SERVICE),this.stream.setDelegate(new cN.SetStream(this.streamServices,this.options,this.stream,e,this.nextValue)),t&&r?this.processPendingUpdatesRetainsValue(e):this.processPendingUpdatesDoesntRetainValue(e)},e.prototype.processPendingUpdatesRetainsValue=function(e){var t=this,r=this.options.dataType.toBytes(this.nextValue).asArray();this.streamServices.STREAM_SET_TOPIC_SERVICE.send(new iN.UpdateStreamRequest(e,r),(function(e){e?t.deferredResolvers.forEach((function(t){t.reject(e)})):t.deferredResolvers.forEach((function(e){e.resolve()}))}))},e.prototype.processPendingUpdatesDoesntRetainValue=function(e){var t=this;this.deferredResolvers.forEach((function(r){var n=t.options.dataType.toBytes(r.value).asArray();t.streamServices.STREAM_SET_TOPIC_SERVICE.send(new iN.UpdateStreamRequest(e,n),(function(e){e?r.reject(e):r.resolve()}))}))},e.prototype.onValidateFailed=function(e){this.stream.setDelegate(new aN.InvalidSetStream(e,this.nextValue)),this.deferredResolvers.forEach((function(t){t.reject(e)}))},e}();vN.PendingValidateAndSetStream=SN;var _N={};Object.defineProperty(_N,"__esModule",{value:!0}),_N.ValidatedStream=void 0;var EN=Xu.create("diffusion.TopicUpdate"),wN=function(){function e(e,t,r,n){this.streamServices=e,this.options=t,this.stream=r,this.streamId=n}return e.prototype.set=function(e){var t=this;return this.options.checkOperation(e),new Promise((function(r,n){t.stream.setDelegate(new cN.SetStream(t.streamServices,t.options,t.stream,t.streamId,e));var o=t.options.dataType.toBytes(e).asArray();t.streamServices.STREAM_SET_TOPIC_SERVICE.send(new iN.UpdateStreamRequest(t.streamId,o),(function(e){e?(EN.debug("Stream set topic failed"),t.stream.onSetFailed(e),n(e)):(t.stream.onSetComplete(t.streamId,t.options.retainsValue,t.options.supportsConflation),r())}))}))},e.prototype.get=function(){throw new va.IllegalStateError("The set method has not been called")},e.prototype.validate=function(){var e=this;return new Promise((function(t,r){e.streamServices.CHECK_UPDATE_STREAM.send(e.streamId,(function(n){n?(EN.debug("Validate update stream failed"),e.stream.onValidateFailed(n),r(n)):(e.stream.onValidateComplete(e.streamId,e.options.retainsValue,e.options.supportsConflation),t(cP.TopicCreationResult.EXISTS))}))}))},e.prototype.onSetComplete=function(){throw new va.IllegalStateError("The set method has not been called")},e.prototype.onSetFailed=function(){throw new va.IllegalStateError("The set method has not been called")},e.prototype.onValidateComplete=function(){},e.prototype.onValidateFailed=function(e){this.stream.setDelegate(new dN.InvalidUnsetStream(e))},e}();_N.ValidatedStream=wN;var mN={};Object.defineProperty(mN,"__esModule",{value:!0}),mN.PendingValidateStream=void 0;var gN=function(){function e(e,t,r,n){this.streamServices=e,this.options=t,this.stream=r,this.pendingResult=n}return e.prototype.set=function(e){var t=this;return this.options.checkOperation(e),new Promise((function(r,n){t.stream.setDelegate(new vN.PendingValidateAndSetStream(t.streamServices,t.options,t.stream,t.pendingResult,{value:e,resolve:r,reject:n},e))}))},e.prototype.get=function(){throw new va.IllegalStateError("The set method has not been called")},e.prototype.validate=function(){var e=this;return new Promise((function(t,r){e.pendingResult.then((function(e){return t(cP.TopicCreationResult.EXISTS),e}),(function(e){r(e)}))}))},e.prototype.onSetComplete=function(){throw new va.IllegalStateError("No set request has been sent")},e.prototype.onSetFailed=function(){throw new va.IllegalStateError("No set request has been sent")},e.prototype.onValidateComplete=function(e,t,r){var n=this;this.options.retainsValue=t,this.options.supportsConflation=r,t||(this.options.toBuffer=function(e,t){return n.options.dataType.toBytes(t).asArray()},this.options.deltaService=this.streamServices.STREAM_SET_TOPIC_SERVICE),this.stream.setDelegate(new _N.ValidatedStream(this.streamServices,this.options,this.stream,e))},e.prototype.onValidateFailed=function(e){this.stream.setDelegate(new dN.InvalidUnsetStream(e))},e}();mN.PendingValidateStream=gN;var TN={};Object.defineProperty(TN,"__esModule",{value:!0}),TN.NewAddTopicAndUpdateStream=void 0;var ON=Xu.create("diffusion.TopicUpdate"),IN=function(){function e(e,t,r,n,o,i){this.streamServices=e,this.options=t,this.stream=r,this.path=n,this.specification=o,this.constraint=i}return e.prototype.set=function(e){var t=this;this.options.checkOperation(e);var r=new Promise((function(r,n){var o=t.options.dataType.toBytes(e).asArray();t.streamServices.STREAM_ADD_AND_SET_TOPIC_SERVICE.send(new tN.AddAndSetTopicRequest(t.path,t.specification,o,t.constraint),(function(e,o){od.responseSuccess(e,o)?(t.stream.onSetComplete(o.streamId,o.retainsValue,o.supportsConflation),r(o.creationResult)):(ON.debug("Stream add and set topic failed"),t.stream.onSetFailed(e),n(e))}))}));return this.stream.setDelegate(new fN.PendingSetStream(this.streamServices,this.options,this.stream,r,e)),r},e.prototype.get=function(){throw new va.IllegalStateError("The set method has not been called")},e.prototype.validate=function(){var e=this,t=new Promise((function(t,r){e.streamServices.STREAM_ADD_TOPIC_SERVICE.send(new nN.UpdateStreamAddTopicRequest(e.path,e.specification,e.constraint),(function(n,o){od.responseSuccess(n,o)?(e.stream.onValidateComplete(o.streamId,o.retainsValue,o.supportsConflation),t(o.creationResult)):(ON.debug("Stream add topic failed"),e.stream.onValidateFailed(n),r(n))}))}));return this.stream.setDelegate(new mN.PendingValidateStream(this.streamServices,this.options,this.stream,t)),t},e.prototype.onSetComplete=function(){throw new va.IllegalStateError("No set request has been sent")},e.prototype.onSetFailed=function(){throw new va.IllegalStateError("No set request has been sent")},e.prototype.onValidateComplete=function(){throw new va.IllegalStateError("No validate request has been sent")},e.prototype.onValidateFailed=function(){throw new va.IllegalStateError("No validate request has been sent")},e}();TN.NewAddTopicAndUpdateStream=IN;var bN={};Object.defineProperty(bN,"__esModule",{value:!0}),bN.CreateUpdateStreamAndSetRequest=void 0;var RN=function(e,t,r,n){this.path=e,this.topicType=t,this.value=r,this.constraint=n};bN.CreateUpdateStreamAndSetRequest=RN;var CN={};Object.defineProperty(CN,"__esModule",{value:!0}),CN.CreateUpdateStreamRequest=void 0;var AN=function(e,t,r){this.path=e,this.topicType=t,this.constraint=r};CN.CreateUpdateStreamRequest=AN;var PN={};Object.defineProperty(PN,"__esModule",{value:!0}),PN.NewUpdateStream=void 0;var NN=Xu.create("diffusion.TopicUpdate"),MN=function(){function e(e,t,r,n,o,i){this.streamServices=e,this.options=t,this.stream=r,this.path=n,this.topicType=o,this.constraint=i}return e.prototype.set=function(e){var t=this;this.options.checkOperation(e);var r=new Promise((function(r,n){var o=t.options.dataType.toBytes(e).asArray();t.streamServices.CREATE_UPDATE_STREAM_AND_SET.send(new bN.CreateUpdateStreamAndSetRequest(t.path,t.topicType,o,t.constraint),(function(e,o){od.responseSuccess(e,o)?(t.stream.onSetComplete(o.streamId,o.retainsValue,o.supportsConflation),r(cP.TopicCreationResult.EXISTS)):(NN.debug("Failed to create update stream and set"),t.stream.onSetFailed(e),n(e))}))}));return this.stream.setDelegate(new fN.PendingSetStream(this.streamServices,this.options,this.stream,r,e)),r},e.prototype.get=function(){throw new va.IllegalStateError("The set method has not been called")},e.prototype.validate=function(){var e=this,t=new Promise((function(t,r){e.streamServices.CREATE_UPDATE_STREAM.send(new CN.CreateUpdateStreamRequest(e.path,e.topicType,e.constraint),(function(n,o){od.responseSuccess(n,o)?(e.stream.onValidateComplete(o.streamId,o.retainsValue,o.supportsConflation),t(cP.TopicCreationResult.EXISTS)):(NN.debug("Create update stream failed"),e.stream.onValidateFailed(n),r(n))}))}));return this.stream.setDelegate(new mN.PendingValidateStream(this.streamServices,this.options,this.stream,t)),t},e.prototype.onSetComplete=function(){throw new va.IllegalStateError("No set request has been sent")},e.prototype.onSetFailed=function(){throw new va.IllegalStateError("No set request has been sent")},e.prototype.onValidateComplete=function(){throw new va.IllegalStateError("No validate request has been sent")},e.prototype.onValidateFailed=function(){throw new va.IllegalStateError("No validate request has been sent")},e}();PN.NewUpdateStream=MN;var DN={};Object.defineProperty(DN,"__esModule",{value:!0}),DN.UpdateStreamImpl=void 0;var jN=function(){function e(e){this.delegate=e(this)}return e.prototype.set=function(e){return this.delegate.set(e)},e.prototype.get=function(){return this.delegate.get()},e.prototype.validate=function(){return this.delegate.validate()},e.prototype.onSetComplete=function(e,t,r){this.delegate.onSetComplete(e,t,r)},e.prototype.onSetFailed=function(e){this.delegate.onSetFailed(e)},e.prototype.onValidateComplete=function(e,t,r){this.delegate.onValidateComplete(e,t,r)},e.prototype.onValidateFailed=function(e){this.delegate.onValidateFailed(e)},e.prototype.setDelegate=function(e){this.delegate=e},e}();DN.UpdateStreamImpl=jN;var LN={};Object.defineProperty(LN,"__esModule",{value:!0}),LN.UpdateStreamFactory=void 0;var xN=function(){function e(e,t){this.context=t,this.streamServices=e}return e.prototype.getValueCheckOperation=function(e){switch(e.name()){case"int64":case"double":case"string":return function(){};default:return function(e){Zl.requireNonNull(e,"null can only be passed for int64, double or string topics")}}},e.prototype.getChangeService=function(e,t){return void 0===e||t?this.streamServices.STREAM_SET_TOPIC_SERVICE:this.streamServices.STREAM_APPLY_DELTA_SERVICE},e.prototype.getToBytesFunction=function(e,t){return void 0===t?function(t,r){return e.toBytes(r).asArray()}:function(e,r){var n=t.diff(e,r);return n.$buffer.subarray(n.$offset,n.$offset+n.$length)}},e.prototype.binaryDeltaType=function(e,t){if(!t)try{return e.binaryDeltaType()}catch(e){return}},e.prototype.createUpdateStream=function(e,t,r,n){var o=this;void 0===n&&(n=!1);var i=this.binaryDeltaType(t,n),s={dataType:t,retainsValue:!0,supportsConflation:!0,checkOperation:this.getValueCheckOperation(t),toBuffer:this.getToBytesFunction(t,i),deltaService:this.getChangeService(i,n)},a=Dc.TopicTypeEnum[t.name().toUpperCase()];return new DN.UpdateStreamImpl((function(t){return new PN.NewUpdateStream(o.streamServices,s,t,e,a,r)}))},e.prototype.createUpdateStreamThatAddsTopic=function(e,t,r,n,o){var i=this;if(void 0===o&&(o=!1),t.type===Dc.TopicTypeEnum.TIME_SERIES){var s=t.properties.TIME_SERIES_EVENT_VALUE_TYPE;if(null==s)throw new va.IllegalArgumentError("The specification for time-series topics requires an event type.");if(s.toLowerCase()!==r.name().toLowerCase())throw new va.IllegalArgumentError("The time-series event and value have different data types.")}else if(r!==this.context.DataTypes.getByValue(t.type))throw new va.IllegalArgumentError("The specification and value have different data types");var a=this.binaryDeltaType(r,o),u={dataType:r,retainsValue:!0,supportsConflation:!0,checkOperation:this.getValueCheckOperation(r),toBuffer:this.getToBytesFunction(r,a),deltaService:this.getChangeService(a,o)};return new DN.UpdateStreamImpl((function(r){return new TN.NewAddTopicAndUpdateStream(i.streamServices,u,r,e,t,n)}))},e}();LN.UpdateStreamFactory=xN;var UN={},BN=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},qN=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(UN,"__esModule",{value:!0}),UN.RecoverableUpdateStreamImpl=void 0;var VN=Xu.create("diffusion.RecoverableUpdateStream"),kN=function(){function e(e,t){this.counter=e,this.updateValue=t}return e.prototype.initPromise=function(e){this.promise=e},e.prototype.getPromise=function(){return this.promise},e}(),FN=function(){function e(e,t){this.counter=Sl.MIN_SAFE_INTEGER,this.priorException=void 0,this.queue=[],this.streamSupplier=Zl.requireNonNull(e,"supplier"),this.delegate=Zl.requireNonNull(e(),"supplier return value"),this.strategy=Zl.requireNonNull(t,"strategy")}return e.prototype.set=function(e){return BN(this,void 0,void 0,(function(){var t,r,n,o;return qN(this,(function(i){switch(i.label){case 0:return void 0===this.recoveryCompletionPromise?[3,2]:[4,this.recoveryCompletionPromise];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),t=new kN(this.counter++,e),this.queue.push(t),r=this.delegate.set(e),t.initPromise(r),[4,r];case 3:return n=i.sent(),this.processUpdateResponse(t,n),[2,n];case 4:throw o=i.sent(),this.processException(o),o;case 5:return[2]}}))}))},e.prototype.get=function(){return this.delegate.get()},e.prototype.validate=function(){return BN(this,void 0,void 0,(function(){var e;return qN(this,(function(t){switch(t.label){case 0:return void 0===this.recoveryCompletionPromise?[3,2]:[4,this.recoveryCompletionPromise];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,this.delegate.validate()];case 3:return[2,t.sent()];case 4:throw e=t.sent(),this.processException(e),e;case 5:return[2]}}))}))},e.prototype.isRecoverable=function(){return this.isRecoverableImpl()},e.prototype.recover=function(){return BN(this,void 0,void 0,(function(){var e,t,r,n,o=this;return qN(this,(function(i){switch(i.label){case 0:if(!this.isRecoverableImpl(this.priorException))throw new va.IllegalStateError("Can only recover following a recoverable exception");this.priorException=void 0,e=void 0,this.recoveryCompletionPromise=new Promise((function(t){e=t})),this.synchronisePendingWork(),t=this.strategy.attempts,r=!0,i.label=1;case 1:if(0===this.queue.length&&!r)return[3,8];r=!1,i.label=2;case 2:return i.trys.push([2,6,,7]),[4,new Promise((function(e){return setTimeout(e,o.strategy.interval)}))];case 3:return i.sent(),VN.trace("Attempting recovery of "+this.queue.length+" topic updates"),this.delegate=this.streamSupplier(),[4,this.delegate.validate()];case 4:return i.sent(),[4,Promise.all(this.queue.map((function(e){return o.delegate.set(e.updateValue).then((function(t){return o.processUpdateResponse(e,t)}))})))];case 5:return i.sent(),VN.trace("Completed recovery during attempt "+(this.strategy.attempts-t)),e(),this.recoveryCompletionPromise=void 0,[3,7];case 6:if(n=i.sent(),this.processUpdateError(n),r=!0,t!==Sl.MAX_SAFE_INTEGER&&t--,!this.isRecoverableImpl(n)||t<=0)throw e(),this.recoveryCompletionPromise=void 0,new va.RetryLimitError("Cannot recover within strategy: "+JSON.stringify(this.strategy));return[3,7];case 7:return[3,1];case 8:return[2]}}))}))},e.prototype.synchronisePendingWork=function(){return BN(this,void 0,void 0,(function(){var e;return qN(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Promise.all(this.queue.map((function(e){return e.getPromise()})))];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),VN.debug("Synchronizing pending work",e),[3,3];case 3:return[2]}}))}))},e.prototype.processUpdateResponse=function(e,t){VN.trace("Received set response: {}, result: {}",e.updateValue,t);var r=this.queue.findIndex((function(t){return t.counter===e.counter}));if(-1===r)throw new va.AssertionError("Cannot find topic update in queue "+e);this.queue.splice(r,1)},e.prototype.processUpdateError=function(e){this.processException(e),this.isRecoverableImpl(e)&&VN.trace("Recoverable error detected. "+this.queue.length+" updates can be recovered.",e)},e.prototype.processException=function(e){void 0===this.priorException&&(this.priorException=e)},e.prototype.isRecoverableImpl=function(e){var t=null!=e?e:this.priorException;return null!=t&&(t.id===_c.ErrorReason.CLUSTER_ROUTING.id||void 0!==t.cause&&this.isRecoverableImpl(t.cause))},e}();UN.RecoverableUpdateStreamImpl=FN;var GN={},HN=this&&this.__assign||function(){return(HN=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(GN,"__esModule",{value:!0}),GN.UpdateStreamBuilderImpl=void 0;var YN=new UA.Unconstrained,WN=function(){function e(e,t){this.topicSpecification=null,this.topicConstraint=YN,this.theSuppressDeltas=!1,this.context=e,this.updateStreamFactory=t}return e.prototype.isSupportedTopicType=function(e){var t=this.context.TopicTypeEnum;return Object.keys(t).some((function(r){return t[r]===e}))},e.prototype.specification=function(e){return null==e?this.topicSpecification=null:this.isSupportedTopicType(e)?this.topicSpecification=new this.context.TopicSpecification(e):this.topicSpecification=e,this},e.prototype.constraint=function(e){return this.topicConstraint=null==e?YN:e,this},e.prototype.suppressDeltas=function(e){return this.theSuppressDeltas=e,this},e.prototype.reset=function(){return this.topicSpecification=null,this.topicConstraint=YN,this.theSuppressDeltas=!1,this},e.prototype.build=function(e,t,r){var n=this;Zl.requireNonNull(e,"path"),Zl.requireNonNull(t,"dataType");var o=function(){return null!==n.topicSpecification?n.updateStreamFactory.createUpdateStreamThatAddsTopic(e,n.topicSpecification,t,n.topicConstraint,n.theSuppressDeltas):n.updateStreamFactory.createUpdateStream(e,t,n.topicConstraint,n.theSuppressDeltas)};if(void 0===r)return o();var i=Jv.DEFAULT_RETRY_STRATEGY;if(void 0!==r.attempts){if(Zl.requireNonNull(r.interval,"retry strategy interval"),r.interval<1)throw new va.IllegalArgumentError("Invalid retry strategy interval.");if(r.attempts<1)throw new va.IllegalArgumentError("Invalid retry strategy attempts.");i=HN({},r)}else if(void 0!==r.interval){if(r.interval<1)throw new va.IllegalArgumentError("Invalid retry strategy interval.");i={interval:r.interval,attempts:Sl.MAX_SAFE_INTEGER}}return new UN.RecoverableUpdateStreamImpl(o,i)},e}();GN.UpdateStreamBuilderImpl=WN;var zN={};Object.defineProperty(zN,"__esModule",{value:!0}),zN.TopicUpdateImpl=void 0;var QN=Xu.create("Session.TopicUpdate"),KN=new UA.Unconstrained,JN=function(){function e(e){this.internal=e;var t=e.getServiceLocator();this.SET_TOPIC=t.obtain(eN.SET_TOPIC),this.ADD_AND_SET_TOPIC=t.obtain(eN.ADD_AND_SET_TOPIC),this.APPLY_JSON_PATCH=t.obtain(eN.APPLY_JSON_PATCH);var r={CREATE_UPDATE_STREAM:t.obtain(eN.CREATE_UPDATE_STREAM),CREATE_UPDATE_STREAM_AND_SET:t.obtain(eN.CREATE_UPDATE_STREAM_AND_SET),CHECK_UPDATE_STREAM:t.obtain(eN.CHECK_UPDATE_STREAM),STREAM_SET_TOPIC_SERVICE:t.obtain(eN.STREAM_SET_TOPIC_SERVICE),STREAM_APPLY_DELTA_SERVICE:t.obtain(eN.STREAM_APPLY_DELTA_SERVICE),STREAM_ADD_TOPIC_SERVICE:t.obtain(eN.STREAM_ADD_TOPIC_SERVICE),STREAM_ADD_AND_SET_TOPIC_SERVICE:t.obtain(eN.STREAM_ADD_AND_SET_TOPIC_SERVICE)};this.updateStreamFactory=new LN.UpdateStreamFactory(r,e.getContext())}return e.prototype.setTopic=function(e,t,r,n){var o=this;return new Promise((function(i,s){var a=o.internal.getContext().TopicTypeEnum;o.SET_TOPIC.send({path:e,topicType:a[t.name().toUpperCase()],value:t.toBytes(r).asArray(),constraint:n},(function(e){e?(QN.debug("Set topic failed"),s(e)):i()}))}))},e.prototype.addAndSetTopic=function(e,t,r,n,o){var i=this,s=this.internal.getContext().TopicTypeEnum;if(t.type!==s[r.name().toUpperCase()]&&t.type!==s.TIME_SERIES)throw new va.IllegalArgumentError("The specification and value have different data types");var a=r.toBytes(n).asArray();return new Promise((function(r,n){i.ADD_AND_SET_TOPIC.send({path:e,topicSpecification:t,value:a,constraint:o},(function(e,t){e?(QN.debug("Add and set topic failed"),n(e)):r(t.result)}))}))},e.prototype.set=function(e,t,r,n){var o=void 0!==n&&void 0!==n.constraint?n.constraint:KN;return void 0!==n&&void 0!==n.specification?this.addAndSetTopic(e,n.specification,t,r,o):this.setTopic(e,t,r,o)},e.prototype.createUpdateStream=function(e,t,r){var n,o=null!==(n=null==r?void 0:r.constraint)&&void 0!==n?n:KN;return void 0!==r&&void 0!==r.specification?this.updateStreamFactory.createUpdateStreamThatAddsTopic(e,r.specification,t,o):this.updateStreamFactory.createUpdateStream(e,t,o)},e.prototype.newUpdateStreamBuilder=function(){return new GN.UpdateStreamBuilderImpl(this.internal.getContext(),this.updateStreamFactory)},e.prototype.applyJsonPatch=function(e,t,r){var n=this;return new Promise((function(o,i){n.APPLY_JSON_PATCH.send({path:e,patch:"string"==typeof t?t:JSON.stringify(t),constraint:r||KN},(function(e,t){e?(QN.debug("Apply JSON patch failed"),i(e)):o(t)}))}))},e}();zN.TopicUpdateImpl=JN;var $N={};Object.defineProperty($N,"__esModule",{value:!0}),$N.CreateTopicViewResult=void 0;var XN=function(e,t){this.view=e,this.errors=t};$N.CreateTopicViewResult=XN;var ZN={};Object.defineProperty(ZN,"__esModule",{value:!0}),ZN.readTopicView=void 0,ZN.readTopicView=function(e){return{name:Iu.readString(e),specification:Iu.readString(e),roles:new Set(Iu.readCollection(e,Iu.readString))}};var eM={},tM=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(eM,"__esModule",{value:!0}),eM.CreateTopicViewResultSerialiser=void 0;var rM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tM(t,e),t.prototype.read=function(e){if(0===e.peek()){Iu.readByte(e);var t=ZN.readTopicView(e);return new $N.CreateTopicViewResult(t)}var r=yw.ErrorReportListSerialiser.read(e);return new $N.CreateTopicViewResult(void 0,r)},t}(Fu.AbstractSerialiser);eM.CreateTopicViewResultSerialiser=new rM;var nM={};Object.defineProperty(nM,"__esModule",{value:!0}),nM.GetTopicViewResult=void 0;var oM=function(e){this.result=e};nM.GetTopicViewResult=oM;var iM={},sM=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(iM,"__esModule",{value:!0}),iM.GetTopicViewResultSerialiser=void 0;var aM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return sM(t,e),t.prototype.read=function(e){var t=1===Iu.readByte(e)?ZN.readTopicView(e):null;return new nM.GetTopicViewResult(t)},t}(Fu.AbstractSerialiser);iM.GetTopicViewResultSerialiser=new aM;var uM={};Object.defineProperty(uM,"__esModule",{value:!0}),uM.ListTopicViewsResult=void 0;var cM=function(e){this.result=e};uM.ListTopicViewsResult=cM;var lM={},pM=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(lM,"__esModule",{value:!0}),lM.ListTopicViewsResultSerialiser=void 0;var fM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pM(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,ZN.readTopicView);return new uM.ListTopicViewsResult(t)},t}(Fu.AbstractSerialiser);lM.ListTopicViewsResultSerialiser=new fM;var hM={},dM=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(hM,"__esModule",{value:!0}),hM.NamedTopicViewSpecificationSerialiser=void 0;var yM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dM(t,e),t.prototype.write=function(e,t){Iu.writeString(e,t.name),Iu.writeString(e,t.specification)},t}(Fu.AbstractSerialiser);hM.NamedTopicViewSpecificationSerialiser=new yM;var vM={};Object.defineProperty(vM,"__esModule",{value:!0}),vM.GET_TOPIC_VIEW=vM.LIST_TOPIC_VIEWS=vM.REMOVE_TOPIC_VIEW=vM.CREATE_TOPIC_VIEW=void 0,vM.CREATE_TOPIC_VIEW={id:138,request:hM.NamedTopicViewSpecificationSerialiser,response:eM.CreateTopicViewResultSerialiser},vM.REMOVE_TOPIC_VIEW={id:139,request:q_.StringSerialiser,response:av.NullSerialiser},vM.LIST_TOPIC_VIEWS={id:141,request:av.NullSerialiser,response:lM.ListTopicViewsResultSerialiser},vM.GET_TOPIC_VIEW={id:182,request:q_.StringSerialiser,response:iM.GetTopicViewResultSerialiser};var SM={};Object.defineProperty(SM,"__esModule",{value:!0}),SM.NamedTopicViewSpecification=void 0;var _M=function(e,t){this.name=e,this.specification=t};SM.NamedTopicViewSpecification=_M;var EM={};Object.defineProperty(EM,"__esModule",{value:!0}),EM.TopicViewsImpl=void 0;var wM=Xu.create("TopicViews"),mM=function(){function e(e){this.internal=e;var t=e.getServiceLocator();this.CREATE_TOPIC_VIEW=t.obtain(vM.CREATE_TOPIC_VIEW),this.LIST_TOPIC_VIEWS=t.obtain(vM.LIST_TOPIC_VIEWS),this.GET_TOPIC_VIEW=t.obtain(vM.GET_TOPIC_VIEW),this.REMOVE_TOPIC_VIEW=t.obtain(vM.REMOVE_TOPIC_VIEW)}return e.prototype.createTopicView=function(e,t){var r=this;return new Promise((function(n,o){if(0===Zl.requireNonNull(e,"name").length)throw new va.IllegalArgumentError("Topic View name cannot be empty");if(r.internal.checkConnected(o)){var i=new SM.NamedTopicViewSpecification(e,Zl.requireNonNull(t,"specification"));r.CREATE_TOPIC_VIEW.send(i,(function(e,t){od.responseSuccess(e,t)?t.errors?(o(t.errors.errors),wM.debug("Create topic view failed")):n(t.view):(o(e),wM.debug("Create topic view failed"))}))}}))},e.prototype.listTopicViews=function(){var e=this;return new Promise((function(t,r){e.internal.checkConnected(r)&&e.LIST_TOPIC_VIEWS.send(null,(function(e,n){od.responseSuccess(e,n)?t(n.result):(r(e),wM.debug("List topic views failed"))}))}))},e.prototype.getTopicView=function(e){var t=this;return new Promise((function(r,n){t.internal.checkConnected(n)&&t.GET_TOPIC_VIEW.send(Zl.requireNonNull(e,"name"),(function(e,t){od.responseSuccess(e,t)?r(t.result):(n(e),wM.debug("Get topic view failed"))}))}))},e.prototype.removeTopicView=function(e){var t=this;return new Promise((function(r,n){t.internal.checkConnected(n)&&t.REMOVE_TOPIC_VIEW.send(Zl.requireNonNull(e,"name"),(function(e){e?(n(e),wM.debug("Remove topic view failed")):r()}))}))},e}();EM.TopicViewsImpl=mM;var gM={};Object.defineProperty(gM,"__esModule",{value:!0}),gM.TopicResultImpl=void 0;var TM=function(){function e(e,t,r,n,o){this.mPath=e,this.mType=t,this.mValue=r,this.mProperties=n,this.sizeInfo=o}return e.prototype.path=function(){return this.mPath},e.prototype.type=function(){return this.mType},e.prototype.value=function(){return this.mValue},e.prototype.specification=function(){return new Cc.TopicSpecification(this.mType,this.mProperties)},e.prototype.valueSize=function(){return this.sizeInfo.valueSize},e.prototype.valueCount=function(){return this.sizeInfo.valueCount},e.prototype.valueTotalSize=function(){return this.sizeInfo.valueTotalSize},e}();gM.TopicResultImpl=TM;var OM={};Object.defineProperty(OM,"__esModule",{value:!0}),OM.FetchResultImpl=OM.TIME_SERIES_DATA_TYPE=void 0;var IM=f({});OM.TIME_SERIES_DATA_TYPE=IM.TimeSeriesEventDataType.create({name:function(){return"event data type"},readValue:function(e){return e},toBytes:function(e){return e}});var bM=function(){function e(e,t,r){this.resultList=t.results.map((function(n){var o;if(void 0!==n.value)if(n.type===r.TopicTypeEnum.TIME_SERIES){var i=OM.TIME_SERIES_DATA_TYPE.readAs(OM.TIME_SERIES_DATA_TYPE.valueClass,n.value);o=e instanceof r.TimeSeriesEventDataType||e instanceof Gc.AnyDataTypeImpl?i:e.readAs(e.valueClass,i.value)}else{o=r.DataTypes.get(n.type).readAs(e.valueClass,n.value)}return new gM.TopicResultImpl(n.path,n.type,o,0===t.properties.length?{}:t.properties[n.propertiesIndex],n.topicSizeInfo)})),this.hasMoreFlag=t.hasMore}return e.prototype.results=function(){return this.resultList},e.prototype.hasMore=function(){return this.hasMoreFlag},e.prototype.size=function(){return this.resultList.length},e.prototype.isEmpty=function(){return 0===this.resultList.length},e}();OM.FetchResultImpl=bM;var RM={};Object.defineProperty(RM,"__esModule",{value:!0}),RM.FetchQuery=void 0;var CM=function(e,t,r,n,o,i,s,a,u,c,l){this.selector=Zl.requireNonNull(e,"FetchQuery.selector"),this.range=t,this.topicTypes=Zl.requireNonNull(r,"FetchQuery.topicTypes"),this.withValues=n,this.withProperties=o,this.limit=i,this.maximumResultSize=s,this.deepBranchDepth=a,this.deepBranchLimit=u,this.withUnpublishedDelayedTopics=c,this.withSizes=l};RM.FetchQuery=CM;var AM={};Object.defineProperty(AM,"__esModule",{value:!0}),AM.FetchTopicResult=void 0;var PM=function(e,t,r,n,o){this.path=e,this.type=t,this.value=o,this.propertiesIndex=r,this.topicSizeInfo=n};AM.FetchTopicResult=PM;var NM={};Object.defineProperty(NM,"__esModule",{value:!0}),NM.FetchQueryResult=void 0;var MM=function(e,t,r){this.properties=e,this.results=t,this.hasMore=r};NM.FetchQueryResult=MM;var DM,jM={};Object.defineProperty(jM,"__esModule",{value:!0}),jM.NO_TOPIC_SIZE_INFO=jM.FetchTopicSizeType=void 0,function(e){e[e.NO_SIZE_INFO=0]="NO_SIZE_INFO",e[e.SIMPLE_SIZE_INFO=1]="SIMPLE_SIZE_INFO",e[e.TIME_SERIES_SIZE_INFO=2]="TIME_SERIES_SIZE_INFO"}(DM=jM.FetchTopicSizeType||(jM.FetchTopicSizeType={})),jM.NO_TOPIC_SIZE_INFO={infoType:DM.NO_SIZE_INFO,valueSize:0,valueCount:0,valueTotalSize:new ka(0)};var LM={},xM=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function UM(e){return Iu.readDictionary(e,Iu.readString)}function BM(e){var t=Iu.readString(e),r=Wh.read(e,Dc.TopicTypeEnum),n=0!==Iu.readByte(e)?Iu.readBytes(e):void 0,o=Iu.readInt32(e),i=function(e){var t=Wh.read(e,jM.FetchTopicSizeType);if(t===jM.FetchTopicSizeType.SIMPLE_SIZE_INFO){var r=Iu.readInt32(e);return{infoType:t,valueSize:r,valueCount:1,valueTotalSize:new ka(r)}}return t===jM.FetchTopicSizeType.TIME_SERIES_SIZE_INFO?{infoType:t,valueSize:Iu.readInt32(e),valueCount:Iu.readInt32(e),valueTotalSize:Iu.readInt64(e)}:jM.NO_TOPIC_SIZE_INFO}(e);return new AM.FetchTopicResult(t,r,o,i,n)}Object.defineProperty(LM,"__esModule",{value:!0}),LM.FetchQueryResultSerialiser=void 0;var qM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xM(t,e),t.prototype.read=function(e){var t=Iu.readCollection(e,UM),r=Iu.readCollection(e,BM),n=Iu.readBoolean(e);return new NM.FetchQueryResult(t,r,n)},t}(Fu.AbstractSerialiser);LM.FetchQueryResultSerialiser=new qM;var VM={};Object.defineProperty(VM,"__esModule",{value:!0}),VM.write=void 0,VM.write=function(e,t){var r=ka.UZERO,n={write:function(e){if(e>=64)throw new va.IOError("Cannot encode enum in long, "+e+" >= 64'");r=r.or(ka.ONE.shiftLeft(e))}};t.forEach((function(e){Wh.write(n,e)})),Iu.writeInt64(e,r)};var kM={},FM=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function GM(e,t){void 0===t?Iu.writeByte(e,0):(Iu.writeByte(e,1),Iu.writeString(e,t.path),Iu.writeBoolean(e,t.includesPath))}Object.defineProperty(kM,"__esModule",{value:!0}),kM.FetchQuerySerialiser=void 0;var HM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return FM(t,e),t.prototype.write=function(e,t){k_.TopicSelectorSerialiser.write(e,t.selector),function(e,t){GM(e,t.from),GM(e,t.to)}(e,t.range),VM.write(e,t.topicTypes),Iu.writeBoolean(e,t.withValues),Iu.writeBoolean(e,t.withProperties),Iu.writeInt32(e,t.limit),Iu.writeInt32(e,t.maximumResultSize),Iu.writeInt32(e,t.deepBranchDepth),Iu.writeInt32(e,t.deepBranchLimit),Iu.writeBoolean(e,t.withUnpublishedDelayedTopics),Iu.writeBoolean(e,t.withSizes)},t}(Fu.AbstractSerialiser);kM.FetchQuerySerialiser=new HM;var YM={};Object.defineProperty(YM,"__esModule",{value:!0}),YM.FETCH_QUERY=YM.UNSUBSCRIBE=YM.SUBSCRIBE=void 0,YM.SUBSCRIBE={id:3,request:k_.TopicSelectorSerialiser,response:av.NullSerialiser},YM.UNSUBSCRIBE={id:4,request:k_.TopicSelectorSerialiser,response:av.NullSerialiser},YM.FETCH_QUERY={id:117,request:kM.FetchQuerySerialiser,response:LM.FetchQueryResultSerialiser};var WM={},zM=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(WM,"__esModule",{value:!0}),WM.FetchRequestImpl=void 0;var QM=Xu.create("Fetch Request"),KM=function(e,t){this.path=e,this.includesPath=t},JM=function(){function e(e,t){this.from=e,this.to=t}return e.prototype.isUnbounded=function(){return void 0===this.from&&void 0===this.to},e}();function $M(e,t,r){if(t===Dc.TopicTypeEnum.TIME_SERIES)return OM.TIME_SERIES_DATA_TYPE.canReadAs(r);var n=e.getByValue(t);return null!==n&&void 0!==r.valueClass&&n.canReadAs(r.valueClass)}function XM(e,t){if(!Number.isInteger(e)||e<0)throw new va.IllegalArgumentError("Invalid argument "+t+": "+e);return e}var ZM=function(e){function t(t,r){var n=e.call(this)||this,o={range:new JM,topicTypes:Lc.FetchRequest.getAllTypes(),dataType:void 0,withProperties:!1,limit:Sl.MAX_INT32,maximumResultSize:t.getOptions().maxMessageSize,deepBranchDepth:Sl.MAX_INT32,deepBranchLimit:Sl.MAX_INT32,withUnpublishedDelayedTopics:!1,withSizes:!1};return n.internal=t,n.options=Object.assign(o,r),n}return zM(t,e),t.prototype.copyOptions=function(){return{range:new JM(this.options.range.from,this.options.range.to),topicTypes:new Set(this.options.topicTypes),dataType:this.options.dataType,withProperties:this.options.withProperties,limit:this.options.limit,maximumResultSize:this.options.maximumResultSize,deepBranchDepth:this.options.deepBranchDepth,deepBranchLimit:this.options.deepBranchLimit,withUnpublishedDelayedTopics:this.options.withUnpublishedDelayedTopics,withSizes:this.options.withSizes}},t.prototype.from=function(e){var r=new KM(e,!0);return new t(this.internal,Object.assign(this.copyOptions(),{range:new JM(r,this.options.range.to)}))},t.prototype.after=function(e){var r=new KM(e,!1);return new t(this.internal,Object.assign(this.copyOptions(),{range:new JM(r,this.options.range.to)}))},t.prototype.to=function(e){var r=new KM(e,!0);return new t(this.internal,Object.assign(this.copyOptions(),{range:new JM(this.options.range.from,r)}))},t.prototype.before=function(e){var r=new KM(e,!1);return new t(this.internal,Object.assign(this.copyOptions(),{range:new JM(this.options.range.from,r)}))},t.prototype.topicTypes=function(e){var r=this;if(Array.isArray(e)&&(e=new Set(e)),0===e.size)throw new va.IllegalArgumentError("No types specified");var n=Lc.FetchRequest.getAllTypes(),o=this.internal.getContext();return e.forEach((function(e){if(!n.has(e))throw new va.IllegalArgumentError("Invalid topic type "+e.id);if(void 0!==r.options.dataType&&!$M(o.DataTypes,e,r.options.dataType)&&e!==o.TopicTypeEnum.TIME_SERIES)throw new va.IllegalArgumentError("Topic type "+e.id+" cannot be read as "+r.options.dataType)})),new t(this.internal,Object.assign(this.copyOptions(),{topicTypes:e}))},t.prototype.withValues=function(e){var r,n=this;if(void 0===e||e instanceof Gc.AnyDataTypeImpl)r=this.options.topicTypes;else if(r=new Set(this.options.topicTypes),this.options.topicTypes.forEach((function(t){$M(n.internal.getContext().DataTypes,t,e)||r.delete(t)})),0===r.size)throw new va.IllegalArgumentError("No selected topic types can be read as "+e);return new t(this.internal,Object.assign(this.copyOptions(),{topicTypes:r,dataType:e}))},t.prototype.withSizes=function(){return new t(this.internal,Object.assign(this.copyOptions(),{withSizes:!0}))},t.prototype.withProperties=function(){return new t(this.internal,Object.assign(this.copyOptions(),{withProperties:!0}))},t.prototype.first=function(e){return new t(this.internal,Object.assign(this.copyOptions(),{limit:XM(e,"count")}))},t.prototype.last=function(e){return new t(this.internal,Object.assign(this.copyOptions(),{limit:0-XM(e,"count")}))},t.prototype.maximumResultSize=function(e){return new t(this.internal,Object.assign(this.copyOptions(),{maximumResultSize:Math.min(XM(e,"maximumSize"),this.internal.getOptions().maxMessageSize)}))},t.prototype.limitDeepBranches=function(e,r){return new t(this.internal,Object.assign(this.copyOptions(),{deepBranchDepth:XM(e,"deepBranchDepth"),deepBranchLimit:XM(r,"deepBranchLimit")}))},t.prototype.withUnpublishedDelayedTopics=function(){return new t(this.internal,Object.assign(this.copyOptions(),{withUnpublishedDelayedTopics:!0}))},t.prototype.fetch=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this.internal.getContext().parseSelector,i=this.internal.getServiceLocator(),s=i.obtain(YM.FETCH_QUERY),a=o(arguments.length>1?Array.prototype.slice.call(arguments):e),u=new RM.FetchQuery(a,this.options.range,this.options.topicTypes,void 0!==this.options.dataType,this.options.withProperties,this.options.limit,this.options.maximumResultSize,this.options.deepBranchDepth,this.options.deepBranchLimit,this.options.withUnpublishedDelayedTopics,this.options.withSizes);return new Promise((function(e,r){s.send(u,(function(n,o){if(od.responseSuccess(n,o))try{var i=new OM.FetchResultImpl(t.options.dataType,o,t.internal.getContext());e(i)}catch(n){r(n)}else QM.debug("Fetch query failed"),r(n)}))}))},t}(Lc.FetchRequest);WM.FetchRequestImpl=ZM;var eD={},tD=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(eD,"__esModule",{value:!0}),eD.ValueStreamImpl=void 0;var rD=function(e){function t(t,r){var n=e.call(this,t)||this;return n.selector=r,n}return tD(t,e),t}(Vh.StreamImpl);eD.ValueStreamImpl=rD;var nD={},oD=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(nD,"__esModule",{value:!0}),nD.ValueStreamTimeseriesToPrimitiveAdapter=nD.ValueStreamTimeseriesAdapter=nD.ValueStreamAdapter=void 0;var iD=p({}),sD=function(){function e(e,t,r){this.stream=e,this.datatype=t,this.sourceDatatype=this.getSourceDataType(r)}return e.prototype.selects=function(e){return this.stream.selects(e)},e.prototype.onOpen=function(){return this.stream.onOpen()},e.prototype.onDelta=function(e,t,r,n,o,i,s){return this.stream.onDelta(e,t,r,n,o,null!==r?this.readAsDataType(r,i):null,this.readAsDataType(n,s))},e.prototype.onValue=function(e,t,r,n,o,i){return this.stream.onValue(e,t,r,n,null!==r?this.readAsDataType(r,o):null,this.readAsDataType(n,i))},e.prototype.onSubscription=function(e,t){return this.stream.onSubscription(e,t)},e.prototype.onUnsubscription=function(e,t,r){return this.stream.onUnsubscription(e,t,r)},e.prototype.onSubscriptionError=function(e){return this.stream.onSubscriptionError(e)},e}(),aD=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return oD(t,e),t.prototype.getSourceDataType=function(e){return iD.DataTypes.getByValue(e.type)},t.prototype.readAsDataType=function(e){return this.sourceDatatype.readAs(this.datatype.valueClass,e)},t}(sD);nD.ValueStreamAdapter=aD;var uD=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.sourceValuetype=iD.DataTypes.getByName(o.sourceDatatype.valueTypeName),o.destValuetype=iD.DataTypes.getByName(o.datatype.valueTypeName),o}return oD(t,e),t.prototype.getSourceDataType=function(e){return iD.DataTypes.timeseries(iD.DataTypes.getByName(e.properties.TIME_SERIES_EVENT_VALUE_TYPE))},t.prototype.readAsDataType=function(e,t){var r;try{r=this.sourceValuetype.writeValueToArray(t.value)}catch(e){throw new va.InvalidDataError(e.message)}var n=this.sourceValuetype.readAs(this.destValuetype.valueClass,r);return new Hf.EventImpl(t.metadata,t.originalEvent,n)},t}(sD);nD.ValueStreamTimeseriesAdapter=uD;var cD=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.sourceValuetype=iD.DataTypes.getByName(o.sourceDatatype.valueTypeName),o}return oD(t,e),t.prototype.getSourceDataType=function(e){return iD.DataTypes.timeseries(iD.DataTypes.getByName(e.properties.TIME_SERIES_EVENT_VALUE_TYPE))},t.prototype.readAsDataType=function(e,t){var r;try{r=this.sourceValuetype.writeValueToArray(t.value)}catch(e){throw new va.InvalidDataError(e.message)}return this.sourceValuetype.readAs(this.datatype.valueClass,r)},t}(sD);nD.ValueStreamTimeseriesToPrimitiveAdapter=cD;var lD={};Object.defineProperty(lD,"__esModule",{value:!0}),lD.create=void 0;var pD=p({}),fD=f({}),hD=function(){function e(e,t,r,n,o,i){var s=this;this.pending=!0;var a=Gh.Emitter.create();this.subscription=o(a,t),this.emitter=a.emitter(this.subscription),this.subscription.on("close",(function(){e.remove(s)})),this.adapterFactory=i,this.datatype=r,this.registry=e;var u=this.subscription.on.bind(this.subscription);this.subscription.on=function(o,i){var a=u(o,i);if(s.pending){try{n?e.addFallback(s,r):e.add(t,s,r)}catch(e){s.emitter.error(_c.ErrorReason.INVALID_DATA)}s.pending=!1}return a}}return e.prototype.selects=function(e){if(e){if(e.type===Dc.TopicTypeEnum.TIME_SERIES){var t=pD.DataTypes.get(e.properties.TIME_SERIES_EVENT_VALUE_TYPE),r=this.datatype instanceof fD.TimeSeriesEventDataType?pD.DataTypes.get(this.datatype.valueTypeName):this.datatype;return!!t&&t.canReadAs(r.valueClass)}return pD.DataTypes.getByValue(e.type).canReadAs(this.datatype.valueClass)}return!1},e.prototype.adapter=function(e){return e.type===Dc.TopicTypeEnum.TIME_SERIES&&this.datatype.valueTypeName===e.properties.TIME_SERIES_EVENT_VALUE_TYPE||e.type===Dc.TopicTypeEnum[this.datatype.name().toUpperCase()]||"any"===this.datatype.name()?this:this.adapterFactory(this,this.datatype,e)},e.prototype.onOpen=function(){this.emitter.emit("open",this.subscription)},e.prototype.onDelta=function(e,t,r,n,o,i,s){this.emitter.emit("value",e,t,s,i)},e.prototype.onValue=function(e,t,r,n,o,i){this.emitter.emit("value",e,t,i,o)},e.prototype.onSubscription=function(e,t){this.emitter.emit("subscribe",e,t)},e.prototype.onUnsubscription=function(e,t,r){this.emitter.emit("unsubscribe",e,t,r)},e.prototype.onSubscriptionError=function(e){this.emitter.error(e),this.registry.remove(this)},e}(),dD=new ch.SelectorSet([]);lD.create=function(e,t,r,n){return void 0===n&&(n=dD),new hD(e,n,t,r,(function(e,t){return new eD.ValueStreamImpl(e,t)}),(function(e,r,n){return t instanceof fD.TimeSeriesEventDataType?new nD.ValueStreamTimeseriesAdapter(e,r,n):n.type===Dc.TopicTypeEnum.TIME_SERIES?new nD.ValueStreamTimeseriesToPrimitiveAdapter(e,r,n):new nD.ValueStreamAdapter(e,r,n)})).subscription};var yD={},vD=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(yD,"__esModule",{value:!0}),yD.TopicsImpl=void 0;var SD=p({}),_D=Xu.create("Session"),ED=function(e){function t(t,r){var n=e.call(this,r)||this;return n.internal=t,n.UNSUBSCRIBE=t.getServiceLocator().obtain(YM.UNSUBSCRIBE),n.SUBSCRIBE=t.getServiceLocator().obtain(YM.SUBSCRIBE),n.streamRegistry=t.getStreamRegistry(),n}return vD(t,e),t.prototype.unsubscribe=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=arguments,i=this.internal.getContext().parseSelector;return new Promise((function(r,n){try{var s=o.length>1?i(Array.prototype.slice.call(o)):i(e);if(t.internal.checkConnected(n)){_D.debug("Unsubscribing",e),t.UNSUBSCRIBE.send(s,(function(t){t?(_D.debug("Unsubscribe failed",e),n(t)):(_D.debug("Unsubscribe complete",e),r())}))}}catch(e){n(e)}}))},t.prototype.fetchRequest=function(){return new WM.FetchRequestImpl(this.internal)},t.prototype.select=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=arguments,i=this.internal.getContext().parseSelector;return new Promise((function(r,n){_D.debug("Subscribing",e);try{var s=o.length>1?i(Array.prototype.slice.call(o)):i(e);t.internal.checkConnected(n)&&t.SUBSCRIBE.send(s,(function(e){e?n(e):r()}))}catch(e){n(e)}}))},t.prototype.addStream=function(e,t){if(2!==arguments.length)throw new va.IllegalArgumentError("Both topic selector and value type are needed");if(!t||SD.DataTypes.get(t))throw new va.IllegalArgumentError("Data type required");var r=this.internal.getContext().parseSelector(e);return lD.create(this.streamRegistry,t,!1,r)},t.prototype.addFallbackStream=function(e){if(!e||SD.DataTypes.get(e))throw new va.IllegalArgumentError("Data type required");return lD.create(this.streamRegistry,e,!0)},t}(Vh.StreamImpl);yD.TopicsImpl=ED;var wD={exports:{}};!function(e,t){"use strict";var r="model",n="name",o="type",i="vendor",s="version",a="mobile",u="tablet",c="smarttv",l=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},p=function(e,t){return"string"==typeof e&&-1!==f(t).indexOf(f(e))},f=function(e){return e.toLowerCase()},h=function(e,t){if("string"==typeof e)return e=e.replace(/^\s\s*/,""),void 0===t?e:e.substring(0,500)},d=function(e,t){for(var r,n,o,i,s,a,u=0;u<t.length&&!s;){var c=t[u],l=t[u+1];for(r=n=0;r<c.length&&!s&&c[r];)if(s=c[r++].exec(e))for(o=0;o<l.length;o++)a=s[++n],"object"==typeof(i=l[o])&&i.length>0?2===i.length?"function"==typeof i[1]?this[i[0]]=i[1].call(this,a):this[i[0]]=i[1]:3===i.length?"function"!=typeof i[1]||i[1].exec&&i[1].test?this[i[0]]=a?a.replace(i[1],i[2]):void 0:this[i[0]]=a?i[1].call(this,a,i[2]):void 0:4===i.length&&(this[i[0]]=a?i[3].call(this,a.replace(i[1],i[2])):void 0):this[i]=a||void 0;u+=2}},y=function(e,t){for(var r in t)if("object"==typeof t[r]&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(p(t[r][n],e))return"?"===r?void 0:r}else if(p(t[r],e))return"?"===r?void 0:r;return e},v={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},S={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[s,[n,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[s,[n,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[n,s],[/opios[\/ ]+([\w\.]+)/i],[s,[n,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[s,[n,"Opera"]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[s,[n,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[n,s],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[s,[n,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[s,[n,"WeChat"]],[/konqueror\/([\w\.]+)/i],[s,[n,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[s,[n,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[s,[n,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[s,[n,"Smart Lenovo Browser"]],[/(avast|avg)\/([\w\.]+)/i],[[n,/(.+)/,"$1 Secure Browser"],s],[/\bfocus\/([\w\.]+)/i],[s,[n,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[s,[n,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[s,[n,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[s,[n,"Dolphin"]],[/coast\/([\w\.]+)/i],[s,[n,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[s,[n,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[s,[n,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[n,"360 Browser"]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[n,/(.+)/,"$1 Browser"],s],[/samsungbrowser\/([\w\.]+)/i],[s,[n,"Samsung Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[n,/_/g," "],s],[/metasr[\/ ]?([\d\.]+)/i],[s,[n,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[n,"Sogou Mobile"],s],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[n,s],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[n],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[n,"Facebook"],s],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[n,s],[/\bgsa\/([\w\.]+) .*safari\//i],[s,[n,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[s,[n,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[s,[n,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[n,"Chrome WebView"],s],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[s,[n,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[n,s],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[s,[n,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[s,n],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[n,[s,y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[n,s],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[n,"Netscape"],s],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[s,[n,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[n,s],[/(cobalt)\/([\w\.]+)/i],[n,[s,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",f]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",f]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",f]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[r,[i,"Samsung"],[o,u]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[r,[i,"Samsung"],[o,a]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[r,[i,"Apple"],[o,a]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[r,[i,"Apple"],[o,u]],[/(macintosh);/i],[r,[i,"Apple"]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[r,[i,"Sharp"],[o,a]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[r,[i,"Huawei"],[o,u]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[r,[i,"Huawei"],[o,a]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[r,/_/g," "],[i,"Xiaomi"],[o,a]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[r,/_/g," "],[i,"Xiaomi"],[o,u]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[r,[i,"OPPO"],[o,a]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[r,[i,"Vivo"],[o,a]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[r,[i,"Realme"],[o,a]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[r,[i,"Motorola"],[o,a]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[r,[i,"Motorola"],[o,u]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[r,[i,"LG"],[o,u]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[r,[i,"LG"],[o,a]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[r,[i,"Lenovo"],[o,u]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[r,/_/g," "],[i,"Nokia"],[o,a]],[/(pixel c)\b/i],[r,[i,"Google"],[o,u]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[r,[i,"Google"],[o,a]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[r,[i,"Sony"],[o,a]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[r,"Xperia Tablet"],[i,"Sony"],[o,u]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[r,[i,"OnePlus"],[o,a]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[r,[i,"Amazon"],[o,u]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[r,/(.+)/g,"Fire Phone $1"],[i,"Amazon"],[o,a]],[/(playbook);[-\w\),; ]+(rim)/i],[r,i,[o,u]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[r,[i,"BlackBerry"],[o,a]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[r,[i,"ASUS"],[o,u]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[r,[i,"ASUS"],[o,a]],[/(nexus 9)/i],[r,[i,"HTC"],[o,u]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[i,[r,/_/g," "],[o,a]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[r,[i,"Acer"],[o,u]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[r,[i,"Meizu"],[o,a]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[r,[i,"Ulefone"],[o,a]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[i,r,[o,a]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[i,r,[o,u]],[/(surface duo)/i],[r,[i,"Microsoft"],[o,u]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[r,[i,"Fairphone"],[o,a]],[/(u304aa)/i],[r,[i,"AT&T"],[o,a]],[/\bsie-(\w*)/i],[r,[i,"Siemens"],[o,a]],[/\b(rct\w+) b/i],[r,[i,"RCA"],[o,u]],[/\b(venue[\d ]{2,7}) b/i],[r,[i,"Dell"],[o,u]],[/\b(q(?:mv|ta)\w+) b/i],[r,[i,"Verizon"],[o,u]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[r,[i,"Barnes & Noble"],[o,u]],[/\b(tm\d{3}\w+) b/i],[r,[i,"NuVision"],[o,u]],[/\b(k88) b/i],[r,[i,"ZTE"],[o,u]],[/\b(nx\d{3}j) b/i],[r,[i,"ZTE"],[o,a]],[/\b(gen\d{3}) b.+49h/i],[r,[i,"Swiss"],[o,a]],[/\b(zur\d{3}) b/i],[r,[i,"Swiss"],[o,u]],[/\b((zeki)?tb.*\b) b/i],[r,[i,"Zeki"],[o,u]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[i,"Dragon Touch"],r,[o,u]],[/\b(ns-?\w{0,9}) b/i],[r,[i,"Insignia"],[o,u]],[/\b((nxa|next)-?\w{0,9}) b/i],[r,[i,"NextBook"],[o,u]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[i,"Voice"],r,[o,a]],[/\b(lvtel\-)?(v1[12]) b/i],[[i,"LvTel"],r,[o,a]],[/\b(ph-1) /i],[r,[i,"Essential"],[o,a]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[r,[i,"Envizen"],[o,u]],[/\b(trio[-\w\. ]+) b/i],[r,[i,"MachSpeed"],[o,u]],[/\btu_(1491) b/i],[r,[i,"Rotor"],[o,u]],[/(shield[\w ]+) b/i],[r,[i,"Nvidia"],[o,u]],[/(sprint) (\w+)/i],[i,r,[o,a]],[/(kin\.[onetw]{3})/i],[[r,/\./g," "],[i,"Microsoft"],[o,a]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[r,[i,"Zebra"],[o,u]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[r,[i,"Zebra"],[o,a]],[/smart-tv.+(samsung)/i],[i,[o,c]],[/hbbtv.+maple;(\d+)/i],[[r,/^/,"SmartTV"],[i,"Samsung"],[o,c]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[i,"LG"],[o,c]],[/(apple) ?tv/i],[i,[r,"Apple TV"],[o,c]],[/crkey/i],[[r,"Chromecast"],[i,"Google"],[o,c]],[/droid.+aft(\w+)( bui|\))/i],[r,[i,"Amazon"],[o,c]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[r,[i,"Sharp"],[o,c]],[/(bravia[\w ]+)( bui|\))/i],[r,[i,"Sony"],[o,c]],[/(mitv-\w{5}) bui/i],[r,[i,"Xiaomi"],[o,c]],[/Hbbtv.*(technisat) (.*);/i],[i,r,[o,c]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[i,h],[r,h],[o,c]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[o,c]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[i,r,[o,"console"]],[/droid.+; (shield) bui/i],[r,[i,"Nvidia"],[o,"console"]],[/(playstation [345portablevi]+)/i],[r,[i,"Sony"],[o,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[r,[i,"Microsoft"],[o,"console"]],[/((pebble))app/i],[i,r,[o,"wearable"]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[r,[i,"Apple"],[o,"wearable"]],[/droid.+; (glass) \d/i],[r,[i,"Google"],[o,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[r,[i,"Zebra"],[o,"wearable"]],[/(quest( 2| pro)?)/i],[r,[i,"Facebook"],[o,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[i,[o,"embedded"]],[/(aeobc)\b/i],[r,[i,"Amazon"],[o,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[r,[o,a]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[r,[o,u]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[o,u]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[o,a]],[/(android[-\w\. ]{0,9});.+buil/i],[r,[i,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[s,[n,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[s,[n,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[n,s],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[s,n]],os:[[/microsoft (windows) (vista|xp)/i],[n,s],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[n,[s,y,v]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[s,y,v],[n,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[s,/_/g,"."],[n,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[n,"Mac OS"],[s,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[s,n],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[n,s],[/\(bb(10);/i],[s,[n,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[s,[n,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[s,[n,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[s,[n,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[s,[n,"watchOS"]],[/crkey\/([\d\.]+)/i],[s,[n,"Chromecast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[n,"Chromium OS"],s],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[n,s],[/(sunos) ?([\w\.\d]*)/i],[[n,"Solaris"],s],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[n,s]]},_=function(t,i){if("object"==typeof t&&(i=t,t=void 0),!(this instanceof _))return new _(t,i).getResult();var c=void 0!==e&&e.navigator?e.navigator:void 0,l=t||(c&&c.userAgent?c.userAgent:""),p=c&&c.userAgentData?c.userAgentData:void 0,f=i?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(S,i):S,y=c&&c.userAgent==l;return this.getBrowser=function(){var e={name:void 0,version:void 0};return d.call(e,l,f.browser),e.major=function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0}(e[s]),y&&c&&c.brave&&"function"==typeof c.brave.isBrave&&(e[n]="Brave"),e},this.getCPU=function(){var e={architecture:void 0};return d.call(e,l,f.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return d.call(e,l,f.device),y&&!e[o]&&p&&p.mobile&&(e[o]=a),y&&"Macintosh"==e[r]&&c&&void 0!==c.standalone&&c.maxTouchPoints&&c.maxTouchPoints>2&&(e[r]="iPad",e[o]=u),e},this.getEngine=function(){var e={name:void 0,version:void 0};return d.call(e,l,f.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return d.call(e,l,f.os),y&&!e[n]&&p&&"Unknown"!=p.platform&&(e[n]=p.platform.replace(/chrome os/i,"Chromium OS").replace(/macos/i,"Mac OS")),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return l},this.setUA=function(e){return l="string"==typeof e&&e.length>500?h(e,500):e,this},this.setUA(l),this};_.VERSION="1.0.37",_.BROWSER=l([n,s,"major"]),_.CPU=l(["architecture"]),_.DEVICE=l([r,i,o,"console",a,c,u,"wearable","embedded"]),_.ENGINE=_.OS=l([n,s]),void 0!==wD.exports?(wD.exports&&(wD.exports=wD.exports=_),wD.exports.UAParser=_):void 0!==e&&(e.UAParser=_);var E=void 0!==e&&(e.jQuery||e.Zepto);if(E&&!E.ua){var w=new _;E.ua=w.getResult(),E.ua.get=function(){return w.getUA()},E.ua.set=function(e){w.setUA(e);var t=w.getResult();for(var r in t)E.ua[r]=t[r]}}}("object"==typeof window?window:this),wD=wD.exports;var mD={};(function(e){(function(){"use strict";Object.defineProperty(mD,"__esModule",{value:!0}),mD.getEnvironmentString=void 0,mD.getEnvironmentString=function(){var t;try{if("undefined"!=typeof navigator){var r=new wD.UAParser(navigator.userAgent).getBrowser();return"BROWSER_"+r.name+"_"+r.version}}catch(e){}try{if(void 0!==e&&void 0!==(null===(t=null==e?void 0:e.versions)||void 0===t?void 0:t.node))return"NODE_"+e.platform+"_"+e.versions.node}catch(e){}return"BROWSER_UNKNOWN"}}).call(this)}).call(this,mh);var gD={},TD=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),OD=this&&this.__assign||function(){return(OD=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(gD,"__esModule",{value:!0}),gD.SessionImpl=void 0;var ID=o({}),bD=function(e){function t(t,r,n){var o=this,i=Gh.Emitter.create();o=e.call(this,n,i)||this;var s=i.emitter(o);return n.on({reconnect:function(){s.emit("reconnect")},disconnect:function(e){s.emit("disconnect",e)},error:function(e){s.emit("error",e)},close:function(e){s.emit("close",e)}}),o.sessionId=t,void 0!==aA.TopicControlImpl&&(o.topicsFeature=new aA.TopicControlImpl(n)),void 0!==om.ClientControlImpl&&(o.clientsFeature=new om.ClientControlImpl(n)),void 0!==ID.GatewayControlImpl&&(o.gatewaysFeature=new ID.GatewayControlImpl(n)),void 0!==WT.MessagesImpl&&(o.messagesFeature=new WT.MessagesImpl(n)),void 0!==NA.TopicNotificationsImpl&&(o.notificationsFeature=new NA.TopicNotificationsImpl(n)),void 0!==PI.RemoteServersImpl&&(o.remoteServersFeature=new PI.RemoteServersImpl(n)),void 0!==mR.SecurityImpl&&(o.securityFeature=new mR.SecurityImpl(n)),void 0!==xR.SessionTreesImpl&&(o.sessionTreesFeature=new xR.SessionTreesImpl(n)),void 0!==BC.TimeSeriesImpl&&(o.timeseriesFeature=new BC.TimeSeriesImpl(n)),void 0!==zN.TopicUpdateImpl&&(o.topicUpdateFeature=new zN.TopicUpdateImpl(n)),void 0!==EM.TopicViewsImpl&&(o.topicViewsFeature=new EM.TopicViewsImpl(n)),void 0!==uT.LogRetrieval&&(o.logRetrievalFeature=new uT.LogRetrieval(n)),void 0!==$O.MetricsImpl&&(o.metricsFeature=new $O.MetricsImpl(n)),void 0!==kI.LicenceUpdater&&(o.licenceUpdaterFeature=new kI.LicenceUpdater(n)),void 0!==oI.PingImpl&&(o.pingFeature=new oI.PingImpl(n)),o.options=void 0!==r?r.with({credentials:void 0}):{},o}return TD(t,e),Object.defineProperty(t.prototype,"topics",{get:function(){if(void 0===this.topicsFeature){if(void 0===aA.TopicControlImpl)throw new va.IllegalStateError("Topic Control feature has not been loaded");this.topicsFeature=new aA.TopicControlImpl(this.internal)}return this.topicsFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clients",{get:function(){if(void 0===this.clientsFeature){if(void 0===om.ClientControlImpl)throw new va.IllegalStateError("Client Control feature has not been loaded");this.clientsFeature=new om.ClientControlImpl(this.internal)}return this.clientsFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"messages",{get:function(){if(void 0===this.messagesFeature){if(void 0===WT.MessagesImpl)throw new va.IllegalStateError("Messages feature has not been loaded");this.messagesFeature=new WT.MessagesImpl(this.internal)}return this.messagesFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notifications",{get:function(){if(void 0===this.notificationsFeature){if(void 0===NA.TopicNotificationsImpl)throw new va.IllegalStateError("Topic Notifications feature has not been loaded");this.notificationsFeature=new NA.TopicNotificationsImpl(this.internal)}return this.notificationsFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"security",{get:function(){if(void 0===this.securityFeature){if(void 0===mR.SecurityImpl)throw new va.IllegalStateError("Security feature has not been loaded");this.securityFeature=new mR.SecurityImpl(this.internal)}return this.securityFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionTrees",{get:function(){if(void 0===this.sessionTreesFeature){if(void 0===xR.SessionTreesImpl)throw new va.IllegalStateError("Session Trees feature has not been loaded");this.sessionTreesFeature=new xR.SessionTreesImpl(this.internal)}return this.sessionTreesFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeseries",{get:function(){if(void 0===this.timeseriesFeature){if(void 0===BC.TimeSeriesImpl)throw new va.IllegalStateError("Timeseries feature has not been loaded");this.timeseriesFeature=new BC.TimeSeriesImpl(this.internal)}return this.timeseriesFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topicUpdate",{get:function(){if(void 0===this.topicUpdateFeature){if(void 0===zN.TopicUpdateImpl)throw new va.IllegalStateError("Topic Update feature has not been loaded");this.topicUpdateFeature=new zN.TopicUpdateImpl(this.internal)}return this.topicUpdateFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topicViews",{get:function(){if(void 0===this.topicViewsFeature){if(void 0===EM.TopicViewsImpl)throw new va.IllegalStateError("Topic Views feature has not been loaded");this.topicViewsFeature=new EM.TopicViewsImpl(this.internal)}return this.topicViewsFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remoteServers",{get:function(){if(void 0===this.remoteServersFeature){if(void 0===PI.RemoteServersImpl)throw new va.IllegalStateError("Remote Servers feature has not been loaded");this.remoteServersFeature=new PI.RemoteServersImpl(this.internal)}return this.remoteServersFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logRetrieval",{get:function(){if(void 0===this.logRetrievalFeature){if(void 0===uT.LogRetrieval)throw new va.IllegalStateError("Log Retrieval feature has not been loaded");this.logRetrievalFeature=new uT.LogRetrieval(this.internal)}return this.logRetrievalFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metrics",{get:function(){if(void 0===this.metricsFeature){if(void 0===$O.MetricsImpl)throw new va.IllegalStateError("Metrics feature has not been loaded");this.metricsFeature=new $O.MetricsImpl(this.internal)}return this.metricsFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"licenceUpdater",{get:function(){if(void 0===this.licenceUpdaterFeature){if(void 0===kI.LicenceUpdater)throw new va.IllegalStateError("Licence Updater feature has not been loaded");this.licenceUpdaterFeature=new kI.LicenceUpdater(this.internal)}return this.licenceUpdaterFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gateways",{get:function(){if(void 0===this.gatewaysFeature){if(void 0===ID.GatewayControlImpl)throw new va.IllegalStateError("Gateway Control feature has not been loaded");this.gatewaysFeature=new ID.GatewayControlImpl(this.internal)}return this.gatewaysFeature},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ping",{get:function(){if(void 0===this.pingFeature){if(void 0===oI.PingImpl)throw new va.IllegalStateError("Ping feature has not been loaded");this.pingFeature=new oI.PingImpl(this.internal)}return this.pingFeature},enumerable:!1,configurable:!0}),t.prototype.updateFeatures=function(){this.internal.updateFeatures()},t.prototype.close=function(){return this.internal.close(),this},t.prototype.closeSession=function(){var e=this;return void 0!==this.closeReason?Promise.resolve(this.closeReason):new Promise((function(t,r){e.on("close",(function(r){e.closeReason=r,t(r)})),e.close()}))},t.prototype.isClosed=function(){var e=this.internal.getState();return"closing"===e||"closed"===e},t.prototype.isConnected=function(){return this.internal.isConnected()},t.prototype.toString=function(){return"Session<"+this.sessionId+" "+this.internal.getState()+">"},t.prototype.getPrincipal=function(){return this.options.principal||""},t.prototype.lock=function(e,t){return void 0===t&&(t=Qh.SessionLockScope.UNLOCK_ON_SESSION_LOSS),this.internal.lock(e,t)},t.prototype.pingServer=function(){return this.ping.pingServer()},t.prototype.getServerMaximumMessageSize=function(){return this.internal.getServerMaximumMessageSize()},t.create=function(e,r,n){var o,i;return void 0===n&&(n=!1),n||((i="string"==typeof r?new Jv.OptionsImpl({host:r}):new Jv.OptionsImpl(r)).properties=OD(OD({},i.properties),((o={}).$Environment=mD.getEnvironmentString(),o))),new Promise((function(r,n){var o=e(i);function s(e,n){o.off("connect",s),o.off("close",a),o.off("error",a),r(new t(e,n||i,o))}function a(e){o.off("connect",s),o.off("close",a),o.off("error",a),n(e)}o.on("connect",s),o.on("close",a),o.on("error",a),o.connect()}))},t}(yD.TopicsImpl);gD.SessionImpl=bD;var RD={},CD=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(RD,"__esModule",{value:!0}),RD.isEqualityOperator=RD.PartialJSONImpl=RD.NoValue=RD.NoTopic=RD.TopicValueConstraint=void 0;var AD=p({}),PD=new Uint8Array([-10]),ND=new Uint8Array([-11]),MD=new Uint8Array([-12]),DD=function(e){function t(t,r,n){var o=e.call(this,UA.ConstraintType.TOPIC_VALUE)||this;return o.operator=t,o.valueType=r,o.bytes=n,o}return CD(t,e),t.prototype.andBlockedFor=function(e){return e instanceof UA.NoValueConstraint||e instanceof UD||e instanceof UA.CompoundConstraint&&e.andBlockedFor(this)},t}(UA.TopicConstraint);RD.TopicValueConstraint=DD;var jD=function(e){function t(){return e.call(this,UA.ConstraintType.NO_TOPIC)||this}return CD(t,e),t}(UA.NoValueConstraint);RD.NoTopic=jD;var LD=function(e){function t(){return e.call(this,UA.ConstraintType.NO_VALUE)||this}return CD(t,e),t}(UA.NoValueConstraint);RD.NoValue=LD;var xD=function(e,t,r){this.operator=e,this.valueType=t,this.buffer=r},UD=function(e){function t(t,r){void 0===t&&(t={}),void 0===r&&(r=new Set);var n=e.call(this,UA.ConstraintType.PARTIAL_JSON)||this;return n.withValues=t,n.withoutValues=r,n}return CD(t,e),t.prototype.validateValue=function(e,t){if([UA.ConstraintValueType.BINARY,UA.ConstraintValueType.NULL].includes(t)){if(e!==aP.UpdateConstraintOperator.IS)throw new va.IllegalArgumentError("Invalid operator for Binary value")}else if(t===UA.ConstraintValueType.BOOLEAN){if(e!==aP.UpdateConstraintOperator.EQ)throw new va.IllegalArgumentError("Invalid operator for Boolean value")}else if(t===UA.ConstraintValueType.STRING){if(!BD(e))throw new va.IllegalArgumentError("Invalid operator for String value")}else if(![UA.ConstraintValueType.DOUBLE,UA.ConstraintValueType.INT64].includes(t))throw new va.IllegalArgumentError("value type "+UA.ConstraintValueType[t]+" is not supported with the "+aP.UpdateConstraintOperator[e]+" operator")},t.prototype.andBlockedFor=function(e){return e instanceof UA.NoValueConstraint||e instanceof DD||e instanceof UA.CompoundConstraint&&e.andBlockedFor(this)},t.prototype.getWithValues=function(){return Object.assign({},this.withValues)},t.prototype.getWithoutValues=function(){return new Set(this.withoutValues)},t.prototype.with=function(e,r,n,o){var i=void 0===n||n instanceof ql.AbstractDataType,s=i?aP.UpdateConstraintOperator.IS:n,a=i?n:o;i&&Zl.requireNonNull(r,"value");var u,c,l=Wl.JSONPointer.parse(Zl.requireNonNull(e,"pointer"));if(Zl.requireNonNull(s,"operator"),null==r){if(!BD(s))throw new va.IllegalArgumentError("Invalid operator for null value");u=PD,c=UA.ConstraintValueType.NULL}else{if(void 0!==a)c=UA.ConstraintValueType[a.name().toUpperCase()],u=a.writeValueToArray(r);else if("boolean"==typeof r)c=UA.ConstraintValueType.BOOLEAN,u=r?ND:MD;else{var p=AD.DataTypes.getByValue(r);if(void 0===p)throw new va.IllegalArgumentError("Datatype invalid or could not be inferred");c=UA.ConstraintValueType[p.name().toUpperCase()],u=p.writeValueToArray(r)}this.validateValue(s,c)}var f={};f[l.toString()]=new xD(s,s===aP.UpdateConstraintOperator.IS?UA.ConstraintValueType.BINARY:c,u);var h=Object.assign({},this.withValues,f),d=new Set(this.withoutValues);return d.delete(l.toString()),new t(h,d)},t.prototype.without=function(e){Wl.JSONPointer.parse(Zl.requireNonNull(e,"pointer"));var r=new Set(this.withoutValues);return r.add(e.toString()),new t(this.withValues,r)},t}(UA.TopicConstraint);function BD(e){return[aP.UpdateConstraintOperator.IS,aP.UpdateConstraintOperator.EQ,aP.UpdateConstraintOperator.NE].includes(e)}RD.PartialJSONImpl=UD,RD.isEqualityOperator=BD;var qD={};Object.defineProperty(qD,"__esModule",{value:!0}),qD.updateConstraintFactory=void 0;var VD=p({}),kD=function(){function e(){}return e.prototype.locked=function(e){return new UA.Locked(e)},e.prototype.value=function(e,t,r){var n=1===arguments.length||2===arguments.length&&arguments[1]instanceof ql.AbstractDataType,o=n?aP.UpdateConstraintOperator.IS:e,i=n?e:t,s=n?t:r;Zl.requireNonNull(i,"value"),Zl.requireNonNull(o,"operator");var a=void 0!==s?s:VD.DataTypes.getByValue(i);if(void 0===a)throw new va.IllegalArgumentError("Datatype invalid or could not be inferred");if(o===aP.UpdateConstraintOperator.IS){var u=i instanceof Bl.BytesImpl?i:a.toBytes(i);return new RD.TopicValueConstraint(aP.UpdateConstraintOperator.IS,UA.ConstraintValueType.BINARY,u)}if(a===VD.DataTypes.string()){if(!RD.isEqualityOperator(o))throw new va.IllegalArgumentError("Invalid operator for String value")}else if(a!==VD.DataTypes.double()&&a!==VD.DataTypes.int64())throw new va.IllegalArgumentError("value type "+a.name()+" is not supported with the "+aP.UpdateConstraintOperator[o]+" operator");return new RD.TopicValueConstraint(o,UA.ConstraintValueType[a.name().toUpperCase()],a.toBytes(i))},e.prototype.noValue=function(){return new RD.NoValue},e.prototype.noTopic=function(){return new RD.NoTopic},e.prototype.jsonValue=function(){return new RD.PartialJSONImpl},e}(),FD=Object.freeze(new kD);qD.updateConstraintFactory=FD;var GD={},HD=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},YD=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e};Object.defineProperty(GD,"__esModule",{value:!0}),GD.TopicSelectors=void 0;var WD=function(){function e(){this.Prefix=ih.Prefix,this.Type=ih.Type}return e.prototype.parse=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return xh.parseSelector.apply(void 0,YD([e],HD(t)))},e}();GD.TopicSelectors=WD;var zD={};Object.defineProperty(zD,"__esModule",{value:!0}),zD.LogLevel=void 0,function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.silent="silent"}(zD.LogLevel||(zD.LogLevel={}));var QD={};return function(e){(function(){"use strict";Object.defineProperty(QD,"__esModule",{value:!0}),QD.buffer=QD.MetricType=QD.StatusLevel=QD.LogLevel=QD.TopicCreationResult=QD.Type=QD.Prefix=QD.TopicNotificationType=QD.SessionLockScope=QD.ValidationType=QD.PathPermission=QD.GlobalPermission=QD.RemoteServerType=QD.ConnectionState=QD.ConnectionOption=QD.SessionEventType=QD.CloseReasonEnum=QD.ClientCloseReason=QD.locks=QD.clients=QD.errors=QD.topicUpdate=QD.topics=QD.datatypes=QD.newSessionEventParametersBuilder=QD.newRemoteServerBuilder=QD.selectors=QD.newTopicMetricCollectorBuilder=QD.newSessionMetricCollectorBuilder=QD.newBranchMappingTableBuilder=QD.updateConstraints=QD.rolesToString=QD.stringToRoles=QD.escape=QD.connectShared=QD.connect=QD.log=QD.build=QD.version=void 0;var t=p({});Xu.setLevel("warn"),QD.version="6.11.2",QD.build="internal",QD.log=function(e){Xu.setLevel(e)},QD.connect=function(e,t,r){return gD.SessionImpl.create(AS.create(t,r),e)},QD.connectShared=function(e,t){return gD.SessionImpl.create(AS.createShared(e,t),void 0,!0)},QD.escape=function(e){return O_.escape(e)},QD.stringToRoles=function(e){return O_.stringToRoles(e)},QD.rolesToString=function(e){return O_.rolesToString(e)},QD.updateConstraints=function(){return qD.updateConstraintFactory},QD.newBranchMappingTableBuilder=function(){return O_.newBranchMappingTableBuilder()},QD.newSessionMetricCollectorBuilder=function(){return O_.newSessionMetricCollectorBuilder()},QD.newTopicMetricCollectorBuilder=function(){return O_.newTopicMetricCollectorBuilder()},QD.selectors=new GD.TopicSelectors,QD.newRemoteServerBuilder=function(e){return O_.newRemoteServerBuilder(QD.selectors,e)},QD.newSessionEventParametersBuilder=function(){return O_.newSessionEventParametersBuilder()},QD.datatypes=t.DataTypes,QD.topics=Uc.topicsNamespace,QD.topicUpdate=cP.TopicUpdateNamespace,QD.errors=_c.ErrorReason,QD.clients=qw.ClientControlOptions,QD.locks=Qh.SessionLockOptions,Object.defineProperty(QD,"ClientCloseReason",{enumerable:!0,get:function(){return Ny.ClientCloseReason}}),Object.defineProperty(QD,"CloseReasonEnum",{enumerable:!0,get:function(){return Ny.CloseReasonEnum}}),Object.defineProperty(QD,"SessionEventType",{enumerable:!0,get:function(){return Bw.SessionEventType}}),Object.defineProperty(QD,"ConnectionOption",{enumerable:!0,get:function(){return MS.ConnectionOption}}),Object.defineProperty(QD,"ConnectionState",{enumerable:!0,get:function(){return MS.ConnectionState}}),Object.defineProperty(QD,"RemoteServerType",{enumerable:!0,get:function(){return MS.RemoteServerType}}),Object.defineProperty(QD,"GlobalPermission",{enumerable:!0,get:function(){return ab.GlobalPermission}}),Object.defineProperty(QD,"PathPermission",{enumerable:!0,get:function(){return ab.PathPermission}}),Object.defineProperty(QD,"ValidationType",{enumerable:!0,get:function(){return ab.ValidationType}}),Object.defineProperty(QD,"SessionLockScope",{enumerable:!0,get:function(){return Qh.SessionLockScope}}),Object.defineProperty(QD,"TopicNotificationType",{enumerable:!0,get:function(){return hA.TopicNotificationType}}),Object.defineProperty(QD,"Prefix",{enumerable:!0,get:function(){return ih.Prefix}}),Object.defineProperty(QD,"Type",{enumerable:!0,get:function(){return ih.Type}}),Object.defineProperty(QD,"TopicCreationResult",{enumerable:!0,get:function(){return cP.TopicCreationResult}}),Object.defineProperty(QD,"LogLevel",{enumerable:!0,get:function(){return zD.LogLevel}});var r=o({});Object.defineProperty(QD,"StatusLevel",{enumerable:!0,get:function(){return r.StatusLevel}}),Object.defineProperty(QD,"MetricType",{enumerable:!0,get:function(){return pO.MetricType}}),QD.buffer=e}).call(this)}.call(this,d({}).Buffer),QD}));